[0m11:54:37.842203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b06e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113aebb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113aebd90>]}


============================== 11:54:37.852166 | 521f1ca3-d3b0-4b6e-bfbd-609127ce469e ==============================
[0m11:54:37.852166 [info ] [MainThread]: Running with dbt=1.10.1
[0m11:54:37.853379 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:54:38.376487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '521f1ca3-d3b0-4b6e-bfbd-609127ce469e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fc28b0>]}
[0m11:54:38.485764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '521f1ca3-d3b0-4b6e-bfbd-609127ce469e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139f7bd0>]}
[0m11:54:38.525122 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m11:54:38.720571 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m11:54:38.722153 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:54:38.722989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '521f1ca3-d3b0-4b6e-bfbd-609127ce469e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bf6c50>]}
[0m11:54:41.122812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '521f1ca3-d3b0-4b6e-bfbd-609127ce469e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f14e60>]}
[0m11:54:41.256682 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m11:54:41.262603 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m11:54:41.312994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '521f1ca3-d3b0-4b6e-bfbd-609127ce469e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113dcd8d0>]}
[0m11:54:41.313803 [info ] [MainThread]: Found 2 models, 4 seeds, 4 data tests, 428 macros
[0m11:54:41.314355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '521f1ca3-d3b0-4b6e-bfbd-609127ce469e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fba340>]}
[0m11:54:41.317287 [info ] [MainThread]: 
[0m11:54:41.317802 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:54:41.318245 [info ] [MainThread]: 
[0m11:54:41.318939 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:54:41.326336 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:54:41.426758 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:54:41.427385 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m11:54:41.428139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:54:41.531219 [debug] [ThreadPool]: SQL status: OK in 0.103 seconds
[0m11:54:41.533361 [debug] [ThreadPool]: On list_dev: Close
[0m11:54:41.534469 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:54:41.535149 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:54:41.544057 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:54:41.544582 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m11:54:41.545006 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:54:41.546195 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:54:41.548137 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:54:41.548579 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:54:41.549177 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:54:41.549596 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:54:41.550007 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:54:41.550689 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:54:41.551923 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:54:41.552367 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:54:41.552774 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:54:41.553347 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:54:41.553791 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:54:41.555809 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m11:54:41.563297 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:54:41.563767 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:54:41.564169 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:54:41.564866 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:54:41.565291 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:54:41.565720 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m11:54:41.584457 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m11:54:41.586448 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:54:41.588547 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:54:41.589092 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:54:41.589935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '521f1ca3-d3b0-4b6e-bfbd-609127ce469e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11414f950>]}
[0m11:54:41.590598 [debug] [MainThread]: Using duckdb connection "master"
[0m11:54:41.591027 [debug] [MainThread]: On master: BEGIN
[0m11:54:41.591426 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:54:41.592224 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:54:41.592685 [debug] [MainThread]: On master: COMMIT
[0m11:54:41.593118 [debug] [MainThread]: Using duckdb connection "master"
[0m11:54:41.593532 [debug] [MainThread]: On master: COMMIT
[0m11:54:41.594112 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:54:41.594549 [debug] [MainThread]: On master: Close
[0m11:54:41.601470 [debug] [Thread-1 (]: Began running node seed.suvera.raw_activities
[0m11:54:41.602332 [info ] [Thread-1 (]: 1 of 4 START seed file main.raw_activities ..................................... [RUN]
[0m11:54:41.603018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now seed.suvera.raw_activities)
[0m11:54:41.603545 [debug] [Thread-1 (]: Began compiling node seed.suvera.raw_activities
[0m11:54:41.604070 [debug] [Thread-1 (]: Began executing node seed.suvera.raw_activities
[0m11:54:41.784671 [debug] [Thread-1 (]: Using duckdb connection "seed.suvera.raw_activities"
[0m11:54:41.785326 [debug] [Thread-1 (]: On seed.suvera.raw_activities: BEGIN
[0m11:54:41.785822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:54:41.786692 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:54:41.787227 [debug] [Thread-1 (]: Using duckdb connection "seed.suvera.raw_activities"
[0m11:54:41.787744 [debug] [Thread-1 (]: On seed.suvera.raw_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "seed.suvera.raw_activities"} */

    create table "dev"."main"."raw_activities" ("activity_id" integer,"patient_id" integer,"activity_type" text,"activity_date" timestamp without time zone,"duration_minutes" integer)
  
[0m11:54:41.789341 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:54:41.810635 [debug] [Thread-1 (]: Using duckdb connection "seed.suvera.raw_activities"
[0m11:54:41.811316 [debug] [Thread-1 (]: On seed.suvera.raw_activities: 
          COPY "dev"."main"."raw_activities" FROM '/Users/puneeth/Documents/suvera_dbt_project/suvera/seeds/raw_activities.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m11:54:42.050579 [debug] [Thread-1 (]: SQL status: OK in 0.238 seconds
[0m11:54:42.059901 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.suvera.raw_activities"
[0m11:54:42.080505 [debug] [Thread-1 (]: On seed.suvera.raw_activities: COMMIT
[0m11:54:42.081150 [debug] [Thread-1 (]: Using duckdb connection "seed.suvera.raw_activities"
[0m11:54:42.081642 [debug] [Thread-1 (]: On seed.suvera.raw_activities: COMMIT
[0m11:54:42.085343 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:54:42.088319 [debug] [Thread-1 (]: On seed.suvera.raw_activities: Close
[0m11:54:42.091488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '521f1ca3-d3b0-4b6e-bfbd-609127ce469e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143855a0>]}
[0m11:54:42.092496 [info ] [Thread-1 (]: 1 of 4 OK loaded seed file main.raw_activities ................................. [[32mINSERT 2007[0m in 0.49s]
[0m11:54:42.093449 [debug] [Thread-1 (]: Finished running node seed.suvera.raw_activities
[0m11:54:42.094139 [debug] [Thread-1 (]: Began running node seed.suvera.raw_patients
[0m11:54:42.094845 [info ] [Thread-1 (]: 2 of 4 START seed file main.raw_patients ....................................... [RUN]
[0m11:54:42.095514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.suvera.raw_activities, now seed.suvera.raw_patients)
[0m11:54:42.096026 [debug] [Thread-1 (]: Began compiling node seed.suvera.raw_patients
[0m11:54:42.096536 [debug] [Thread-1 (]: Began executing node seed.suvera.raw_patients
[0m11:54:42.103567 [debug] [Thread-1 (]: Using duckdb connection "seed.suvera.raw_patients"
[0m11:54:42.104126 [debug] [Thread-1 (]: On seed.suvera.raw_patients: BEGIN
[0m11:54:42.104616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:54:42.105483 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:54:42.106022 [debug] [Thread-1 (]: Using duckdb connection "seed.suvera.raw_patients"
[0m11:54:42.106516 [debug] [Thread-1 (]: On seed.suvera.raw_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "seed.suvera.raw_patients"} */

    create table "dev"."main"."raw_patients" ("data" text)
  
[0m11:54:42.107317 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:54:42.108993 [debug] [Thread-1 (]: Using duckdb connection "seed.suvera.raw_patients"
[0m11:54:42.109503 [debug] [Thread-1 (]: On seed.suvera.raw_patients: 
          COPY "dev"."main"."raw_patients" FROM '/Users/puneeth/Documents/suvera_dbt_project/suvera/seeds/raw_patients.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m11:54:42.115040 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:54:42.115990 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.suvera.raw_patients"
[0m11:54:42.118675 [debug] [Thread-1 (]: On seed.suvera.raw_patients: COMMIT
[0m11:54:42.119206 [debug] [Thread-1 (]: Using duckdb connection "seed.suvera.raw_patients"
[0m11:54:42.119691 [debug] [Thread-1 (]: On seed.suvera.raw_patients: COMMIT
[0m11:54:42.122214 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:54:42.123586 [debug] [Thread-1 (]: On seed.suvera.raw_patients: Close
[0m11:54:42.124361 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '521f1ca3-d3b0-4b6e-bfbd-609127ce469e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145ee3f0>]}
[0m11:54:42.125151 [info ] [Thread-1 (]: 2 of 4 OK loaded seed file main.raw_patients ................................... [[32mINSERT 255[0m in 0.03s]
[0m11:54:42.126080 [debug] [Thread-1 (]: Finished running node seed.suvera.raw_patients
[0m11:54:42.126690 [debug] [Thread-1 (]: Began running node seed.suvera.raw_pcns
[0m11:54:42.127695 [info ] [Thread-1 (]: 3 of 4 START seed file main.raw_pcns ........................................... [RUN]
[0m11:54:42.128522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.suvera.raw_patients, now seed.suvera.raw_pcns)
[0m11:54:42.129113 [debug] [Thread-1 (]: Began compiling node seed.suvera.raw_pcns
[0m11:54:42.129671 [debug] [Thread-1 (]: Began executing node seed.suvera.raw_pcns
[0m11:54:42.136106 [debug] [Thread-1 (]: Using duckdb connection "seed.suvera.raw_pcns"
[0m11:54:42.138544 [debug] [Thread-1 (]: On seed.suvera.raw_pcns: BEGIN
[0m11:54:42.141906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:54:42.145335 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:54:42.146523 [debug] [Thread-1 (]: Using duckdb connection "seed.suvera.raw_pcns"
[0m11:54:42.147187 [debug] [Thread-1 (]: On seed.suvera.raw_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "seed.suvera.raw_pcns"} */

    create table "dev"."main"."raw_pcns" ("id" integer,"pcn_name" text)
  
[0m11:54:42.148497 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:54:42.150758 [debug] [Thread-1 (]: Using duckdb connection "seed.suvera.raw_pcns"
[0m11:54:42.151329 [debug] [Thread-1 (]: On seed.suvera.raw_pcns: 
          COPY "dev"."main"."raw_pcns" FROM '/Users/puneeth/Documents/suvera_dbt_project/suvera/seeds/raw_pcns.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m11:54:42.154130 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:54:42.155151 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.suvera.raw_pcns"
[0m11:54:42.157862 [debug] [Thread-1 (]: On seed.suvera.raw_pcns: COMMIT
[0m11:54:42.158400 [debug] [Thread-1 (]: Using duckdb connection "seed.suvera.raw_pcns"
[0m11:54:42.158885 [debug] [Thread-1 (]: On seed.suvera.raw_pcns: COMMIT
[0m11:54:42.160155 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:54:42.161236 [debug] [Thread-1 (]: On seed.suvera.raw_pcns: Close
[0m11:54:42.161936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '521f1ca3-d3b0-4b6e-bfbd-609127ce469e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114786b50>]}
[0m11:54:42.162667 [info ] [Thread-1 (]: 3 of 4 OK loaded seed file main.raw_pcns ....................................... [[32mINSERT 2[0m in 0.03s]
[0m11:54:42.163508 [debug] [Thread-1 (]: Finished running node seed.suvera.raw_pcns
[0m11:54:42.164062 [debug] [Thread-1 (]: Began running node seed.suvera.raw_practices
[0m11:54:42.164713 [info ] [Thread-1 (]: 4 of 4 START seed file main.raw_practices ...................................... [RUN]
[0m11:54:42.165426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.suvera.raw_pcns, now seed.suvera.raw_practices)
[0m11:54:42.165960 [debug] [Thread-1 (]: Began compiling node seed.suvera.raw_practices
[0m11:54:42.166472 [debug] [Thread-1 (]: Began executing node seed.suvera.raw_practices
[0m11:54:42.172409 [debug] [Thread-1 (]: Using duckdb connection "seed.suvera.raw_practices"
[0m11:54:42.173225 [debug] [Thread-1 (]: On seed.suvera.raw_practices: BEGIN
[0m11:54:42.174122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:54:42.175301 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:54:42.175880 [debug] [Thread-1 (]: Using duckdb connection "seed.suvera.raw_practices"
[0m11:54:42.177391 [debug] [Thread-1 (]: On seed.suvera.raw_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "seed.suvera.raw_practices"} */

    create table "dev"."main"."raw_practices" ("id" integer,"practice_name" text,"location" text,"established_date" date,"pcn" integer)
  
[0m11:54:42.180736 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:54:42.185077 [debug] [Thread-1 (]: Using duckdb connection "seed.suvera.raw_practices"
[0m11:54:42.185960 [debug] [Thread-1 (]: On seed.suvera.raw_practices: 
          COPY "dev"."main"."raw_practices" FROM '/Users/puneeth/Documents/suvera_dbt_project/suvera/seeds/raw_practices.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m11:54:42.189750 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:54:42.190676 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.suvera.raw_practices"
[0m11:54:42.193325 [debug] [Thread-1 (]: On seed.suvera.raw_practices: COMMIT
[0m11:54:42.193877 [debug] [Thread-1 (]: Using duckdb connection "seed.suvera.raw_practices"
[0m11:54:42.194370 [debug] [Thread-1 (]: On seed.suvera.raw_practices: COMMIT
[0m11:54:42.195599 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:54:42.196783 [debug] [Thread-1 (]: On seed.suvera.raw_practices: Close
[0m11:54:42.197521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '521f1ca3-d3b0-4b6e-bfbd-609127ce469e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114322350>]}
[0m11:54:42.198268 [info ] [Thread-1 (]: 4 of 4 OK loaded seed file main.raw_practices .................................. [[32mINSERT 5[0m in 0.03s]
[0m11:54:42.199184 [debug] [Thread-1 (]: Finished running node seed.suvera.raw_practices
[0m11:54:42.201861 [debug] [MainThread]: Using duckdb connection "master"
[0m11:54:42.202482 [debug] [MainThread]: On master: BEGIN
[0m11:54:42.202916 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:54:42.203728 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:54:42.204179 [debug] [MainThread]: On master: COMMIT
[0m11:54:42.204607 [debug] [MainThread]: Using duckdb connection "master"
[0m11:54:42.205013 [debug] [MainThread]: On master: COMMIT
[0m11:54:42.205666 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:54:42.206130 [debug] [MainThread]: On master: Close
[0m11:54:42.206679 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:54:42.207078 [debug] [MainThread]: Connection 'seed.suvera.raw_practices' was properly closed.
[0m11:54:42.207521 [info ] [MainThread]: 
[0m11:54:42.208015 [info ] [MainThread]: Finished running 4 seeds in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m11:54:42.209737 [debug] [MainThread]: Command end result
[0m11:54:42.248875 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m11:54:42.253222 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m11:54:42.263126 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m11:54:42.263691 [info ] [MainThread]: 
[0m11:54:42.264259 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:54:42.264705 [info ] [MainThread]: 
[0m11:54:42.265189 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m11:54:42.272931 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 4.5692177, "process_in_blocks": "0", "process_kernel_time": 0.842457, "process_mem_max_rss": "141037568", "process_out_blocks": "0", "process_user_time": 6.285556}
[0m11:54:42.273936 [debug] [MainThread]: Command `dbt seed` succeeded at 11:54:42.273718 after 4.57 seconds
[0m11:54:42.274584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139d1190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11471be90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11471be30>]}
[0m11:54:42.275154 [debug] [MainThread]: Flushing usage events
[0m11:54:42.666592 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:07:35.234687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1d2e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f17fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f17fd90>]}


============================== 12:07:35.248070 | cca9f73d-fccb-42ac-aa86-834831ceb9f4 ==============================
[0m12:07:35.248070 [info ] [MainThread]: Running with dbt=1.10.1
[0m12:07:35.249266 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_patients', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:07:35.794773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cca9f73d-fccb-42ac-aa86-834831ceb9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6828b0>]}
[0m12:07:35.896711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cca9f73d-fccb-42ac-aa86-834831ceb9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f08fbd0>]}
[0m12:07:35.936344 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m12:07:36.108676 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m12:07:36.381342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m12:07:36.382138 [debug] [MainThread]: Partial parsing: added file: suvera://models/staging/stg_activities.sql
[0m12:07:36.382725 [debug] [MainThread]: Partial parsing: added file: suvera://models/staging/schema.yml
[0m12:07:36.910757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cca9f73d-fccb-42ac-aa86-834831ceb9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f593450>]}
[0m12:07:37.036950 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m12:07:37.043812 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m12:07:37.096188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cca9f73d-fccb-42ac-aa86-834831ceb9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f46ac60>]}
[0m12:07:37.097003 [info ] [MainThread]: Found 3 models, 4 seeds, 4 data tests, 428 macros
[0m12:07:37.097527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cca9f73d-fccb-42ac-aa86-834831ceb9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8da890>]}
[0m12:07:37.098517 [warn ] [MainThread]: The selection criterion 'stg_patients' does not match any enabled nodes
[0m12:07:37.100381 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:07:37.101170 [debug] [MainThread]: Command end result
[0m12:07:37.131577 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m12:07:37.134528 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m12:07:37.140902 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m12:07:37.151721 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.061398, "process_in_blocks": "0", "process_kernel_time": 0.726711, "process_mem_max_rss": "120610816", "process_out_blocks": "0", "process_user_time": 3.877621}
[0m12:07:37.152517 [debug] [MainThread]: Command `dbt run` succeeded at 12:07:37.152346 after 2.06 seconds
[0m12:07:37.153096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f927ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef23e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f939910>]}
[0m12:07:37.153634 [debug] [MainThread]: Flushing usage events
[0m12:07:37.577539 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:07:52.379365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047a2e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10574fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10574fd90>]}


============================== 12:07:52.388642 | aa70898b-6ffa-4b43-9cba-1ee986dcc674 ==============================
[0m12:07:52.388642 [info ] [MainThread]: Running with dbt=1.10.1
[0m12:07:52.389559 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_patients', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:07:52.850650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa70898b-6ffa-4b43-9cba-1ee986dcc674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c528b0>]}
[0m12:07:52.953627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa70898b-6ffa-4b43-9cba-1ee986dcc674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10565fbd0>]}
[0m12:07:52.984274 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m12:07:53.150042 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m12:07:53.409121 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:07:53.410043 [debug] [MainThread]: Partial parsing: updated file: suvera://models/staging/stg_activities.sql
[0m12:07:53.928837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa70898b-6ffa-4b43-9cba-1ee986dcc674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b63550>]}
[0m12:07:54.051118 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m12:07:54.054801 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m12:07:54.100669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa70898b-6ffa-4b43-9cba-1ee986dcc674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a3ac60>]}
[0m12:07:54.101377 [info ] [MainThread]: Found 3 models, 4 seeds, 4 data tests, 428 macros
[0m12:07:54.101887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa70898b-6ffa-4b43-9cba-1ee986dcc674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eab310>]}
[0m12:07:54.102856 [warn ] [MainThread]: The selection criterion 'stg_patients' does not match any enabled nodes
[0m12:07:54.104694 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:07:54.105584 [debug] [MainThread]: Command end result
[0m12:07:54.135205 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m12:07:54.138084 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m12:07:54.143773 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m12:07:54.154974 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8984684, "process_in_blocks": "0", "process_kernel_time": 0.505411, "process_mem_max_rss": "119889920", "process_out_blocks": "0", "process_user_time": 3.65445}
[0m12:07:54.155789 [debug] [MainThread]: Command `dbt run` succeeded at 12:07:54.155616 after 1.90 seconds
[0m12:07:54.156363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054f3e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105efd9d0>]}
[0m12:07:54.156884 [debug] [MainThread]: Flushing usage events
[0m12:07:54.513548 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:09:00.407386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e1ee40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e07b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e07d90>]}


============================== 12:09:00.417806 | efcc5ca1-ab38-46c6-9106-1684f6387c2c ==============================
[0m12:09:00.417806 [info ] [MainThread]: Running with dbt=1.10.1
[0m12:09:00.418824 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_patients', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:09:00.964380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efcc5ca1-ab38-46c6-9106-1684f6387c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132de8b0>]}
[0m12:09:01.129128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efcc5ca1-ab38-46c6-9106-1684f6387c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d13bd0>]}
[0m12:09:01.163080 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m12:09:01.371377 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m12:09:01.633278 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:09:01.634227 [debug] [MainThread]: Partial parsing: updated file: suvera://models/staging/stg_activities.sql
[0m12:09:02.164485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efcc5ca1-ab38-46c6-9106-1684f6387c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11422b550>]}
[0m12:09:02.292028 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m12:09:02.298037 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m12:09:02.346497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efcc5ca1-ab38-46c6-9106-1684f6387c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140fec60>]}
[0m12:09:02.347213 [info ] [MainThread]: Found 3 models, 4 seeds, 4 data tests, 428 macros
[0m12:09:02.347737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efcc5ca1-ab38-46c6-9106-1684f6387c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114587310>]}
[0m12:09:02.348697 [warn ] [MainThread]: The selection criterion 'stg_patients' does not match any enabled nodes
[0m12:09:02.350559 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:09:02.351355 [debug] [MainThread]: Command end result
[0m12:09:02.382257 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m12:09:02.386358 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m12:09:02.393810 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m12:09:02.404438 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1340168, "process_in_blocks": "0", "process_kernel_time": 0.734869, "process_mem_max_rss": "120590336", "process_out_blocks": "0", "process_user_time": 3.939272}
[0m12:09:02.405260 [debug] [MainThread]: Command `dbt run` succeeded at 12:09:02.405086 after 2.14 seconds
[0m12:09:02.405840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145d4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ba3e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145ed9d0>]}
[0m12:09:02.406370 [debug] [MainThread]: Flushing usage events
[0m12:09:02.824188 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:10:40.856809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10524ae40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106233b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106233d90>]}


============================== 12:10:40.868884 | c22018b8-9b23-45c7-acf9-d9bdea222b8e ==============================
[0m12:10:40.868884 [info ] [MainThread]: Running with dbt=1.10.1
[0m12:10:40.869983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select stg_activities', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:10:41.383951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c22018b8-9b23-45c7-acf9-d9bdea222b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10570a8b0>]}
[0m12:10:41.491287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c22018b8-9b23-45c7-acf9-d9bdea222b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106143bd0>]}
[0m12:10:41.543394 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m12:10:41.719740 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m12:10:41.993989 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:10:41.994535 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:10:42.073282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c22018b8-9b23-45c7-acf9-d9bdea222b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106655f50>]}
[0m12:10:42.201729 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m12:10:42.208071 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m12:10:42.258279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c22018b8-9b23-45c7-acf9-d9bdea222b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10652ac60>]}
[0m12:10:42.259028 [info ] [MainThread]: Found 3 models, 4 seeds, 4 data tests, 428 macros
[0m12:10:42.259550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c22018b8-9b23-45c7-acf9-d9bdea222b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065142f0>]}
[0m12:10:42.262048 [info ] [MainThread]: 
[0m12:10:42.262578 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:10:42.263013 [info ] [MainThread]: 
[0m12:10:42.263787 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:10:42.264977 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:10:42.374942 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:10:42.375552 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:10:42.376042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:10:42.563057 [debug] [ThreadPool]: SQL status: OK in 0.187 seconds
[0m12:10:42.566016 [debug] [ThreadPool]: On list_dev: Close
[0m12:10:42.567055 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:10:42.568107 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:10:42.577435 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:10:42.577966 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m12:10:42.578395 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:42.581236 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:10:42.584960 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:10:42.585698 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:10:42.586721 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:10:42.587295 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:10:42.587846 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:10:42.593969 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m12:10:42.596448 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:10:42.597215 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:10:42.597897 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:10:42.598874 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:10:42.599484 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:10:42.608406 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:10:42.618854 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:10:42.620454 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:10:42.621598 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:42.622864 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:10:42.623352 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:10:42.623794 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:10:42.651895 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m12:10:42.654934 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:10:42.657043 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:10:42.657539 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:10:42.659412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c22018b8-9b23-45c7-acf9-d9bdea222b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bed230>]}
[0m12:10:42.660079 [debug] [MainThread]: Using duckdb connection "master"
[0m12:10:42.660504 [debug] [MainThread]: On master: BEGIN
[0m12:10:42.660900 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:10:42.661724 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:10:42.662173 [debug] [MainThread]: On master: COMMIT
[0m12:10:42.662605 [debug] [MainThread]: Using duckdb connection "master"
[0m12:10:42.663008 [debug] [MainThread]: On master: COMMIT
[0m12:10:42.663587 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:10:42.664031 [debug] [MainThread]: On master: Close
[0m12:10:42.669632 [debug] [Thread-1 (]: Began running node model.suvera.stg_activities
[0m12:10:42.670535 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_activities ................................ [RUN]
[0m12:10:42.671220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.stg_activities)
[0m12:10:42.671752 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_activities
[0m12:10:42.681946 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_activities"
[0m12:10:42.683408 [debug] [Thread-1 (]: Began executing node model.suvera.stg_activities
[0m12:10:42.740860 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_activities"
[0m12:10:42.742330 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m12:10:42.742862 [debug] [Thread-1 (]: On model.suvera.stg_activities: BEGIN
[0m12:10:42.743354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:10:42.744245 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:10:42.744757 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m12:10:42.745253 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */

  
  create view "dev"."main"."stg_activities__dbt_tmp" as (
    select * 
from "dev"."main"."raw_activities"
limit 100
  );

[0m12:10:42.747020 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:10:42.756136 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m12:10:42.756744 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
alter view "dev"."main"."stg_activities__dbt_tmp" rename to "stg_activities"
[0m12:10:42.761694 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:10:42.776624 [debug] [Thread-1 (]: On model.suvera.stg_activities: COMMIT
[0m12:10:42.777214 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m12:10:42.777712 [debug] [Thread-1 (]: On model.suvera.stg_activities: COMMIT
[0m12:10:42.781250 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:10:42.788823 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m12:10:42.789395 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
drop view if exists "dev"."main"."stg_activities__dbt_backup" cascade
[0m12:10:42.791450 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:10:42.795238 [debug] [Thread-1 (]: On model.suvera.stg_activities: Close
[0m12:10:42.798919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c22018b8-9b23-45c7-acf9-d9bdea222b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106886b10>]}
[0m12:10:42.800680 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_activities ........................... [[32mOK[0m in 0.12s]
[0m12:10:42.802207 [debug] [Thread-1 (]: Finished running node model.suvera.stg_activities
[0m12:10:42.805629 [debug] [MainThread]: Using duckdb connection "master"
[0m12:10:42.806284 [debug] [MainThread]: On master: BEGIN
[0m12:10:42.806813 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:10:42.807734 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:10:42.808292 [debug] [MainThread]: On master: COMMIT
[0m12:10:42.808841 [debug] [MainThread]: Using duckdb connection "master"
[0m12:10:42.809279 [debug] [MainThread]: On master: COMMIT
[0m12:10:42.809889 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:10:42.810356 [debug] [MainThread]: On master: Close
[0m12:10:42.810934 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:10:42.811358 [debug] [MainThread]: Connection 'model.suvera.stg_activities' was properly closed.
[0m12:10:42.811819 [info ] [MainThread]: 
[0m12:10:42.812333 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m12:10:42.813431 [debug] [MainThread]: Command end result
[0m12:10:42.844461 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m12:10:42.851789 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m12:10:42.863371 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m12:10:42.863868 [info ] [MainThread]: 
[0m12:10:42.864417 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:10:42.864862 [info ] [MainThread]: 
[0m12:10:42.865354 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:10:42.871886 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1442442, "process_in_blocks": "0", "process_kernel_time": 0.793098, "process_mem_max_rss": "132284416", "process_out_blocks": "0", "process_user_time": 3.746761}
[0m12:10:42.872855 [debug] [MainThread]: Command `dbt run` succeeded at 12:10:42.872592 after 2.15 seconds
[0m12:10:42.873461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068626d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc2710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc2170>]}
[0m12:10:42.874043 [debug] [MainThread]: Flushing usage events
[0m12:10:43.323586 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:27:56.268880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041e9d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ff7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ff7750>]}


============================== 12:27:56.278749 | fe2c586e-c9c0-42a4-9080-3055b1a998d3 ==============================
[0m12:27:56.278749 [info ] [MainThread]: Running with dbt=1.10.1
[0m12:27:56.280252 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_activities', 'send_anonymous_usage_stats': 'True'}
[0m12:27:56.793795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe2c586e-c9c0-42a4-9080-3055b1a998d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044c5220>]}
[0m12:27:56.895341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe2c586e-c9c0-42a4-9080-3055b1a998d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104edf130>]}
[0m12:27:56.929110 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m12:27:57.100711 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m12:27:57.379516 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:27:57.380103 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:27:57.457825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe2c586e-c9c0-42a4-9080-3055b1a998d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105422950>]}
[0m12:27:57.584883 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m12:27:57.593729 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m12:27:57.653671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe2c586e-c9c0-42a4-9080-3055b1a998d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052cea80>]}
[0m12:27:57.654442 [info ] [MainThread]: Found 3 models, 4 seeds, 4 data tests, 428 macros
[0m12:27:57.654995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe2c586e-c9c0-42a4-9080-3055b1a998d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051c8830>]}
[0m12:27:57.657484 [info ] [MainThread]: 
[0m12:27:57.658069 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:27:57.658540 [info ] [MainThread]: 
[0m12:27:57.659309 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:27:57.660631 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:27:57.760630 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:27:57.761253 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:27:57.761737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:57.842059 [debug] [ThreadPool]: SQL status: OK in 0.080 seconds
[0m12:27:57.846641 [debug] [ThreadPool]: On list_dev: Close
[0m12:27:57.848763 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:27:57.849683 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:27:57.859008 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:27:57.859519 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m12:27:57.859996 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:27:57.865516 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m12:27:57.869829 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:27:57.870706 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:27:57.871909 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:27:57.872519 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:27:57.873102 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:27:57.878620 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m12:27:57.880978 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:27:57.881838 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:27:57.882570 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:27:57.883693 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:27:57.884352 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:27:57.893726 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:27:57.901415 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:27:57.901943 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:27:57.902382 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:27:57.903248 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:27:57.903722 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:27:57.904192 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:27:57.934578 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m12:27:57.938516 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:27:57.940763 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:27:57.941318 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:27:57.943435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe2c586e-c9c0-42a4-9080-3055b1a998d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105862820>]}
[0m12:27:57.944104 [debug] [MainThread]: Using duckdb connection "master"
[0m12:27:57.944563 [debug] [MainThread]: On master: BEGIN
[0m12:27:57.944992 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:27:57.945840 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:27:57.946330 [debug] [MainThread]: On master: COMMIT
[0m12:27:57.946786 [debug] [MainThread]: Using duckdb connection "master"
[0m12:27:57.947224 [debug] [MainThread]: On master: COMMIT
[0m12:27:57.947918 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:27:57.948395 [debug] [MainThread]: On master: Close
[0m12:27:57.952989 [debug] [Thread-1 (]: Began running node model.suvera.stg_activities
[0m12:27:57.953866 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_activities ................................ [RUN]
[0m12:27:57.954592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.stg_activities)
[0m12:27:57.955153 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_activities
[0m12:27:57.966211 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_activities"
[0m12:27:57.968090 [debug] [Thread-1 (]: Began executing node model.suvera.stg_activities
[0m12:27:58.016425 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_activities"
[0m12:27:58.018664 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m12:27:58.019349 [debug] [Thread-1 (]: On model.suvera.stg_activities: BEGIN
[0m12:27:58.020067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:58.021434 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:27:58.022039 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m12:27:58.022614 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */

  
  create view "dev"."main"."stg_activities__dbt_tmp" as (
    select * 
from "dev"."main"."raw_activities"
limit 100
  );

[0m12:27:58.026608 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:27:58.035778 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m12:27:58.036406 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
alter view "dev"."main"."stg_activities" rename to "stg_activities__dbt_backup"
[0m12:27:58.041128 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:27:58.046397 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m12:27:58.047112 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
alter view "dev"."main"."stg_activities__dbt_tmp" rename to "stg_activities"
[0m12:27:58.048181 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:27:58.066454 [debug] [Thread-1 (]: On model.suvera.stg_activities: COMMIT
[0m12:27:58.067149 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m12:27:58.067693 [debug] [Thread-1 (]: On model.suvera.stg_activities: COMMIT
[0m12:27:58.071011 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:27:58.078503 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m12:27:58.079186 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
drop view if exists "dev"."main"."stg_activities__dbt_backup" cascade
[0m12:27:58.081460 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:27:58.085309 [debug] [Thread-1 (]: On model.suvera.stg_activities: Close
[0m12:27:58.088730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe2c586e-c9c0-42a4-9080-3055b1a998d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105643a10>]}
[0m12:27:58.089831 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_activities ........................... [[32mOK[0m in 0.13s]
[0m12:27:58.090817 [debug] [Thread-1 (]: Finished running node model.suvera.stg_activities
[0m12:27:58.092737 [debug] [MainThread]: Using duckdb connection "master"
[0m12:27:58.093267 [debug] [MainThread]: On master: BEGIN
[0m12:27:58.093719 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:27:58.094612 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:27:58.095099 [debug] [MainThread]: On master: COMMIT
[0m12:27:58.095564 [debug] [MainThread]: Using duckdb connection "master"
[0m12:27:58.096240 [debug] [MainThread]: On master: COMMIT
[0m12:27:58.097266 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:27:58.097866 [debug] [MainThread]: On master: Close
[0m12:27:58.098619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:27:58.099101 [debug] [MainThread]: Connection 'model.suvera.stg_activities' was properly closed.
[0m12:27:58.099619 [info ] [MainThread]: 
[0m12:27:58.100337 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m12:27:58.101981 [debug] [MainThread]: Command end result
[0m12:27:58.211459 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m12:27:58.214327 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m12:27:58.224522 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m12:27:58.225079 [info ] [MainThread]: 
[0m12:27:58.225725 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:27:58.226251 [info ] [MainThread]: 
[0m12:27:58.226848 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:27:58.231655 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.077088, "process_in_blocks": "0", "process_kernel_time": 0.508551, "process_mem_max_rss": "134475776", "process_out_blocks": "0", "process_user_time": 3.548625}
[0m12:27:58.232759 [debug] [MainThread]: Command `dbt run` succeeded at 12:27:58.232527 after 2.08 seconds
[0m12:27:58.233585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056b5bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a37f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a37cf0>]}
[0m12:27:58.234432 [debug] [MainThread]: Flushing usage events
[0m12:27:58.600980 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:37:01.355098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112de5d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bbf610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bbf750>]}


============================== 12:37:01.366587 | 80337ca4-e40d-43b7-a49e-52cb766589be ==============================
[0m12:37:01.366587 [info ] [MainThread]: Running with dbt=1.10.1
[0m12:37:01.367709 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test --select stg_activities', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:37:01.874954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80337ca4-e40d-43b7-a49e-52cb766589be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130c5220>]}
[0m12:37:01.976580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80337ca4-e40d-43b7-a49e-52cb766589be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113aab130>]}
[0m12:37:02.009668 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m12:37:02.176140 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m12:37:02.445586 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:37:02.446686 [debug] [MainThread]: Partial parsing: updated file: suvera://models/staging/schema.yml
[0m12:37:03.129643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80337ca4-e40d-43b7-a49e-52cb766589be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143dc750>]}
[0m12:37:03.252294 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m12:37:03.258596 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m12:37:03.409504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80337ca4-e40d-43b7-a49e-52cb766589be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114402a80>]}
[0m12:37:03.410269 [info ] [MainThread]: Found 3 models, 4 seeds, 8 data tests, 428 macros
[0m12:37:03.410816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80337ca4-e40d-43b7-a49e-52cb766589be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141d3cb0>]}
[0m12:37:03.413528 [info ] [MainThread]: 
[0m12:37:03.414071 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:37:03.414537 [info ] [MainThread]: 
[0m12:37:03.415272 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:37:03.425149 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m12:37:03.522871 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:37:03.523650 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:37:03.524200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:03.540514 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: BEGIN
[0m12:37:03.541140 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m12:37:03.542291 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:37:03.542748 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m12:37:03.543202 [info ] [MainThread]: 
[0m12:37:03.543712 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m12:37:03.544419 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/puneeth/Documents/suvera_dbt_project/suvera/dev.duckdb": Conflicting lock is held in /usr/local/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 15487) by user puneeth. See also https://duckdb.org/docs/stable/connect/concurrency
[0m12:37:03.549453 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.3338857, "process_in_blocks": "0", "process_kernel_time": 0.76872, "process_mem_max_rss": "132222976", "process_out_blocks": "0", "process_user_time": 4.25257}
[0m12:37:03.550362 [debug] [MainThread]: Command `dbt test` failed at 12:37:03.550166 after 2.34 seconds
[0m12:37:03.551005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145d2820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a6da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114471910>]}
[0m12:37:03.551588 [debug] [MainThread]: Flushing usage events
[0m12:37:03.943260 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:37:57.379558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11050dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112e7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112e7750>]}


============================== 12:37:57.391964 | 46e60a05-99c7-42f8-b8d5-a3e94e5c99e4 ==============================
[0m12:37:57.391964 [info ] [MainThread]: Running with dbt=1.10.1
[0m12:37:57.393082 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test --select stg_activities', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:37:57.920234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46e60a05-99c7-42f8-b8d5-a3e94e5c99e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107c1220>]}
[0m12:37:58.022303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46e60a05-99c7-42f8-b8d5-a3e94e5c99e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111d3130>]}
[0m12:37:58.052641 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m12:37:58.219690 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m12:37:58.487781 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:37:58.488382 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:37:58.567081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46e60a05-99c7-42f8-b8d5-a3e94e5c99e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111702850>]}
[0m12:37:58.696212 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m12:37:58.702050 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m12:37:58.777915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46e60a05-99c7-42f8-b8d5-a3e94e5c99e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111976210>]}
[0m12:37:58.778660 [info ] [MainThread]: Found 3 models, 4 seeds, 8 data tests, 428 macros
[0m12:37:58.779216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46e60a05-99c7-42f8-b8d5-a3e94e5c99e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111953cb0>]}
[0m12:37:58.781985 [info ] [MainThread]: 
[0m12:37:58.782559 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:37:58.783055 [info ] [MainThread]: 
[0m12:37:58.783866 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:37:58.793636 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m12:37:58.891812 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:37:58.892496 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:37:58.893006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:58.918442 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m12:37:58.919068 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:37:58.919557 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:37:58.939873 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m12:37:58.942238 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:37:58.944406 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:37:58.944938 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:37:58.947161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46e60a05-99c7-42f8-b8d5-a3e94e5c99e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c01b20>]}
[0m12:37:58.947842 [debug] [MainThread]: Using duckdb connection "master"
[0m12:37:58.948309 [debug] [MainThread]: On master: BEGIN
[0m12:37:58.948752 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:37:58.949555 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:37:58.950042 [debug] [MainThread]: On master: COMMIT
[0m12:37:58.950512 [debug] [MainThread]: Using duckdb connection "master"
[0m12:37:58.950974 [debug] [MainThread]: On master: COMMIT
[0m12:37:58.951634 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:37:58.952120 [debug] [MainThread]: On master: Close
[0m12:37:58.957001 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_activities_activity_date.51ab13376e
[0m12:37:58.957742 [info ] [Thread-1 (]: 1 of 4 START test not_null_stg_activities_activity_date ........................ [RUN]
[0m12:37:58.958468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now test.suvera.not_null_stg_activities_activity_date.51ab13376e)
[0m12:37:58.959029 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_activities_activity_date.51ab13376e
[0m12:37:58.986480 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_activities_activity_date.51ab13376e"
[0m12:37:58.987800 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_activities_activity_date.51ab13376e
[0m12:37:59.015907 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_activities_activity_date.51ab13376e"
[0m12:37:59.017343 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_activity_date.51ab13376e"
[0m12:37:59.017927 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_date.51ab13376e: BEGIN
[0m12:37:59.018468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:37:59.019409 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:37:59.019959 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_activity_date.51ab13376e"
[0m12:37:59.020506 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_date.51ab13376e: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_activities_activity_date.51ab13376e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_date
from "dev"."main"."stg_activities"
where activity_date is null



  
  
      
    ) dbt_internal_test
[0m12:37:59.031286 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m12:37:59.038540 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_date.51ab13376e: ROLLBACK
[0m12:37:59.039614 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_activities_activity_date.51ab13376e'
[0m12:37:59.040205 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_date.51ab13376e: Close
[0m12:37:59.041163 [info ] [Thread-1 (]: 1 of 4 PASS not_null_stg_activities_activity_date .............................. [[32mPASS[0m in 0.08s]
[0m12:37:59.042114 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_activities_activity_date.51ab13376e
[0m12:37:59.042771 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a
[0m12:37:59.043474 [info ] [Thread-1 (]: 2 of 4 START test not_null_stg_activities_activity_id .......................... [RUN]
[0m12:37:59.044172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_activities_activity_date.51ab13376e, now test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a)
[0m12:37:59.044742 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a
[0m12:37:59.050608 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a"
[0m12:37:59.051719 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a
[0m12:37:59.055483 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a"
[0m12:37:59.057745 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a"
[0m12:37:59.058947 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a: BEGIN
[0m12:37:59.059558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:37:59.060955 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:37:59.061878 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a"
[0m12:37:59.062534 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_id
from "dev"."main"."stg_activities"
where activity_id is null



  
  
      
    ) dbt_internal_test
[0m12:37:59.064182 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:37:59.066427 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a: ROLLBACK
[0m12:37:59.067353 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a'
[0m12:37:59.067904 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a: Close
[0m12:37:59.068777 [info ] [Thread-1 (]: 2 of 4 PASS not_null_stg_activities_activity_id ................................ [[32mPASS[0m in 0.02s]
[0m12:37:59.069676 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a
[0m12:37:59.070281 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_activities_patient_id.199695ff40
[0m12:37:59.070841 [info ] [Thread-1 (]: 3 of 4 START test not_null_stg_activities_patient_id ........................... [RUN]
[0m12:37:59.071575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a, now test.suvera.not_null_stg_activities_patient_id.199695ff40)
[0m12:37:59.072176 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_activities_patient_id.199695ff40
[0m12:37:59.079654 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_activities_patient_id.199695ff40"
[0m12:37:59.080744 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_activities_patient_id.199695ff40
[0m12:37:59.084660 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_activities_patient_id.199695ff40"
[0m12:37:59.085840 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_patient_id.199695ff40"
[0m12:37:59.086406 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_patient_id.199695ff40: BEGIN
[0m12:37:59.086933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:37:59.087863 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:37:59.088433 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_patient_id.199695ff40"
[0m12:37:59.088982 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_patient_id.199695ff40: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_activities_patient_id.199695ff40"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "dev"."main"."stg_activities"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m12:37:59.093717 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:37:59.096234 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_patient_id.199695ff40: ROLLBACK
[0m12:37:59.097191 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_activities_patient_id.199695ff40'
[0m12:37:59.097751 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_patient_id.199695ff40: Close
[0m12:37:59.098600 [info ] [Thread-1 (]: 3 of 4 PASS not_null_stg_activities_patient_id ................................. [[32mPASS[0m in 0.03s]
[0m12:37:59.099474 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_activities_patient_id.199695ff40
[0m12:37:59.100063 [debug] [Thread-1 (]: Began running node test.suvera.unique_stg_activities_activity_id.896c965cc8
[0m12:37:59.100685 [info ] [Thread-1 (]: 4 of 4 START test unique_stg_activities_activity_id ............................ [RUN]
[0m12:37:59.101357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_activities_patient_id.199695ff40, now test.suvera.unique_stg_activities_activity_id.896c965cc8)
[0m12:37:59.101913 [debug] [Thread-1 (]: Began compiling node test.suvera.unique_stg_activities_activity_id.896c965cc8
[0m12:37:59.112005 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.unique_stg_activities_activity_id.896c965cc8"
[0m12:37:59.114606 [debug] [Thread-1 (]: Began executing node test.suvera.unique_stg_activities_activity_id.896c965cc8
[0m12:37:59.118229 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.unique_stg_activities_activity_id.896c965cc8"
[0m12:37:59.119370 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.unique_stg_activities_activity_id.896c965cc8"
[0m12:37:59.119935 [debug] [Thread-1 (]: On test.suvera.unique_stg_activities_activity_id.896c965cc8: BEGIN
[0m12:37:59.120462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:37:59.121362 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:37:59.121911 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.unique_stg_activities_activity_id.896c965cc8"
[0m12:37:59.122471 [debug] [Thread-1 (]: On test.suvera.unique_stg_activities_activity_id.896c965cc8: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.unique_stg_activities_activity_id.896c965cc8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_activities"
where activity_id is not null
group by activity_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:37:59.133669 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:37:59.136059 [debug] [Thread-1 (]: On test.suvera.unique_stg_activities_activity_id.896c965cc8: ROLLBACK
[0m12:37:59.136985 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.unique_stg_activities_activity_id.896c965cc8'
[0m12:37:59.137537 [debug] [Thread-1 (]: On test.suvera.unique_stg_activities_activity_id.896c965cc8: Close
[0m12:37:59.138389 [info ] [Thread-1 (]: 4 of 4 PASS unique_stg_activities_activity_id .................................. [[32mPASS[0m in 0.04s]
[0m12:37:59.139273 [debug] [Thread-1 (]: Finished running node test.suvera.unique_stg_activities_activity_id.896c965cc8
[0m12:37:59.141274 [debug] [MainThread]: Using duckdb connection "master"
[0m12:37:59.141807 [debug] [MainThread]: On master: BEGIN
[0m12:37:59.142248 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:37:59.143075 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:37:59.143564 [debug] [MainThread]: On master: COMMIT
[0m12:37:59.144035 [debug] [MainThread]: Using duckdb connection "master"
[0m12:37:59.144766 [debug] [MainThread]: On master: COMMIT
[0m12:37:59.146105 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:37:59.147259 [debug] [MainThread]: On master: Close
[0m12:37:59.148077 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:37:59.148619 [debug] [MainThread]: Connection 'test.suvera.unique_stg_activities_activity_id.896c965cc8' was properly closed.
[0m12:37:59.149115 [info ] [MainThread]: 
[0m12:37:59.149644 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m12:37:59.151898 [debug] [MainThread]: Command end result
[0m12:37:59.188709 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m12:37:59.191788 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m12:37:59.203511 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m12:37:59.204078 [info ] [MainThread]: 
[0m12:37:59.204661 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:37:59.205153 [info ] [MainThread]: 
[0m12:37:59.205688 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m12:37:59.210985 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.9606248, "process_in_blocks": "0", "process_kernel_time": 0.78519, "process_mem_max_rss": "135426048", "process_out_blocks": "0", "process_user_time": 3.861994}
[0m12:37:59.211953 [debug] [MainThread]: Command `dbt test` succeeded at 12:37:59.211752 after 1.96 seconds
[0m12:37:59.212588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111195a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111937490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111937c20>]}
[0m12:37:59.213150 [debug] [MainThread]: Flushing usage events
[0m12:37:59.579807 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:41:39.977282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db21d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e933610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e933750>]}


============================== 12:41:39.987990 | 2d02d764-b60b-4071-9382-d73873f2292e ==============================
[0m12:41:39.987990 [info ] [MainThread]: Running with dbt=1.10.1
[0m12:41:39.989037 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'profiles_dir': '/Users/puneeth/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test --select stg_activities', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:41:40.517984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d02d764-b60b-4071-9382-d73873f2292e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de05220>]}
[0m12:41:40.707377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d02d764-b60b-4071-9382-d73873f2292e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e817130>]}
[0m12:41:40.733553 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m12:41:40.919946 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m12:41:41.184506 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:41:41.185125 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:41:41.264119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d02d764-b60b-4071-9382-d73873f2292e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed5a850>]}
[0m12:41:41.392623 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m12:41:41.399774 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m12:41:41.470779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d02d764-b60b-4071-9382-d73873f2292e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efda210>]}
[0m12:41:41.471532 [info ] [MainThread]: Found 3 models, 4 seeds, 8 data tests, 428 macros
[0m12:41:41.472092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d02d764-b60b-4071-9382-d73873f2292e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efb7cb0>]}
[0m12:41:41.474906 [info ] [MainThread]: 
[0m12:41:41.475483 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:41:41.475951 [info ] [MainThread]: 
[0m12:41:41.476735 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:41:41.486917 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m12:41:41.587128 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:41:41.587713 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:41:41.588186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:41:41.614333 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m12:41:41.615049 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:41:41.615812 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:41:41.636754 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m12:41:41.639107 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:41:41.641321 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:41:41.641857 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:41:41.644084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d02d764-b60b-4071-9382-d73873f2292e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f275b20>]}
[0m12:41:41.644785 [debug] [MainThread]: Using duckdb connection "master"
[0m12:41:41.645247 [debug] [MainThread]: On master: BEGIN
[0m12:41:41.645690 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:41:41.646503 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:41:41.646986 [debug] [MainThread]: On master: COMMIT
[0m12:41:41.647448 [debug] [MainThread]: Using duckdb connection "master"
[0m12:41:41.647898 [debug] [MainThread]: On master: COMMIT
[0m12:41:41.648550 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:41:41.649032 [debug] [MainThread]: On master: Close
[0m12:41:41.653732 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_activities_activity_date.51ab13376e
[0m12:41:41.654480 [info ] [Thread-1 (]: 1 of 4 START test not_null_stg_activities_activity_date ........................ [RUN]
[0m12:41:41.655223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now test.suvera.not_null_stg_activities_activity_date.51ab13376e)
[0m12:41:41.655786 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_activities_activity_date.51ab13376e
[0m12:41:41.681590 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_activities_activity_date.51ab13376e"
[0m12:41:41.684399 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_activities_activity_date.51ab13376e
[0m12:41:41.711981 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_activities_activity_date.51ab13376e"
[0m12:41:41.713264 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_activity_date.51ab13376e"
[0m12:41:41.713842 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_date.51ab13376e: BEGIN
[0m12:41:41.714385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:41:41.715386 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:41:41.715956 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_activity_date.51ab13376e"
[0m12:41:41.716518 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_date.51ab13376e: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_activities_activity_date.51ab13376e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_date
from "dev"."main"."stg_activities"
where activity_date is null



  
  
      
    ) dbt_internal_test
[0m12:41:41.718236 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:41:41.724562 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_date.51ab13376e: ROLLBACK
[0m12:41:41.725702 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_activities_activity_date.51ab13376e'
[0m12:41:41.726286 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_date.51ab13376e: Close
[0m12:41:41.727260 [info ] [Thread-1 (]: 1 of 4 PASS not_null_stg_activities_activity_date .............................. [[32mPASS[0m in 0.07s]
[0m12:41:41.728204 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_activities_activity_date.51ab13376e
[0m12:41:41.728821 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a
[0m12:41:41.729394 [info ] [Thread-1 (]: 2 of 4 START test not_null_stg_activities_activity_id .......................... [RUN]
[0m12:41:41.730193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_activities_activity_date.51ab13376e, now test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a)
[0m12:41:41.730765 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a
[0m12:41:41.736680 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a"
[0m12:41:41.737820 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a
[0m12:41:41.743288 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a"
[0m12:41:41.745152 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a"
[0m12:41:41.745768 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a: BEGIN
[0m12:41:41.746301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:41:41.747225 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:41:41.747775 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a"
[0m12:41:41.748322 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_id
from "dev"."main"."stg_activities"
where activity_id is null



  
  
      
    ) dbt_internal_test
[0m12:41:41.749941 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:41:41.752188 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a: ROLLBACK
[0m12:41:41.753075 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a'
[0m12:41:41.753610 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a: Close
[0m12:41:41.754463 [info ] [Thread-1 (]: 2 of 4 PASS not_null_stg_activities_activity_id ................................ [[32mPASS[0m in 0.02s]
[0m12:41:41.755395 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a
[0m12:41:41.756229 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_activities_patient_id.199695ff40
[0m12:41:41.757047 [info ] [Thread-1 (]: 3 of 4 START test not_null_stg_activities_patient_id ........................... [RUN]
[0m12:41:41.757923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a, now test.suvera.not_null_stg_activities_patient_id.199695ff40)
[0m12:41:41.758794 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_activities_patient_id.199695ff40
[0m12:41:41.764530 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_activities_patient_id.199695ff40"
[0m12:41:41.765916 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_activities_patient_id.199695ff40
[0m12:41:41.791494 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_activities_patient_id.199695ff40"
[0m12:41:41.793801 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_patient_id.199695ff40"
[0m12:41:41.794500 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_patient_id.199695ff40: BEGIN
[0m12:41:41.795073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:41:41.796022 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:41:41.796559 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_patient_id.199695ff40"
[0m12:41:41.797099 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_patient_id.199695ff40: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_activities_patient_id.199695ff40"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "dev"."main"."stg_activities"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m12:41:41.801055 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:41:41.803389 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_patient_id.199695ff40: ROLLBACK
[0m12:41:41.804279 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_activities_patient_id.199695ff40'
[0m12:41:41.804813 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_patient_id.199695ff40: Close
[0m12:41:41.805640 [info ] [Thread-1 (]: 3 of 4 PASS not_null_stg_activities_patient_id ................................. [[32mPASS[0m in 0.05s]
[0m12:41:41.806521 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_activities_patient_id.199695ff40
[0m12:41:41.807164 [debug] [Thread-1 (]: Began running node test.suvera.unique_stg_activities_activity_id.896c965cc8
[0m12:41:41.807979 [info ] [Thread-1 (]: 4 of 4 START test unique_stg_activities_activity_id ............................ [RUN]
[0m12:41:41.808723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_activities_patient_id.199695ff40, now test.suvera.unique_stg_activities_activity_id.896c965cc8)
[0m12:41:41.809607 [debug] [Thread-1 (]: Began compiling node test.suvera.unique_stg_activities_activity_id.896c965cc8
[0m12:41:41.820731 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.unique_stg_activities_activity_id.896c965cc8"
[0m12:41:41.821798 [debug] [Thread-1 (]: Began executing node test.suvera.unique_stg_activities_activity_id.896c965cc8
[0m12:41:41.825471 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.unique_stg_activities_activity_id.896c965cc8"
[0m12:41:41.827296 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.unique_stg_activities_activity_id.896c965cc8"
[0m12:41:41.827871 [debug] [Thread-1 (]: On test.suvera.unique_stg_activities_activity_id.896c965cc8: BEGIN
[0m12:41:41.828457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:41:41.829353 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:41:41.829891 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.unique_stg_activities_activity_id.896c965cc8"
[0m12:41:41.830439 [debug] [Thread-1 (]: On test.suvera.unique_stg_activities_activity_id.896c965cc8: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.unique_stg_activities_activity_id.896c965cc8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_activities"
where activity_id is not null
group by activity_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:41:41.834891 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:41:41.837307 [debug] [Thread-1 (]: On test.suvera.unique_stg_activities_activity_id.896c965cc8: ROLLBACK
[0m12:41:41.838283 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.unique_stg_activities_activity_id.896c965cc8'
[0m12:41:41.838846 [debug] [Thread-1 (]: On test.suvera.unique_stg_activities_activity_id.896c965cc8: Close
[0m12:41:41.839857 [info ] [Thread-1 (]: 4 of 4 PASS unique_stg_activities_activity_id .................................. [[32mPASS[0m in 0.03s]
[0m12:41:41.841027 [debug] [Thread-1 (]: Finished running node test.suvera.unique_stg_activities_activity_id.896c965cc8
[0m12:41:41.843409 [debug] [MainThread]: Using duckdb connection "master"
[0m12:41:41.843982 [debug] [MainThread]: On master: BEGIN
[0m12:41:41.844429 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:41:41.845255 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:41:41.845768 [debug] [MainThread]: On master: COMMIT
[0m12:41:41.846444 [debug] [MainThread]: Using duckdb connection "master"
[0m12:41:41.846949 [debug] [MainThread]: On master: COMMIT
[0m12:41:41.847987 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:41:41.848591 [debug] [MainThread]: On master: Close
[0m12:41:41.849274 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:41:41.849769 [debug] [MainThread]: Connection 'test.suvera.unique_stg_activities_activity_id.896c965cc8' was properly closed.
[0m12:41:41.850297 [info ] [MainThread]: 
[0m12:41:41.850983 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m12:41:41.853568 [debug] [MainThread]: Command end result
[0m12:41:41.893589 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m12:41:41.896462 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m12:41:41.907679 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m12:41:41.908292 [info ] [MainThread]: 
[0m12:41:41.909150 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:41:41.910414 [info ] [MainThread]: 
[0m12:41:41.911113 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m12:41:41.915969 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.0769043, "process_in_blocks": "0", "process_kernel_time": 0.774399, "process_mem_max_rss": "135274496", "process_out_blocks": "0", "process_user_time": 3.989564}
[0m12:41:41.916882 [debug] [MainThread]: Command `dbt test` succeeded at 12:41:41.916675 after 2.08 seconds
[0m12:41:41.917721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7d9a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef97800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef97ac0>]}
[0m12:41:41.918560 [debug] [MainThread]: Flushing usage events
[0m12:41:42.314753 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:42:56.474617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d06dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de7f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de7f750>]}


============================== 12:42:56.486891 | 80c7fe7b-5267-4c83-a7fb-12d4b513641e ==============================
[0m12:42:56.486891 [info ] [MainThread]: Running with dbt=1.10.1
[0m12:42:56.487983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select stg_activities', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:42:56.945263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80c7fe7b-5267-4c83-a7fb-12d4b513641e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d34d220>]}
[0m12:42:57.049252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80c7fe7b-5267-4c83-a7fb-12d4b513641e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd6b130>]}
[0m12:42:57.084382 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m12:42:57.255588 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m12:42:57.522886 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:42:57.524043 [debug] [MainThread]: Partial parsing: updated file: suvera://models/staging/schema.yml
[0m12:42:58.213775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80c7fe7b-5267-4c83-a7fb-12d4b513641e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e728750>]}
[0m12:42:58.338349 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m12:42:58.344998 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m12:42:58.498570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80c7fe7b-5267-4c83-a7fb-12d4b513641e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e766a80>]}
[0m12:42:58.499299 [info ] [MainThread]: Found 3 models, 4 seeds, 10 data tests, 428 macros
[0m12:42:58.499852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80c7fe7b-5267-4c83-a7fb-12d4b513641e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4e0750>]}
[0m12:42:58.502740 [info ] [MainThread]: 
[0m12:42:58.503408 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:42:58.503949 [info ] [MainThread]: 
[0m12:42:58.504793 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:42:58.514933 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m12:42:58.605949 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:42:58.606570 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:42:58.607031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:58.632564 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m12:42:58.633182 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:42:58.633674 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:42:58.654346 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m12:42:58.656723 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:42:58.658809 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:42:58.659324 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:42:58.661532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80c7fe7b-5267-4c83-a7fb-12d4b513641e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8aa5b0>]}
[0m12:42:58.662213 [debug] [MainThread]: Using duckdb connection "master"
[0m12:42:58.662681 [debug] [MainThread]: On master: BEGIN
[0m12:42:58.663134 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:42:58.663945 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:42:58.664427 [debug] [MainThread]: On master: COMMIT
[0m12:42:58.664897 [debug] [MainThread]: Using duckdb connection "master"
[0m12:42:58.665345 [debug] [MainThread]: On master: COMMIT
[0m12:42:58.666002 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:42:58.666488 [debug] [MainThread]: On master: Close
[0m12:42:58.671063 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_activities_activity_date.51ab13376e
[0m12:42:58.671834 [info ] [Thread-1 (]: 1 of 6 START test not_null_stg_activities_activity_date ........................ [RUN]
[0m12:42:58.672614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now test.suvera.not_null_stg_activities_activity_date.51ab13376e)
[0m12:42:58.673174 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_activities_activity_date.51ab13376e
[0m12:42:58.699891 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_activities_activity_date.51ab13376e"
[0m12:42:58.702181 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_activities_activity_date.51ab13376e
[0m12:42:58.728562 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_activities_activity_date.51ab13376e"
[0m12:42:58.729934 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_activity_date.51ab13376e"
[0m12:42:58.730520 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_date.51ab13376e: BEGIN
[0m12:42:58.731055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:58.732026 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:42:58.732603 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_activity_date.51ab13376e"
[0m12:42:58.733194 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_date.51ab13376e: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_activities_activity_date.51ab13376e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_date
from "dev"."main"."stg_activities"
where activity_date is null



  
  
      
    ) dbt_internal_test
[0m12:42:58.734980 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:42:58.741334 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_date.51ab13376e: ROLLBACK
[0m12:42:58.742367 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_activities_activity_date.51ab13376e'
[0m12:42:58.742931 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_date.51ab13376e: Close
[0m12:42:58.743865 [info ] [Thread-1 (]: 1 of 6 PASS not_null_stg_activities_activity_date .............................. [[32mPASS[0m in 0.07s]
[0m12:42:58.744790 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_activities_activity_date.51ab13376e
[0m12:42:58.745401 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a
[0m12:42:58.746089 [info ] [Thread-1 (]: 2 of 6 START test not_null_stg_activities_activity_id .......................... [RUN]
[0m12:42:58.746788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_activities_activity_date.51ab13376e, now test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a)
[0m12:42:58.747347 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a
[0m12:42:58.753091 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a"
[0m12:42:58.754233 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a
[0m12:42:58.758980 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a"
[0m12:42:58.761134 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a"
[0m12:42:58.761761 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a: BEGIN
[0m12:42:58.762288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:58.763167 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:42:58.763716 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a"
[0m12:42:58.764272 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_id
from "dev"."main"."stg_activities"
where activity_id is null



  
  
      
    ) dbt_internal_test
[0m12:42:58.765871 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:42:58.768101 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a: ROLLBACK
[0m12:42:58.769019 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a'
[0m12:42:58.769572 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a: Close
[0m12:42:58.770448 [info ] [Thread-1 (]: 2 of 6 PASS not_null_stg_activities_activity_id ................................ [[32mPASS[0m in 0.02s]
[0m12:42:58.771549 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a
[0m12:42:58.772721 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_activities_activity_type.69907e08a2
[0m12:42:58.773520 [info ] [Thread-1 (]: 3 of 6 START test not_null_stg_activities_activity_type ........................ [RUN]
[0m12:42:58.774489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a, now test.suvera.not_null_stg_activities_activity_type.69907e08a2)
[0m12:42:58.775198 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_activities_activity_type.69907e08a2
[0m12:42:58.780786 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_activities_activity_type.69907e08a2"
[0m12:42:58.781872 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_activities_activity_type.69907e08a2
[0m12:42:58.784744 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_activities_activity_type.69907e08a2"
[0m12:42:58.785777 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_activity_type.69907e08a2"
[0m12:42:58.786330 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_type.69907e08a2: BEGIN
[0m12:42:58.786900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:58.788067 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:42:58.789840 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_activity_type.69907e08a2"
[0m12:42:58.790488 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_type.69907e08a2: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_activities_activity_type.69907e08a2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_type
from "dev"."main"."stg_activities"
where activity_type is null



  
  
      
    ) dbt_internal_test
[0m12:42:58.792316 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:42:58.794766 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_type.69907e08a2: ROLLBACK
[0m12:42:58.796033 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_activities_activity_type.69907e08a2'
[0m12:42:58.796912 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_type.69907e08a2: Close
[0m12:42:58.798253 [info ] [Thread-1 (]: 3 of 6 PASS not_null_stg_activities_activity_type .............................. [[32mPASS[0m in 0.02s]
[0m12:42:58.799173 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_activities_activity_type.69907e08a2
[0m12:42:58.799779 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_activities_patient_id.199695ff40
[0m12:42:58.800338 [info ] [Thread-1 (]: 4 of 6 START test not_null_stg_activities_patient_id ........................... [RUN]
[0m12:42:58.801054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_activities_activity_type.69907e08a2, now test.suvera.not_null_stg_activities_patient_id.199695ff40)
[0m12:42:58.801628 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_activities_patient_id.199695ff40
[0m12:42:58.806890 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_activities_patient_id.199695ff40"
[0m12:42:58.808203 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_activities_patient_id.199695ff40
[0m12:42:58.812371 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_activities_patient_id.199695ff40"
[0m12:42:58.813551 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_patient_id.199695ff40"
[0m12:42:58.814121 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_patient_id.199695ff40: BEGIN
[0m12:42:58.815546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:58.816739 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:42:58.817515 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_patient_id.199695ff40"
[0m12:42:58.818290 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_patient_id.199695ff40: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_activities_patient_id.199695ff40"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "dev"."main"."stg_activities"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m12:42:58.821940 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:42:58.824442 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_patient_id.199695ff40: ROLLBACK
[0m12:42:58.825698 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_activities_patient_id.199695ff40'
[0m12:42:58.827172 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_patient_id.199695ff40: Close
[0m12:42:58.828211 [info ] [Thread-1 (]: 4 of 6 PASS not_null_stg_activities_patient_id ................................. [[32mPASS[0m in 0.03s]
[0m12:42:58.829268 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_activities_patient_id.199695ff40
[0m12:42:58.829881 [debug] [Thread-1 (]: Began running node test.suvera.unique_stg_activities_activity_id.896c965cc8
[0m12:42:58.830441 [info ] [Thread-1 (]: 5 of 6 START test unique_stg_activities_activity_id ............................ [RUN]
[0m12:42:58.831159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_activities_patient_id.199695ff40, now test.suvera.unique_stg_activities_activity_id.896c965cc8)
[0m12:42:58.831736 [debug] [Thread-1 (]: Began compiling node test.suvera.unique_stg_activities_activity_id.896c965cc8
[0m12:42:58.841274 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.unique_stg_activities_activity_id.896c965cc8"
[0m12:42:58.843046 [debug] [Thread-1 (]: Began executing node test.suvera.unique_stg_activities_activity_id.896c965cc8
[0m12:42:58.846265 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.unique_stg_activities_activity_id.896c965cc8"
[0m12:42:58.847849 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.unique_stg_activities_activity_id.896c965cc8"
[0m12:42:58.848500 [debug] [Thread-1 (]: On test.suvera.unique_stg_activities_activity_id.896c965cc8: BEGIN
[0m12:42:58.849025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:58.849923 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:42:58.850477 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.unique_stg_activities_activity_id.896c965cc8"
[0m12:42:58.851031 [debug] [Thread-1 (]: On test.suvera.unique_stg_activities_activity_id.896c965cc8: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.unique_stg_activities_activity_id.896c965cc8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_activities"
where activity_id is not null
group by activity_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:42:58.855452 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:42:58.858003 [debug] [Thread-1 (]: On test.suvera.unique_stg_activities_activity_id.896c965cc8: ROLLBACK
[0m12:42:58.859882 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.unique_stg_activities_activity_id.896c965cc8'
[0m12:42:58.860658 [debug] [Thread-1 (]: On test.suvera.unique_stg_activities_activity_id.896c965cc8: Close
[0m12:42:58.861680 [info ] [Thread-1 (]: 5 of 6 PASS unique_stg_activities_activity_id .................................. [[32mPASS[0m in 0.03s]
[0m12:42:58.862600 [debug] [Thread-1 (]: Finished running node test.suvera.unique_stg_activities_activity_id.896c965cc8
[0m12:42:58.863201 [debug] [Thread-1 (]: Began running node test.suvera.unique_stg_activities_patient_id.d1593386a5
[0m12:42:58.863761 [info ] [Thread-1 (]: 6 of 6 START test unique_stg_activities_patient_id ............................. [RUN]
[0m12:42:58.864427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.unique_stg_activities_activity_id.896c965cc8, now test.suvera.unique_stg_activities_patient_id.d1593386a5)
[0m12:42:58.865071 [debug] [Thread-1 (]: Began compiling node test.suvera.unique_stg_activities_patient_id.d1593386a5
[0m12:42:58.870430 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.unique_stg_activities_patient_id.d1593386a5"
[0m12:42:58.871485 [debug] [Thread-1 (]: Began executing node test.suvera.unique_stg_activities_patient_id.d1593386a5
[0m12:42:58.875491 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.unique_stg_activities_patient_id.d1593386a5"
[0m12:42:58.877420 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.unique_stg_activities_patient_id.d1593386a5"
[0m12:42:58.878292 [debug] [Thread-1 (]: On test.suvera.unique_stg_activities_patient_id.d1593386a5: BEGIN
[0m12:42:58.879010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:58.879919 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:42:58.880466 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.unique_stg_activities_patient_id.d1593386a5"
[0m12:42:58.881023 [debug] [Thread-1 (]: On test.suvera.unique_stg_activities_patient_id.d1593386a5: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.unique_stg_activities_patient_id.d1593386a5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_activities"
where patient_id is not null
group by patient_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:42:58.885799 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:42:58.888178 [debug] [Thread-1 (]: On test.suvera.unique_stg_activities_patient_id.d1593386a5: ROLLBACK
[0m12:42:58.889135 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.unique_stg_activities_patient_id.d1593386a5'
[0m12:42:58.889678 [debug] [Thread-1 (]: On test.suvera.unique_stg_activities_patient_id.d1593386a5: Close
[0m12:42:58.890558 [error] [Thread-1 (]: 6 of 6 FAIL 18 unique_stg_activities_patient_id ................................ [[31mFAIL 18[0m in 0.03s]
[0m12:42:58.891861 [debug] [Thread-1 (]: Finished running node test.suvera.unique_stg_activities_patient_id.d1593386a5
[0m12:42:58.894687 [debug] [MainThread]: Using duckdb connection "master"
[0m12:42:58.895314 [debug] [MainThread]: On master: BEGIN
[0m12:42:58.895947 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:42:58.896798 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:42:58.897673 [debug] [MainThread]: On master: COMMIT
[0m12:42:58.898166 [debug] [MainThread]: Using duckdb connection "master"
[0m12:42:58.898617 [debug] [MainThread]: On master: COMMIT
[0m12:42:58.899359 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:42:58.899838 [debug] [MainThread]: On master: Close
[0m12:42:58.900438 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:42:58.900871 [debug] [MainThread]: Connection 'test.suvera.unique_stg_activities_patient_id.d1593386a5' was properly closed.
[0m12:42:58.901355 [info ] [MainThread]: 
[0m12:42:58.901851 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m12:42:58.904014 [debug] [MainThread]: Command end result
[0m12:42:58.939699 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m12:42:58.943710 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m12:42:58.955100 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m12:42:58.955660 [info ] [MainThread]: 
[0m12:42:58.956252 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:42:58.956765 [info ] [MainThread]: 
[0m12:42:58.957353 [error] [MainThread]: [31mFailure in test unique_stg_activities_patient_id (models/staging/schema.yml)[0m
[0m12:42:58.958213 [error] [MainThread]:   Got 18 results, configured to fail if != 0
[0m12:42:58.958729 [info ] [MainThread]: 
[0m12:42:58.959870 [info ] [MainThread]:   compiled code at target/compiled/suvera/models/staging/schema.yml/unique_stg_activities_patient_id.sql
[0m12:42:58.960438 [info ] [MainThread]: 
[0m12:42:58.960968 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=6
[0m12:42:58.965819 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.6217263, "process_in_blocks": "0", "process_kernel_time": 0.780109, "process_mem_max_rss": "138821632", "process_out_blocks": "0", "process_user_time": 4.580556}
[0m12:42:58.966689 [debug] [MainThread]: Command `dbt test` failed at 12:42:58.966449 after 2.62 seconds
[0m12:42:58.967379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd25a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8e8940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8e8c00>]}
[0m12:42:58.967958 [debug] [MainThread]: Flushing usage events
[0m12:42:59.381113 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:54:12.215290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e169d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef47610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef47750>]}


============================== 12:54:12.226884 | f5ac136e-1f14-4f4c-9208-5c045977c4b8 ==============================
[0m12:54:12.226884 [info ] [MainThread]: Running with dbt=1.10.1
[0m12:54:12.228081 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select stg_patients', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:54:12.740090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5ac136e-1f14-4f4c-9208-5c045977c4b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e421220>]}
[0m12:54:12.848627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5ac136e-1f14-4f4c-9208-5c045977c4b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee33130>]}
[0m12:54:12.875009 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m12:54:13.042438 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m12:54:13.304038 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m12:54:13.304890 [debug] [MainThread]: Partial parsing: added file: suvera://models/staging/stg_patients.sql
[0m12:54:13.305756 [debug] [MainThread]: Partial parsing: updated file: suvera://models/staging/schema.yml
[0m12:54:14.041570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5ac136e-1f14-4f4c-9208-5c045977c4b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7d0650>]}
[0m12:54:14.172207 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m12:54:14.177523 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m12:54:14.229936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5ac136e-1f14-4f4c-9208-5c045977c4b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f20ea80>]}
[0m12:54:14.230727 [info ] [MainThread]: Found 4 models, 4 seeds, 9 data tests, 428 macros
[0m12:54:14.231310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5ac136e-1f14-4f4c-9208-5c045977c4b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f59b930>]}
[0m12:54:14.233918 [info ] [MainThread]: 
[0m12:54:14.234573 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:54:14.235118 [info ] [MainThread]: 
[0m12:54:14.236302 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:54:14.237779 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:54:14.409262 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:54:14.409868 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:54:14.410345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:14.437475 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m12:54:14.439543 [debug] [ThreadPool]: On list_dev: Close
[0m12:54:14.440549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:54:14.441253 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:54:14.450481 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:54:14.451121 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m12:54:14.451604 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:54:14.452999 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:54:14.455027 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:54:14.455508 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:54:14.456241 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:54:14.456721 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:54:14.457181 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:54:14.457960 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:54:14.459273 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:54:14.459766 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:54:14.460224 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:54:14.460921 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:54:14.461415 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:54:14.470063 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:54:14.478292 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:54:14.478833 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:54:14.479389 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:54:14.480446 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:54:14.480970 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:54:14.481454 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:54:14.501485 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m12:54:14.503816 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:54:14.506535 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:54:14.507131 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:54:14.509285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5ac136e-1f14-4f4c-9208-5c045977c4b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7aef70>]}
[0m12:54:14.509961 [debug] [MainThread]: Using duckdb connection "master"
[0m12:54:14.510434 [debug] [MainThread]: On master: BEGIN
[0m12:54:14.510878 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:54:14.511692 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:54:14.512341 [debug] [MainThread]: On master: COMMIT
[0m12:54:14.512953 [debug] [MainThread]: Using duckdb connection "master"
[0m12:54:14.513427 [debug] [MainThread]: On master: COMMIT
[0m12:54:14.514172 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:54:14.514669 [debug] [MainThread]: On master: Close
[0m12:54:14.518915 [debug] [Thread-1 (]: Began running node model.suvera.stg_patients
[0m12:54:14.519817 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_patients .................................. [RUN]
[0m12:54:14.520542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.stg_patients)
[0m12:54:14.521114 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_patients
[0m12:54:14.531844 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_patients"
[0m12:54:14.532998 [debug] [Thread-1 (]: Began executing node model.suvera.stg_patients
[0m12:54:14.581652 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_patients"
[0m12:54:14.582876 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m12:54:14.583447 [debug] [Thread-1 (]: On model.suvera.stg_patients: BEGIN
[0m12:54:14.583984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:14.584993 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:54:14.585562 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m12:54:14.586115 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */

  
  create view "dev"."main"."stg_patients__dbt_tmp" as (
    select * 
from "dev"."main"."raw_patients"
LIMIT 100
  );

[0m12:54:14.587844 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:54:14.596695 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m12:54:14.597344 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m12:54:14.598358 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:54:14.613763 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m12:54:14.614414 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m12:54:14.614956 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m12:54:14.617289 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:54:14.624182 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m12:54:14.624783 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
drop view if exists "dev"."main"."stg_patients__dbt_backup" cascade
[0m12:54:14.626505 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:54:14.630377 [debug] [Thread-1 (]: On model.suvera.stg_patients: Close
[0m12:54:14.633624 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5ac136e-1f14-4f4c-9208-5c045977c4b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa31250>]}
[0m12:54:14.634758 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_patients ............................. [[32mOK[0m in 0.11s]
[0m12:54:14.635715 [debug] [Thread-1 (]: Finished running node model.suvera.stg_patients
[0m12:54:14.637328 [debug] [MainThread]: Using duckdb connection "master"
[0m12:54:14.637831 [debug] [MainThread]: On master: BEGIN
[0m12:54:14.638290 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:54:14.639135 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:54:14.639635 [debug] [MainThread]: On master: COMMIT
[0m12:54:14.640111 [debug] [MainThread]: Using duckdb connection "master"
[0m12:54:14.640570 [debug] [MainThread]: On master: COMMIT
[0m12:54:14.641531 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:54:14.642119 [debug] [MainThread]: On master: Close
[0m12:54:14.642799 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:54:14.643263 [debug] [MainThread]: Connection 'model.suvera.stg_patients' was properly closed.
[0m12:54:14.643759 [info ] [MainThread]: 
[0m12:54:14.644405 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m12:54:14.645735 [debug] [MainThread]: Command end result
[0m12:54:14.683857 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m12:54:14.686983 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m12:54:14.697240 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m12:54:14.697794 [info ] [MainThread]: 
[0m12:54:14.698400 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:54:14.698918 [info ] [MainThread]: 
[0m12:54:14.699453 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:54:14.704110 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.620104, "process_in_blocks": "0", "process_kernel_time": 0.780581, "process_mem_max_rss": "137166848", "process_out_blocks": "0", "process_user_time": 4.613811}
[0m12:54:14.705022 [debug] [MainThread]: Command `dbt run` succeeded at 12:54:14.704816 after 2.62 seconds
[0m12:54:14.705677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f84b330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4e54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3a7d90>]}
[0m12:54:14.706317 [debug] [MainThread]: Flushing usage events
[0m12:54:15.136963 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:56:13.516839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133f1d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114203610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114203750>]}


============================== 12:56:13.528131 | 23f4bc8f-f4d3-41bb-9058-18c759cdd4c8 ==============================
[0m12:56:13.528131 [info ] [MainThread]: Running with dbt=1.10.1
[0m12:56:13.529352 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'version_check': 'True', 'profiles_dir': '/Users/puneeth/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_patients', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:56:14.050159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23f4bc8f-f4d3-41bb-9058-18c759cdd4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136d5220>]}
[0m12:56:14.152749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23f4bc8f-f4d3-41bb-9058-18c759cdd4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140eb130>]}
[0m12:56:14.185531 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m12:56:14.367201 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m12:56:14.640343 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:56:14.640916 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:56:14.718968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23f4bc8f-f4d3-41bb-9058-18c759cdd4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11462b150>]}
[0m12:56:14.844757 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m12:56:14.850225 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m12:56:14.899461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23f4bc8f-f4d3-41bb-9058-18c759cdd4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144d6a80>]}
[0m12:56:14.900218 [info ] [MainThread]: Found 4 models, 4 seeds, 9 data tests, 428 macros
[0m12:56:14.900773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23f4bc8f-f4d3-41bb-9058-18c759cdd4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143cc830>]}
[0m12:56:14.903349 [info ] [MainThread]: 
[0m12:56:14.903912 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:56:14.904376 [info ] [MainThread]: 
[0m12:56:14.905271 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:56:14.906649 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:56:15.005437 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:56:15.006098 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:56:15.006642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:15.020611 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:56:15.021225 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m12:56:15.022336 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:56:15.022789 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m12:56:15.023242 [info ] [MainThread]: 
[0m12:56:15.023754 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m12:56:15.024514 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/puneeth/Documents/suvera_dbt_project/suvera/dev.duckdb": Conflicting lock is held in /usr/local/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 16984) by user puneeth. See also https://duckdb.org/docs/stable/connect/concurrency
[0m12:56:15.029625 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6452868, "process_in_blocks": "0", "process_kernel_time": 0.766709, "process_mem_max_rss": "125222912", "process_out_blocks": "0", "process_user_time": 3.620939}
[0m12:56:15.030632 [debug] [MainThread]: Command `dbt run` failed at 12:56:15.030424 after 1.65 seconds
[0m12:56:15.031358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a76000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140a9a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11483b110>]}
[0m12:56:15.031944 [debug] [MainThread]: Flushing usage events
[0m12:56:15.440957 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:56:56.503080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c61d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a73610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a73750>]}


============================== 12:56:56.515042 | 9dafa87c-001d-4e3a-971c-631813711bc6 ==============================
[0m12:56:56.515042 [info ] [MainThread]: Running with dbt=1.10.1
[0m12:56:56.516242 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_patients', 'send_anonymous_usage_stats': 'True'}
[0m12:56:57.017479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9dafa87c-001d-4e3a-971c-631813711bc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f45220>]}
[0m12:56:57.132260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9dafa87c-001d-4e3a-971c-631813711bc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10495b130>]}
[0m12:56:57.162808 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m12:56:57.359422 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m12:56:57.632286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:56:57.632938 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:56:57.729885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9dafa87c-001d-4e3a-971c-631813711bc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e9f150>]}
[0m12:56:57.883428 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m12:56:57.889112 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m12:56:57.938859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9dafa87c-001d-4e3a-971c-631813711bc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d46a80>]}
[0m12:56:57.939616 [info ] [MainThread]: Found 4 models, 4 seeds, 9 data tests, 428 macros
[0m12:56:57.940197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dafa87c-001d-4e3a-971c-631813711bc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c3c830>]}
[0m12:56:57.943219 [info ] [MainThread]: 
[0m12:56:57.944330 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:56:57.945093 [info ] [MainThread]: 
[0m12:56:57.946258 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:56:57.947609 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:56:58.052366 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:56:58.052981 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:56:58.053468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:58.080513 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m12:56:58.083134 [debug] [ThreadPool]: On list_dev: Close
[0m12:56:58.084346 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:56:58.085670 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:56:58.095542 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:56:58.096127 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m12:56:58.096592 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:56:58.098133 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:56:58.100654 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:56:58.101191 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:56:58.101938 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:56:58.102398 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:56:58.102850 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:56:58.103669 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:56:58.104984 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:56:58.105468 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:56:58.105987 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:56:58.106722 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:56:58.107229 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:56:58.115329 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:56:58.123218 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:56:58.123948 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:56:58.124537 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:56:58.125359 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:56:58.125830 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:56:58.126309 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:56:58.146902 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m12:56:58.150381 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:56:58.153140 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:56:58.153775 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:56:58.156691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dafa87c-001d-4e3a-971c-631813711bc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052e6820>]}
[0m12:56:58.157511 [debug] [MainThread]: Using duckdb connection "master"
[0m12:56:58.157992 [debug] [MainThread]: On master: BEGIN
[0m12:56:58.158434 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:56:58.159240 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:56:58.159724 [debug] [MainThread]: On master: COMMIT
[0m12:56:58.160190 [debug] [MainThread]: Using duckdb connection "master"
[0m12:56:58.160637 [debug] [MainThread]: On master: COMMIT
[0m12:56:58.161338 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:56:58.161840 [debug] [MainThread]: On master: Close
[0m12:56:58.166300 [debug] [Thread-1 (]: Began running node model.suvera.stg_patients
[0m12:56:58.167169 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_patients .................................. [RUN]
[0m12:56:58.167900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.stg_patients)
[0m12:56:58.168473 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_patients
[0m12:56:58.180026 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_patients"
[0m12:56:58.181798 [debug] [Thread-1 (]: Began executing node model.suvera.stg_patients
[0m12:56:58.232082 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_patients"
[0m12:56:58.233263 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m12:56:58.233825 [debug] [Thread-1 (]: On model.suvera.stg_patients: BEGIN
[0m12:56:58.234345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:58.235232 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:56:58.235775 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m12:56:58.236446 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */

  
  create view "dev"."main"."stg_patients__dbt_tmp" as (
    select * 
from "dev"."main"."raw_patients"
LIMIT 100
  );

[0m12:56:58.237526 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:56:58.246460 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m12:56:58.247112 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients" rename to "stg_patients__dbt_backup"
[0m12:56:58.248109 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:56:58.252418 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m12:56:58.253217 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m12:56:58.254399 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:56:58.273001 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m12:56:58.273678 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m12:56:58.274221 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m12:56:58.275840 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:56:58.283402 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m12:56:58.284042 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
drop view if exists "dev"."main"."stg_patients__dbt_backup" cascade
[0m12:56:58.285413 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:56:58.289808 [debug] [Thread-1 (]: On model.suvera.stg_patients: Close
[0m12:56:58.293622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dafa87c-001d-4e3a-971c-631813711bc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050abdd0>]}
[0m12:56:58.295257 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_patients ............................. [[32mOK[0m in 0.12s]
[0m12:56:58.296481 [debug] [Thread-1 (]: Finished running node model.suvera.stg_patients
[0m12:56:58.298177 [debug] [MainThread]: Using duckdb connection "master"
[0m12:56:58.298688 [debug] [MainThread]: On master: BEGIN
[0m12:56:58.299141 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:56:58.299945 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:56:58.300423 [debug] [MainThread]: On master: COMMIT
[0m12:56:58.300888 [debug] [MainThread]: Using duckdb connection "master"
[0m12:56:58.301335 [debug] [MainThread]: On master: COMMIT
[0m12:56:58.302428 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:56:58.303225 [debug] [MainThread]: On master: Close
[0m12:56:58.304129 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:56:58.304585 [debug] [MainThread]: Connection 'model.suvera.stg_patients' was properly closed.
[0m12:56:58.305065 [info ] [MainThread]: 
[0m12:56:58.305634 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m12:56:58.306720 [debug] [MainThread]: Command end result
[0m12:56:58.340703 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m12:56:58.343822 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m12:56:58.354357 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m12:56:58.354939 [info ] [MainThread]: 
[0m12:56:58.355552 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:56:58.356040 [info ] [MainThread]: 
[0m12:56:58.356575 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:56:58.361538 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9996458, "process_in_blocks": "0", "process_kernel_time": 0.767175, "process_mem_max_rss": "135249920", "process_out_blocks": "0", "process_user_time": 3.985903}
[0m12:56:58.362393 [debug] [MainThread]: Command `dbt run` succeeded at 12:56:58.362211 after 2.00 seconds
[0m12:56:58.363180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105139a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054c3e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054c3bb0>]}
[0m12:56:58.363771 [debug] [MainThread]: Flushing usage events
[0m12:56:58.799023 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:57:07.337312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad9d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098b3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098b3750>]}


============================== 12:57:07.344433 | 0a722939-12e8-4f14-b804-f1eb8e946b28 ==============================
[0m12:57:07.344433 [info ] [MainThread]: Running with dbt=1.10.1
[0m12:57:07.345347 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'profiles_dir': '/Users/puneeth/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_patients', 'send_anonymous_usage_stats': 'True'}
[0m12:57:07.747005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a722939-12e8-4f14-b804-f1eb8e946b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d8d220>]}
[0m12:57:07.849389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a722939-12e8-4f14-b804-f1eb8e946b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10979f130>]}
[0m12:57:07.864481 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m12:57:08.021477 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m12:57:08.222635 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:57:08.223230 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:57:08.301118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a722939-12e8-4f14-b804-f1eb8e946b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ccf150>]}
[0m12:57:08.429981 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m12:57:08.433954 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m12:57:08.463196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a722939-12e8-4f14-b804-f1eb8e946b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b7aa80>]}
[0m12:57:08.464032 [info ] [MainThread]: Found 4 models, 4 seeds, 9 data tests, 428 macros
[0m12:57:08.464620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a722939-12e8-4f14-b804-f1eb8e946b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a78830>]}
[0m12:57:08.467586 [info ] [MainThread]: 
[0m12:57:08.468260 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:57:08.468746 [info ] [MainThread]: 
[0m12:57:08.469549 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:57:08.471066 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:57:08.558945 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:57:08.559588 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:57:08.560083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:08.583915 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m12:57:08.586077 [debug] [ThreadPool]: On list_dev: Close
[0m12:57:08.587129 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:57:08.587845 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:57:08.596844 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:57:08.597379 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m12:57:08.597835 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:57:08.599151 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:57:08.601098 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:57:08.601569 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:57:08.602267 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:57:08.602720 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:57:08.603165 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:57:08.603962 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:57:08.605402 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:57:08.605968 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:57:08.606445 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:57:08.607218 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:57:08.607712 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:57:08.616024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:57:08.623525 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:57:08.624041 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:57:08.624476 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:57:08.625360 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:57:08.625843 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:57:08.626314 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:57:08.646761 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m12:57:08.650023 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:57:08.651619 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:57:08.652111 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:57:08.654456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a722939-12e8-4f14-b804-f1eb8e946b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a10a820>]}
[0m12:57:08.655128 [debug] [MainThread]: Using duckdb connection "master"
[0m12:57:08.655595 [debug] [MainThread]: On master: BEGIN
[0m12:57:08.656037 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:57:08.656842 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:57:08.657323 [debug] [MainThread]: On master: COMMIT
[0m12:57:08.657793 [debug] [MainThread]: Using duckdb connection "master"
[0m12:57:08.658240 [debug] [MainThread]: On master: COMMIT
[0m12:57:08.658903 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:57:08.659392 [debug] [MainThread]: On master: Close
[0m12:57:08.662105 [debug] [Thread-1 (]: Began running node model.suvera.stg_patients
[0m12:57:08.662912 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_patients .................................. [RUN]
[0m12:57:08.663603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.stg_patients)
[0m12:57:08.664175 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_patients
[0m12:57:08.675268 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_patients"
[0m12:57:08.676884 [debug] [Thread-1 (]: Began executing node model.suvera.stg_patients
[0m12:57:08.724715 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_patients"
[0m12:57:08.725910 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m12:57:08.726480 [debug] [Thread-1 (]: On model.suvera.stg_patients: BEGIN
[0m12:57:08.727003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:08.727957 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:57:08.728517 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m12:57:08.729066 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */

  
  create view "dev"."main"."stg_patients__dbt_tmp" as (
    select * 
from "dev"."main"."raw_patients"
LIMIT 100
  );

[0m12:57:08.730085 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:57:08.738719 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m12:57:08.739330 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients" rename to "stg_patients__dbt_backup"
[0m12:57:08.740315 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:57:08.744597 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m12:57:08.745179 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m12:57:08.746184 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:57:08.764080 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m12:57:08.764737 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m12:57:08.765289 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m12:57:08.766924 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:57:08.773745 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m12:57:08.774327 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
drop view if exists "dev"."main"."stg_patients__dbt_backup" cascade
[0m12:57:08.775696 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:57:08.779576 [debug] [Thread-1 (]: On model.suvera.stg_patients: Close
[0m12:57:08.782190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a722939-12e8-4f14-b804-f1eb8e946b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109eb3dd0>]}
[0m12:57:08.783180 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_patients ............................. [[32mOK[0m in 0.12s]
[0m12:57:08.784123 [debug] [Thread-1 (]: Finished running node model.suvera.stg_patients
[0m12:57:08.785891 [debug] [MainThread]: Using duckdb connection "master"
[0m12:57:08.786393 [debug] [MainThread]: On master: BEGIN
[0m12:57:08.786846 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:57:08.787680 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:57:08.788159 [debug] [MainThread]: On master: COMMIT
[0m12:57:08.788627 [debug] [MainThread]: Using duckdb connection "master"
[0m12:57:08.789078 [debug] [MainThread]: On master: COMMIT
[0m12:57:08.789744 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:57:08.790373 [debug] [MainThread]: On master: Close
[0m12:57:08.791173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:08.791727 [debug] [MainThread]: Connection 'model.suvera.stg_patients' was properly closed.
[0m12:57:08.792468 [info ] [MainThread]: 
[0m12:57:08.793042 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m12:57:08.794158 [debug] [MainThread]: Command end result
[0m12:57:08.830380 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m12:57:08.833558 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m12:57:08.843178 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m12:57:08.843715 [info ] [MainThread]: 
[0m12:57:08.844393 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:57:08.845071 [info ] [MainThread]: 
[0m12:57:08.845907 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:57:08.850177 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6252097, "process_in_blocks": "0", "process_kernel_time": 0.480162, "process_mem_max_rss": "134418432", "process_out_blocks": "0", "process_user_time": 3.554277}
[0m12:57:08.851034 [debug] [MainThread]: Command `dbt run` succeeded at 12:57:08.850855 after 1.63 seconds
[0m12:57:08.851645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f61a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2dfe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2dfbb0>]}
[0m12:57:08.852218 [debug] [MainThread]: Flushing usage events
[0m12:57:09.287101 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:01:09.146789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127b9d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135cb610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135cb750>]}


============================== 13:01:09.157720 | b5d5f90e-7ef8-4d0e-b845-10c6b0fabd78 ==============================
[0m13:01:09.157720 [info ] [MainThread]: Running with dbt=1.10.1
[0m13:01:09.158845 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_patients', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:01:09.665940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5d5f90e-7ef8-4d0e-b845-10c6b0fabd78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a9d220>]}
[0m13:01:09.769318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5d5f90e-7ef8-4d0e-b845-10c6b0fabd78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134b3130>]}
[0m13:01:09.802765 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:01:09.975755 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m13:01:10.216401 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:01:10.217383 [debug] [MainThread]: Partial parsing: updated file: suvera://models/staging/stg_patients.sql
[0m13:01:10.749221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5d5f90e-7ef8-4d0e-b845-10c6b0fabd78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d5ca50>]}
[0m13:01:10.881405 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:01:10.886571 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:01:10.939013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5d5f90e-7ef8-4d0e-b845-10c6b0fabd78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11389ea80>]}
[0m13:01:10.939892 [info ] [MainThread]: Found 4 models, 4 seeds, 9 data tests, 428 macros
[0m13:01:10.940487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5d5f90e-7ef8-4d0e-b845-10c6b0fabd78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113dba350>]}
[0m13:01:10.943121 [info ] [MainThread]: 
[0m13:01:10.943698 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:01:10.944351 [info ] [MainThread]: 
[0m13:01:10.945234 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:01:10.946978 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:01:11.043975 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:01:11.044595 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:01:11.045157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:11.072782 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m13:01:11.074921 [debug] [ThreadPool]: On list_dev: Close
[0m13:01:11.075954 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m13:01:11.077155 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m13:01:11.086371 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:01:11.086927 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m13:01:11.087393 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:11.088722 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:01:11.090715 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:01:11.091182 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m13:01:11.091870 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:01:11.092326 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:01:11.092778 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m13:01:11.093536 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:01:11.094853 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:01:11.095358 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:01:11.095806 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:01:11.096543 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:01:11.097041 [debug] [ThreadPool]: On create_dev_main: Close
[0m13:01:11.105278 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m13:01:11.112980 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:01:11.113512 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:01:11.113951 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:11.114768 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:01:11.115231 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:01:11.115704 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m13:01:11.135229 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m13:01:11.137447 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:01:11.140232 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:01:11.140849 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:01:11.220908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5d5f90e-7ef8-4d0e-b845-10c6b0fabd78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b4f860>]}
[0m13:01:11.221626 [debug] [MainThread]: Using duckdb connection "master"
[0m13:01:11.222101 [debug] [MainThread]: On master: BEGIN
[0m13:01:11.222540 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:01:11.223347 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:01:11.223823 [debug] [MainThread]: On master: COMMIT
[0m13:01:11.224287 [debug] [MainThread]: Using duckdb connection "master"
[0m13:01:11.224728 [debug] [MainThread]: On master: COMMIT
[0m13:01:11.225400 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:01:11.225911 [debug] [MainThread]: On master: Close
[0m13:01:11.230608 [debug] [Thread-1 (]: Began running node model.suvera.stg_patients
[0m13:01:11.231499 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_patients .................................. [RUN]
[0m13:01:11.232230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.stg_patients)
[0m13:01:11.232796 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_patients
[0m13:01:11.244543 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_patients"
[0m13:01:11.245811 [debug] [Thread-1 (]: Began executing node model.suvera.stg_patients
[0m13:01:11.293928 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_patients"
[0m13:01:11.295249 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:01:11.295835 [debug] [Thread-1 (]: On model.suvera.stg_patients: BEGIN
[0m13:01:11.296365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:11.297267 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:01:11.297806 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:01:11.298372 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */

  
  create view "dev"."main"."stg_patients__dbt_tmp" as (
    with source as (
    select * from "dev"."main"."raw_patients"
),

parsed as (
    select
        json_extract_scalar(data, '$.patient_id')::INT as patient_id,
        json_extract_scalar(data, '$.practice_id')::INT as practice_id,
        json_extract_scalar(data, '$.first_name') as first_name,
        json_extract_scalar(data, '$.last_name') as last_name,
        json_extract_scalar(data, '$.date_of_birth')::DATE as date_of_birth,
        json_extract_scalar(data, '$.has_hypertension')::BOOLEAN as has_hypertension
    from source
)

select * from parsed
  );

[0m13:01:11.322457 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */

  
  create view "dev"."main"."stg_patients__dbt_tmp" as (
    with source as (
    select * from "dev"."main"."raw_patients"
),

parsed as (
    select
        json_extract_scalar(data, '$.patient_id')::INT as patient_id,
        json_extract_scalar(data, '$.practice_id')::INT as practice_id,
        json_extract_scalar(data, '$.first_name') as first_name,
        json_extract_scalar(data, '$.last_name') as last_name,
        json_extract_scalar(data, '$.date_of_birth')::DATE as date_of_birth,
        json_extract_scalar(data, '$.has_hypertension')::BOOLEAN as has_hypertension
    from source
)

select * from parsed
  );

[0m13:01:11.323253 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:01:11.323964 [debug] [Thread-1 (]: On model.suvera.stg_patients: ROLLBACK
[0m13:01:11.342901 [debug] [Thread-1 (]: Failed to rollback 'model.suvera.stg_patients'
[0m13:01:11.343535 [debug] [Thread-1 (]: On model.suvera.stg_patients: Close
[0m13:01:11.349662 [debug] [Thread-1 (]: Runtime Error in model stg_patients (models/staging/stg_patients.sql)
  Catalog Error: Scalar Function with name json_extract_scalar does not exist!
  Did you mean "json_extract"?
  
  LINE 11:         json_extract_scalar(data, '$.patient_id')::INT as patient_id...
                   ^
[0m13:01:11.353471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5d5f90e-7ef8-4d0e-b845-10c6b0fabd78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114170e90>]}
[0m13:01:11.355200 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_patients ......................... [[31mERROR[0m in 0.12s]
[0m13:01:11.356753 [debug] [Thread-1 (]: Finished running node model.suvera.stg_patients
[0m13:01:11.358108 [debug] [Thread-4 (]: Marking all children of 'model.suvera.stg_patients' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_patients (models/staging/stg_patients.sql)
  Catalog Error: Scalar Function with name json_extract_scalar does not exist!
  Did you mean "json_extract"?
  
  LINE 11:         json_extract_scalar(data, '$.patient_id')::INT as patient_id...
                   ^.
[0m13:01:11.361828 [debug] [MainThread]: Using duckdb connection "master"
[0m13:01:11.362636 [debug] [MainThread]: On master: BEGIN
[0m13:01:11.363186 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:01:11.364093 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:01:11.364665 [debug] [MainThread]: On master: COMMIT
[0m13:01:11.365187 [debug] [MainThread]: Using duckdb connection "master"
[0m13:01:11.365680 [debug] [MainThread]: On master: COMMIT
[0m13:01:11.366482 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:01:11.367039 [debug] [MainThread]: On master: Close
[0m13:01:11.367642 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:11.368072 [debug] [MainThread]: Connection 'model.suvera.stg_patients' was properly closed.
[0m13:01:11.368767 [info ] [MainThread]: 
[0m13:01:11.369743 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m13:01:11.370877 [debug] [MainThread]: Command end result
[0m13:01:11.408035 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:01:11.410850 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:01:11.420390 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m13:01:11.420972 [info ] [MainThread]: 
[0m13:01:11.421561 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:01:11.422070 [info ] [MainThread]: 
[0m13:01:11.422667 [error] [MainThread]: [31mFailure in model stg_patients (models/staging/stg_patients.sql)[0m
[0m13:01:11.423263 [error] [MainThread]:   Runtime Error in model stg_patients (models/staging/stg_patients.sql)
  Catalog Error: Scalar Function with name json_extract_scalar does not exist!
  Did you mean "json_extract"?
  
  LINE 11:         json_extract_scalar(data, '$.patient_id')::INT as patient_id...
                   ^
[0m13:01:11.423739 [info ] [MainThread]: 
[0m13:01:11.424298 [info ] [MainThread]:   compiled code at target/compiled/suvera/models/staging/stg_patients.sql
[0m13:01:11.424763 [info ] [MainThread]: 
[0m13:01:11.425447 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m13:01:11.430649 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.412259, "process_in_blocks": "0", "process_kernel_time": 0.763323, "process_mem_max_rss": "138682368", "process_out_blocks": "0", "process_user_time": 4.311614}
[0m13:01:11.431452 [debug] [MainThread]: Command `dbt run` failed at 13:01:11.431284 after 2.41 seconds
[0m13:01:11.432026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e52990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b254f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e051d0>]}
[0m13:01:11.432580 [debug] [MainThread]: Flushing usage events
[0m13:01:11.826438 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:02:51.504692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111535d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11230f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11230f750>]}


============================== 13:02:51.515699 | 0a5a301b-d00f-4cc1-a6af-5e79b49b9849 ==============================
[0m13:02:51.515699 [info ] [MainThread]: Running with dbt=1.10.1
[0m13:02:51.516802 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'profiles_dir': '/Users/puneeth/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_patients', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:02:52.037123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a5a301b-d00f-4cc1-a6af-5e79b49b9849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117e9220>]}
[0m13:02:52.139988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a5a301b-d00f-4cc1-a6af-5e79b49b9849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121fb130>]}
[0m13:02:52.169260 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:02:52.403973 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m13:02:52.655261 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:02:52.656313 [debug] [MainThread]: Partial parsing: updated file: suvera://models/staging/stg_patients.sql
[0m13:02:53.193298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a5a301b-d00f-4cc1-a6af-5e79b49b9849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a88a50>]}
[0m13:02:53.326088 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:02:53.331819 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:02:53.383871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a5a301b-d00f-4cc1-a6af-5e79b49b9849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125d6a80>]}
[0m13:02:53.384679 [info ] [MainThread]: Found 4 models, 4 seeds, 9 data tests, 428 macros
[0m13:02:53.385250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a5a301b-d00f-4cc1-a6af-5e79b49b9849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112af6190>]}
[0m13:02:53.387873 [info ] [MainThread]: 
[0m13:02:53.388432 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:02:53.388900 [info ] [MainThread]: 
[0m13:02:53.389742 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:02:53.391720 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:02:53.489654 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:02:53.490248 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:02:53.490731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:02:53.517011 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m13:02:53.519151 [debug] [ThreadPool]: On list_dev: Close
[0m13:02:53.520188 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m13:02:53.521462 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m13:02:53.531223 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:02:53.531829 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m13:02:53.532294 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:02:53.533618 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:02:53.535587 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:02:53.536059 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m13:02:53.536742 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:02:53.537199 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:02:53.537647 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m13:02:53.538434 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:02:53.539743 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:02:53.540230 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:02:53.540679 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:02:53.541350 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:02:53.541834 [debug] [ThreadPool]: On create_dev_main: Close
[0m13:02:53.550172 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m13:02:53.557645 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:02:53.558157 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:02:53.558601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:02:53.559432 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:02:53.559896 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:02:53.560362 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m13:02:53.579989 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m13:02:53.582378 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:02:53.585274 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:02:53.585886 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:02:53.667973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a5a301b-d00f-4cc1-a6af-5e79b49b9849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112867860>]}
[0m13:02:53.677670 [debug] [MainThread]: Using duckdb connection "master"
[0m13:02:53.678887 [debug] [MainThread]: On master: BEGIN
[0m13:02:53.679860 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:02:53.681142 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:02:53.681927 [debug] [MainThread]: On master: COMMIT
[0m13:02:53.682689 [debug] [MainThread]: Using duckdb connection "master"
[0m13:02:53.683309 [debug] [MainThread]: On master: COMMIT
[0m13:02:53.684217 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:02:53.684870 [debug] [MainThread]: On master: Close
[0m13:02:53.689791 [debug] [Thread-1 (]: Began running node model.suvera.stg_patients
[0m13:02:53.690734 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_patients .................................. [RUN]
[0m13:02:53.691508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.stg_patients)
[0m13:02:53.692114 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_patients
[0m13:02:53.703895 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_patients"
[0m13:02:53.705104 [debug] [Thread-1 (]: Began executing node model.suvera.stg_patients
[0m13:02:53.753032 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_patients"
[0m13:02:53.754251 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:02:53.754813 [debug] [Thread-1 (]: On model.suvera.stg_patients: BEGIN
[0m13:02:53.755334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:02:53.756235 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:02:53.756782 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:02:53.757349 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */

  
  create view "dev"."main"."stg_patients__dbt_tmp" as (
    -- models/staging/stg_patients.sql

with source as (
    select * from "dev"."main"."raw_patients"
),

parsed as (
    select
        cast(json_extract(data, '$.patient_id') as INTEGER) as patient_id,
        cast(json_extract(data, '$.practice_id') as INTEGER) as practice_id,
        cast(json_extract(data, '$.first_name') as TEXT) as first_name,
        cast(json_extract(data, '$.last_name') as TEXT) as last_name,
        cast(json_extract(data, '$.date_of_birth') as DATE) as date_of_birth,
        cast(json_extract(data, '$.has_hypertension') as BOOLEAN) as has_hypertension
    from source
)

select * from parsed
  );

[0m13:02:53.759636 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:02:53.768440 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:02:53.769068 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients" rename to "stg_patients__dbt_backup"
[0m13:02:53.770073 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:02:53.774307 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:02:53.774884 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m13:02:53.775790 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:02:53.793991 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m13:02:53.794659 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:02:53.795197 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m13:02:53.797883 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:02:53.805298 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:02:53.805882 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
drop view if exists "dev"."main"."stg_patients__dbt_backup" cascade
[0m13:02:53.807291 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:02:53.810879 [debug] [Thread-1 (]: On model.suvera.stg_patients: Close
[0m13:02:53.814853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a5a301b-d00f-4cc1-a6af-5e79b49b9849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e9d310>]}
[0m13:02:53.816316 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_patients ............................. [[32mOK[0m in 0.12s]
[0m13:02:53.817438 [debug] [Thread-1 (]: Finished running node model.suvera.stg_patients
[0m13:02:53.819282 [debug] [MainThread]: Using duckdb connection "master"
[0m13:02:53.819822 [debug] [MainThread]: On master: BEGIN
[0m13:02:53.820305 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:02:53.821209 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:02:53.821737 [debug] [MainThread]: On master: COMMIT
[0m13:02:53.822203 [debug] [MainThread]: Using duckdb connection "master"
[0m13:02:53.822651 [debug] [MainThread]: On master: COMMIT
[0m13:02:53.823318 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:02:53.824009 [debug] [MainThread]: On master: Close
[0m13:02:53.824795 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:02:53.825305 [debug] [MainThread]: Connection 'model.suvera.stg_patients' was properly closed.
[0m13:02:53.825933 [info ] [MainThread]: 
[0m13:02:53.826503 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m13:02:53.827762 [debug] [MainThread]: Command end result
[0m13:02:53.864073 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:02:53.866736 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:02:53.876039 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m13:02:53.876779 [info ] [MainThread]: 
[0m13:02:53.877924 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:02:53.879152 [info ] [MainThread]: 
[0m13:02:53.879945 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:02:53.885133 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5102475, "process_in_blocks": "0", "process_kernel_time": 0.774004, "process_mem_max_rss": "136962048", "process_out_blocks": "0", "process_user_time": 4.331494}
[0m13:02:53.885931 [debug] [MainThread]: Command `dbt run` succeeded at 13:02:53.885764 after 2.51 seconds
[0m13:02:53.886553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b75b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11296e170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11296d8b0>]}
[0m13:02:53.887118 [debug] [MainThread]: Flushing usage events
[0m13:02:54.368985 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:07:00.194938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d165d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df77610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df77750>]}


============================== 13:07:00.205587 | cf0f66af-8626-4160-8b71-287a5bd759c3 ==============================
[0m13:07:00.205587 [info ] [MainThread]: Running with dbt=1.10.1
[0m13:07:00.206550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_patients', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:07:00.712729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf0f66af-8626-4160-8b71-287a5bd759c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d445220>]}
[0m13:07:00.819631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf0f66af-8626-4160-8b71-287a5bd759c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de5f130>]}
[0m13:07:00.841517 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:07:01.099558 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m13:07:01.577034 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:07:01.577917 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:07:01.692008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf0f66af-8626-4160-8b71-287a5bd759c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3a3150>]}
[0m13:07:01.837691 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:07:01.842578 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:07:01.888205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf0f66af-8626-4160-8b71-287a5bd759c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e24aa80>]}
[0m13:07:01.888992 [info ] [MainThread]: Found 4 models, 4 seeds, 9 data tests, 428 macros
[0m13:07:01.889557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf0f66af-8626-4160-8b71-287a5bd759c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e144830>]}
[0m13:07:01.892370 [info ] [MainThread]: 
[0m13:07:01.893080 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:07:01.893815 [info ] [MainThread]: 
[0m13:07:01.894795 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:07:01.896465 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:07:02.007469 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:07:02.008089 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:07:02.008586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:07:02.036647 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m13:07:02.039278 [debug] [ThreadPool]: On list_dev: Close
[0m13:07:02.040400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m13:07:02.041127 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m13:07:02.052837 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:07:02.053943 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m13:07:02.054581 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:07:02.056245 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:07:02.058292 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:07:02.058771 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m13:07:02.059514 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:07:02.059976 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:07:02.060428 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m13:07:02.061626 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:07:02.064055 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:07:02.064801 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:07:02.065300 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:07:02.066066 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:07:02.066564 [debug] [ThreadPool]: On create_dev_main: Close
[0m13:07:02.076948 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m13:07:02.086622 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:07:02.087617 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:07:02.088280 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:07:02.089167 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:07:02.089658 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:07:02.090140 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m13:07:02.111482 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m13:07:02.114641 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:07:02.116655 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:07:02.117204 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:07:02.119751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf0f66af-8626-4160-8b71-287a5bd759c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7ea820>]}
[0m13:07:02.120479 [debug] [MainThread]: Using duckdb connection "master"
[0m13:07:02.120962 [debug] [MainThread]: On master: BEGIN
[0m13:07:02.121410 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:07:02.122251 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:07:02.122764 [debug] [MainThread]: On master: COMMIT
[0m13:07:02.123248 [debug] [MainThread]: Using duckdb connection "master"
[0m13:07:02.123705 [debug] [MainThread]: On master: COMMIT
[0m13:07:02.124458 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:07:02.124996 [debug] [MainThread]: On master: Close
[0m13:07:02.128715 [debug] [Thread-1 (]: Began running node model.suvera.stg_patients
[0m13:07:02.129581 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_patients .................................. [RUN]
[0m13:07:02.130303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.stg_patients)
[0m13:07:02.130886 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_patients
[0m13:07:02.143354 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_patients"
[0m13:07:02.144702 [debug] [Thread-1 (]: Began executing node model.suvera.stg_patients
[0m13:07:02.215061 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_patients"
[0m13:07:02.216667 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:07:02.217273 [debug] [Thread-1 (]: On model.suvera.stg_patients: BEGIN
[0m13:07:02.217901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:07:02.218826 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:07:02.219389 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:07:02.219954 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */

  
  create view "dev"."main"."stg_patients__dbt_tmp" as (
    -- models/staging/stg_patients.sql

with source as (
    select * from "dev"."main"."raw_patients"
),

parsed as (
    select
        cast(json_extract(data, '$.patient_id') as INTEGER) as patient_id,
        cast(json_extract(data, '$.practice_id') as INTEGER) as practice_id,
        cast(json_extract(data, '$.first_name') as TEXT) as first_name,
        cast(json_extract(data, '$.last_name') as TEXT) as last_name,
        cast(json_extract(data, '$.date_of_birth') as DATE) as date_of_birth,
        cast(json_extract(data, '$.has_hypertension') as BOOLEAN) as has_hypertension
    from source
)

select * from parsed
  );

[0m13:07:02.222165 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:07:02.233631 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:07:02.234723 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients" rename to "stg_patients__dbt_backup"
[0m13:07:02.236272 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:07:02.242663 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:07:02.243611 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m13:07:02.244948 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:07:02.264120 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m13:07:02.264793 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:07:02.265325 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m13:07:02.266875 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:07:02.278218 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:07:02.279304 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
drop view if exists "dev"."main"."stg_patients__dbt_backup" cascade
[0m13:07:02.281264 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:07:02.285750 [debug] [Thread-1 (]: On model.suvera.stg_patients: Close
[0m13:07:02.291026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf0f66af-8626-4160-8b71-287a5bd759c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5afdd0>]}
[0m13:07:02.292447 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_patients ............................. [[32mOK[0m in 0.16s]
[0m13:07:02.293920 [debug] [Thread-1 (]: Finished running node model.suvera.stg_patients
[0m13:07:02.295717 [debug] [MainThread]: Using duckdb connection "master"
[0m13:07:02.296316 [debug] [MainThread]: On master: BEGIN
[0m13:07:02.297113 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:07:02.298300 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:07:02.299304 [debug] [MainThread]: On master: COMMIT
[0m13:07:02.299828 [debug] [MainThread]: Using duckdb connection "master"
[0m13:07:02.300287 [debug] [MainThread]: On master: COMMIT
[0m13:07:02.301048 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:07:02.301558 [debug] [MainThread]: On master: Close
[0m13:07:02.302196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:07:02.302635 [debug] [MainThread]: Connection 'model.suvera.stg_patients' was properly closed.
[0m13:07:02.303112 [info ] [MainThread]: 
[0m13:07:02.303634 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m13:07:02.304872 [debug] [MainThread]: Command end result
[0m13:07:02.347446 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:07:02.352756 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:07:02.365136 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m13:07:02.365697 [info ] [MainThread]: 
[0m13:07:02.366423 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:07:02.366981 [info ] [MainThread]: 
[0m13:07:02.368210 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:07:02.386555 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.332536, "process_in_blocks": "0", "process_kernel_time": 0.814366, "process_mem_max_rss": "134365184", "process_out_blocks": "0", "process_user_time": 4.068092}
[0m13:07:02.392510 [debug] [MainThread]: Command `dbt run` succeeded at 13:07:02.391661 after 2.34 seconds
[0m13:07:02.393677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e641a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9c7e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9c7bb0>]}
[0m13:07:02.396930 [debug] [MainThread]: Flushing usage events
[0m13:07:02.879731 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:09:05.362153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104749d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105727610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105727750>]}


============================== 13:09:05.373301 | d5cd4b3b-80e6-40e7-a359-be03717d46df ==============================
[0m13:09:05.373301 [info ] [MainThread]: Running with dbt=1.10.1
[0m13:09:05.374426 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'profiles_dir': '/Users/puneeth/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_patients', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:09:05.878713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5cd4b3b-80e6-40e7-a359-be03717d46df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bd5220>]}
[0m13:09:05.981338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5cd4b3b-80e6-40e7-a359-be03717d46df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10560f130>]}
[0m13:09:06.009956 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:09:06.179474 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m13:09:06.460273 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:09:06.461296 [debug] [MainThread]: Partial parsing: updated file: suvera://models/staging/stg_patients.sql
[0m13:09:06.991280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5cd4b3b-80e6-40e7-a359-be03717d46df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ec0a50>]}
[0m13:09:07.120109 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:09:07.126428 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:09:07.178441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5cd4b3b-80e6-40e7-a359-be03717d46df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059faa80>]}
[0m13:09:07.179207 [info ] [MainThread]: Found 4 models, 4 seeds, 9 data tests, 428 macros
[0m13:09:07.179773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5cd4b3b-80e6-40e7-a359-be03717d46df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f1e190>]}
[0m13:09:07.182344 [info ] [MainThread]: 
[0m13:09:07.182918 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:09:07.183390 [info ] [MainThread]: 
[0m13:09:07.184155 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:09:07.185365 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:09:07.287014 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:09:07.287964 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:09:07.288759 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:09:07.321114 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m13:09:07.323267 [debug] [ThreadPool]: On list_dev: Close
[0m13:09:07.324302 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m13:09:07.325016 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m13:09:07.334007 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:09:07.334536 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m13:09:07.334993 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:09:07.336285 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:09:07.338225 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:09:07.338700 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m13:09:07.339383 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:09:07.339841 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:09:07.340295 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m13:09:07.341058 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:09:07.342343 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:09:07.342830 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:09:07.343348 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:09:07.344035 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:09:07.344518 [debug] [ThreadPool]: On create_dev_main: Close
[0m13:09:07.352755 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m13:09:07.360246 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:09:07.360763 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:09:07.361205 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:09:07.362040 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:09:07.362505 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:09:07.362990 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m13:09:07.383060 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m13:09:07.385350 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:09:07.388192 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:09:07.388845 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:09:07.469186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5cd4b3b-80e6-40e7-a359-be03717d46df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cbb860>]}
[0m13:09:07.469912 [debug] [MainThread]: Using duckdb connection "master"
[0m13:09:07.470387 [debug] [MainThread]: On master: BEGIN
[0m13:09:07.470832 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:09:07.471641 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:09:07.472127 [debug] [MainThread]: On master: COMMIT
[0m13:09:07.472598 [debug] [MainThread]: Using duckdb connection "master"
[0m13:09:07.473049 [debug] [MainThread]: On master: COMMIT
[0m13:09:07.473735 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:09:07.474251 [debug] [MainThread]: On master: Close
[0m13:09:07.479330 [debug] [Thread-1 (]: Began running node model.suvera.stg_patients
[0m13:09:07.480237 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_patients .................................. [RUN]
[0m13:09:07.480963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.stg_patients)
[0m13:09:07.481536 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_patients
[0m13:09:07.492750 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_patients"
[0m13:09:07.494452 [debug] [Thread-1 (]: Began executing node model.suvera.stg_patients
[0m13:09:07.543339 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_patients"
[0m13:09:07.544616 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:09:07.545255 [debug] [Thread-1 (]: On model.suvera.stg_patients: BEGIN
[0m13:09:07.545804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:09:07.546728 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:09:07.547288 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:09:07.547874 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */

  
  create view "dev"."main"."stg_patients__dbt_tmp" as (
    with source as (
    select * from "dev"."main"."raw_patients"
),

-- Step 1: convert escaped string to valid JSON using DOUBLE unescape
converted as (
    select
        parse_json(replace(data, '""', '"')) as json_data
    from source
),

-- Step 2: extract fields from parsed JSON
parsed as (
    select
        json_data ->> 'patient_id' as patient_id,
        json_data ->> 'practice_id' as practice_id,
        json_data ->> 'age' as age,
        json_data ->> 'gender' as gender,
        json_data ->> 'registration_date' as registration_date,
        json_data -> 'conditions' as conditions,
        json_data -> 'contact' ->> 'email' as email,
        json_data -> 'contact' ->> 'phone' as phone
    from converted
)

select
    cast(patient_id as integer) as patient_id,
    cast(practice_id as integer) as practice_id,
    cast(age as integer) as age,
    gender,
    cast(registration_date as date) as registration_date,
    conditions,
    email,
    phone
from parsed
  );

[0m13:09:07.551492 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */

  
  create view "dev"."main"."stg_patients__dbt_tmp" as (
    with source as (
    select * from "dev"."main"."raw_patients"
),

-- Step 1: convert escaped string to valid JSON using DOUBLE unescape
converted as (
    select
        parse_json(replace(data, '""', '"')) as json_data
    from source
),

-- Step 2: extract fields from parsed JSON
parsed as (
    select
        json_data ->> 'patient_id' as patient_id,
        json_data ->> 'practice_id' as practice_id,
        json_data ->> 'age' as age,
        json_data ->> 'gender' as gender,
        json_data ->> 'registration_date' as registration_date,
        json_data -> 'conditions' as conditions,
        json_data -> 'contact' ->> 'email' as email,
        json_data -> 'contact' ->> 'phone' as phone
    from converted
)

select
    cast(patient_id as integer) as patient_id,
    cast(practice_id as integer) as practice_id,
    cast(age as integer) as age,
    gender,
    cast(registration_date as date) as registration_date,
    conditions,
    email,
    phone
from parsed
  );

[0m13:09:07.552139 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:09:07.552846 [debug] [Thread-1 (]: On model.suvera.stg_patients: ROLLBACK
[0m13:09:07.575517 [debug] [Thread-1 (]: Failed to rollback 'model.suvera.stg_patients'
[0m13:09:07.576165 [debug] [Thread-1 (]: On model.suvera.stg_patients: Close
[0m13:09:07.582171 [debug] [Thread-1 (]: Runtime Error in model stg_patients (models/staging/stg_patients.sql)
  Catalog Error: Scalar Function with name parse_json does not exist!
  Did you mean "parse_dirname"?
  
  LINE 12:         parse_json(replace(data, '""', '"')) as json_data
                   ^
[0m13:09:07.585246 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5cd4b3b-80e6-40e7-a359-be03717d46df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062e4f50>]}
[0m13:09:07.586381 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_patients ......................... [[31mERROR[0m in 0.10s]
[0m13:09:07.587369 [debug] [Thread-1 (]: Finished running node model.suvera.stg_patients
[0m13:09:07.588216 [debug] [Thread-4 (]: Marking all children of 'model.suvera.stg_patients' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_patients (models/staging/stg_patients.sql)
  Catalog Error: Scalar Function with name parse_json does not exist!
  Did you mean "parse_dirname"?
  
  LINE 12:         parse_json(replace(data, '""', '"')) as json_data
                   ^.
[0m13:09:07.590706 [debug] [MainThread]: Using duckdb connection "master"
[0m13:09:07.591210 [debug] [MainThread]: On master: BEGIN
[0m13:09:07.591663 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:09:07.592488 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:09:07.593212 [debug] [MainThread]: On master: COMMIT
[0m13:09:07.593757 [debug] [MainThread]: Using duckdb connection "master"
[0m13:09:07.594232 [debug] [MainThread]: On master: COMMIT
[0m13:09:07.595189 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:09:07.595777 [debug] [MainThread]: On master: Close
[0m13:09:07.596465 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:09:07.596937 [debug] [MainThread]: Connection 'model.suvera.stg_patients' was properly closed.
[0m13:09:07.597420 [info ] [MainThread]: 
[0m13:09:07.597960 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m13:09:07.599475 [debug] [MainThread]: Command end result
[0m13:09:07.633616 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:09:07.636257 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:09:07.646127 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m13:09:07.646773 [info ] [MainThread]: 
[0m13:09:07.647817 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:09:07.648367 [info ] [MainThread]: 
[0m13:09:07.649090 [error] [MainThread]: [31mFailure in model stg_patients (models/staging/stg_patients.sql)[0m
[0m13:09:07.649790 [error] [MainThread]:   Runtime Error in model stg_patients (models/staging/stg_patients.sql)
  Catalog Error: Scalar Function with name parse_json does not exist!
  Did you mean "parse_dirname"?
  
  LINE 12:         parse_json(replace(data, '""', '"')) as json_data
                   ^
[0m13:09:07.650274 [info ] [MainThread]: 
[0m13:09:07.650835 [info ] [MainThread]:   compiled code at target/compiled/suvera/models/staging/stg_patients.sql
[0m13:09:07.651312 [info ] [MainThread]: 
[0m13:09:07.651846 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m13:09:07.656625 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.4220216, "process_in_blocks": "0", "process_kernel_time": 0.788249, "process_mem_max_rss": "138133504", "process_out_blocks": "0", "process_user_time": 4.307531}
[0m13:09:07.657428 [debug] [MainThread]: Command `dbt run` failed at 13:09:07.657258 after 2.42 seconds
[0m13:09:07.658062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fb2a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102cc14f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f65270>]}
[0m13:09:07.659010 [debug] [MainThread]: Flushing usage events
[0m13:09:08.060781 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:14:44.677264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107379d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108353610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108353750>]}


============================== 13:14:44.688809 | c235fcf9-fe2a-4872-a69d-608381b58ce5 ==============================
[0m13:14:44.688809 [info ] [MainThread]: Running with dbt=1.10.1
[0m13:14:44.689923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select stg_patients', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:14:45.209685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c235fcf9-fe2a-4872-a69d-608381b58ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107801220>]}
[0m13:14:45.313376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c235fcf9-fe2a-4872-a69d-608381b58ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10823b130>]}
[0m13:14:45.337853 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:14:45.514382 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m13:14:45.789862 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:14:45.790862 [debug] [MainThread]: Partial parsing: updated file: suvera://models/staging/stg_patients.sql
[0m13:14:46.328334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c235fcf9-fe2a-4872-a69d-608381b58ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aeca50>]}
[0m13:14:46.458963 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:14:46.465186 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:14:46.517096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c235fcf9-fe2a-4872-a69d-608381b58ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108626a80>]}
[0m13:14:46.517890 [info ] [MainThread]: Found 4 models, 4 seeds, 9 data tests, 428 macros
[0m13:14:46.518452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c235fcf9-fe2a-4872-a69d-608381b58ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b0a190>]}
[0m13:14:46.521055 [info ] [MainThread]: 
[0m13:14:46.521622 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:14:46.522111 [info ] [MainThread]: 
[0m13:14:46.522881 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:14:46.524146 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:14:46.621982 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:14:46.622594 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:14:46.623082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:46.650283 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m13:14:46.652459 [debug] [ThreadPool]: On list_dev: Close
[0m13:14:46.653484 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m13:14:46.654197 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m13:14:46.663284 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:14:46.663828 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m13:14:46.664289 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:14:46.665585 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:14:46.667548 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:14:46.668019 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m13:14:46.668701 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:14:46.669159 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:14:46.669608 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m13:14:46.670362 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:14:46.671655 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:14:46.672142 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:14:46.672591 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:14:46.673266 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:14:46.673753 [debug] [ThreadPool]: On create_dev_main: Close
[0m13:14:46.681986 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m13:14:46.689604 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:14:46.690143 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:14:46.690587 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:14:46.691436 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:14:46.691901 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:14:46.692365 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m13:14:46.712562 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m13:14:46.714811 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:14:46.716925 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:14:46.717448 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:14:46.794995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c235fcf9-fe2a-4872-a69d-608381b58ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d3860>]}
[0m13:14:46.795729 [debug] [MainThread]: Using duckdb connection "master"
[0m13:14:46.796204 [debug] [MainThread]: On master: BEGIN
[0m13:14:46.796645 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:14:46.797454 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:14:46.797942 [debug] [MainThread]: On master: COMMIT
[0m13:14:46.798413 [debug] [MainThread]: Using duckdb connection "master"
[0m13:14:46.798863 [debug] [MainThread]: On master: COMMIT
[0m13:14:46.799538 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:14:46.800051 [debug] [MainThread]: On master: Close
[0m13:14:46.805058 [debug] [Thread-1 (]: Began running node model.suvera.stg_patients
[0m13:14:46.805948 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_patients .................................. [RUN]
[0m13:14:46.806716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.stg_patients)
[0m13:14:46.807301 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_patients
[0m13:14:46.818635 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_patients"
[0m13:14:46.819842 [debug] [Thread-1 (]: Began executing node model.suvera.stg_patients
[0m13:14:46.867854 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_patients"
[0m13:14:46.869023 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:14:46.869591 [debug] [Thread-1 (]: On model.suvera.stg_patients: BEGIN
[0m13:14:46.870117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:14:46.871042 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:14:46.871582 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:14:46.872157 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */

  
  create view "dev"."main"."stg_patients__dbt_tmp" as (
    with source as (
    select * from "dev"."main"."raw_patients"
),

parsed as (
    select
        cast(regexp_extract(data, '"patient_id": ([0-9]+)', 1) as integer) as patient_id,
        cast(regexp_extract(data, '"practice_id": ([0-9]+|null)', 1) as integer) as practice_id,
        cast(regexp_extract(data, '"age": ([0-9]+)', 1) as integer) as age,
        regexp_extract(data, '"gender": "?(\\w*)"?', 1) as gender,
        cast(regexp_extract(data, '"registration_date": "([^"]+)"', 1) as date) as registration_date,
        regexp_extract(data, '"email": "([^"]+)"', 1) as email,
        regexp_extract(data, '"phone": "([^"]+)"', 1) as phone
    from source
)

select * from parsed
  );

[0m13:14:46.875007 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:14:46.883840 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:14:46.884471 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients" rename to "stg_patients__dbt_backup"
[0m13:14:46.885479 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:14:46.889704 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:14:46.890273 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m13:14:46.891178 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:14:46.909115 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m13:14:46.909779 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:14:46.910316 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m13:14:46.912043 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:14:46.918979 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:14:46.919572 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
drop view if exists "dev"."main"."stg_patients__dbt_backup" cascade
[0m13:14:46.920904 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:14:46.924530 [debug] [Thread-1 (]: On model.suvera.stg_patients: Close
[0m13:14:46.928196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c235fcf9-fe2a-4872-a69d-608381b58ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f09310>]}
[0m13:14:46.929404 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_patients ............................. [[32mOK[0m in 0.12s]
[0m13:14:46.930380 [debug] [Thread-1 (]: Finished running node model.suvera.stg_patients
[0m13:14:46.932163 [debug] [MainThread]: Using duckdb connection "master"
[0m13:14:46.932658 [debug] [MainThread]: On master: BEGIN
[0m13:14:46.933105 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:14:46.933921 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:14:46.934394 [debug] [MainThread]: On master: COMMIT
[0m13:14:46.934861 [debug] [MainThread]: Using duckdb connection "master"
[0m13:14:46.935307 [debug] [MainThread]: On master: COMMIT
[0m13:14:46.935959 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:14:46.936626 [debug] [MainThread]: On master: Close
[0m13:14:46.937330 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:14:46.937814 [debug] [MainThread]: Connection 'model.suvera.stg_patients' was properly closed.
[0m13:14:46.938317 [info ] [MainThread]: 
[0m13:14:46.938878 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m13:14:46.939997 [debug] [MainThread]: Command end result
[0m13:14:46.975035 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:14:46.978532 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:14:46.988729 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m13:14:46.989280 [info ] [MainThread]: 
[0m13:14:46.989888 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:14:46.990732 [info ] [MainThread]: 
[0m13:14:46.991340 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:14:46.996287 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4524295, "process_in_blocks": "0", "process_kernel_time": 0.771302, "process_mem_max_rss": "138047488", "process_out_blocks": "0", "process_user_time": 4.358158}
[0m13:14:46.997174 [debug] [MainThread]: Command `dbt run` succeeded at 13:14:46.996996 after 2.45 seconds
[0m13:14:46.997751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108be1b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089ca170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089c98b0>]}
[0m13:14:46.998375 [debug] [MainThread]: Flushing usage events
[0m13:14:47.403271 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:27:56.556968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a491d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b46b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b46b750>]}


============================== 13:27:56.566768 | 51b4b740-f39c-4615-ac74-26af43ad8fb2 ==============================
[0m13:27:56.566768 [info ] [MainThread]: Running with dbt=1.10.1
[0m13:27:56.567824 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/puneeth/.dbt', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select stg_patients', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:27:56.959847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51b4b740-f39c-4615-ac74-26af43ad8fb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a945220>]}
[0m13:27:57.067774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51b4b740-f39c-4615-ac74-26af43ad8fb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b353130>]}
[0m13:27:57.090187 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:27:57.222793 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m13:27:57.445359 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:27:57.446064 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:27:57.517923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51b4b740-f39c-4615-ac74-26af43ad8fb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b893150>]}
[0m13:27:57.635275 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:27:57.642408 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:27:57.691507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51b4b740-f39c-4615-ac74-26af43ad8fb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b73ea80>]}
[0m13:27:57.692225 [info ] [MainThread]: Found 4 models, 4 seeds, 9 data tests, 428 macros
[0m13:27:57.692751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51b4b740-f39c-4615-ac74-26af43ad8fb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b638830>]}
[0m13:27:57.695240 [info ] [MainThread]: 
[0m13:27:57.695792 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:27:57.696215 [info ] [MainThread]: 
[0m13:27:57.696929 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:27:57.698335 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:27:57.784334 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:27:57.785676 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:27:57.786233 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:57.818207 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m13:27:57.820773 [debug] [ThreadPool]: On list_dev: Close
[0m13:27:57.821514 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m13:27:57.822003 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m13:27:57.828635 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:27:57.829107 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m13:27:57.829442 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:27:57.830545 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:27:57.832380 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:27:57.832832 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m13:27:57.834496 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:27:57.835705 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:27:57.836424 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m13:27:57.837534 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:27:57.838880 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:27:57.839275 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:27:57.839599 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:27:57.840194 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:27:57.840550 [debug] [ThreadPool]: On create_dev_main: Close
[0m13:27:57.846910 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m13:27:57.854424 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:27:57.854891 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:27:57.855210 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:27:57.855914 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:27:57.856243 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:27:57.856570 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m13:27:57.872251 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m13:27:57.874780 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:27:57.877209 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:27:57.877739 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:27:57.879644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51b4b740-f39c-4615-ac74-26af43ad8fb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bce2820>]}
[0m13:27:57.880219 [debug] [MainThread]: Using duckdb connection "master"
[0m13:27:57.880552 [debug] [MainThread]: On master: BEGIN
[0m13:27:57.880862 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:27:57.881625 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:27:57.882064 [debug] [MainThread]: On master: COMMIT
[0m13:27:57.882424 [debug] [MainThread]: Using duckdb connection "master"
[0m13:27:57.882857 [debug] [MainThread]: On master: COMMIT
[0m13:27:57.884047 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:27:57.884708 [debug] [MainThread]: On master: Close
[0m13:27:57.889473 [debug] [Thread-1 (]: Began running node model.suvera.stg_patients
[0m13:27:57.890261 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_patients .................................. [RUN]
[0m13:27:57.890890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.stg_patients)
[0m13:27:57.891350 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_patients
[0m13:27:57.901534 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_patients"
[0m13:27:57.904036 [debug] [Thread-1 (]: Began executing node model.suvera.stg_patients
[0m13:27:57.942732 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_patients"
[0m13:27:57.943720 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:27:57.944125 [debug] [Thread-1 (]: On model.suvera.stg_patients: BEGIN
[0m13:27:57.944503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:57.945525 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:27:57.946016 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:27:57.946411 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */

  
  create view "dev"."main"."stg_patients__dbt_tmp" as (
    with source as (
    select * from "dev"."main"."raw_patients"
),

parsed as (
    select
        cast(regexp_extract(data, '"patient_id": ([0-9]+)', 1) as integer) as patient_id,
        cast(regexp_extract(data, '"practice_id": ([0-9]+|null)', 1) as integer) as practice_id,
        cast(regexp_extract(data, '"age": ([0-9]+)', 1) as integer) as age,
        regexp_extract(data, '"gender": "?(\\w*)"?', 1) as gender,
        cast(regexp_extract(data, '"registration_date": "([^"]+)"', 1) as date) as registration_date,
        regexp_extract(data, '"email": "([^"]+)"', 1) as email,
        regexp_extract(data, '"phone": "([^"]+)"', 1) as phone
    from source
)

select * from parsed
  );

[0m13:27:57.947672 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:27:57.957640 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:27:57.958157 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients" rename to "stg_patients__dbt_backup"
[0m13:27:57.958963 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:27:57.962592 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:27:57.963051 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m13:27:57.963767 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:27:57.978479 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m13:27:57.979058 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:27:57.979440 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m13:27:57.980909 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:27:57.987932 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:27:57.988426 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
drop view if exists "dev"."main"."stg_patients__dbt_backup" cascade
[0m13:27:57.989640 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:27:57.992562 [debug] [Thread-1 (]: On model.suvera.stg_patients: Close
[0m13:27:57.995417 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51b4b740-f39c-4615-ac74-26af43ad8fb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10baa7dd0>]}
[0m13:27:57.996666 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_patients ............................. [[32mOK[0m in 0.10s]
[0m13:27:57.997577 [debug] [Thread-1 (]: Finished running node model.suvera.stg_patients
[0m13:27:57.999370 [debug] [MainThread]: Using duckdb connection "master"
[0m13:27:58.000239 [debug] [MainThread]: On master: BEGIN
[0m13:27:58.000851 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:27:58.002336 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:27:58.002917 [debug] [MainThread]: On master: COMMIT
[0m13:27:58.003394 [debug] [MainThread]: Using duckdb connection "master"
[0m13:27:58.003776 [debug] [MainThread]: On master: COMMIT
[0m13:27:58.004493 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:27:58.004926 [debug] [MainThread]: On master: Close
[0m13:27:58.005406 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:27:58.005722 [debug] [MainThread]: Connection 'model.suvera.stg_patients' was properly closed.
[0m13:27:58.006081 [info ] [MainThread]: 
[0m13:27:58.006503 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m13:27:58.007480 [debug] [MainThread]: Command end result
[0m13:27:58.032586 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:27:58.037723 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:27:58.045460 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m13:27:58.045856 [info ] [MainThread]: 
[0m13:27:58.046381 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:27:58.046980 [info ] [MainThread]: 
[0m13:27:58.047627 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:27:58.053490 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6037809, "process_in_blocks": "0", "process_kernel_time": 0.672708, "process_mem_max_rss": "135385088", "process_out_blocks": "0", "process_user_time": 3.243669}
[0m13:27:58.054172 [debug] [MainThread]: Command `dbt run` succeeded at 13:27:58.054040 after 1.60 seconds
[0m13:27:58.054634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb35a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bebfe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bebfbb0>]}
[0m13:27:58.055050 [debug] [MainThread]: Flushing usage events
[0m13:27:58.466807 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:29:43.444287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e11d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104beb610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104beb750>]}


============================== 13:29:43.454216 | aa5ac5ff-920f-4531-83c9-eabc08614732 ==============================
[0m13:29:43.454216 [info ] [MainThread]: Running with dbt=1.10.1
[0m13:29:43.455261 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/puneeth/.dbt', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_patients', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:29:43.810666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa5ac5ff-920f-4531-83c9-eabc08614732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040d1220>]}
[0m13:29:43.895394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa5ac5ff-920f-4531-83c9-eabc08614732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ad7130>]}
[0m13:29:43.922104 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:29:44.051068 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m13:29:44.270680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:29:44.271505 [debug] [MainThread]: Partial parsing: updated file: suvera://models/staging/stg_patients.sql
[0m13:29:44.662871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa5ac5ff-920f-4531-83c9-eabc08614732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105364a50>]}
[0m13:29:44.751485 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:29:44.756847 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:29:44.801999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa5ac5ff-920f-4531-83c9-eabc08614732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eb2a80>]}
[0m13:29:44.802635 [info ] [MainThread]: Found 4 models, 4 seeds, 9 data tests, 428 macros
[0m13:29:44.803080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa5ac5ff-920f-4531-83c9-eabc08614732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10539e190>]}
[0m13:29:44.805116 [info ] [MainThread]: 
[0m13:29:44.805586 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:29:44.805959 [info ] [MainThread]: 
[0m13:29:44.806591 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:29:44.807596 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:29:44.896452 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:29:44.897415 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:29:44.898217 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:29:44.930880 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m13:29:44.932714 [debug] [ThreadPool]: On list_dev: Close
[0m13:29:44.933587 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m13:29:44.934177 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m13:29:44.941192 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:29:44.941593 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m13:29:44.941918 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:29:44.942965 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:29:44.944353 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:29:44.944684 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m13:29:44.945239 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:29:44.945709 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:29:44.946033 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m13:29:44.947033 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:29:44.948345 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:29:44.948854 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:29:44.949180 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:29:44.949812 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:29:44.950164 [debug] [ThreadPool]: On create_dev_main: Close
[0m13:29:44.956156 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m13:29:44.961545 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:29:44.961920 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:29:44.962235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:29:44.962945 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:29:44.963278 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:29:44.963608 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m13:29:44.982320 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m13:29:44.984816 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:29:44.987305 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:29:44.988000 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:29:45.065371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa5ac5ff-920f-4531-83c9-eabc08614732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10515b860>]}
[0m13:29:45.066077 [debug] [MainThread]: Using duckdb connection "master"
[0m13:29:45.066536 [debug] [MainThread]: On master: BEGIN
[0m13:29:45.066963 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:29:45.067758 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:29:45.068228 [debug] [MainThread]: On master: COMMIT
[0m13:29:45.068686 [debug] [MainThread]: Using duckdb connection "master"
[0m13:29:45.069122 [debug] [MainThread]: On master: COMMIT
[0m13:29:45.069780 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:29:45.070278 [debug] [MainThread]: On master: Close
[0m13:29:45.074782 [debug] [Thread-1 (]: Began running node model.suvera.stg_patients
[0m13:29:45.075665 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_patients .................................. [RUN]
[0m13:29:45.076373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.stg_patients)
[0m13:29:45.076926 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_patients
[0m13:29:45.087689 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_patients"
[0m13:29:45.089363 [debug] [Thread-1 (]: Began executing node model.suvera.stg_patients
[0m13:29:45.130037 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_patients"
[0m13:29:45.131069 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:29:45.131533 [debug] [Thread-1 (]: On model.suvera.stg_patients: BEGIN
[0m13:29:45.131927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:45.132674 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:29:45.133139 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:29:45.133581 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */

  
  create view "dev"."main"."stg_patients__dbt_tmp" as (
    with source as (
    select * from "dev"."main"."raw_patients"
),

parsed as (
    select
        regexp_extract(data, '"patient_id": ([0-9]+)', 1) as patient_id,
        regexp_extract(data, '"practice_id": ([0-9]+|null)', 1) as practice_id,
        regexp_extract(data, '"age": ([0-9]+)', 1) as age,
        regexp_extract(data, '"gender": "?(\\w*)"?', 1) as gender,
        regexp_extract(data, '"registration_date": "([^"]+)"', 1) as registration_date,
        regexp_extract(data, '"email": "([^"]+)"', 1) as email,
        regexp_extract(data, '"phone": "([^"]+)"', 1) as phone,
        regexp_extract(data, '"conditions": \\[(.*?)\\]', 1) as conditions
    from source
)

select * from parsed
  );

[0m13:29:45.134823 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:29:45.141585 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:29:45.142107 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients" rename to "stg_patients__dbt_backup"
[0m13:29:45.142949 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:29:45.146565 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:29:45.148058 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m13:29:45.149318 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:29:45.162398 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m13:29:45.162917 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:29:45.163318 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m13:29:45.164753 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:29:45.170537 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:29:45.171085 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
drop view if exists "dev"."main"."stg_patients__dbt_backup" cascade
[0m13:29:45.172241 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:29:45.175285 [debug] [Thread-1 (]: On model.suvera.stg_patients: Close
[0m13:29:45.178311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa5ac5ff-920f-4531-83c9-eabc08614732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105779310>]}
[0m13:29:45.179217 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_patients ............................. [[32mOK[0m in 0.10s]
[0m13:29:45.180053 [debug] [Thread-1 (]: Finished running node model.suvera.stg_patients
[0m13:29:45.181487 [debug] [MainThread]: Using duckdb connection "master"
[0m13:29:45.181842 [debug] [MainThread]: On master: BEGIN
[0m13:29:45.182165 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:29:45.182824 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:29:45.183177 [debug] [MainThread]: On master: COMMIT
[0m13:29:45.183509 [debug] [MainThread]: Using duckdb connection "master"
[0m13:29:45.183827 [debug] [MainThread]: On master: COMMIT
[0m13:29:45.184436 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:29:45.184796 [debug] [MainThread]: On master: Close
[0m13:29:45.185252 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:29:45.185567 [debug] [MainThread]: Connection 'model.suvera.stg_patients' was properly closed.
[0m13:29:45.185915 [info ] [MainThread]: 
[0m13:29:45.186349 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m13:29:45.187541 [debug] [MainThread]: Command end result
[0m13:29:45.214931 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:29:45.217799 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:29:45.226132 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m13:29:45.226696 [info ] [MainThread]: 
[0m13:29:45.227176 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:29:45.227540 [info ] [MainThread]: 
[0m13:29:45.227930 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:29:45.231475 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.882502, "process_in_blocks": "0", "process_kernel_time": 0.644525, "process_mem_max_rss": "136683520", "process_out_blocks": "0", "process_user_time": 3.484279}
[0m13:29:45.232650 [debug] [MainThread]: Command `dbt run` succeeded at 13:29:45.232247 after 1.88 seconds
[0m13:29:45.233288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10545db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105242170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052418b0>]}
[0m13:29:45.233883 [debug] [MainThread]: Flushing usage events
[0m13:29:45.614508 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:33:23.713358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1d5d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efe7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efe7750>]}


============================== 13:33:23.724731 | a177aa0b-45d3-42d3-85a1-ddd75e7ddb58 ==============================
[0m13:33:23.724731 [info ] [MainThread]: Running with dbt=1.10.1
[0m13:33:23.725795 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_patients', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:33:24.136206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a177aa0b-45d3-42d3-85a1-ddd75e7ddb58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4b9220>]}
[0m13:33:24.210441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a177aa0b-45d3-42d3-85a1-ddd75e7ddb58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eecf130>]}
[0m13:33:24.245299 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:33:24.395000 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m13:33:24.614473 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:33:24.615248 [debug] [MainThread]: Partial parsing: updated file: suvera://models/staging/stg_patients.sql
[0m13:33:25.001963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a177aa0b-45d3-42d3-85a1-ddd75e7ddb58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f77ca50>]}
[0m13:33:25.096015 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:33:25.101542 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:33:25.147035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a177aa0b-45d3-42d3-85a1-ddd75e7ddb58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2baa80>]}
[0m13:33:25.147666 [info ] [MainThread]: Found 4 models, 4 seeds, 9 data tests, 428 macros
[0m13:33:25.148112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a177aa0b-45d3-42d3-85a1-ddd75e7ddb58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7e6190>]}
[0m13:33:25.150306 [info ] [MainThread]: 
[0m13:33:25.150996 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:33:25.151639 [info ] [MainThread]: 
[0m13:33:25.152620 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:33:25.153658 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:33:25.239364 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:33:25.239871 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:33:25.240232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:33:25.263290 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m13:33:25.265491 [debug] [ThreadPool]: On list_dev: Close
[0m13:33:25.266441 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m13:33:25.266985 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m13:33:25.273799 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:33:25.274226 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m13:33:25.274603 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:33:25.275699 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:33:25.277206 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:33:25.277539 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m13:33:25.278146 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:33:25.278458 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:33:25.278766 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m13:33:25.279398 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:33:25.280290 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:33:25.280623 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:33:25.280931 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:33:25.281505 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:33:25.281875 [debug] [ThreadPool]: On create_dev_main: Close
[0m13:33:25.288309 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m13:33:25.294959 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:33:25.295397 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:33:25.295709 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:33:25.296403 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:33:25.296732 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:33:25.297059 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m13:33:25.311202 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m13:33:25.312875 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:33:25.314666 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:33:25.315064 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:33:25.388135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a177aa0b-45d3-42d3-85a1-ddd75e7ddb58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f563860>]}
[0m13:33:25.388873 [debug] [MainThread]: Using duckdb connection "master"
[0m13:33:25.389330 [debug] [MainThread]: On master: BEGIN
[0m13:33:25.389757 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:33:25.390608 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:33:25.391053 [debug] [MainThread]: On master: COMMIT
[0m13:33:25.391483 [debug] [MainThread]: Using duckdb connection "master"
[0m13:33:25.391897 [debug] [MainThread]: On master: COMMIT
[0m13:33:25.392508 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:33:25.392953 [debug] [MainThread]: On master: Close
[0m13:33:25.396730 [debug] [Thread-1 (]: Began running node model.suvera.stg_patients
[0m13:33:25.397544 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_patients .................................. [RUN]
[0m13:33:25.398231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.stg_patients)
[0m13:33:25.398755 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_patients
[0m13:33:25.408861 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_patients"
[0m13:33:25.410296 [debug] [Thread-1 (]: Began executing node model.suvera.stg_patients
[0m13:33:25.448097 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_patients"
[0m13:33:25.449144 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:33:25.449563 [debug] [Thread-1 (]: On model.suvera.stg_patients: BEGIN
[0m13:33:25.449931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:25.450589 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:33:25.450972 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:33:25.451371 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */

  
  create view "dev"."main"."stg_patients__dbt_tmp" as (
    with source as (
    select * from "dev"."main"."raw_patients"
),

parsed as (
    select
        regexp_extract(data, '""patient_id"": ([0-9]+)', 1) as patient_id,
        regexp_extract(data, '""practice_id"": ([0-9]+|null)', 1) as practice_id,
        regexp_extract(data, '""age"": ([0-9]+)', 1) as age,
        regexp_extract(data, '""gender"": ""([^""]*)""', 1) as gender,
        regexp_extract(data, '""registration_date"": ""([^""]+)""', 1) as registration_date,
        regexp_extract(data, '""email"": ""([^""]+)""', 1) as email,
        regexp_extract(data, '""phone"": ""([^""]+)""', 1) as phone,
        regexp_extract(data, '""conditions"": \\[(.*?)\\]', 1) as conditions
    from source
)

select * from parsed
  );

[0m13:33:25.452513 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:33:25.458889 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:33:25.459373 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients" rename to "stg_patients__dbt_backup"
[0m13:33:25.460287 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:33:25.463445 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:33:25.463854 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m13:33:25.464512 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:33:25.477290 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m13:33:25.477754 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:33:25.478132 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m13:33:25.479437 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:33:25.484246 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:33:25.484641 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
drop view if exists "dev"."main"."stg_patients__dbt_backup" cascade
[0m13:33:25.485781 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:33:25.488363 [debug] [Thread-1 (]: On model.suvera.stg_patients: Close
[0m13:33:25.491344 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a177aa0b-45d3-42d3-85a1-ddd75e7ddb58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb8d310>]}
[0m13:33:25.492288 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_patients ............................. [[32mOK[0m in 0.09s]
[0m13:33:25.493163 [debug] [Thread-1 (]: Finished running node model.suvera.stg_patients
[0m13:33:25.494704 [debug] [MainThread]: Using duckdb connection "master"
[0m13:33:25.495055 [debug] [MainThread]: On master: BEGIN
[0m13:33:25.495361 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:33:25.496017 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:33:25.496344 [debug] [MainThread]: On master: COMMIT
[0m13:33:25.496663 [debug] [MainThread]: Using duckdb connection "master"
[0m13:33:25.496970 [debug] [MainThread]: On master: COMMIT
[0m13:33:25.497482 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:33:25.497813 [debug] [MainThread]: On master: Close
[0m13:33:25.498419 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:33:25.499003 [debug] [MainThread]: Connection 'model.suvera.stg_patients' was properly closed.
[0m13:33:25.499447 [info ] [MainThread]: 
[0m13:33:25.500003 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m13:33:25.501045 [debug] [MainThread]: Command end result
[0m13:33:25.529161 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:33:25.531292 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:33:25.539118 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m13:33:25.539710 [info ] [MainThread]: 
[0m13:33:25.540547 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:33:25.541170 [info ] [MainThread]: 
[0m13:33:25.541620 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:33:25.545219 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.94024, "process_in_blocks": "0", "process_kernel_time": 0.689931, "process_mem_max_rss": "138039296", "process_out_blocks": "0", "process_user_time": 3.466386}
[0m13:33:25.545851 [debug] [MainThread]: Command `dbt run` succeeded at 13:33:25.545715 after 1.94 seconds
[0m13:33:25.546458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f871b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f656170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6558b0>]}
[0m13:33:25.546919 [debug] [MainThread]: Flushing usage events
[0m13:33:25.943463 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:35:02.850065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e295d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f26f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f26f750>]}


============================== 13:35:02.859610 | 709fd5af-038c-4334-8b4d-7ae8ec3e29f7 ==============================
[0m13:35:02.859610 [info ] [MainThread]: Running with dbt=1.10.1
[0m13:35:02.861017 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_patients', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:35:03.245041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '709fd5af-038c-4334-8b4d-7ae8ec3e29f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e71d220>]}
[0m13:35:03.326329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '709fd5af-038c-4334-8b4d-7ae8ec3e29f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f157130>]}
[0m13:35:03.351086 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:35:03.480842 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m13:35:03.708794 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:35:03.709296 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:35:03.766927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '709fd5af-038c-4334-8b4d-7ae8ec3e29f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f69f150>]}
[0m13:35:03.863268 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:35:03.866942 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:35:03.911587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '709fd5af-038c-4334-8b4d-7ae8ec3e29f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f542a80>]}
[0m13:35:03.912162 [info ] [MainThread]: Found 4 models, 4 seeds, 9 data tests, 428 macros
[0m13:35:03.912583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '709fd5af-038c-4334-8b4d-7ae8ec3e29f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f43c830>]}
[0m13:35:03.914506 [info ] [MainThread]: 
[0m13:35:03.914935 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:35:03.915288 [info ] [MainThread]: 
[0m13:35:03.915895 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:35:03.916914 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:35:04.001915 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:35:04.002373 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:35:04.002726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:35:04.023215 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m13:35:04.024749 [debug] [ThreadPool]: On list_dev: Close
[0m13:35:04.025472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m13:35:04.025970 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m13:35:04.032810 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:35:04.033243 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m13:35:04.033572 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:35:04.034589 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:35:04.036034 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:35:04.036367 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m13:35:04.036905 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:35:04.037231 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:35:04.037548 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m13:35:04.038113 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:35:04.039294 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:35:04.039665 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:35:04.039983 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:35:04.040569 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:35:04.040929 [debug] [ThreadPool]: On create_dev_main: Close
[0m13:35:04.047103 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m13:35:04.052674 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:35:04.053047 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:35:04.053359 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:35:04.054234 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:35:04.054757 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:35:04.055543 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m13:35:04.070923 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m13:35:04.073899 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:35:04.076578 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:35:04.077183 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:35:04.079398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '709fd5af-038c-4334-8b4d-7ae8ec3e29f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10faea820>]}
[0m13:35:04.080043 [debug] [MainThread]: Using duckdb connection "master"
[0m13:35:04.080431 [debug] [MainThread]: On master: BEGIN
[0m13:35:04.080791 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:35:04.081508 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:35:04.081913 [debug] [MainThread]: On master: COMMIT
[0m13:35:04.082294 [debug] [MainThread]: Using duckdb connection "master"
[0m13:35:04.082654 [debug] [MainThread]: On master: COMMIT
[0m13:35:04.083196 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:35:04.083586 [debug] [MainThread]: On master: Close
[0m13:35:04.088330 [debug] [Thread-1 (]: Began running node model.suvera.stg_patients
[0m13:35:04.089268 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_patients .................................. [RUN]
[0m13:35:04.089895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.stg_patients)
[0m13:35:04.090363 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_patients
[0m13:35:04.099192 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_patients"
[0m13:35:04.100094 [debug] [Thread-1 (]: Began executing node model.suvera.stg_patients
[0m13:35:04.139157 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_patients"
[0m13:35:04.140087 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:35:04.140505 [debug] [Thread-1 (]: On model.suvera.stg_patients: BEGIN
[0m13:35:04.140874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:35:04.141581 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:04.141961 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:35:04.142365 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */

  
  create view "dev"."main"."stg_patients__dbt_tmp" as (
    with source as (
    select * from "dev"."main"."raw_patients"
),

parsed as (
    select
        regexp_extract(data, '""patient_id"": ([0-9]+)', 1) as patient_id,
        regexp_extract(data, '""practice_id"": ([0-9]+|null)', 1) as practice_id,
        regexp_extract(data, '""age"": ([0-9]+)', 1) as age,
        regexp_extract(data, '""gender"": ""([^""]*)""', 1) as gender,
        regexp_extract(data, '""registration_date"": ""([^""]+)""', 1) as registration_date,
        regexp_extract(data, '""email"": ""([^""]+)""', 1) as email,
        regexp_extract(data, '""phone"": ""([^""]+)""', 1) as phone,
        regexp_extract(data, '""conditions"": \\[(.*?)\\]', 1) as conditions
    from source
)

select * from parsed
  );

[0m13:35:04.143702 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:04.150236 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:35:04.150907 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients" rename to "stg_patients__dbt_backup"
[0m13:35:04.151673 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:35:04.155181 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:35:04.155698 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m13:35:04.156495 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:35:04.170163 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m13:35:04.170651 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:35:04.171025 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m13:35:04.172584 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:04.177839 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:35:04.178337 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
drop view if exists "dev"."main"."stg_patients__dbt_backup" cascade
[0m13:35:04.179384 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:04.181954 [debug] [Thread-1 (]: On model.suvera.stg_patients: Close
[0m13:35:04.184676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '709fd5af-038c-4334-8b4d-7ae8ec3e29f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8abdd0>]}
[0m13:35:04.185629 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_patients ............................. [[32mOK[0m in 0.09s]
[0m13:35:04.186498 [debug] [Thread-1 (]: Finished running node model.suvera.stg_patients
[0m13:35:04.188107 [debug] [MainThread]: Using duckdb connection "master"
[0m13:35:04.188474 [debug] [MainThread]: On master: BEGIN
[0m13:35:04.188793 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:35:04.189443 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:35:04.189796 [debug] [MainThread]: On master: COMMIT
[0m13:35:04.190130 [debug] [MainThread]: Using duckdb connection "master"
[0m13:35:04.190453 [debug] [MainThread]: On master: COMMIT
[0m13:35:04.190962 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:35:04.191307 [debug] [MainThread]: On master: Close
[0m13:35:04.191736 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:35:04.192047 [debug] [MainThread]: Connection 'model.suvera.stg_patients' was properly closed.
[0m13:35:04.192384 [info ] [MainThread]: 
[0m13:35:04.192754 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m13:35:04.194121 [debug] [MainThread]: Command end result
[0m13:35:04.222159 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:35:04.224935 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:35:04.232298 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m13:35:04.232709 [info ] [MainThread]: 
[0m13:35:04.233249 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:35:04.233645 [info ] [MainThread]: 
[0m13:35:04.234075 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:35:04.237815 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5005003, "process_in_blocks": "0", "process_kernel_time": 0.690012, "process_mem_max_rss": "135413760", "process_out_blocks": "0", "process_user_time": 3.186535}
[0m13:35:04.238564 [debug] [MainThread]: Command `dbt run` succeeded at 13:35:04.238417 after 1.50 seconds
[0m13:35:04.239144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f939a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fcc3e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fcc3bb0>]}
[0m13:35:04.239730 [debug] [MainThread]: Flushing usage events
[0m13:35:04.664270 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:36:33.533893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7c1d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5d3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5d3750>]}


============================== 13:36:33.542522 | 2c56b03f-cbe1-44b0-8da5-4f16b760ae48 ==============================
[0m13:36:33.542522 [info ] [MainThread]: Running with dbt=1.10.1
[0m13:36:33.543510 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_patients', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:36:33.856352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c56b03f-cbe1-44b0-8da5-4f16b760ae48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10baad220>]}
[0m13:36:33.927403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c56b03f-cbe1-44b0-8da5-4f16b760ae48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4bb130>]}
[0m13:36:33.958480 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:36:34.096418 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m13:36:34.328607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:36:34.329147 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:36:34.384586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c56b03f-cbe1-44b0-8da5-4f16b760ae48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9fb150>]}
[0m13:36:34.474136 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:36:34.478473 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:36:34.518569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c56b03f-cbe1-44b0-8da5-4f16b760ae48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8a6a80>]}
[0m13:36:34.519132 [info ] [MainThread]: Found 4 models, 4 seeds, 9 data tests, 428 macros
[0m13:36:34.519551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c56b03f-cbe1-44b0-8da5-4f16b760ae48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7a0830>]}
[0m13:36:34.521484 [info ] [MainThread]: 
[0m13:36:34.521909 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:36:34.522254 [info ] [MainThread]: 
[0m13:36:34.522847 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:36:34.523733 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:36:34.602159 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:36:34.602677 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:36:34.603088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:36:34.614248 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:36:34.614711 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m13:36:34.615715 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:36:34.616026 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m13:36:34.616339 [info ] [MainThread]: 
[0m13:36:34.616736 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m13:36:34.617541 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/puneeth/Documents/suvera_dbt_project/suvera/dev.duckdb": Conflicting lock is held in /usr/local/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 18812) by user puneeth. See also https://duckdb.org/docs/stable/connect/concurrency
[0m13:36:34.621320 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1838064, "process_in_blocks": "0", "process_kernel_time": 0.602, "process_mem_max_rss": "125882368", "process_out_blocks": "0", "process_user_time": 2.833823}
[0m13:36:34.621958 [debug] [MainThread]: Command `dbt run` failed at 13:36:34.621831 after 1.18 seconds
[0m13:36:34.622557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce46000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c479a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc0b110>]}
[0m13:36:34.623322 [debug] [MainThread]: Flushing usage events
[0m13:36:35.009837 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:36:43.508179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10789dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086af610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086af750>]}


============================== 13:36:43.513436 | a863becd-d4c6-4837-8d17-2e8e43acb3b8 ==============================
[0m13:36:43.513436 [info ] [MainThread]: Running with dbt=1.10.1
[0m13:36:43.514246 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_patients', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:36:43.808374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a863becd-d4c6-4837-8d17-2e8e43acb3b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b89220>]}
[0m13:36:43.891579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a863becd-d4c6-4837-8d17-2e8e43acb3b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10859b130>]}
[0m13:36:43.902777 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:36:44.020632 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m13:36:44.160292 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:36:44.160746 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:36:44.215938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a863becd-d4c6-4837-8d17-2e8e43acb3b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad7150>]}
[0m13:36:44.308940 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:36:44.311549 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:36:44.332745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a863becd-d4c6-4837-8d17-2e8e43acb3b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108982a80>]}
[0m13:36:44.333273 [info ] [MainThread]: Found 4 models, 4 seeds, 9 data tests, 428 macros
[0m13:36:44.333730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a863becd-d4c6-4837-8d17-2e8e43acb3b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10887c830>]}
[0m13:36:44.335800 [info ] [MainThread]: 
[0m13:36:44.336271 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:36:44.336696 [info ] [MainThread]: 
[0m13:36:44.337301 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:36:44.338196 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:36:44.394342 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:36:44.394788 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:36:44.395136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:36:44.405552 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:36:44.406026 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m13:36:44.406903 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:36:44.407223 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m13:36:44.407549 [info ] [MainThread]: 
[0m13:36:44.407961 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m13:36:44.408578 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/puneeth/Documents/suvera_dbt_project/suvera/dev.duckdb": Conflicting lock is held in /usr/local/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 18812) by user puneeth. See also https://duckdb.org/docs/stable/connect/concurrency
[0m13:36:44.411624 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.98457634, "process_in_blocks": "0", "process_kernel_time": 0.318059, "process_mem_max_rss": "125898752", "process_out_blocks": "0", "process_user_time": 2.343302}
[0m13:36:44.412192 [debug] [MainThread]: Command `dbt run` failed at 13:36:44.412065 after 0.99 seconds
[0m13:36:44.412636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f22000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108555a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ce7110>]}
[0m13:36:44.413036 [debug] [MainThread]: Flushing usage events
[0m13:36:44.772049 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:36:52.543696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe21d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c33610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c33750>]}


============================== 13:36:52.549145 | bc8efbf6-f857-4c11-a535-6d5899953ac8 ==============================
[0m13:36:52.549145 [info ] [MainThread]: Running with dbt=1.10.1
[0m13:36:52.550010 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_patients', 'send_anonymous_usage_stats': 'True'}
[0m13:36:52.834484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc8efbf6-f857-4c11-a535-6d5899953ac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110101220>]}
[0m13:36:52.905186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc8efbf6-f857-4c11-a535-6d5899953ac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b1b130>]}
[0m13:36:52.915177 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:36:53.023243 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m13:36:53.159357 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:36:53.159794 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:36:53.214480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc8efbf6-f857-4c11-a535-6d5899953ac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111057150>]}
[0m13:36:53.303096 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:36:53.305510 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:36:53.325163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc8efbf6-f857-4c11-a535-6d5899953ac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f06a80>]}
[0m13:36:53.325690 [info ] [MainThread]: Found 4 models, 4 seeds, 9 data tests, 428 macros
[0m13:36:53.326106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc8efbf6-f857-4c11-a535-6d5899953ac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e00830>]}
[0m13:36:53.327985 [info ] [MainThread]: 
[0m13:36:53.328510 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:36:53.328939 [info ] [MainThread]: 
[0m13:36:53.329797 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:36:53.330677 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:36:53.386970 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:36:53.387411 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:36:53.387747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:36:53.398082 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:36:53.398560 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m13:36:53.399423 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:36:53.399748 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m13:36:53.400077 [info ] [MainThread]: 
[0m13:36:53.400447 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m13:36:53.401095 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/puneeth/Documents/suvera_dbt_project/suvera/dev.duckdb": Conflicting lock is held in /usr/local/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 18812) by user puneeth. See also https://duckdb.org/docs/stable/connect/concurrency
[0m13:36:53.404113 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.94053024, "process_in_blocks": "0", "process_kernel_time": 0.293963, "process_mem_max_rss": "125579264", "process_out_blocks": "0", "process_user_time": 2.285907}
[0m13:36:53.404670 [debug] [MainThread]: Command `dbt run` failed at 13:36:53.404544 after 0.94 seconds
[0m13:36:53.405088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114a6000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ad9a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11126b110>]}
[0m13:36:53.405484 [debug] [MainThread]: Flushing usage events
[0m13:36:53.767449 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:37:05.274521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c909d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6e3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6e3750>]}


============================== 13:37:05.279692 | 489c4e52-fa67-4fdd-bca7-6a673dd1f498 ==============================
[0m13:37:05.279692 [info ] [MainThread]: Running with dbt=1.10.1
[0m13:37:05.280487 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_patients', 'send_anonymous_usage_stats': 'True'}
[0m13:37:05.573423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '489c4e52-fa67-4fdd-bca7-6a673dd1f498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbbd220>]}
[0m13:37:05.643474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '489c4e52-fa67-4fdd-bca7-6a673dd1f498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5cf130>]}
[0m13:37:05.653525 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:37:05.761643 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m13:37:05.902580 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:37:05.903013 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:37:05.957802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '489c4e52-fa67-4fdd-bca7-6a673dd1f498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dafb150>]}
[0m13:37:06.043899 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:37:06.046384 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:37:06.066258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '489c4e52-fa67-4fdd-bca7-6a673dd1f498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9aaa80>]}
[0m13:37:06.066779 [info ] [MainThread]: Found 4 models, 4 seeds, 9 data tests, 428 macros
[0m13:37:06.067197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '489c4e52-fa67-4fdd-bca7-6a673dd1f498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8a8830>]}
[0m13:37:06.069106 [info ] [MainThread]: 
[0m13:37:06.069616 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:37:06.070059 [info ] [MainThread]: 
[0m13:37:06.070793 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:37:06.071661 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:37:06.134964 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:37:06.135416 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:37:06.135757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:37:06.155395 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m13:37:06.157082 [debug] [ThreadPool]: On list_dev: Close
[0m13:37:06.157785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m13:37:06.158278 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m13:37:06.164532 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:37:06.164874 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m13:37:06.165183 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:37:06.166280 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:37:06.167636 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:37:06.167963 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m13:37:06.168480 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:37:06.168793 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:37:06.169099 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m13:37:06.169771 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:37:06.170694 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:37:06.171031 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:37:06.171339 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:37:06.171907 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:37:06.172267 [debug] [ThreadPool]: On create_dev_main: Close
[0m13:37:06.177991 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m13:37:06.183361 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:37:06.183719 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:37:06.184022 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:37:06.184753 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:37:06.185087 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:37:06.185410 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m13:37:06.199696 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m13:37:06.201982 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:37:06.204529 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:37:06.205073 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:37:06.207419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '489c4e52-fa67-4fdd-bca7-6a673dd1f498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df36820>]}
[0m13:37:06.208099 [debug] [MainThread]: Using duckdb connection "master"
[0m13:37:06.208514 [debug] [MainThread]: On master: BEGIN
[0m13:37:06.208922 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:37:06.209777 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:37:06.210151 [debug] [MainThread]: On master: COMMIT
[0m13:37:06.210488 [debug] [MainThread]: Using duckdb connection "master"
[0m13:37:06.210795 [debug] [MainThread]: On master: COMMIT
[0m13:37:06.211328 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:37:06.211673 [debug] [MainThread]: On master: Close
[0m13:37:06.215713 [debug] [Thread-1 (]: Began running node model.suvera.stg_patients
[0m13:37:06.216521 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_patients .................................. [RUN]
[0m13:37:06.217137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.stg_patients)
[0m13:37:06.217601 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_patients
[0m13:37:06.226140 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_patients"
[0m13:37:06.227018 [debug] [Thread-1 (]: Began executing node model.suvera.stg_patients
[0m13:37:06.263399 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_patients"
[0m13:37:06.264329 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:37:06.264736 [debug] [Thread-1 (]: On model.suvera.stg_patients: BEGIN
[0m13:37:06.265108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:37:06.265804 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:37:06.266194 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:37:06.266599 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */

  
  create view "dev"."main"."stg_patients__dbt_tmp" as (
    with source as (
    select * from "dev"."main"."raw_patients"
),

parsed as (
    select
        regexp_extract(data, '""patient_id"": ([0-9]+)', 1) as patient_id,
        regexp_extract(data, '""practice_id"": ([0-9]+|null)', 1) as practice_id,
        regexp_extract(data, '""age"": ([0-9]+)', 1) as age,
        regexp_extract(data, '""gender"": ""([^""]*)""', 1) as gender,
        regexp_extract(data, '""registration_date"": ""([^""]+)""', 1) as registration_date,
        regexp_extract(data, '""email"": ""([^""]+)""', 1) as email,
        regexp_extract(data, '""phone"": ""([^""]+)""', 1) as phone,
        regexp_extract(data, '""conditions"": \\[(.*?)\\]', 1) as conditions
    from source
)

select * from parsed
  );

[0m13:37:06.267730 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:37:06.273953 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:37:06.274398 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients" rename to "stg_patients__dbt_backup"
[0m13:37:06.275374 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:37:06.278671 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:37:06.279091 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m13:37:06.279839 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:37:06.292497 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m13:37:06.292948 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:37:06.293319 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m13:37:06.294829 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:37:06.299639 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:37:06.300042 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
drop view if exists "dev"."main"."stg_patients__dbt_backup" cascade
[0m13:37:06.301160 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:37:06.303643 [debug] [Thread-1 (]: On model.suvera.stg_patients: Close
[0m13:37:06.305742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '489c4e52-fa67-4fdd-bca7-6a673dd1f498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcdfdd0>]}
[0m13:37:06.306510 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_patients ............................. [[32mOK[0m in 0.09s]
[0m13:37:06.307461 [debug] [Thread-1 (]: Finished running node model.suvera.stg_patients
[0m13:37:06.308854 [debug] [MainThread]: Using duckdb connection "master"
[0m13:37:06.309197 [debug] [MainThread]: On master: BEGIN
[0m13:37:06.309503 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:37:06.310190 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:37:06.310532 [debug] [MainThread]: On master: COMMIT
[0m13:37:06.310855 [debug] [MainThread]: Using duckdb connection "master"
[0m13:37:06.311161 [debug] [MainThread]: On master: COMMIT
[0m13:37:06.311667 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:37:06.311998 [debug] [MainThread]: On master: Close
[0m13:37:06.312405 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:37:06.312866 [debug] [MainThread]: Connection 'model.suvera.stg_patients' was properly closed.
[0m13:37:06.313451 [info ] [MainThread]: 
[0m13:37:06.313961 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m13:37:06.315055 [debug] [MainThread]: Command end result
[0m13:37:06.341915 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:37:06.343880 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:37:06.351042 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m13:37:06.351433 [info ] [MainThread]: 
[0m13:37:06.351952 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:37:06.352500 [info ] [MainThread]: 
[0m13:37:06.352964 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:37:06.356163 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1675783, "process_in_blocks": "0", "process_kernel_time": 0.339751, "process_mem_max_rss": "135012352", "process_out_blocks": "0", "process_user_time": 2.532896}
[0m13:37:06.356749 [debug] [MainThread]: Command `dbt run` succeeded at 13:37:06.356623 after 1.17 seconds
[0m13:37:06.357190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd91a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e10be30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e10bbb0>]}
[0m13:37:06.357595 [debug] [MainThread]: Flushing usage events
[0m13:37:06.714873 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:38:03.407891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ed9d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ceb610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ceb750>]}


============================== 13:38:03.415779 | b8852b94-d243-4980-bcc7-17f54d040bdd ==============================
[0m13:38:03.415779 [info ] [MainThread]: Running with dbt=1.10.1
[0m13:38:03.416885 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_patients', 'send_anonymous_usage_stats': 'True'}
[0m13:38:03.735668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8852b94-d243-4980-bcc7-17f54d040bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131b9220>]}
[0m13:38:03.808338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8852b94-d243-4980-bcc7-17f54d040bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bd3130>]}
[0m13:38:03.832291 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:38:03.964136 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m13:38:04.164106 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:38:04.164690 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:38:04.289272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8852b94-d243-4980-bcc7-17f54d040bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114113150>]}
[0m13:38:04.382340 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:38:04.387537 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:38:04.433574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8852b94-d243-4980-bcc7-17f54d040bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fbea80>]}
[0m13:38:04.434321 [info ] [MainThread]: Found 4 models, 4 seeds, 9 data tests, 428 macros
[0m13:38:04.434800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8852b94-d243-4980-bcc7-17f54d040bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113eb8830>]}
[0m13:38:04.437053 [info ] [MainThread]: 
[0m13:38:04.437514 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:38:04.437891 [info ] [MainThread]: 
[0m13:38:04.438597 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:38:04.439860 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:38:04.518790 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:38:04.519358 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:38:04.519770 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:04.546732 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m13:38:04.548579 [debug] [ThreadPool]: On list_dev: Close
[0m13:38:04.549444 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m13:38:04.550034 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m13:38:04.557120 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:38:04.557504 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m13:38:04.557822 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:04.558939 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:38:04.560346 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:38:04.560669 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m13:38:04.561205 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:38:04.561518 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:38:04.561825 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m13:38:04.562402 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:38:04.563293 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:38:04.563625 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:38:04.563930 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:38:04.564432 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:38:04.564767 [debug] [ThreadPool]: On create_dev_main: Close
[0m13:38:04.570766 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m13:38:04.576251 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:38:04.576709 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:38:04.577485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:04.578453 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:38:04.579085 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:38:04.579508 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m13:38:04.593302 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m13:38:04.595622 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:38:04.598418 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:38:04.599013 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:38:04.601260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8852b94-d243-4980-bcc7-17f54d040bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11455ed00>]}
[0m13:38:04.601894 [debug] [MainThread]: Using duckdb connection "master"
[0m13:38:04.602318 [debug] [MainThread]: On master: BEGIN
[0m13:38:04.602678 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:38:04.603393 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:38:04.603780 [debug] [MainThread]: On master: COMMIT
[0m13:38:04.604156 [debug] [MainThread]: Using duckdb connection "master"
[0m13:38:04.604514 [debug] [MainThread]: On master: COMMIT
[0m13:38:04.605048 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:38:04.605440 [debug] [MainThread]: On master: Close
[0m13:38:04.609413 [debug] [Thread-1 (]: Began running node model.suvera.stg_patients
[0m13:38:04.610179 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_patients .................................. [RUN]
[0m13:38:04.610772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.stg_patients)
[0m13:38:04.611233 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_patients
[0m13:38:04.620298 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_patients"
[0m13:38:04.621564 [debug] [Thread-1 (]: Began executing node model.suvera.stg_patients
[0m13:38:04.656821 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_patients"
[0m13:38:04.657721 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:38:04.658129 [debug] [Thread-1 (]: On model.suvera.stg_patients: BEGIN
[0m13:38:04.658496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:04.659196 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:38:04.659574 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:38:04.659974 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */

  
  create view "dev"."main"."stg_patients__dbt_tmp" as (
    with source as (
    select * from "dev"."main"."raw_patients"
),

parsed as (
    select
        regexp_extract(data, '""patient_id"": ([0-9]+)', 1) as patient_id,
        regexp_extract(data, '""practice_id"": ([0-9]+|null)', 1) as practice_id,
        regexp_extract(data, '""age"": ([0-9]+)', 1) as age,
        regexp_extract(data, '""gender"": ""([^""]*)""', 1) as gender,
        regexp_extract(data, '""registration_date"": ""([^""]+)""', 1) as registration_date,
        regexp_extract(data, '""email"": ""([^""]+)""', 1) as email,
        regexp_extract(data, '""phone"": ""([^""]+)""', 1) as phone,
        regexp_extract(data, '""conditions"": \\[(.*?)\\]', 1) as conditions
    from source
)

select * from parsed
  );

[0m13:38:04.661083 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:38:04.667488 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:38:04.668149 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients" rename to "stg_patients__dbt_backup"
[0m13:38:04.669097 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:38:04.672323 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:38:04.673009 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m13:38:04.673876 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:38:04.688388 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m13:38:04.688900 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:38:04.689383 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m13:38:04.690792 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:38:04.695856 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:38:04.696277 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
drop view if exists "dev"."main"."stg_patients__dbt_backup" cascade
[0m13:38:04.697382 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:38:04.699961 [debug] [Thread-1 (]: On model.suvera.stg_patients: Close
[0m13:38:04.702281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8852b94-d243-4980-bcc7-17f54d040bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114323dd0>]}
[0m13:38:04.703057 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_patients ............................. [[32mOK[0m in 0.09s]
[0m13:38:04.703822 [debug] [Thread-1 (]: Finished running node model.suvera.stg_patients
[0m13:38:04.705166 [debug] [MainThread]: Using duckdb connection "master"
[0m13:38:04.705514 [debug] [MainThread]: On master: BEGIN
[0m13:38:04.705833 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:38:04.706731 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:38:04.707153 [debug] [MainThread]: On master: COMMIT
[0m13:38:04.707540 [debug] [MainThread]: Using duckdb connection "master"
[0m13:38:04.707903 [debug] [MainThread]: On master: COMMIT
[0m13:38:04.708443 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:38:04.708836 [debug] [MainThread]: On master: Close
[0m13:38:04.709316 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:38:04.709626 [debug] [MainThread]: Connection 'model.suvera.stg_patients' was properly closed.
[0m13:38:04.709967 [info ] [MainThread]: 
[0m13:38:04.710614 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m13:38:04.711558 [debug] [MainThread]: Command end result
[0m13:38:04.739199 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:38:04.742158 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:38:04.748510 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m13:38:04.749036 [info ] [MainThread]: 
[0m13:38:04.749500 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:38:04.749976 [info ] [MainThread]: 
[0m13:38:04.750544 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:38:04.755285 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4375211, "process_in_blocks": "0", "process_kernel_time": 0.616072, "process_mem_max_rss": "135065600", "process_out_blocks": "0", "process_user_time": 3.100237}
[0m13:38:04.756023 [debug] [MainThread]: Command `dbt run` succeeded at 13:38:04.755870 after 1.44 seconds
[0m13:38:04.756526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143b5a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11473be30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11473bbb0>]}
[0m13:38:04.756988 [debug] [MainThread]: Flushing usage events
[0m13:38:05.159710 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:38:09.752099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a49d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10785b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10785b750>]}


============================== 13:38:09.757416 | fe3b607a-9c29-439d-8389-9ba06c808cfc ==============================
[0m13:38:09.757416 [info ] [MainThread]: Running with dbt=1.10.1
[0m13:38:09.758231 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_patients', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:38:10.041850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe3b607a-9c29-439d-8389-9ba06c808cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d29220>]}
[0m13:38:10.113651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe3b607a-9c29-439d-8389-9ba06c808cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107743130>]}
[0m13:38:10.123475 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:38:10.231069 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m13:38:10.369126 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:38:10.369894 [debug] [MainThread]: Partial parsing: updated file: suvera://models/staging/stg_patients.sql
[0m13:38:10.754035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe3b607a-9c29-439d-8389-9ba06c808cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ff0a50>]}
[0m13:38:10.849543 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:38:10.851991 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:38:10.868280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe3b607a-9c29-439d-8389-9ba06c808cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b2ea80>]}
[0m13:38:10.868824 [info ] [MainThread]: Found 4 models, 4 seeds, 9 data tests, 428 macros
[0m13:38:10.869257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe3b607a-9c29-439d-8389-9ba06c808cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10805a190>]}
[0m13:38:10.871804 [info ] [MainThread]: 
[0m13:38:10.872389 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:38:10.872845 [info ] [MainThread]: 
[0m13:38:10.873580 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:38:10.874560 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:38:10.932294 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:38:10.932981 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:38:10.933330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:10.950227 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m13:38:10.951764 [debug] [ThreadPool]: On list_dev: Close
[0m13:38:10.952526 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m13:38:10.953017 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m13:38:10.959519 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:38:10.959898 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m13:38:10.960219 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:10.961344 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:38:10.962727 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:38:10.963053 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m13:38:10.963604 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:38:10.963918 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:38:10.964230 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m13:38:10.964862 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:38:10.965754 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:38:10.966087 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:38:10.966398 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:38:10.966948 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:38:10.967279 [debug] [ThreadPool]: On create_dev_main: Close
[0m13:38:10.973148 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m13:38:10.978594 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:38:10.978964 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:38:10.979268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:10.979984 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:38:10.980304 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:38:10.980627 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m13:38:10.995159 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m13:38:10.996790 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:38:10.997926 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:38:10.998261 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:38:11.068247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe3b607a-9c29-439d-8389-9ba06c808cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc7860>]}
[0m13:38:11.068945 [debug] [MainThread]: Using duckdb connection "master"
[0m13:38:11.069405 [debug] [MainThread]: On master: BEGIN
[0m13:38:11.069833 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:38:11.070626 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:38:11.071089 [debug] [MainThread]: On master: COMMIT
[0m13:38:11.071538 [debug] [MainThread]: Using duckdb connection "master"
[0m13:38:11.071971 [debug] [MainThread]: On master: COMMIT
[0m13:38:11.072644 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:38:11.073115 [debug] [MainThread]: On master: Close
[0m13:38:11.075656 [debug] [Thread-1 (]: Began running node model.suvera.stg_patients
[0m13:38:11.076402 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_patients .................................. [RUN]
[0m13:38:11.077062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.stg_patients)
[0m13:38:11.077588 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_patients
[0m13:38:11.088052 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_patients"
[0m13:38:11.089397 [debug] [Thread-1 (]: Began executing node model.suvera.stg_patients
[0m13:38:11.128267 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_patients"
[0m13:38:11.129181 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:38:11.129586 [debug] [Thread-1 (]: On model.suvera.stg_patients: BEGIN
[0m13:38:11.129962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:11.130672 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:38:11.131059 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:38:11.131471 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */

  
  create view "dev"."main"."stg_patients__dbt_tmp" as (
    with source as (
    select * from "dev"."main"."raw_patients"
),

parsed as (
    select
        regexp_extract(data, '"patient_id": ([0-9]+)', 1) as patient_id,
        regexp_extract(data, '"practice_id": ([0-9]+|null)', 1) as practice_id,
        regexp_extract(data, '"age": ([0-9]+)', 1) as age,
        regexp_extract(data, '"gender": "?(\\w*)"?', 1) as gender,
        regexp_extract(data, '"registration_date": "([^"]+)"', 1) as registration_date,
        regexp_extract(data, '"email": "([^"]+)"', 1) as email,
        regexp_extract(data, '"phone": "([^"]+)"', 1) as phone,
        regexp_extract(data, '"conditions": \\[(.*?)\\]', 1) as conditions
    from source
)

select * from parsed
  );

[0m13:38:11.132583 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:38:11.138810 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:38:11.139546 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients" rename to "stg_patients__dbt_backup"
[0m13:38:11.140588 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:38:11.143861 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:38:11.144269 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m13:38:11.145084 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:38:11.158092 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m13:38:11.158564 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:38:11.158941 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m13:38:11.160352 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:38:11.165154 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:38:11.165555 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
drop view if exists "dev"."main"."stg_patients__dbt_backup" cascade
[0m13:38:11.166711 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:38:11.169265 [debug] [Thread-1 (]: On model.suvera.stg_patients: Close
[0m13:38:11.171140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe3b607a-9c29-439d-8389-9ba06c808cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083f9310>]}
[0m13:38:11.171821 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_patients ............................. [[32mOK[0m in 0.09s]
[0m13:38:11.172794 [debug] [Thread-1 (]: Finished running node model.suvera.stg_patients
[0m13:38:11.174371 [debug] [MainThread]: Using duckdb connection "master"
[0m13:38:11.174910 [debug] [MainThread]: On master: BEGIN
[0m13:38:11.175222 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:38:11.175866 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:38:11.176196 [debug] [MainThread]: On master: COMMIT
[0m13:38:11.176514 [debug] [MainThread]: Using duckdb connection "master"
[0m13:38:11.176822 [debug] [MainThread]: On master: COMMIT
[0m13:38:11.177383 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:38:11.177715 [debug] [MainThread]: On master: Close
[0m13:38:11.178124 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:38:11.178426 [debug] [MainThread]: Connection 'model.suvera.stg_patients' was properly closed.
[0m13:38:11.178782 [info ] [MainThread]: 
[0m13:38:11.179398 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m13:38:11.180565 [debug] [MainThread]: Command end result
[0m13:38:11.207235 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:38:11.210296 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:38:11.216846 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m13:38:11.217360 [info ] [MainThread]: 
[0m13:38:11.217798 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:38:11.218287 [info ] [MainThread]: 
[0m13:38:11.218819 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:38:11.221797 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.553104, "process_in_blocks": "0", "process_kernel_time": 0.327545, "process_mem_max_rss": "137281536", "process_out_blocks": "0", "process_user_time": 2.874608}
[0m13:38:11.222345 [debug] [MainThread]: Command `dbt run` succeeded at 13:38:11.222225 after 1.55 seconds
[0m13:38:11.223068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080e1b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eca170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ec98b0>]}
[0m13:38:11.223731 [debug] [MainThread]: Flushing usage events
[0m13:38:11.586303 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:41:07.841448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108129d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f3b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f3b750>]}


============================== 13:41:07.850679 | f8875b2d-cef8-420a-9422-3c61065b6e0d ==============================
[0m13:41:07.850679 [info ] [MainThread]: Running with dbt=1.10.1
[0m13:41:07.851671 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_patients', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:41:08.176673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8875b2d-cef8-420a-9422-3c61065b6e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108415220>]}
[0m13:41:08.246958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8875b2d-cef8-420a-9422-3c61065b6e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e27130>]}
[0m13:41:08.276221 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:41:08.404026 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m13:41:08.619240 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:41:08.620026 [debug] [MainThread]: Partial parsing: updated file: suvera://models/staging/stg_patients.sql
[0m13:41:08.991385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8875b2d-cef8-420a-9422-3c61065b6e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096d0a50>]}
[0m13:41:09.076476 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:41:09.080423 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:41:09.122319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8875b2d-cef8-420a-9422-3c61065b6e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10920ea80>]}
[0m13:41:09.122915 [info ] [MainThread]: Found 4 models, 4 seeds, 9 data tests, 428 macros
[0m13:41:09.123350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8875b2d-cef8-420a-9422-3c61065b6e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109736190>]}
[0m13:41:09.125323 [info ] [MainThread]: 
[0m13:41:09.125749 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:41:09.126097 [info ] [MainThread]: 
[0m13:41:09.126693 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:41:09.127642 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:41:09.202295 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:41:09.202757 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:41:09.203099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:41:09.230141 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m13:41:09.232050 [debug] [ThreadPool]: On list_dev: Close
[0m13:41:09.232872 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m13:41:09.233452 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m13:41:09.240464 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:41:09.240842 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m13:41:09.241158 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:41:09.242199 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:41:09.243592 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:41:09.243919 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m13:41:09.244434 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:41:09.244743 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:41:09.245049 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m13:41:09.245611 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:41:09.246500 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:41:09.246828 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:41:09.247133 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:41:09.247624 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:41:09.247949 [debug] [ThreadPool]: On create_dev_main: Close
[0m13:41:09.253678 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m13:41:09.258928 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:41:09.259294 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:41:09.259597 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:41:09.260252 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:41:09.260567 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:41:09.260884 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m13:41:09.275509 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m13:41:09.277184 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:41:09.279608 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:41:09.280151 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:41:09.357137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8875b2d-cef8-420a-9422-3c61065b6e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094b7860>]}
[0m13:41:09.357878 [debug] [MainThread]: Using duckdb connection "master"
[0m13:41:09.358337 [debug] [MainThread]: On master: BEGIN
[0m13:41:09.358761 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:41:09.359544 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:41:09.360004 [debug] [MainThread]: On master: COMMIT
[0m13:41:09.360453 [debug] [MainThread]: Using duckdb connection "master"
[0m13:41:09.360883 [debug] [MainThread]: On master: COMMIT
[0m13:41:09.361572 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:41:09.362053 [debug] [MainThread]: On master: Close
[0m13:41:09.366500 [debug] [Thread-1 (]: Began running node model.suvera.stg_patients
[0m13:41:09.367331 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_patients .................................. [RUN]
[0m13:41:09.368014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.stg_patients)
[0m13:41:09.368585 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_patients
[0m13:41:09.379024 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_patients"
[0m13:41:09.380077 [debug] [Thread-1 (]: Began executing node model.suvera.stg_patients
[0m13:41:09.420751 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_patients"
[0m13:41:09.421668 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:41:09.422077 [debug] [Thread-1 (]: On model.suvera.stg_patients: BEGIN
[0m13:41:09.422455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:09.423416 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:41:09.423822 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:41:09.424364 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */

  
  create view "dev"."main"."stg_patients__dbt_tmp" as (
    with source as (
    select * from "dev"."main"."raw_patients"
),

parsed as (
    select
        regexp_extract(data, '"patient_id": ([0-9]+)', 1) as patient_id,
        regexp_extract(data, '"practice_id": ([0-9]+|null)', 1) as practice_id,
        regexp_extract(data, '"age": ([0-9]+)', 1) as age,
        regexp_extract(data, '""gender"": ""([^""]*)""', 1) as gender,
        regexp_extract(data, '"registration_date": "([^"]+)"', 1) as registration_date,
        regexp_extract(data, '"email": "([^"]+)"', 1) as email,
        regexp_extract(data, '"phone": "([^"]+)"', 1) as phone,
        regexp_extract(data, '"conditions": \\[(.*?)\\]', 1) as conditions
    from source
)

select * from parsed
  );

[0m13:41:09.425514 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:41:09.431905 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:41:09.432383 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients" rename to "stg_patients__dbt_backup"
[0m13:41:09.433382 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:41:09.436832 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:41:09.437326 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m13:41:09.438134 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:41:09.450759 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m13:41:09.451216 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:41:09.451590 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m13:41:09.452992 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:41:09.459444 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:41:09.460214 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
drop view if exists "dev"."main"."stg_patients__dbt_backup" cascade
[0m13:41:09.461762 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:41:09.466191 [debug] [Thread-1 (]: On model.suvera.stg_patients: Close
[0m13:41:09.469412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8875b2d-cef8-420a-9422-3c61065b6e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ad5310>]}
[0m13:41:09.470502 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_patients ............................. [[32mOK[0m in 0.10s]
[0m13:41:09.471405 [debug] [Thread-1 (]: Finished running node model.suvera.stg_patients
[0m13:41:09.473044 [debug] [MainThread]: Using duckdb connection "master"
[0m13:41:09.473508 [debug] [MainThread]: On master: BEGIN
[0m13:41:09.473912 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:41:09.474606 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:41:09.475005 [debug] [MainThread]: On master: COMMIT
[0m13:41:09.475386 [debug] [MainThread]: Using duckdb connection "master"
[0m13:41:09.475748 [debug] [MainThread]: On master: COMMIT
[0m13:41:09.476320 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:41:09.476941 [debug] [MainThread]: On master: Close
[0m13:41:09.477610 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:41:09.478059 [debug] [MainThread]: Connection 'model.suvera.stg_patients' was properly closed.
[0m13:41:09.478573 [info ] [MainThread]: 
[0m13:41:09.479027 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m13:41:09.479998 [debug] [MainThread]: Command end result
[0m13:41:09.507508 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:41:09.510410 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:41:09.516985 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m13:41:09.517448 [info ] [MainThread]: 
[0m13:41:09.518011 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:41:09.518565 [info ] [MainThread]: 
[0m13:41:09.519203 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:41:09.522873 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7727684, "process_in_blocks": "0", "process_kernel_time": 0.618918, "process_mem_max_rss": "137502720", "process_out_blocks": "0", "process_user_time": 3.386228}
[0m13:41:09.523547 [debug] [MainThread]: Command `dbt run` succeeded at 13:41:09.523415 after 1.77 seconds
[0m13:41:09.524034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097c5b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095aa170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095a98b0>]}
[0m13:41:09.524459 [debug] [MainThread]: Flushing usage events
[0m13:41:09.940713 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:43:05.382174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103db9d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b93610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b93750>]}


============================== 13:43:05.390845 | 330ca511-a59b-4628-a3f0-34a44e862eac ==============================
[0m13:43:05.390845 [info ] [MainThread]: Running with dbt=1.10.1
[0m13:43:05.391819 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'profiles_dir': '/Users/puneeth/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_patients', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:43:05.703549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '330ca511-a59b-4628-a3f0-34a44e862eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10406d220>]}
[0m13:43:05.778225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '330ca511-a59b-4628-a3f0-34a44e862eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a7f130>]}
[0m13:43:05.796205 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:43:05.922512 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m13:43:06.098307 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:43:06.099093 [debug] [MainThread]: Partial parsing: updated file: suvera://models/staging/stg_patients.sql
[0m13:43:06.478398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '330ca511-a59b-4628-a3f0-34a44e862eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10530ca50>]}
[0m13:43:06.564070 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:43:06.568159 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:43:06.613671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '330ca511-a59b-4628-a3f0-34a44e862eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e5aa80>]}
[0m13:43:06.614302 [info ] [MainThread]: Found 4 models, 4 seeds, 9 data tests, 428 macros
[0m13:43:06.614770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '330ca511-a59b-4628-a3f0-34a44e862eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105346190>]}
[0m13:43:06.616903 [info ] [MainThread]: 
[0m13:43:06.617378 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:43:06.617801 [info ] [MainThread]: 
[0m13:43:06.618405 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:43:06.619350 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:43:06.697273 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:43:06.697781 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:43:06.698182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:06.716904 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m13:43:06.718407 [debug] [ThreadPool]: On list_dev: Close
[0m13:43:06.719201 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m13:43:06.719686 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m13:43:06.727128 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:43:06.727622 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m13:43:06.727988 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:06.729075 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:43:06.734353 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:43:06.735265 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m13:43:06.736620 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:43:06.737287 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:43:06.738048 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m13:43:06.739120 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:43:06.741258 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:43:06.741929 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:43:06.742929 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:43:06.744060 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:43:06.744606 [debug] [ThreadPool]: On create_dev_main: Close
[0m13:43:06.753230 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m13:43:06.759393 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:43:06.759995 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:43:06.760435 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:06.761201 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:43:06.761616 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:43:06.762011 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m13:43:06.781785 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m13:43:06.783600 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:43:06.785556 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:43:06.785994 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:43:06.864101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '330ca511-a59b-4628-a3f0-34a44e862eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105107860>]}
[0m13:43:06.865229 [debug] [MainThread]: Using duckdb connection "master"
[0m13:43:06.865779 [debug] [MainThread]: On master: BEGIN
[0m13:43:06.866199 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:43:06.867067 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:43:06.867625 [debug] [MainThread]: On master: COMMIT
[0m13:43:06.868072 [debug] [MainThread]: Using duckdb connection "master"
[0m13:43:06.868494 [debug] [MainThread]: On master: COMMIT
[0m13:43:06.869153 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:43:06.869642 [debug] [MainThread]: On master: Close
[0m13:43:06.874101 [debug] [Thread-1 (]: Began running node model.suvera.stg_patients
[0m13:43:06.874908 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_patients .................................. [RUN]
[0m13:43:06.875667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.stg_patients)
[0m13:43:06.876208 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_patients
[0m13:43:06.886359 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_patients"
[0m13:43:06.887822 [debug] [Thread-1 (]: Began executing node model.suvera.stg_patients
[0m13:43:06.926371 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_patients"
[0m13:43:06.927851 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:43:06.928405 [debug] [Thread-1 (]: On model.suvera.stg_patients: BEGIN
[0m13:43:06.928786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:06.929508 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:43:06.929896 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:43:06.930303 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */

  
  create view "dev"."main"."stg_patients__dbt_tmp" as (
    with source as (
    select * from "dev"."main"."raw_patients"
),

parsed as (
    select
        regexp_extract(data, '"patient_id": ([0-9]+)', 1) as patient_id,
        regexp_extract(data, '"practice_id": ([0-9]+|null)', 1) as practice_id,
        regexp_extract(data, '"age": ([0-9]+)', 1) as age,
        regexp_extract(data, '"gender": "([^""]*)"', 1) as gender,
        regexp_extract(data, '"registration_date": "([^"]+)"', 1) as registration_date,
        regexp_extract(data, '"email": "([^"]+)"', 1) as email,
        regexp_extract(data, '"phone": "([^"]+)"', 1) as phone,
        regexp_extract(data, '"conditions": \\[(.*?)\\]', 1) as conditions
    from source
)

select * from parsed
  );

[0m13:43:06.931556 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:43:06.937809 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:43:06.938460 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients" rename to "stg_patients__dbt_backup"
[0m13:43:06.939470 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:43:06.943362 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:43:06.943945 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m13:43:06.944783 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:43:06.957924 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m13:43:06.958569 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:43:06.959086 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m13:43:06.960523 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:43:06.966031 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:43:06.966492 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
drop view if exists "dev"."main"."stg_patients__dbt_backup" cascade
[0m13:43:06.967626 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:43:06.970302 [debug] [Thread-1 (]: On model.suvera.stg_patients: Close
[0m13:43:06.972471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '330ca511-a59b-4628-a3f0-34a44e862eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105721310>]}
[0m13:43:06.973192 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_patients ............................. [[32mOK[0m in 0.10s]
[0m13:43:06.974095 [debug] [Thread-1 (]: Finished running node model.suvera.stg_patients
[0m13:43:06.975954 [debug] [MainThread]: Using duckdb connection "master"
[0m13:43:06.976384 [debug] [MainThread]: On master: BEGIN
[0m13:43:06.976708 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:43:06.977419 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:43:06.977776 [debug] [MainThread]: On master: COMMIT
[0m13:43:06.978119 [debug] [MainThread]: Using duckdb connection "master"
[0m13:43:06.978514 [debug] [MainThread]: On master: COMMIT
[0m13:43:06.980135 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:43:06.980785 [debug] [MainThread]: On master: Close
[0m13:43:06.981442 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:43:06.981976 [debug] [MainThread]: Connection 'model.suvera.stg_patients' was properly closed.
[0m13:43:06.982384 [info ] [MainThread]: 
[0m13:43:06.982920 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m13:43:06.983723 [debug] [MainThread]: Command end result
[0m13:43:07.018727 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:43:07.021046 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:43:07.030184 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m13:43:07.030815 [info ] [MainThread]: 
[0m13:43:07.031483 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:43:07.031959 [info ] [MainThread]: 
[0m13:43:07.032388 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:43:07.036180 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7452182, "process_in_blocks": "0", "process_kernel_time": 0.595574, "process_mem_max_rss": "137437184", "process_out_blocks": "0", "process_user_time": 3.340713}
[0m13:43:07.036830 [debug] [MainThread]: Command `dbt run` succeeded at 13:43:07.036683 after 1.75 seconds
[0m13:43:07.037513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105405b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051ee170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051ed8b0>]}
[0m13:43:07.038022 [debug] [MainThread]: Flushing usage events
[0m13:43:07.434518 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:49:47.656225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108b5d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116c7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116c7750>]}


============================== 13:49:47.666491 | 357178e1-7068-4885-87fb-5470629c3d22 ==============================
[0m13:49:47.666491 [info ] [MainThread]: Running with dbt=1.10.1
[0m13:49:47.668116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_patients', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:49:48.044623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '357178e1-7068-4885-87fb-5470629c3d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b99220>]}
[0m13:49:48.130588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '357178e1-7068-4885-87fb-5470629c3d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115af130>]}
[0m13:49:48.152455 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:49:48.292098 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m13:49:48.492516 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:49:48.493456 [debug] [MainThread]: Partial parsing: updated file: suvera://models/staging/stg_patients.sql
[0m13:49:48.936477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '357178e1-7068-4885-87fb-5470629c3d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e5ca50>]}
[0m13:49:49.039119 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:49:49.043733 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:49:49.089556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '357178e1-7068-4885-87fb-5470629c3d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11199aa80>]}
[0m13:49:49.090232 [info ] [MainThread]: Found 4 models, 4 seeds, 9 data tests, 428 macros
[0m13:49:49.090747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '357178e1-7068-4885-87fb-5470629c3d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eca190>]}
[0m13:49:49.093411 [info ] [MainThread]: 
[0m13:49:49.093980 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:49:49.094372 [info ] [MainThread]: 
[0m13:49:49.094996 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:49:49.096001 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:49:49.178464 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:49:49.179038 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:49:49.179495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:49.201452 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m13:49:49.203049 [debug] [ThreadPool]: On list_dev: Close
[0m13:49:49.203815 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m13:49:49.204330 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m13:49:49.211346 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:49:49.211771 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m13:49:49.212098 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:49.213207 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:49:49.215642 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:49:49.216091 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m13:49:49.216685 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:49:49.217166 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:49:49.217509 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m13:49:49.218121 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:49:49.219137 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:49:49.219496 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:49:49.219824 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:49:49.220324 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:49:49.220674 [debug] [ThreadPool]: On create_dev_main: Close
[0m13:49:49.226897 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m13:49:49.233792 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:49:49.234267 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:49:49.234659 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:49.235374 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:49:49.235771 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:49:49.236225 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m13:49:49.252343 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m13:49:49.253982 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:49:49.255826 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:49:49.256214 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:49:49.338701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '357178e1-7068-4885-87fb-5470629c3d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c43860>]}
[0m13:49:49.339408 [debug] [MainThread]: Using duckdb connection "master"
[0m13:49:49.339870 [debug] [MainThread]: On master: BEGIN
[0m13:49:49.340295 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:49:49.341084 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:49:49.341543 [debug] [MainThread]: On master: COMMIT
[0m13:49:49.341986 [debug] [MainThread]: Using duckdb connection "master"
[0m13:49:49.342411 [debug] [MainThread]: On master: COMMIT
[0m13:49:49.343076 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:49:49.343521 [debug] [MainThread]: On master: Close
[0m13:49:49.347844 [debug] [Thread-1 (]: Began running node model.suvera.stg_patients
[0m13:49:49.348643 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_patients .................................. [RUN]
[0m13:49:49.349304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.stg_patients)
[0m13:49:49.349825 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_patients
[0m13:49:49.360792 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_patients"
[0m13:49:49.363189 [debug] [Thread-1 (]: Began executing node model.suvera.stg_patients
[0m13:49:49.398650 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_patients"
[0m13:49:49.399751 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:49:49.400165 [debug] [Thread-1 (]: On model.suvera.stg_patients: BEGIN
[0m13:49:49.400525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:49.401278 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:49.401652 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:49:49.402042 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */

  
  create view "dev"."main"."stg_patients__dbt_tmp" as (
    with source as (
    select * from "dev"."main"."raw_patients"
),

parsed as (
    select
        regexp_extract(data, '"patient_id": ([0-9]+)', 1) as patient_id,
        regexp_extract(data, '"practice_id": ([0-9]+|null)', 1) as practice_id,
        regexp_extract(data, '"age": ([0-9]+)', 1) as age,
        regexp_extract(data, '"gender": "([^""]*)"', 1) as gender,
        regexp_extract(data, '"registration_date": "([^"]+)"', 1) as registration_date,
        regexp_extract(data, '"email": "([^"]+)"', 1) as email,
        regexp_extract(data, '"phone": "([^"]+)"', 1) as phone,
        regexp_extract(data, '"conditions": \[(.*?)\]', 1) as conditions
    from source
)

select * from parsed
  );

[0m13:49:49.403215 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:49.409343 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:49:49.409762 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients" rename to "stg_patients__dbt_backup"
[0m13:49:49.410731 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:49.414017 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:49:49.414425 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m13:49:49.415186 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:49:49.427641 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m13:49:49.428095 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:49:49.428466 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m13:49:49.430852 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:49:49.436641 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:49:49.437081 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
drop view if exists "dev"."main"."stg_patients__dbt_backup" cascade
[0m13:49:49.438320 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:49.441402 [debug] [Thread-1 (]: On model.suvera.stg_patients: Close
[0m13:49:49.444456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '357178e1-7068-4885-87fb-5470629c3d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112271310>]}
[0m13:49:49.445268 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_patients ............................. [[32mOK[0m in 0.09s]
[0m13:49:49.446122 [debug] [Thread-1 (]: Finished running node model.suvera.stg_patients
[0m13:49:49.448125 [debug] [MainThread]: Using duckdb connection "master"
[0m13:49:49.448539 [debug] [MainThread]: On master: BEGIN
[0m13:49:49.448858 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:49:49.449752 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:49:49.450134 [debug] [MainThread]: On master: COMMIT
[0m13:49:49.450464 [debug] [MainThread]: Using duckdb connection "master"
[0m13:49:49.450810 [debug] [MainThread]: On master: COMMIT
[0m13:49:49.451372 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:49:49.451856 [debug] [MainThread]: On master: Close
[0m13:49:49.452641 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:49:49.453118 [debug] [MainThread]: Connection 'model.suvera.stg_patients' was properly closed.
[0m13:49:49.453672 [info ] [MainThread]: 
[0m13:49:49.454307 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m13:49:49.455418 [debug] [MainThread]: Command end result
[0m13:49:49.480144 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:49:49.482675 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:49:49.489930 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m13:49:49.490857 [info ] [MainThread]: 
[0m13:49:49.491601 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:49:49.492322 [info ] [MainThread]: 
[0m13:49:49.493009 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:49:49.497275 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9443399, "process_in_blocks": "0", "process_kernel_time": 0.665826, "process_mem_max_rss": "137474048", "process_out_blocks": "0", "process_user_time": 3.574331}
[0m13:49:49.497953 [debug] [MainThread]: Command `dbt run` succeeded at 13:49:49.497813 after 1.95 seconds
[0m13:49:49.498421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f59b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d36170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d358b0>]}
[0m13:49:49.498875 [debug] [MainThread]: Flushing usage events
[0m13:49:49.894604 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:54:44.537280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f11d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ceb610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ceb750>]}


============================== 13:54:44.546870 | 29134a20-e0ac-4eab-bc12-9c919c008768 ==============================
[0m13:54:44.546870 [info ] [MainThread]: Running with dbt=1.10.1
[0m13:54:44.547945 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select stg_patients', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:54:44.952086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29134a20-e0ac-4eab-bc12-9c919c008768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051c5220>]}
[0m13:54:45.028522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29134a20-e0ac-4eab-bc12-9c919c008768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bd7130>]}
[0m13:54:45.061248 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:54:45.195317 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m13:54:45.432231 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:54:45.432963 [debug] [MainThread]: Partial parsing: updated file: suvera://models/staging/stg_patients.sql
[0m13:54:45.822621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29134a20-e0ac-4eab-bc12-9c919c008768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106464a50>]}
[0m13:54:45.917720 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:54:45.924052 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:54:45.970322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29134a20-e0ac-4eab-bc12-9c919c008768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fb2a80>]}
[0m13:54:45.971022 [info ] [MainThread]: Found 4 models, 4 seeds, 9 data tests, 428 macros
[0m13:54:45.971495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29134a20-e0ac-4eab-bc12-9c919c008768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10649e190>]}
[0m13:54:45.973664 [info ] [MainThread]: 
[0m13:54:45.974140 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:54:45.974501 [info ] [MainThread]: 
[0m13:54:45.975113 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:54:45.976073 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:54:46.055425 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:54:46.056008 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:54:46.056516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:46.077991 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m13:54:46.079553 [debug] [ThreadPool]: On list_dev: Close
[0m13:54:46.080256 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m13:54:46.080746 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m13:54:46.086983 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:54:46.087338 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m13:54:46.087647 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:46.088786 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:54:46.090288 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:54:46.090619 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m13:54:46.091300 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:54:46.091611 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:54:46.091920 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m13:54:46.092476 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:54:46.093368 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:54:46.093696 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:54:46.093999 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:54:46.094509 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:54:46.094843 [debug] [ThreadPool]: On create_dev_main: Close
[0m13:54:46.100795 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m13:54:46.106381 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:54:46.106773 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:54:46.107079 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:46.107763 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:54:46.108081 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:54:46.108400 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m13:54:46.122452 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m13:54:46.124064 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:54:46.126760 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:54:46.127302 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:54:46.203355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29134a20-e0ac-4eab-bc12-9c919c008768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10625b860>]}
[0m13:54:46.204041 [debug] [MainThread]: Using duckdb connection "master"
[0m13:54:46.204499 [debug] [MainThread]: On master: BEGIN
[0m13:54:46.204924 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:54:46.205751 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:54:46.206221 [debug] [MainThread]: On master: COMMIT
[0m13:54:46.206668 [debug] [MainThread]: Using duckdb connection "master"
[0m13:54:46.207095 [debug] [MainThread]: On master: COMMIT
[0m13:54:46.207750 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:54:46.208192 [debug] [MainThread]: On master: Close
[0m13:54:46.212577 [debug] [Thread-1 (]: Began running node model.suvera.stg_patients
[0m13:54:46.213425 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_patients .................................. [RUN]
[0m13:54:46.214099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.stg_patients)
[0m13:54:46.214619 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_patients
[0m13:54:46.224838 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_patients"
[0m13:54:46.226394 [debug] [Thread-1 (]: Began executing node model.suvera.stg_patients
[0m13:54:46.263593 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_patients"
[0m13:54:46.264509 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:54:46.264913 [debug] [Thread-1 (]: On model.suvera.stg_patients: BEGIN
[0m13:54:46.265281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:46.265974 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:46.266349 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:54:46.266752 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */

  
  create view "dev"."main"."stg_patients__dbt_tmp" as (
    with source as (
    select * from "dev"."main"."raw_patients"
),

parsed as (
    select
        regexp_extract(data, '"patient_id": ([0-9]+)', 1) as patient_id,
        regexp_extract(data, '"practice_id": ([0-9]+|null)', 1) as practice_id,
        regexp_extract(data, '"age": ([0-9]+)', 1) as age,
        regexp_extract(data, '"gender": "([^""]*)"', 1) as gender,
        regexp_extract(data, '"registration_date": "([^"]+)"', 1) as registration_date,
        regexp_extract(data, '"email": "([^"]+)"', 1) as email,
        regexp_extract(data, '"phone": "([^"]+)"', 1) as phone,
        string_split(replace(regexp_extract(data, '"conditions": \[(.*?)\]', 1),'"',''), ', ') as conditions
    from source
)

select * from parsed
  );

[0m13:54:46.267881 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:46.274652 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:54:46.275129 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients" rename to "stg_patients__dbt_backup"
[0m13:54:46.276122 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:46.279371 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:54:46.279781 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m13:54:46.280503 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:54:46.293044 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m13:54:46.293483 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:54:46.293845 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m13:54:46.295884 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:54:46.301120 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:54:46.301520 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
drop view if exists "dev"."main"."stg_patients__dbt_backup" cascade
[0m13:54:46.302693 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:54:46.305459 [debug] [Thread-1 (]: On model.suvera.stg_patients: Close
[0m13:54:46.308398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29134a20-e0ac-4eab-bc12-9c919c008768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106879310>]}
[0m13:54:46.309405 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_patients ............................. [[32mOK[0m in 0.09s]
[0m13:54:46.310377 [debug] [Thread-1 (]: Finished running node model.suvera.stg_patients
[0m13:54:46.312110 [debug] [MainThread]: Using duckdb connection "master"
[0m13:54:46.312538 [debug] [MainThread]: On master: BEGIN
[0m13:54:46.312856 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:54:46.313544 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:54:46.313899 [debug] [MainThread]: On master: COMMIT
[0m13:54:46.314226 [debug] [MainThread]: Using duckdb connection "master"
[0m13:54:46.314537 [debug] [MainThread]: On master: COMMIT
[0m13:54:46.315038 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:54:46.315373 [debug] [MainThread]: On master: Close
[0m13:54:46.315793 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:54:46.316097 [debug] [MainThread]: Connection 'model.suvera.stg_patients' was properly closed.
[0m13:54:46.316441 [info ] [MainThread]: 
[0m13:54:46.317075 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m13:54:46.318070 [debug] [MainThread]: Command end result
[0m13:54:46.346275 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:54:46.348430 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:54:46.356629 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m13:54:46.357102 [info ] [MainThread]: 
[0m13:54:46.357582 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:54:46.357983 [info ] [MainThread]: 
[0m13:54:46.358552 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:54:46.362592 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.92746, "process_in_blocks": "0", "process_kernel_time": 0.677209, "process_mem_max_rss": "137744384", "process_out_blocks": "0", "process_user_time": 3.392277}
[0m13:54:46.363358 [debug] [MainThread]: Command `dbt run` succeeded at 13:54:46.363136 after 1.93 seconds
[0m13:54:46.363844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106551b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106346170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063458b0>]}
[0m13:54:46.364273 [debug] [MainThread]: Flushing usage events
[0m13:54:46.772731 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:55:38.423407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112811d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113623610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113623750>]}


============================== 13:55:38.431664 | 45f564f4-6db5-4a58-b477-9e0cf6cf7dcf ==============================
[0m13:55:38.431664 [info ] [MainThread]: Running with dbt=1.10.1
[0m13:55:38.432722 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_patients', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:55:38.837772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45f564f4-6db5-4a58-b477-9e0cf6cf7dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112af5220>]}
[0m13:55:38.912243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45f564f4-6db5-4a58-b477-9e0cf6cf7dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11350b130>]}
[0m13:55:38.940840 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:55:39.076367 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m13:55:39.285822 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:55:39.286310 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:55:39.342310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45f564f4-6db5-4a58-b477-9e0cf6cf7dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a4b150>]}
[0m13:55:39.434149 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:55:39.439068 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:55:39.485138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45f564f4-6db5-4a58-b477-9e0cf6cf7dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138f6a80>]}
[0m13:55:39.485804 [info ] [MainThread]: Found 4 models, 4 seeds, 9 data tests, 428 macros
[0m13:55:39.486259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45f564f4-6db5-4a58-b477-9e0cf6cf7dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137ec830>]}
[0m13:55:39.488534 [info ] [MainThread]: 
[0m13:55:39.489282 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:55:39.489679 [info ] [MainThread]: 
[0m13:55:39.490298 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:55:39.491261 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:55:39.568265 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:55:39.568781 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:55:39.569176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:39.591250 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m13:55:39.592765 [debug] [ThreadPool]: On list_dev: Close
[0m13:55:39.593478 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m13:55:39.593981 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m13:55:39.600530 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:55:39.600929 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m13:55:39.601236 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:39.602283 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:55:39.603866 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:55:39.604190 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m13:55:39.604742 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:55:39.605050 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:55:39.605394 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m13:55:39.606055 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:55:39.606956 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:55:39.607282 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:55:39.607582 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:55:39.608073 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:55:39.608399 [debug] [ThreadPool]: On create_dev_main: Close
[0m13:55:39.614228 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m13:55:39.619544 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:55:39.619896 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:55:39.620198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:39.621083 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:55:39.621402 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:55:39.621718 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m13:55:39.636379 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m13:55:39.638897 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:55:39.641594 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:55:39.642245 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:55:39.644514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45f564f4-6db5-4a58-b477-9e0cf6cf7dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e96c30>]}
[0m13:55:39.645143 [debug] [MainThread]: Using duckdb connection "master"
[0m13:55:39.645567 [debug] [MainThread]: On master: BEGIN
[0m13:55:39.645967 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:55:39.646739 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:55:39.647180 [debug] [MainThread]: On master: COMMIT
[0m13:55:39.647598 [debug] [MainThread]: Using duckdb connection "master"
[0m13:55:39.647952 [debug] [MainThread]: On master: COMMIT
[0m13:55:39.648484 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:55:39.648872 [debug] [MainThread]: On master: Close
[0m13:55:39.652891 [debug] [Thread-1 (]: Began running node model.suvera.stg_patients
[0m13:55:39.653654 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_patients .................................. [RUN]
[0m13:55:39.654249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.stg_patients)
[0m13:55:39.654697 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_patients
[0m13:55:39.663371 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_patients"
[0m13:55:39.665224 [debug] [Thread-1 (]: Began executing node model.suvera.stg_patients
[0m13:55:39.700818 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_patients"
[0m13:55:39.701740 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:55:39.702136 [debug] [Thread-1 (]: On model.suvera.stg_patients: BEGIN
[0m13:55:39.702495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:39.703185 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:55:39.703565 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:55:39.703958 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */

  
  create view "dev"."main"."stg_patients__dbt_tmp" as (
    with source as (
    select * from "dev"."main"."raw_patients"
),

parsed as (
    select
        regexp_extract(data, '"patient_id": ([0-9]+)', 1) as patient_id,
        regexp_extract(data, '"practice_id": ([0-9]+|null)', 1) as practice_id,
        regexp_extract(data, '"age": ([0-9]+)', 1) as age,
        regexp_extract(data, '"gender": "([^""]*)"', 1) as gender,
        regexp_extract(data, '"registration_date": "([^"]+)"', 1) as registration_date,
        regexp_extract(data, '"email": "([^"]+)"', 1) as email,
        regexp_extract(data, '"phone": "([^"]+)"', 1) as phone,
        string_split(replace(regexp_extract(data, '"conditions": \[(.*?)\]', 1),'"',''), ', ') as conditions
    from source
)

select * from parsed
  );

[0m13:55:39.705312 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:55:39.711648 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:55:39.712263 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients" rename to "stg_patients__dbt_backup"
[0m13:55:39.713224 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:55:39.716636 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:55:39.717068 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m13:55:39.717850 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:55:39.730325 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m13:55:39.730755 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:55:39.731113 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m13:55:39.732486 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:55:39.737671 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m13:55:39.738073 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
drop view if exists "dev"."main"."stg_patients__dbt_backup" cascade
[0m13:55:39.739351 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:55:39.741814 [debug] [Thread-1 (]: On model.suvera.stg_patients: Close
[0m13:55:39.744654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45f564f4-6db5-4a58-b477-9e0cf6cf7dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c5bdd0>]}
[0m13:55:39.745483 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_patients ............................. [[32mOK[0m in 0.09s]
[0m13:55:39.746322 [debug] [Thread-1 (]: Finished running node model.suvera.stg_patients
[0m13:55:39.747868 [debug] [MainThread]: Using duckdb connection "master"
[0m13:55:39.748201 [debug] [MainThread]: On master: BEGIN
[0m13:55:39.748501 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:55:39.749162 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:55:39.749494 [debug] [MainThread]: On master: COMMIT
[0m13:55:39.749808 [debug] [MainThread]: Using duckdb connection "master"
[0m13:55:39.750108 [debug] [MainThread]: On master: COMMIT
[0m13:55:39.750618 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:55:39.750971 [debug] [MainThread]: On master: Close
[0m13:55:39.751378 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:39.751671 [debug] [MainThread]: Connection 'model.suvera.stg_patients' was properly closed.
[0m13:55:39.752061 [info ] [MainThread]: 
[0m13:55:39.752701 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m13:55:39.754150 [debug] [MainThread]: Command end result
[0m13:55:39.782088 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m13:55:39.784965 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m13:55:39.793268 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m13:55:39.793718 [info ] [MainThread]: 
[0m13:55:39.794259 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:55:39.794687 [info ] [MainThread]: 
[0m13:55:39.795120 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:55:39.799455 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.484253, "process_in_blocks": "0", "process_kernel_time": 0.629922, "process_mem_max_rss": "134795264", "process_out_blocks": "0", "process_user_time": 3.011449}
[0m13:55:39.800336 [debug] [MainThread]: Command `dbt run` succeeded at 13:55:39.800181 after 1.49 seconds
[0m13:55:39.800841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ce9a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114073e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114073bb0>]}
[0m13:55:39.801369 [debug] [MainThread]: Flushing usage events
[0m13:55:40.161613 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:07:37.688266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110319d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11112b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11112b750>]}


============================== 14:07:37.698327 | 8e51dbaa-85b3-4229-8a6d-51b18e79d53d ==============================
[0m14:07:37.698327 [info ] [MainThread]: Running with dbt=1.10.1
[0m14:07:37.699305 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/puneeth/.dbt', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:07:38.100916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e51dbaa-85b3-4229-8a6d-51b18e79d53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105fd220>]}
[0m14:07:38.174116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e51dbaa-85b3-4229-8a6d-51b18e79d53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111013130>]}
[0m14:07:38.193337 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m14:07:38.339321 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m14:07:38.557310 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:07:38.558207 [debug] [MainThread]: Partial parsing: updated file: suvera://models/staging/schema.yml
[0m14:07:39.052966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e51dbaa-85b3-4229-8a6d-51b18e79d53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118c0e50>]}
[0m14:07:39.150643 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m14:07:39.155184 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m14:07:39.293888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e51dbaa-85b3-4229-8a6d-51b18e79d53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11181f020>]}
[0m14:07:39.294725 [info ] [MainThread]: Found 4 models, 4 seeds, 16 data tests, 428 macros
[0m14:07:39.295262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e51dbaa-85b3-4229-8a6d-51b18e79d53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111615710>]}
[0m14:07:39.298718 [info ] [MainThread]: 
[0m14:07:39.299167 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:07:39.299610 [info ] [MainThread]: 
[0m14:07:39.300365 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:07:39.308660 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m14:07:39.381809 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:07:39.382259 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:07:39.382574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:39.394026 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: BEGIN
[0m14:07:39.394591 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m14:07:39.395632 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:39.395947 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m14:07:39.396258 [info ] [MainThread]: 
[0m14:07:39.396685 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m14:07:39.397311 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/puneeth/Documents/suvera_dbt_project/suvera/dev.duckdb": Conflicting lock is held in /usr/local/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 20087) by user puneeth. See also https://duckdb.org/docs/stable/connect/concurrency
[0m14:07:39.400773 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.8152344, "process_in_blocks": "0", "process_kernel_time": 0.675436, "process_mem_max_rss": "131821568", "process_out_blocks": "0", "process_user_time": 3.366451}
[0m14:07:39.401300 [debug] [MainThread]: Command `dbt test` failed at 14:07:39.401186 after 1.82 seconds
[0m14:07:39.401692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b4add0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fd1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11182df10>]}
[0m14:07:39.402073 [debug] [MainThread]: Flushing usage events
[0m14:07:39.801950 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:08:08.766155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118a1d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126b3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126b3750>]}


============================== 14:08:08.773642 | 0f1ee9f6-f674-4f61-85fd-c6a12cd6696c ==============================
[0m14:08:08.773642 [info ] [MainThread]: Running with dbt=1.10.1
[0m14:08:08.774606 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'profiles_dir': '/Users/puneeth/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m14:08:09.124469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f1ee9f6-f674-4f61-85fd-c6a12cd6696c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b81220>]}
[0m14:08:09.195657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f1ee9f6-f674-4f61-85fd-c6a12cd6696c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11259b130>]}
[0m14:08:09.219338 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m14:08:09.346712 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m14:08:09.576128 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:08:09.576579 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:08:09.630519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f1ee9f6-f674-4f61-85fd-c6a12cd6696c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112adb050>]}
[0m14:08:09.723203 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m14:08:09.728943 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m14:08:09.799483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f1ee9f6-f674-4f61-85fd-c6a12cd6696c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d1ed50>]}
[0m14:08:09.800105 [info ] [MainThread]: Found 4 models, 4 seeds, 16 data tests, 428 macros
[0m14:08:09.800543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f1ee9f6-f674-4f61-85fd-c6a12cd6696c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112df0f30>]}
[0m14:08:09.803589 [info ] [MainThread]: 
[0m14:08:09.804033 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:08:09.804388 [info ] [MainThread]: 
[0m14:08:09.805005 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:08:09.812038 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m14:08:09.887822 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:08:09.888330 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:08:09.888763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:09.910787 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m14:08:09.911262 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:08:09.911596 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m14:08:09.926266 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m14:08:09.927951 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:08:09.929960 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:08:09.930409 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:08:09.932415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f1ee9f6-f674-4f61-85fd-c6a12cd6696c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fd2410>]}
[0m14:08:09.932985 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:09.933369 [debug] [MainThread]: On master: BEGIN
[0m14:08:09.933733 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:08:09.934427 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:08:09.934765 [debug] [MainThread]: On master: COMMIT
[0m14:08:09.935087 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:09.935394 [debug] [MainThread]: On master: COMMIT
[0m14:08:09.935911 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:08:09.936246 [debug] [MainThread]: On master: Close
[0m14:08:09.940378 [debug] [Thread-1 (]: Began running node test.suvera.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:08:09.940987 [info ] [Thread-1 (]: 1 of 16 START test not_null_my_first_dbt_model_id .............................. [RUN]
[0m14:08:09.941586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now test.suvera.not_null_my_first_dbt_model_id.5fb22c2710)
[0m14:08:09.942050 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:08:09.963189 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:08:09.964737 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:08:09.985308 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:08:09.986480 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:08:09.986892 [debug] [Thread-1 (]: On test.suvera.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m14:08:09.987272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:09.987973 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:09.988381 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:08:09.988779 [debug] [Thread-1 (]: On test.suvera.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_my_first_dbt_model_id.5fb22c2710"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "dev"."main"."my_first_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m14:08:09.992100 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_my_first_dbt_model_id.5fb22c2710"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "dev"."main"."my_first_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m14:08:09.992727 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m14:08:09.993318 [debug] [Thread-1 (]: On test.suvera.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m14:08:10.012452 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_my_first_dbt_model_id.5fb22c2710'
[0m14:08:10.012996 [debug] [Thread-1 (]: On test.suvera.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m14:08:10.017367 [debug] [Thread-1 (]: Runtime Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  Catalog Error: Table with name my_first_dbt_model does not exist!
  Did you mean "raw_patients"?
  
  LINE 17: from "dev"."main"."my_first_dbt_model"
                ^
[0m14:08:10.017932 [error] [Thread-1 (]: 1 of 16 ERROR not_null_my_first_dbt_model_id ................................... [[31mERROR[0m in 0.08s]
[0m14:08:10.018732 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:08:10.019183 [debug] [Thread-1 (]: Began running node test.suvera.not_null_my_second_dbt_model_id.151b76d778
[0m14:08:10.019593 [info ] [Thread-1 (]: 2 of 16 START test not_null_my_second_dbt_model_id ............................. [RUN]
[0m14:08:10.020416 [debug] [Thread-4 (]: Marking all children of 'test.suvera.not_null_my_first_dbt_model_id.5fb22c2710' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  Catalog Error: Table with name my_first_dbt_model does not exist!
  Did you mean "raw_patients"?
  
  LINE 17: from "dev"."main"."my_first_dbt_model"
                ^.
[0m14:08:10.020883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_my_first_dbt_model_id.5fb22c2710, now test.suvera.not_null_my_second_dbt_model_id.151b76d778)
[0m14:08:10.022069 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_my_second_dbt_model_id.151b76d778
[0m14:08:10.026407 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_my_second_dbt_model_id.151b76d778"
[0m14:08:10.027529 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_my_second_dbt_model_id.151b76d778
[0m14:08:10.030673 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_my_second_dbt_model_id.151b76d778"
[0m14:08:10.032316 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_my_second_dbt_model_id.151b76d778"
[0m14:08:10.032991 [debug] [Thread-1 (]: On test.suvera.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m14:08:10.034028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:10.035372 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:10.036322 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_my_second_dbt_model_id.151b76d778"
[0m14:08:10.037290 [debug] [Thread-1 (]: On test.suvera.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_my_second_dbt_model_id.151b76d778"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "dev"."main"."my_second_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m14:08:10.038442 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_my_second_dbt_model_id.151b76d778"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "dev"."main"."my_second_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m14:08:10.039020 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m14:08:10.039887 [debug] [Thread-1 (]: On test.suvera.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m14:08:10.044626 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_my_second_dbt_model_id.151b76d778'
[0m14:08:10.045071 [debug] [Thread-1 (]: On test.suvera.not_null_my_second_dbt_model_id.151b76d778: Close
[0m14:08:10.049198 [debug] [Thread-1 (]: Runtime Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  Catalog Error: Table with name my_second_dbt_model does not exist!
  Did you mean "raw_patients"?
  
  LINE 17: from "dev"."main"."my_second_dbt_model"
                ^
[0m14:08:10.049730 [error] [Thread-1 (]: 2 of 16 ERROR not_null_my_second_dbt_model_id .................................. [[31mERROR[0m in 0.03s]
[0m14:08:10.050408 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_my_second_dbt_model_id.151b76d778
[0m14:08:10.050891 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_activities_activity_date.51ab13376e
[0m14:08:10.051292 [info ] [Thread-1 (]: 3 of 16 START test not_null_stg_activities_activity_date ....................... [RUN]
[0m14:08:10.051993 [debug] [Thread-4 (]: Marking all children of 'test.suvera.not_null_my_second_dbt_model_id.151b76d778' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  Catalog Error: Table with name my_second_dbt_model does not exist!
  Did you mean "raw_patients"?
  
  LINE 17: from "dev"."main"."my_second_dbt_model"
                ^.
[0m14:08:10.052435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_my_second_dbt_model_id.151b76d778, now test.suvera.not_null_stg_activities_activity_date.51ab13376e)
[0m14:08:10.053058 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_activities_activity_date.51ab13376e
[0m14:08:10.058104 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_activities_activity_date.51ab13376e"
[0m14:08:10.060259 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_activities_activity_date.51ab13376e
[0m14:08:10.064390 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_activities_activity_date.51ab13376e"
[0m14:08:10.065282 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_activity_date.51ab13376e"
[0m14:08:10.065685 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_date.51ab13376e: BEGIN
[0m14:08:10.066059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:10.066792 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:10.067184 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_activity_date.51ab13376e"
[0m14:08:10.067579 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_date.51ab13376e: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_activities_activity_date.51ab13376e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_date
from "dev"."main"."stg_activities"
where activity_date is null



  
  
      
    ) dbt_internal_test
[0m14:08:10.068864 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:10.074901 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_date.51ab13376e: ROLLBACK
[0m14:08:10.075670 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_activities_activity_date.51ab13376e'
[0m14:08:10.076069 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_date.51ab13376e: Close
[0m14:08:10.076732 [info ] [Thread-1 (]: 3 of 16 PASS not_null_stg_activities_activity_date ............................. [[32mPASS[0m in 0.02s]
[0m14:08:10.077379 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_activities_activity_date.51ab13376e
[0m14:08:10.077815 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a
[0m14:08:10.078219 [info ] [Thread-1 (]: 4 of 16 START test not_null_stg_activities_activity_id ......................... [RUN]
[0m14:08:10.078747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_activities_activity_date.51ab13376e, now test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a)
[0m14:08:10.079166 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a
[0m14:08:10.082892 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a"
[0m14:08:10.083619 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a
[0m14:08:10.085909 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a"
[0m14:08:10.087537 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a"
[0m14:08:10.088122 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a: BEGIN
[0m14:08:10.088887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:10.089950 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:10.090669 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a"
[0m14:08:10.091275 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_id
from "dev"."main"."stg_activities"
where activity_id is null



  
  
      
    ) dbt_internal_test
[0m14:08:10.092726 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:10.095732 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a: ROLLBACK
[0m14:08:10.097110 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a'
[0m14:08:10.097847 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a: Close
[0m14:08:10.098872 [info ] [Thread-1 (]: 4 of 16 PASS not_null_stg_activities_activity_id ............................... [[32mPASS[0m in 0.02s]
[0m14:08:10.099676 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a
[0m14:08:10.100120 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_activities_activity_type.69907e08a2
[0m14:08:10.100525 [info ] [Thread-1 (]: 5 of 16 START test not_null_stg_activities_activity_type ....................... [RUN]
[0m14:08:10.101072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a, now test.suvera.not_null_stg_activities_activity_type.69907e08a2)
[0m14:08:10.101493 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_activities_activity_type.69907e08a2
[0m14:08:10.106263 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_activities_activity_type.69907e08a2"
[0m14:08:10.108717 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_activities_activity_type.69907e08a2
[0m14:08:10.111097 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_activities_activity_type.69907e08a2"
[0m14:08:10.111862 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_activity_type.69907e08a2"
[0m14:08:10.112259 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_type.69907e08a2: BEGIN
[0m14:08:10.112628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:10.113490 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:10.113968 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_activity_type.69907e08a2"
[0m14:08:10.114373 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_type.69907e08a2: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_activities_activity_type.69907e08a2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_type
from "dev"."main"."stg_activities"
where activity_type is null



  
  
      
    ) dbt_internal_test
[0m14:08:10.115604 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:10.117188 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_type.69907e08a2: ROLLBACK
[0m14:08:10.117840 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_activities_activity_type.69907e08a2'
[0m14:08:10.118227 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_type.69907e08a2: Close
[0m14:08:10.118859 [info ] [Thread-1 (]: 5 of 16 PASS not_null_stg_activities_activity_type ............................. [[32mPASS[0m in 0.02s]
[0m14:08:10.119749 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_activities_activity_type.69907e08a2
[0m14:08:10.120301 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_activities_patient_id.199695ff40
[0m14:08:10.120815 [info ] [Thread-1 (]: 6 of 16 START test not_null_stg_activities_patient_id .......................... [RUN]
[0m14:08:10.121796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_activities_activity_type.69907e08a2, now test.suvera.not_null_stg_activities_patient_id.199695ff40)
[0m14:08:10.122625 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_activities_patient_id.199695ff40
[0m14:08:10.129261 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_activities_patient_id.199695ff40"
[0m14:08:10.130273 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_activities_patient_id.199695ff40
[0m14:08:10.133715 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_activities_patient_id.199695ff40"
[0m14:08:10.134600 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_patient_id.199695ff40"
[0m14:08:10.135034 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_patient_id.199695ff40: BEGIN
[0m14:08:10.135418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:10.136300 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:10.136986 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_patient_id.199695ff40"
[0m14:08:10.137537 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_patient_id.199695ff40: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_activities_patient_id.199695ff40"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "dev"."main"."stg_activities"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m14:08:10.142599 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:08:10.145035 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_patient_id.199695ff40: ROLLBACK
[0m14:08:10.145797 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_activities_patient_id.199695ff40'
[0m14:08:10.146201 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_patient_id.199695ff40: Close
[0m14:08:10.146869 [info ] [Thread-1 (]: 6 of 16 PASS not_null_stg_activities_patient_id ................................ [[32mPASS[0m in 0.03s]
[0m14:08:10.147519 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_activities_patient_id.199695ff40
[0m14:08:10.147951 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_age.7a0c6139fb
[0m14:08:10.148353 [info ] [Thread-1 (]: 7 of 16 START test not_null_stg_patients_age ................................... [RUN]
[0m14:08:10.148903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_activities_patient_id.199695ff40, now test.suvera.not_null_stg_patients_age.7a0c6139fb)
[0m14:08:10.149320 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_age.7a0c6139fb
[0m14:08:10.152981 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_age.7a0c6139fb"
[0m14:08:10.153738 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_age.7a0c6139fb
[0m14:08:10.156983 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_age.7a0c6139fb"
[0m14:08:10.158617 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_age.7a0c6139fb"
[0m14:08:10.159633 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_age.7a0c6139fb: BEGIN
[0m14:08:10.160782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:10.161831 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:10.162272 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_age.7a0c6139fb"
[0m14:08:10.162667 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_age.7a0c6139fb: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_age.7a0c6139fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select age
from "dev"."main"."stg_patients"
where age is null



  
  
      
    ) dbt_internal_test
[0m14:08:10.166879 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:08:10.169267 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_age.7a0c6139fb: ROLLBACK
[0m14:08:10.170023 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_age.7a0c6139fb'
[0m14:08:10.170424 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_age.7a0c6139fb: Close
[0m14:08:10.171075 [info ] [Thread-1 (]: 7 of 16 PASS not_null_stg_patients_age ......................................... [[32mPASS[0m in 0.02s]
[0m14:08:10.171947 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_age.7a0c6139fb
[0m14:08:10.172800 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_email.ce8e444e21
[0m14:08:10.174163 [info ] [Thread-1 (]: 8 of 16 START test not_null_stg_patients_email ................................. [RUN]
[0m14:08:10.174806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_age.7a0c6139fb, now test.suvera.not_null_stg_patients_email.ce8e444e21)
[0m14:08:10.175285 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_email.ce8e444e21
[0m14:08:10.179676 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_email.ce8e444e21"
[0m14:08:10.180604 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_email.ce8e444e21
[0m14:08:10.182867 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_email.ce8e444e21"
[0m14:08:10.183671 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_email.ce8e444e21"
[0m14:08:10.184121 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_email.ce8e444e21: BEGIN
[0m14:08:10.184547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:10.185278 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:10.185692 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_email.ce8e444e21"
[0m14:08:10.186100 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_email.ce8e444e21: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_email.ce8e444e21"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from "dev"."main"."stg_patients"
where email is null



  
  
      
    ) dbt_internal_test
[0m14:08:10.187956 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:10.190603 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_email.ce8e444e21: ROLLBACK
[0m14:08:10.192142 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_email.ce8e444e21'
[0m14:08:10.193129 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_email.ce8e444e21: Close
[0m14:08:10.194234 [info ] [Thread-1 (]: 8 of 16 PASS not_null_stg_patients_email ....................................... [[32mPASS[0m in 0.02s]
[0m14:08:10.195163 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_email.ce8e444e21
[0m14:08:10.195652 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_patient_id.e578180344
[0m14:08:10.196053 [info ] [Thread-1 (]: 9 of 16 START test not_null_stg_patients_patient_id ............................ [RUN]
[0m14:08:10.196818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_email.ce8e444e21, now test.suvera.not_null_stg_patients_patient_id.e578180344)
[0m14:08:10.197390 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_patient_id.e578180344
[0m14:08:10.207397 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_patient_id.e578180344"
[0m14:08:10.209333 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_patient_id.e578180344
[0m14:08:10.212489 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_patient_id.e578180344"
[0m14:08:10.213545 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_patient_id.e578180344"
[0m14:08:10.213978 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_patient_id.e578180344: BEGIN
[0m14:08:10.214349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:10.215252 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:10.215846 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_patient_id.e578180344"
[0m14:08:10.216295 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_patient_id.e578180344: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_patient_id.e578180344"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "dev"."main"."stg_patients"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m14:08:10.218681 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:08:10.221134 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_patient_id.e578180344: ROLLBACK
[0m14:08:10.222625 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_patient_id.e578180344'
[0m14:08:10.223397 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_patient_id.e578180344: Close
[0m14:08:10.224566 [info ] [Thread-1 (]: 9 of 16 PASS not_null_stg_patients_patient_id .................................. [[32mPASS[0m in 0.03s]
[0m14:08:10.225356 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_patient_id.e578180344
[0m14:08:10.225981 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_phone.4e628022ba
[0m14:08:10.226536 [info ] [Thread-1 (]: 10 of 16 START test not_null_stg_patients_phone ................................ [RUN]
[0m14:08:10.227164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_patient_id.e578180344, now test.suvera.not_null_stg_patients_phone.4e628022ba)
[0m14:08:10.227798 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_phone.4e628022ba
[0m14:08:10.233926 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_phone.4e628022ba"
[0m14:08:10.234789 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_phone.4e628022ba
[0m14:08:10.307750 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_phone.4e628022ba"
[0m14:08:10.308887 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_phone.4e628022ba"
[0m14:08:10.309421 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_phone.4e628022ba: BEGIN
[0m14:08:10.309928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:10.310796 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:10.311308 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_phone.4e628022ba"
[0m14:08:10.311814 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_phone.4e628022ba: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_phone.4e628022ba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select phone
from "dev"."main"."stg_patients"
where phone is null



  
  
      
    ) dbt_internal_test
[0m14:08:10.314066 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:08:10.316087 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_phone.4e628022ba: ROLLBACK
[0m14:08:10.316918 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_phone.4e628022ba'
[0m14:08:10.317428 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_phone.4e628022ba: Close
[0m14:08:10.318233 [info ] [Thread-1 (]: 10 of 16 PASS not_null_stg_patients_phone ...................................... [[32mPASS[0m in 0.09s]
[0m14:08:10.319070 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_phone.4e628022ba
[0m14:08:10.319736 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3
[0m14:08:10.320353 [info ] [Thread-1 (]: 11 of 16 START test not_null_stg_patients_practice_id .......................... [RUN]
[0m14:08:10.322263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_phone.4e628022ba, now test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3)
[0m14:08:10.322910 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3
[0m14:08:10.329345 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3"
[0m14:08:10.330627 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3
[0m14:08:10.334253 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3"
[0m14:08:10.335349 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3"
[0m14:08:10.335935 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3: BEGIN
[0m14:08:10.336403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:10.337184 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:10.337670 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3"
[0m14:08:10.338129 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select practice_id
from "dev"."main"."stg_patients"
where practice_id is null



  
  
      
    ) dbt_internal_test
[0m14:08:10.342268 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:08:10.344449 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3: ROLLBACK
[0m14:08:10.345201 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3'
[0m14:08:10.345620 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3: Close
[0m14:08:10.346356 [info ] [Thread-1 (]: 11 of 16 PASS not_null_stg_patients_practice_id ................................ [[32mPASS[0m in 0.02s]
[0m14:08:10.347077 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3
[0m14:08:10.347546 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_registration_date.51d8eb4a55
[0m14:08:10.348049 [info ] [Thread-1 (]: 12 of 16 START test not_null_stg_patients_registration_date .................... [RUN]
[0m14:08:10.348585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3, now test.suvera.not_null_stg_patients_registration_date.51d8eb4a55)
[0m14:08:10.349023 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_registration_date.51d8eb4a55
[0m14:08:10.353041 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_registration_date.51d8eb4a55"
[0m14:08:10.353906 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_registration_date.51d8eb4a55
[0m14:08:10.357395 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_registration_date.51d8eb4a55"
[0m14:08:10.359437 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_registration_date.51d8eb4a55"
[0m14:08:10.360072 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_registration_date.51d8eb4a55: BEGIN
[0m14:08:10.360495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:10.361297 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:10.361805 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_registration_date.51d8eb4a55"
[0m14:08:10.362256 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_registration_date.51d8eb4a55: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_registration_date.51d8eb4a55"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select registration_date
from "dev"."main"."stg_patients"
where registration_date is null



  
  
      
    ) dbt_internal_test
[0m14:08:10.364564 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:08:10.366612 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_registration_date.51d8eb4a55: ROLLBACK
[0m14:08:10.367432 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_registration_date.51d8eb4a55'
[0m14:08:10.367876 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_registration_date.51d8eb4a55: Close
[0m14:08:10.368638 [info ] [Thread-1 (]: 12 of 16 PASS not_null_stg_patients_registration_date .......................... [[32mPASS[0m in 0.02s]
[0m14:08:10.369565 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_registration_date.51d8eb4a55
[0m14:08:10.370175 [debug] [Thread-1 (]: Began running node test.suvera.unique_my_first_dbt_model_id.16e066b321
[0m14:08:10.370870 [info ] [Thread-1 (]: 13 of 16 START test unique_my_first_dbt_model_id ............................... [RUN]
[0m14:08:10.371835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_registration_date.51d8eb4a55, now test.suvera.unique_my_first_dbt_model_id.16e066b321)
[0m14:08:10.372613 [debug] [Thread-1 (]: Began compiling node test.suvera.unique_my_first_dbt_model_id.16e066b321
[0m14:08:10.381412 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.unique_my_first_dbt_model_id.16e066b321"
[0m14:08:10.382308 [debug] [Thread-1 (]: Began executing node test.suvera.unique_my_first_dbt_model_id.16e066b321
[0m14:08:10.384616 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.unique_my_first_dbt_model_id.16e066b321"
[0m14:08:10.385484 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.unique_my_first_dbt_model_id.16e066b321"
[0m14:08:10.385911 [debug] [Thread-1 (]: On test.suvera.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m14:08:10.386302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:10.387068 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:10.387534 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.unique_my_first_dbt_model_id.16e066b321"
[0m14:08:10.387948 [debug] [Thread-1 (]: On test.suvera.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.unique_my_first_dbt_model_id.16e066b321"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."main"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:08:10.389046 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.unique_my_first_dbt_model_id.16e066b321"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."main"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:08:10.389568 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m14:08:10.390179 [debug] [Thread-1 (]: On test.suvera.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m14:08:10.395903 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.unique_my_first_dbt_model_id.16e066b321'
[0m14:08:10.396503 [debug] [Thread-1 (]: On test.suvera.unique_my_first_dbt_model_id.16e066b321: Close
[0m14:08:10.400804 [debug] [Thread-1 (]: Runtime Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  Catalog Error: Table with name my_first_dbt_model does not exist!
  Did you mean "raw_patients"?
  
  LINE 18: from "dev"."main"."my_first_dbt_model"
                ^
[0m14:08:10.401331 [error] [Thread-1 (]: 13 of 16 ERROR unique_my_first_dbt_model_id .................................... [[31mERROR[0m in 0.03s]
[0m14:08:10.402052 [debug] [Thread-1 (]: Finished running node test.suvera.unique_my_first_dbt_model_id.16e066b321
[0m14:08:10.402477 [debug] [Thread-1 (]: Began running node test.suvera.unique_my_second_dbt_model_id.57a0f8c493
[0m14:08:10.402875 [info ] [Thread-1 (]: 14 of 16 START test unique_my_second_dbt_model_id .............................. [RUN]
[0m14:08:10.403613 [debug] [Thread-4 (]: Marking all children of 'test.suvera.unique_my_first_dbt_model_id.16e066b321' to be skipped because of status 'error'.  Reason: Runtime Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  Catalog Error: Table with name my_first_dbt_model does not exist!
  Did you mean "raw_patients"?
  
  LINE 18: from "dev"."main"."my_first_dbt_model"
                ^.
[0m14:08:10.404045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.unique_my_first_dbt_model_id.16e066b321, now test.suvera.unique_my_second_dbt_model_id.57a0f8c493)
[0m14:08:10.404536 [debug] [Thread-1 (]: Began compiling node test.suvera.unique_my_second_dbt_model_id.57a0f8c493
[0m14:08:10.410588 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:08:10.411965 [debug] [Thread-1 (]: Began executing node test.suvera.unique_my_second_dbt_model_id.57a0f8c493
[0m14:08:10.415258 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:08:10.416237 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:08:10.416705 [debug] [Thread-1 (]: On test.suvera.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m14:08:10.417150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:10.417978 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:10.418850 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:08:10.419524 [debug] [Thread-1 (]: On test.suvera.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.unique_my_second_dbt_model_id.57a0f8c493"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."main"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:08:10.420517 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.unique_my_second_dbt_model_id.57a0f8c493"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."main"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:08:10.420952 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m14:08:10.421448 [debug] [Thread-1 (]: On test.suvera.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m14:08:10.427237 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.unique_my_second_dbt_model_id.57a0f8c493'
[0m14:08:10.428212 [debug] [Thread-1 (]: On test.suvera.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m14:08:10.432924 [debug] [Thread-1 (]: Runtime Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  Catalog Error: Table with name my_second_dbt_model does not exist!
  Did you mean "raw_patients"?
  
  LINE 18: from "dev"."main"."my_second_dbt_model"
                ^
[0m14:08:10.433561 [error] [Thread-1 (]: 14 of 16 ERROR unique_my_second_dbt_model_id ................................... [[31mERROR[0m in 0.03s]
[0m14:08:10.434251 [debug] [Thread-1 (]: Finished running node test.suvera.unique_my_second_dbt_model_id.57a0f8c493
[0m14:08:10.434724 [debug] [Thread-1 (]: Began running node test.suvera.unique_stg_activities_activity_id.896c965cc8
[0m14:08:10.435647 [debug] [Thread-4 (]: Marking all children of 'test.suvera.unique_my_second_dbt_model_id.57a0f8c493' to be skipped because of status 'error'.  Reason: Runtime Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  Catalog Error: Table with name my_second_dbt_model does not exist!
  Did you mean "raw_patients"?
  
  LINE 18: from "dev"."main"."my_second_dbt_model"
                ^.
[0m14:08:10.435140 [info ] [Thread-1 (]: 15 of 16 START test unique_stg_activities_activity_id .......................... [RUN]
[0m14:08:10.436494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.unique_my_second_dbt_model_id.57a0f8c493, now test.suvera.unique_stg_activities_activity_id.896c965cc8)
[0m14:08:10.436971 [debug] [Thread-1 (]: Began compiling node test.suvera.unique_stg_activities_activity_id.896c965cc8
[0m14:08:10.441676 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.unique_stg_activities_activity_id.896c965cc8"
[0m14:08:10.443678 [debug] [Thread-1 (]: Began executing node test.suvera.unique_stg_activities_activity_id.896c965cc8
[0m14:08:10.446830 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.unique_stg_activities_activity_id.896c965cc8"
[0m14:08:10.447810 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.unique_stg_activities_activity_id.896c965cc8"
[0m14:08:10.448275 [debug] [Thread-1 (]: On test.suvera.unique_stg_activities_activity_id.896c965cc8: BEGIN
[0m14:08:10.448703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:10.449462 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:10.449896 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.unique_stg_activities_activity_id.896c965cc8"
[0m14:08:10.450292 [debug] [Thread-1 (]: On test.suvera.unique_stg_activities_activity_id.896c965cc8: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.unique_stg_activities_activity_id.896c965cc8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_activities"
where activity_id is not null
group by activity_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:08:10.453013 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:08:10.455380 [debug] [Thread-1 (]: On test.suvera.unique_stg_activities_activity_id.896c965cc8: ROLLBACK
[0m14:08:10.456171 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.unique_stg_activities_activity_id.896c965cc8'
[0m14:08:10.456647 [debug] [Thread-1 (]: On test.suvera.unique_stg_activities_activity_id.896c965cc8: Close
[0m14:08:10.457694 [info ] [Thread-1 (]: 15 of 16 PASS unique_stg_activities_activity_id ................................ [[32mPASS[0m in 0.02s]
[0m14:08:10.459208 [debug] [Thread-1 (]: Finished running node test.suvera.unique_stg_activities_activity_id.896c965cc8
[0m14:08:10.459904 [debug] [Thread-1 (]: Began running node test.suvera.unique_stg_patients_patient_id.8907d3ccf0
[0m14:08:10.460541 [info ] [Thread-1 (]: 16 of 16 START test unique_stg_patients_patient_id ............................. [RUN]
[0m14:08:10.461634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.unique_stg_activities_activity_id.896c965cc8, now test.suvera.unique_stg_patients_patient_id.8907d3ccf0)
[0m14:08:10.462148 [debug] [Thread-1 (]: Began compiling node test.suvera.unique_stg_patients_patient_id.8907d3ccf0
[0m14:08:10.466567 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.unique_stg_patients_patient_id.8907d3ccf0"
[0m14:08:10.467493 [debug] [Thread-1 (]: Began executing node test.suvera.unique_stg_patients_patient_id.8907d3ccf0
[0m14:08:10.469900 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.unique_stg_patients_patient_id.8907d3ccf0"
[0m14:08:10.470857 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.unique_stg_patients_patient_id.8907d3ccf0"
[0m14:08:10.471319 [debug] [Thread-1 (]: On test.suvera.unique_stg_patients_patient_id.8907d3ccf0: BEGIN
[0m14:08:10.471732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:10.472515 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:10.472971 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.unique_stg_patients_patient_id.8907d3ccf0"
[0m14:08:10.473403 [debug] [Thread-1 (]: On test.suvera.unique_stg_patients_patient_id.8907d3ccf0: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.unique_stg_patients_patient_id.8907d3ccf0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_patients"
where patient_id is not null
group by patient_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:08:10.477614 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:08:10.479862 [debug] [Thread-1 (]: On test.suvera.unique_stg_patients_patient_id.8907d3ccf0: ROLLBACK
[0m14:08:10.480714 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.unique_stg_patients_patient_id.8907d3ccf0'
[0m14:08:10.481164 [debug] [Thread-1 (]: On test.suvera.unique_stg_patients_patient_id.8907d3ccf0: Close
[0m14:08:10.481865 [error] [Thread-1 (]: 16 of 16 FAIL 6 unique_stg_patients_patient_id ................................. [[31mFAIL 6[0m in 0.02s]
[0m14:08:10.482595 [debug] [Thread-1 (]: Finished running node test.suvera.unique_stg_patients_patient_id.8907d3ccf0
[0m14:08:10.484096 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:10.484655 [debug] [MainThread]: On master: BEGIN
[0m14:08:10.485073 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:08:10.485820 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:08:10.486203 [debug] [MainThread]: On master: COMMIT
[0m14:08:10.486555 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:10.486886 [debug] [MainThread]: On master: COMMIT
[0m14:08:10.487441 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:08:10.488010 [debug] [MainThread]: On master: Close
[0m14:08:10.488617 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:08:10.489409 [debug] [MainThread]: Connection 'test.suvera.unique_stg_patients_patient_id.8907d3ccf0' was properly closed.
[0m14:08:10.490067 [info ] [MainThread]: 
[0m14:08:10.490508 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m14:08:10.494743 [debug] [MainThread]: Command end result
[0m14:08:10.522056 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m14:08:10.525395 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m14:08:10.535452 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m14:08:10.535884 [info ] [MainThread]: 
[0m14:08:10.536307 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m14:08:10.536678 [info ] [MainThread]: 
[0m14:08:10.537121 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m14:08:10.537558 [error] [MainThread]:   Runtime Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  Catalog Error: Table with name my_first_dbt_model does not exist!
  Did you mean "raw_patients"?
  
  LINE 17: from "dev"."main"."my_first_dbt_model"
                ^
[0m14:08:10.537993 [info ] [MainThread]: 
[0m14:08:10.538474 [info ] [MainThread]:   compiled code at target/compiled/suvera/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m14:08:10.538845 [info ] [MainThread]: 
[0m14:08:10.539270 [error] [MainThread]: [31mFailure in test not_null_my_second_dbt_model_id (models/example/schema.yml)[0m
[0m14:08:10.539688 [error] [MainThread]:   Runtime Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  Catalog Error: Table with name my_second_dbt_model does not exist!
  Did you mean "raw_patients"?
  
  LINE 17: from "dev"."main"."my_second_dbt_model"
                ^
[0m14:08:10.540030 [info ] [MainThread]: 
[0m14:08:10.540430 [info ] [MainThread]:   compiled code at target/compiled/suvera/models/example/schema.yml/not_null_my_second_dbt_model_id.sql
[0m14:08:10.540776 [info ] [MainThread]: 
[0m14:08:10.541190 [error] [MainThread]: [31mFailure in test unique_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m14:08:10.541683 [error] [MainThread]:   Runtime Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  Catalog Error: Table with name my_first_dbt_model does not exist!
  Did you mean "raw_patients"?
  
  LINE 18: from "dev"."main"."my_first_dbt_model"
                ^
[0m14:08:10.542115 [info ] [MainThread]: 
[0m14:08:10.542785 [info ] [MainThread]:   compiled code at target/compiled/suvera/models/example/schema.yml/unique_my_first_dbt_model_id.sql
[0m14:08:10.543393 [info ] [MainThread]: 
[0m14:08:10.543940 [error] [MainThread]: [31mFailure in test unique_my_second_dbt_model_id (models/example/schema.yml)[0m
[0m14:08:10.544389 [error] [MainThread]:   Runtime Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  Catalog Error: Table with name my_second_dbt_model does not exist!
  Did you mean "raw_patients"?
  
  LINE 18: from "dev"."main"."my_second_dbt_model"
                ^
[0m14:08:10.544815 [info ] [MainThread]: 
[0m14:08:10.545314 [info ] [MainThread]:   compiled code at target/compiled/suvera/models/example/schema.yml/unique_my_second_dbt_model_id.sql
[0m14:08:10.545708 [info ] [MainThread]: 
[0m14:08:10.546169 [error] [MainThread]: [31mFailure in test unique_stg_patients_patient_id (models/staging/schema.yml)[0m
[0m14:08:10.546765 [error] [MainThread]:   Got 6 results, configured to fail if != 0
[0m14:08:10.547380 [info ] [MainThread]: 
[0m14:08:10.548030 [info ] [MainThread]:   compiled code at target/compiled/suvera/models/staging/schema.yml/unique_stg_patients_patient_id.sql
[0m14:08:10.549454 [info ] [MainThread]: 
[0m14:08:10.550500 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=5 SKIP=0 NO-OP=0 TOTAL=16
[0m14:08:10.555164 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.8930836, "process_in_blocks": "0", "process_kernel_time": 0.67162, "process_mem_max_rss": "137203712", "process_out_blocks": "0", "process_user_time": 3.43047}
[0m14:08:10.556268 [debug] [MainThread]: Command `dbt test` failed at 14:08:10.556072 after 1.89 seconds
[0m14:08:10.556822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112559a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131e4940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131e49f0>]}
[0m14:08:10.557456 [debug] [MainThread]: Flushing usage events
[0m14:08:10.912118 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:08:44.690377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109eedd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acc7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acc7750>]}


============================== 14:08:44.699211 | e0a5866b-088b-4f18-a4d3-6df1bdf96a4f ==============================
[0m14:08:44.699211 [info ] [MainThread]: Running with dbt=1.10.1
[0m14:08:44.700194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test --select stg_patients stg_activities', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:08:45.098447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0a5866b-088b-4f18-a4d3-6df1bdf96a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1a1220>]}
[0m14:08:45.170902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0a5866b-088b-4f18-a4d3-6df1bdf96a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abb3130>]}
[0m14:08:45.204585 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m14:08:45.333331 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m14:08:45.547734 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:08:45.548175 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:08:45.602914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0a5866b-088b-4f18-a4d3-6df1bdf96a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0db050>]}
[0m14:08:45.696316 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m14:08:45.701274 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m14:08:45.754566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0a5866b-088b-4f18-a4d3-6df1bdf96a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b31ad50>]}
[0m14:08:45.755138 [info ] [MainThread]: Found 4 models, 4 seeds, 16 data tests, 428 macros
[0m14:08:45.755600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0a5866b-088b-4f18-a4d3-6df1bdf96a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3e8f30>]}
[0m14:08:45.758211 [info ] [MainThread]: 
[0m14:08:45.758771 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:08:45.759220 [info ] [MainThread]: 
[0m14:08:45.760046 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:08:45.767319 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m14:08:45.845458 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:08:45.845969 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:08:45.846365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:45.868248 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m14:08:45.868714 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:08:45.869044 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m14:08:45.883356 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m14:08:45.885054 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:08:45.887018 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:08:45.887511 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:08:45.889840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0a5866b-088b-4f18-a4d3-6df1bdf96a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5d6410>]}
[0m14:08:45.890417 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:45.890798 [debug] [MainThread]: On master: BEGIN
[0m14:08:45.891158 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:08:45.891844 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:08:45.892247 [debug] [MainThread]: On master: COMMIT
[0m14:08:45.892631 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:45.892997 [debug] [MainThread]: On master: COMMIT
[0m14:08:45.893534 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:08:45.893933 [debug] [MainThread]: On master: Close
[0m14:08:45.897434 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_activities_activity_date.51ab13376e
[0m14:08:45.898047 [info ] [Thread-1 (]: 1 of 12 START test not_null_stg_activities_activity_date ....................... [RUN]
[0m14:08:45.898651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now test.suvera.not_null_stg_activities_activity_date.51ab13376e)
[0m14:08:45.899176 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_activities_activity_date.51ab13376e
[0m14:08:45.919688 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_activities_activity_date.51ab13376e"
[0m14:08:45.921271 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_activities_activity_date.51ab13376e
[0m14:08:45.941987 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_activities_activity_date.51ab13376e"
[0m14:08:45.942944 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_activity_date.51ab13376e"
[0m14:08:45.943354 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_date.51ab13376e: BEGIN
[0m14:08:45.943726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:45.944456 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:45.944858 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_activity_date.51ab13376e"
[0m14:08:45.945256 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_date.51ab13376e: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_activities_activity_date.51ab13376e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_date
from "dev"."main"."stg_activities"
where activity_date is null



  
  
      
    ) dbt_internal_test
[0m14:08:45.946635 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:45.951011 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_date.51ab13376e: ROLLBACK
[0m14:08:45.951707 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_activities_activity_date.51ab13376e'
[0m14:08:45.952096 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_date.51ab13376e: Close
[0m14:08:45.952764 [info ] [Thread-1 (]: 1 of 12 PASS not_null_stg_activities_activity_date ............................. [[32mPASS[0m in 0.05s]
[0m14:08:45.953775 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_activities_activity_date.51ab13376e
[0m14:08:45.954243 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a
[0m14:08:45.954799 [info ] [Thread-1 (]: 2 of 12 START test not_null_stg_activities_activity_id ......................... [RUN]
[0m14:08:45.955717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_activities_activity_date.51ab13376e, now test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a)
[0m14:08:45.956137 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a
[0m14:08:45.960542 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a"
[0m14:08:45.961465 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a
[0m14:08:45.964121 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a"
[0m14:08:45.964862 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a"
[0m14:08:45.965263 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a: BEGIN
[0m14:08:45.965638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:45.966380 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:45.966784 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a"
[0m14:08:45.967173 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_id
from "dev"."main"."stg_activities"
where activity_id is null



  
  
      
    ) dbt_internal_test
[0m14:08:45.968376 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:45.969973 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a: ROLLBACK
[0m14:08:45.970634 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a'
[0m14:08:45.971021 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a: Close
[0m14:08:45.971649 [info ] [Thread-1 (]: 2 of 12 PASS not_null_stg_activities_activity_id ............................... [[32mPASS[0m in 0.02s]
[0m14:08:45.972573 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a
[0m14:08:45.973101 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_activities_activity_type.69907e08a2
[0m14:08:45.973889 [info ] [Thread-1 (]: 3 of 12 START test not_null_stg_activities_activity_type ....................... [RUN]
[0m14:08:45.974999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a, now test.suvera.not_null_stg_activities_activity_type.69907e08a2)
[0m14:08:45.975479 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_activities_activity_type.69907e08a2
[0m14:08:45.980947 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_activities_activity_type.69907e08a2"
[0m14:08:45.981762 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_activities_activity_type.69907e08a2
[0m14:08:45.983849 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_activities_activity_type.69907e08a2"
[0m14:08:45.984587 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_activity_type.69907e08a2"
[0m14:08:45.984995 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_type.69907e08a2: BEGIN
[0m14:08:45.985362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:45.986510 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:45.986901 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_activity_type.69907e08a2"
[0m14:08:45.987295 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_type.69907e08a2: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_activities_activity_type.69907e08a2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_type
from "dev"."main"."stg_activities"
where activity_type is null



  
  
      
    ) dbt_internal_test
[0m14:08:45.988577 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:45.990333 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_type.69907e08a2: ROLLBACK
[0m14:08:45.991181 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_activities_activity_type.69907e08a2'
[0m14:08:45.991893 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_type.69907e08a2: Close
[0m14:08:45.992962 [info ] [Thread-1 (]: 3 of 12 PASS not_null_stg_activities_activity_type ............................. [[32mPASS[0m in 0.02s]
[0m14:08:45.994095 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_activities_activity_type.69907e08a2
[0m14:08:45.994897 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_activities_patient_id.199695ff40
[0m14:08:45.995704 [info ] [Thread-1 (]: 4 of 12 START test not_null_stg_activities_patient_id .......................... [RUN]
[0m14:08:45.996688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_activities_activity_type.69907e08a2, now test.suvera.not_null_stg_activities_patient_id.199695ff40)
[0m14:08:45.997157 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_activities_patient_id.199695ff40
[0m14:08:46.001475 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_activities_patient_id.199695ff40"
[0m14:08:46.002349 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_activities_patient_id.199695ff40
[0m14:08:46.004582 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_activities_patient_id.199695ff40"
[0m14:08:46.005518 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_patient_id.199695ff40"
[0m14:08:46.005988 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_patient_id.199695ff40: BEGIN
[0m14:08:46.006367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:46.007276 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:46.007810 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_patient_id.199695ff40"
[0m14:08:46.008271 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_patient_id.199695ff40: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_activities_patient_id.199695ff40"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "dev"."main"."stg_activities"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m14:08:46.012764 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:08:46.014577 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_patient_id.199695ff40: ROLLBACK
[0m14:08:46.015262 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_activities_patient_id.199695ff40'
[0m14:08:46.015656 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_patient_id.199695ff40: Close
[0m14:08:46.016285 [info ] [Thread-1 (]: 4 of 12 PASS not_null_stg_activities_patient_id ................................ [[32mPASS[0m in 0.02s]
[0m14:08:46.016927 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_activities_patient_id.199695ff40
[0m14:08:46.017361 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_age.7a0c6139fb
[0m14:08:46.017766 [info ] [Thread-1 (]: 5 of 12 START test not_null_stg_patients_age ................................... [RUN]
[0m14:08:46.018300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_activities_patient_id.199695ff40, now test.suvera.not_null_stg_patients_age.7a0c6139fb)
[0m14:08:46.018716 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_age.7a0c6139fb
[0m14:08:46.023429 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_age.7a0c6139fb"
[0m14:08:46.024578 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_age.7a0c6139fb
[0m14:08:46.027265 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_age.7a0c6139fb"
[0m14:08:46.028160 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_age.7a0c6139fb"
[0m14:08:46.028561 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_age.7a0c6139fb: BEGIN
[0m14:08:46.028933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:46.029604 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:46.030017 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_age.7a0c6139fb"
[0m14:08:46.030411 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_age.7a0c6139fb: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_age.7a0c6139fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select age
from "dev"."main"."stg_patients"
where age is null



  
  
      
    ) dbt_internal_test
[0m14:08:46.032415 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:08:46.034061 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_age.7a0c6139fb: ROLLBACK
[0m14:08:46.034720 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_age.7a0c6139fb'
[0m14:08:46.035096 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_age.7a0c6139fb: Close
[0m14:08:46.035973 [info ] [Thread-1 (]: 5 of 12 PASS not_null_stg_patients_age ......................................... [[32mPASS[0m in 0.02s]
[0m14:08:46.036661 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_age.7a0c6139fb
[0m14:08:46.037131 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_email.ce8e444e21
[0m14:08:46.037528 [info ] [Thread-1 (]: 6 of 12 START test not_null_stg_patients_email ................................. [RUN]
[0m14:08:46.038419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_age.7a0c6139fb, now test.suvera.not_null_stg_patients_email.ce8e444e21)
[0m14:08:46.038848 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_email.ce8e444e21
[0m14:08:46.044264 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_email.ce8e444e21"
[0m14:08:46.045229 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_email.ce8e444e21
[0m14:08:46.047917 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_email.ce8e444e21"
[0m14:08:46.048658 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_email.ce8e444e21"
[0m14:08:46.049071 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_email.ce8e444e21: BEGIN
[0m14:08:46.049454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:46.050158 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:46.050561 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_email.ce8e444e21"
[0m14:08:46.050955 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_email.ce8e444e21: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_email.ce8e444e21"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from "dev"."main"."stg_patients"
where email is null



  
  
      
    ) dbt_internal_test
[0m14:08:46.052758 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:46.054398 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_email.ce8e444e21: ROLLBACK
[0m14:08:46.055276 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_email.ce8e444e21'
[0m14:08:46.055930 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_email.ce8e444e21: Close
[0m14:08:46.056788 [info ] [Thread-1 (]: 6 of 12 PASS not_null_stg_patients_email ....................................... [[32mPASS[0m in 0.02s]
[0m14:08:46.058147 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_email.ce8e444e21
[0m14:08:46.059072 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_patient_id.e578180344
[0m14:08:46.060399 [info ] [Thread-1 (]: 7 of 12 START test not_null_stg_patients_patient_id ............................ [RUN]
[0m14:08:46.061409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_email.ce8e444e21, now test.suvera.not_null_stg_patients_patient_id.e578180344)
[0m14:08:46.061908 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_patient_id.e578180344
[0m14:08:46.066416 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_patient_id.e578180344"
[0m14:08:46.067257 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_patient_id.e578180344
[0m14:08:46.069330 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_patient_id.e578180344"
[0m14:08:46.070152 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_patient_id.e578180344"
[0m14:08:46.070579 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_patient_id.e578180344: BEGIN
[0m14:08:46.070955 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:46.071654 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:46.072080 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_patient_id.e578180344"
[0m14:08:46.072486 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_patient_id.e578180344: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_patient_id.e578180344"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "dev"."main"."stg_patients"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m14:08:46.074550 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:08:46.077740 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_patient_id.e578180344: ROLLBACK
[0m14:08:46.078770 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_patient_id.e578180344'
[0m14:08:46.079327 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_patient_id.e578180344: Close
[0m14:08:46.080187 [info ] [Thread-1 (]: 7 of 12 PASS not_null_stg_patients_patient_id .................................. [[32mPASS[0m in 0.02s]
[0m14:08:46.080997 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_patient_id.e578180344
[0m14:08:46.081423 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_phone.4e628022ba
[0m14:08:46.081813 [info ] [Thread-1 (]: 8 of 12 START test not_null_stg_patients_phone ................................. [RUN]
[0m14:08:46.082399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_patient_id.e578180344, now test.suvera.not_null_stg_patients_phone.4e628022ba)
[0m14:08:46.082793 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_phone.4e628022ba
[0m14:08:46.086987 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_phone.4e628022ba"
[0m14:08:46.087878 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_phone.4e628022ba
[0m14:08:46.090833 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_phone.4e628022ba"
[0m14:08:46.092394 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_phone.4e628022ba"
[0m14:08:46.093174 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_phone.4e628022ba: BEGIN
[0m14:08:46.093696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:46.094443 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:46.094880 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_phone.4e628022ba"
[0m14:08:46.095333 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_phone.4e628022ba: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_phone.4e628022ba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select phone
from "dev"."main"."stg_patients"
where phone is null



  
  
      
    ) dbt_internal_test
[0m14:08:46.097126 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:46.098809 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_phone.4e628022ba: ROLLBACK
[0m14:08:46.099516 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_phone.4e628022ba'
[0m14:08:46.099922 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_phone.4e628022ba: Close
[0m14:08:46.100568 [info ] [Thread-1 (]: 8 of 12 PASS not_null_stg_patients_phone ....................................... [[32mPASS[0m in 0.02s]
[0m14:08:46.101207 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_phone.4e628022ba
[0m14:08:46.101636 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3
[0m14:08:46.102037 [info ] [Thread-1 (]: 9 of 12 START test not_null_stg_patients_practice_id ........................... [RUN]
[0m14:08:46.102585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_phone.4e628022ba, now test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3)
[0m14:08:46.103005 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3
[0m14:08:46.113610 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3"
[0m14:08:46.114479 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3
[0m14:08:46.116564 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3"
[0m14:08:46.117264 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3"
[0m14:08:46.117657 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3: BEGIN
[0m14:08:46.118026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:46.118706 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:46.119105 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3"
[0m14:08:46.119501 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select practice_id
from "dev"."main"."stg_patients"
where practice_id is null



  
  
      
    ) dbt_internal_test
[0m14:08:46.121258 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:46.123021 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3: ROLLBACK
[0m14:08:46.124239 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3'
[0m14:08:46.124910 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3: Close
[0m14:08:46.125932 [info ] [Thread-1 (]: 9 of 12 PASS not_null_stg_patients_practice_id ................................. [[32mPASS[0m in 0.02s]
[0m14:08:46.127262 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3
[0m14:08:46.127912 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_registration_date.51d8eb4a55
[0m14:08:46.128572 [info ] [Thread-1 (]: 10 of 12 START test not_null_stg_patients_registration_date .................... [RUN]
[0m14:08:46.129336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3, now test.suvera.not_null_stg_patients_registration_date.51d8eb4a55)
[0m14:08:46.129788 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_registration_date.51d8eb4a55
[0m14:08:46.135211 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_registration_date.51d8eb4a55"
[0m14:08:46.136443 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_registration_date.51d8eb4a55
[0m14:08:46.209169 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_registration_date.51d8eb4a55"
[0m14:08:46.210300 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_registration_date.51d8eb4a55"
[0m14:08:46.210837 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_registration_date.51d8eb4a55: BEGIN
[0m14:08:46.211340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:46.212204 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:46.212725 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_registration_date.51d8eb4a55"
[0m14:08:46.213257 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_registration_date.51d8eb4a55: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_registration_date.51d8eb4a55"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select registration_date
from "dev"."main"."stg_patients"
where registration_date is null



  
  
      
    ) dbt_internal_test
[0m14:08:46.215594 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:08:46.217700 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_registration_date.51d8eb4a55: ROLLBACK
[0m14:08:46.218536 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_registration_date.51d8eb4a55'
[0m14:08:46.219040 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_registration_date.51d8eb4a55: Close
[0m14:08:46.219824 [info ] [Thread-1 (]: 10 of 12 PASS not_null_stg_patients_registration_date .......................... [[32mPASS[0m in 0.09s]
[0m14:08:46.220782 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_registration_date.51d8eb4a55
[0m14:08:46.221366 [debug] [Thread-1 (]: Began running node test.suvera.unique_stg_activities_activity_id.896c965cc8
[0m14:08:46.222024 [info ] [Thread-1 (]: 11 of 12 START test unique_stg_activities_activity_id .......................... [RUN]
[0m14:08:46.222720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_registration_date.51d8eb4a55, now test.suvera.unique_stg_activities_activity_id.896c965cc8)
[0m14:08:46.223275 [debug] [Thread-1 (]: Began compiling node test.suvera.unique_stg_activities_activity_id.896c965cc8
[0m14:08:46.232792 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.unique_stg_activities_activity_id.896c965cc8"
[0m14:08:46.233864 [debug] [Thread-1 (]: Began executing node test.suvera.unique_stg_activities_activity_id.896c965cc8
[0m14:08:46.236653 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.unique_stg_activities_activity_id.896c965cc8"
[0m14:08:46.237566 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.unique_stg_activities_activity_id.896c965cc8"
[0m14:08:46.238055 [debug] [Thread-1 (]: On test.suvera.unique_stg_activities_activity_id.896c965cc8: BEGIN
[0m14:08:46.238509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:46.239305 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:46.239878 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.unique_stg_activities_activity_id.896c965cc8"
[0m14:08:46.240668 [debug] [Thread-1 (]: On test.suvera.unique_stg_activities_activity_id.896c965cc8: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.unique_stg_activities_activity_id.896c965cc8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_activities"
where activity_id is not null
group by activity_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:08:46.244532 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:08:46.246603 [debug] [Thread-1 (]: On test.suvera.unique_stg_activities_activity_id.896c965cc8: ROLLBACK
[0m14:08:46.247378 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.unique_stg_activities_activity_id.896c965cc8'
[0m14:08:46.247802 [debug] [Thread-1 (]: On test.suvera.unique_stg_activities_activity_id.896c965cc8: Close
[0m14:08:46.248479 [info ] [Thread-1 (]: 11 of 12 PASS unique_stg_activities_activity_id ................................ [[32mPASS[0m in 0.03s]
[0m14:08:46.249162 [debug] [Thread-1 (]: Finished running node test.suvera.unique_stg_activities_activity_id.896c965cc8
[0m14:08:46.249619 [debug] [Thread-1 (]: Began running node test.suvera.unique_stg_patients_patient_id.8907d3ccf0
[0m14:08:46.250049 [info ] [Thread-1 (]: 12 of 12 START test unique_stg_patients_patient_id ............................. [RUN]
[0m14:08:46.250598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.unique_stg_activities_activity_id.896c965cc8, now test.suvera.unique_stg_patients_patient_id.8907d3ccf0)
[0m14:08:46.251026 [debug] [Thread-1 (]: Began compiling node test.suvera.unique_stg_patients_patient_id.8907d3ccf0
[0m14:08:46.255728 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.unique_stg_patients_patient_id.8907d3ccf0"
[0m14:08:46.256725 [debug] [Thread-1 (]: Began executing node test.suvera.unique_stg_patients_patient_id.8907d3ccf0
[0m14:08:46.259996 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.unique_stg_patients_patient_id.8907d3ccf0"
[0m14:08:46.261017 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.unique_stg_patients_patient_id.8907d3ccf0"
[0m14:08:46.261686 [debug] [Thread-1 (]: On test.suvera.unique_stg_patients_patient_id.8907d3ccf0: BEGIN
[0m14:08:46.262153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:46.262930 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:46.263386 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.unique_stg_patients_patient_id.8907d3ccf0"
[0m14:08:46.263824 [debug] [Thread-1 (]: On test.suvera.unique_stg_patients_patient_id.8907d3ccf0: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.unique_stg_patients_patient_id.8907d3ccf0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_patients"
where patient_id is not null
group by patient_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:08:46.266928 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:08:46.269099 [debug] [Thread-1 (]: On test.suvera.unique_stg_patients_patient_id.8907d3ccf0: ROLLBACK
[0m14:08:46.269937 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.unique_stg_patients_patient_id.8907d3ccf0'
[0m14:08:46.270501 [debug] [Thread-1 (]: On test.suvera.unique_stg_patients_patient_id.8907d3ccf0: Close
[0m14:08:46.271359 [error] [Thread-1 (]: 12 of 12 FAIL 6 unique_stg_patients_patient_id ................................. [[31mFAIL 6[0m in 0.02s]
[0m14:08:46.272456 [debug] [Thread-1 (]: Finished running node test.suvera.unique_stg_patients_patient_id.8907d3ccf0
[0m14:08:46.274519 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:46.274972 [debug] [MainThread]: On master: BEGIN
[0m14:08:46.275309 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:08:46.276036 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:08:46.276690 [debug] [MainThread]: On master: COMMIT
[0m14:08:46.277461 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:46.277962 [debug] [MainThread]: On master: COMMIT
[0m14:08:46.278671 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:08:46.279085 [debug] [MainThread]: On master: Close
[0m14:08:46.279570 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:08:46.279906 [debug] [MainThread]: Connection 'test.suvera.unique_stg_patients_patient_id.8907d3ccf0' was properly closed.
[0m14:08:46.280293 [info ] [MainThread]: 
[0m14:08:46.280688 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m14:08:46.283296 [debug] [MainThread]: Command end result
[0m14:08:46.311536 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m14:08:46.314646 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m14:08:46.323415 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m14:08:46.323854 [info ] [MainThread]: 
[0m14:08:46.324288 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:08:46.324670 [info ] [MainThread]: 
[0m14:08:46.325106 [error] [MainThread]: [31mFailure in test unique_stg_patients_patient_id (models/staging/schema.yml)[0m
[0m14:08:46.325524 [error] [MainThread]:   Got 6 results, configured to fail if != 0
[0m14:08:46.325866 [info ] [MainThread]: 
[0m14:08:46.326273 [info ] [MainThread]:   compiled code at target/compiled/suvera/models/staging/schema.yml/unique_stg_patients_patient_id.sql
[0m14:08:46.326630 [info ] [MainThread]: 
[0m14:08:46.327023 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=12
[0m14:08:46.330805 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.7439531, "process_in_blocks": "0", "process_kernel_time": 0.684874, "process_mem_max_rss": "137138176", "process_out_blocks": "0", "process_user_time": 3.285776}
[0m14:08:46.331437 [debug] [MainThread]: Command `dbt test` failed at 14:08:46.331311 after 1.74 seconds
[0m14:08:46.331878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab75a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7e87e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7e8890>]}
[0m14:08:46.332294 [debug] [MainThread]: Flushing usage events
[0m14:08:46.693721 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:12:29.305554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aa5d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10687f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10687f750>]}


============================== 14:12:29.315506 | b3d38b45-1530-437b-8db3-0875fc622fe7 ==============================
[0m14:12:29.315506 [info ] [MainThread]: Running with dbt=1.10.1
[0m14:12:29.316474 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'debug': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt test --select stg_patients', 'send_anonymous_usage_stats': 'True'}
[0m14:12:29.728214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3d38b45-1530-437b-8db3-0875fc622fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d59220>]}
[0m14:12:29.808237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3d38b45-1530-437b-8db3-0875fc622fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10676b130>]}
[0m14:12:29.834789 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m14:12:29.977465 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m14:12:30.197548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:12:30.198523 [debug] [MainThread]: Partial parsing: updated file: suvera://models/staging/schema.yml
[0m14:12:30.710438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3d38b45-1530-437b-8db3-0875fc622fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107084b50>]}
[0m14:12:30.804363 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m14:12:30.809049 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m14:12:30.934173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3d38b45-1530-437b-8db3-0875fc622fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070cec60>]}
[0m14:12:30.934755 [info ] [MainThread]: Found 4 models, 4 seeds, 16 data tests, 428 macros
[0m14:12:30.935193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3d38b45-1530-437b-8db3-0875fc622fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eaf070>]}
[0m14:12:30.937493 [info ] [MainThread]: 
[0m14:12:30.937924 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:12:30.938309 [info ] [MainThread]: 
[0m14:12:30.938881 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:12:30.945528 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m14:12:31.026933 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:12:31.027573 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:12:31.028077 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:31.040626 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: BEGIN
[0m14:12:31.041077 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m14:12:31.042042 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:12:31.042359 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m14:12:31.042677 [info ] [MainThread]: 
[0m14:12:31.043071 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m14:12:31.043894 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/puneeth/Documents/suvera_dbt_project/suvera/dev.duckdb": Conflicting lock is held in /usr/local/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 20449) by user puneeth. See also https://duckdb.org/docs/stable/connect/concurrency
[0m14:12:31.048224 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.8428909, "process_in_blocks": "0", "process_kernel_time": 0.689306, "process_mem_max_rss": "129503232", "process_out_blocks": "0", "process_user_time": 3.4399}
[0m14:12:31.048985 [debug] [MainThread]: Command `dbt test` failed at 14:12:31.048837 after 1.84 seconds
[0m14:12:31.049481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072731e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10672da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107119d90>]}
[0m14:12:31.050100 [debug] [MainThread]: Flushing usage events
[0m14:12:31.439004 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:12:51.154679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104281d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10505b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10505b750>]}


============================== 14:12:51.163966 | 34dbfa80-c493-49bb-aea0-6b550dc9aee1 ==============================
[0m14:12:51.163966 [info ] [MainThread]: Running with dbt=1.10.1
[0m14:12:51.164941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select stg_patients', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:12:51.505298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34dbfa80-c493-49bb-aea0-6b550dc9aee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104535220>]}
[0m14:12:51.582482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34dbfa80-c493-49bb-aea0-6b550dc9aee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f47130>]}
[0m14:12:51.598924 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m14:12:51.752908 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m14:12:51.968206 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:12:51.968673 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:12:52.023550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34dbfa80-c493-49bb-aea0-6b550dc9aee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105473050>]}
[0m14:12:52.115385 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m14:12:52.118265 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m14:12:52.186709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34dbfa80-c493-49bb-aea0-6b550dc9aee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056bed50>]}
[0m14:12:52.187333 [info ] [MainThread]: Found 4 models, 4 seeds, 16 data tests, 428 macros
[0m14:12:52.187767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34dbfa80-c493-49bb-aea0-6b550dc9aee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10577cf30>]}
[0m14:12:52.190151 [info ] [MainThread]: 
[0m14:12:52.190580 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:12:52.190934 [info ] [MainThread]: 
[0m14:12:52.191582 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:12:52.199387 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m14:12:52.273044 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:12:52.273564 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:12:52.273982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:52.294941 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m14:12:52.295407 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:12:52.295746 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m14:12:52.310959 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m14:12:52.312771 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:12:52.314535 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:12:52.314920 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:12:52.316778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34dbfa80-c493-49bb-aea0-6b550dc9aee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059565b0>]}
[0m14:12:52.317264 [debug] [MainThread]: Using duckdb connection "master"
[0m14:12:52.317582 [debug] [MainThread]: On master: BEGIN
[0m14:12:52.317883 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:12:52.318631 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:12:52.318964 [debug] [MainThread]: On master: COMMIT
[0m14:12:52.319287 [debug] [MainThread]: Using duckdb connection "master"
[0m14:12:52.319767 [debug] [MainThread]: On master: COMMIT
[0m14:12:52.320271 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:12:52.320613 [debug] [MainThread]: On master: Close
[0m14:12:52.324364 [debug] [Thread-1 (]: Began running node test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b
[0m14:12:52.325047 [info ] [Thread-1 (]: 1 of 7 START test dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id  [RUN]
[0m14:12:52.325716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b)
[0m14:12:52.326328 [debug] [Thread-1 (]: Began compiling node test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b
[0m14:12:52.357555 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id (models/staging/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:12:52.358354 [error] [Thread-1 (]: 1 of 7 ERROR dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id  [[31mERROR[0m in 0.03s]
[0m14:12:52.359136 [debug] [Thread-1 (]: Finished running node test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b
[0m14:12:52.359576 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_age.7a0c6139fb
[0m14:12:52.359984 [info ] [Thread-1 (]: 2 of 7 START test not_null_stg_patients_age .................................... [RUN]
[0m14:12:52.360675 [debug] [Thread-4 (]: Marking all children of 'test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id (models/staging/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m14:12:52.361135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b, now test.suvera.not_null_stg_patients_age.7a0c6139fb)
[0m14:12:52.363022 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_age.7a0c6139fb
[0m14:12:52.373046 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_age.7a0c6139fb"
[0m14:12:52.374385 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_age.7a0c6139fb
[0m14:12:52.396962 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_age.7a0c6139fb"
[0m14:12:52.397899 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_age.7a0c6139fb"
[0m14:12:52.398401 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_age.7a0c6139fb: BEGIN
[0m14:12:52.398920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:52.399755 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:12:52.400165 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_age.7a0c6139fb"
[0m14:12:52.400560 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_age.7a0c6139fb: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_age.7a0c6139fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select age
from "dev"."main"."stg_patients"
where age is null



  
  
      
    ) dbt_internal_test
[0m14:12:52.403510 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:12:52.409365 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_age.7a0c6139fb: ROLLBACK
[0m14:12:52.410086 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_age.7a0c6139fb'
[0m14:12:52.410516 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_age.7a0c6139fb: Close
[0m14:12:52.411185 [info ] [Thread-1 (]: 2 of 7 PASS not_null_stg_patients_age .......................................... [[32mPASS[0m in 0.05s]
[0m14:12:52.412019 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_age.7a0c6139fb
[0m14:12:52.412488 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_email.ce8e444e21
[0m14:12:52.412883 [info ] [Thread-1 (]: 3 of 7 START test not_null_stg_patients_email .................................. [RUN]
[0m14:12:52.413586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_age.7a0c6139fb, now test.suvera.not_null_stg_patients_email.ce8e444e21)
[0m14:12:52.414115 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_email.ce8e444e21
[0m14:12:52.419216 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_email.ce8e444e21"
[0m14:12:52.420104 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_email.ce8e444e21
[0m14:12:52.423354 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_email.ce8e444e21"
[0m14:12:52.425009 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_email.ce8e444e21"
[0m14:12:52.425510 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_email.ce8e444e21: BEGIN
[0m14:12:52.425926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:52.426622 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:12:52.427022 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_email.ce8e444e21"
[0m14:12:52.427419 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_email.ce8e444e21: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_email.ce8e444e21"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from "dev"."main"."stg_patients"
where email is null



  
  
      
    ) dbt_internal_test
[0m14:12:52.429255 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:12:52.430959 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_email.ce8e444e21: ROLLBACK
[0m14:12:52.431622 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_email.ce8e444e21'
[0m14:12:52.432009 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_email.ce8e444e21: Close
[0m14:12:52.432640 [info ] [Thread-1 (]: 3 of 7 PASS not_null_stg_patients_email ........................................ [[32mPASS[0m in 0.02s]
[0m14:12:52.433283 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_email.ce8e444e21
[0m14:12:52.433708 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_patient_id.e578180344
[0m14:12:52.434103 [info ] [Thread-1 (]: 4 of 7 START test not_null_stg_patients_patient_id ............................. [RUN]
[0m14:12:52.434570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_email.ce8e444e21, now test.suvera.not_null_stg_patients_patient_id.e578180344)
[0m14:12:52.434980 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_patient_id.e578180344
[0m14:12:52.439931 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_patient_id.e578180344"
[0m14:12:52.441549 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_patient_id.e578180344
[0m14:12:52.444082 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_patient_id.e578180344"
[0m14:12:52.444843 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_patient_id.e578180344"
[0m14:12:52.445250 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_patient_id.e578180344: BEGIN
[0m14:12:52.445620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:52.446287 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:12:52.446684 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_patient_id.e578180344"
[0m14:12:52.447077 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_patient_id.e578180344: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_patient_id.e578180344"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "dev"."main"."stg_patients"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m14:12:52.448768 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:12:52.450398 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_patient_id.e578180344: ROLLBACK
[0m14:12:52.451058 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_patient_id.e578180344'
[0m14:12:52.451516 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_patient_id.e578180344: Close
[0m14:12:52.452148 [info ] [Thread-1 (]: 4 of 7 PASS not_null_stg_patients_patient_id ................................... [[32mPASS[0m in 0.02s]
[0m14:12:52.452803 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_patient_id.e578180344
[0m14:12:52.453228 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_phone.4e628022ba
[0m14:12:52.453628 [info ] [Thread-1 (]: 5 of 7 START test not_null_stg_patients_phone .................................. [RUN]
[0m14:12:52.454098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_patient_id.e578180344, now test.suvera.not_null_stg_patients_phone.4e628022ba)
[0m14:12:52.454492 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_phone.4e628022ba
[0m14:12:52.459871 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_phone.4e628022ba"
[0m14:12:52.461723 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_phone.4e628022ba
[0m14:12:52.465017 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_phone.4e628022ba"
[0m14:12:52.465865 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_phone.4e628022ba"
[0m14:12:52.466282 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_phone.4e628022ba: BEGIN
[0m14:12:52.466667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:52.467372 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:12:52.467777 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_phone.4e628022ba"
[0m14:12:52.468173 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_phone.4e628022ba: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_phone.4e628022ba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select phone
from "dev"."main"."stg_patients"
where phone is null



  
  
      
    ) dbt_internal_test
[0m14:12:52.469986 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:12:52.471627 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_phone.4e628022ba: ROLLBACK
[0m14:12:52.472445 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_phone.4e628022ba'
[0m14:12:52.472910 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_phone.4e628022ba: Close
[0m14:12:52.473921 [info ] [Thread-1 (]: 5 of 7 PASS not_null_stg_patients_phone ........................................ [[32mPASS[0m in 0.02s]
[0m14:12:52.474965 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_phone.4e628022ba
[0m14:12:52.475519 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3
[0m14:12:52.476227 [info ] [Thread-1 (]: 6 of 7 START test not_null_stg_patients_practice_id ............................ [RUN]
[0m14:12:52.476862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_phone.4e628022ba, now test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3)
[0m14:12:52.477256 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3
[0m14:12:52.482413 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3"
[0m14:12:52.483252 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3
[0m14:12:52.485320 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3"
[0m14:12:52.486904 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3"
[0m14:12:52.487509 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3: BEGIN
[0m14:12:52.487892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:52.488666 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:12:52.489355 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3"
[0m14:12:52.489917 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select practice_id
from "dev"."main"."stg_patients"
where practice_id is null



  
  
      
    ) dbt_internal_test
[0m14:12:52.493430 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:12:52.495343 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3: ROLLBACK
[0m14:12:52.496089 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3'
[0m14:12:52.496491 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3: Close
[0m14:12:52.497137 [info ] [Thread-1 (]: 6 of 7 PASS not_null_stg_patients_practice_id .................................. [[32mPASS[0m in 0.02s]
[0m14:12:52.497781 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3
[0m14:12:52.498209 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_registration_date.51d8eb4a55
[0m14:12:52.498611 [info ] [Thread-1 (]: 7 of 7 START test not_null_stg_patients_registration_date ...................... [RUN]
[0m14:12:52.499099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3, now test.suvera.not_null_stg_patients_registration_date.51d8eb4a55)
[0m14:12:52.499549 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_registration_date.51d8eb4a55
[0m14:12:52.503783 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_registration_date.51d8eb4a55"
[0m14:12:52.504722 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_registration_date.51d8eb4a55
[0m14:12:52.508458 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_registration_date.51d8eb4a55"
[0m14:12:52.509885 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_registration_date.51d8eb4a55"
[0m14:12:52.510934 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_registration_date.51d8eb4a55: BEGIN
[0m14:12:52.511403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:52.512101 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:12:52.512481 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_registration_date.51d8eb4a55"
[0m14:12:52.512866 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_registration_date.51d8eb4a55: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_registration_date.51d8eb4a55"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select registration_date
from "dev"."main"."stg_patients"
where registration_date is null



  
  
      
    ) dbt_internal_test
[0m14:12:52.514811 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:12:52.516459 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_registration_date.51d8eb4a55: ROLLBACK
[0m14:12:52.517128 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_registration_date.51d8eb4a55'
[0m14:12:52.517521 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_registration_date.51d8eb4a55: Close
[0m14:12:52.518145 [info ] [Thread-1 (]: 7 of 7 PASS not_null_stg_patients_registration_date ............................ [[32mPASS[0m in 0.02s]
[0m14:12:52.518786 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_registration_date.51d8eb4a55
[0m14:12:52.520029 [debug] [MainThread]: Using duckdb connection "master"
[0m14:12:52.520388 [debug] [MainThread]: On master: BEGIN
[0m14:12:52.520707 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:12:52.521330 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:12:52.521690 [debug] [MainThread]: On master: COMMIT
[0m14:12:52.522028 [debug] [MainThread]: Using duckdb connection "master"
[0m14:12:52.522507 [debug] [MainThread]: On master: COMMIT
[0m14:12:52.523385 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:12:52.524723 [debug] [MainThread]: On master: Close
[0m14:12:52.525317 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:12:52.525635 [debug] [MainThread]: Connection 'test.suvera.not_null_stg_patients_registration_date.51d8eb4a55' was properly closed.
[0m14:12:52.526223 [info ] [MainThread]: 
[0m14:12:52.526654 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m14:12:52.528404 [debug] [MainThread]: Command end result
[0m14:12:52.634834 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m14:12:52.637219 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m14:12:52.648580 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m14:12:52.649131 [info ] [MainThread]: 
[0m14:12:52.649597 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:12:52.650013 [info ] [MainThread]: 
[0m14:12:52.650608 [error] [MainThread]: [31mFailure in test dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id (models/staging/schema.yml)[0m
[0m14:12:52.651092 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id (models/staging/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:12:52.651503 [info ] [MainThread]: 
[0m14:12:52.651941 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m14:12:52.656546 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.5959169, "process_in_blocks": "0", "process_kernel_time": 0.586214, "process_mem_max_rss": "136892416", "process_out_blocks": "0", "process_user_time": 3.090424}
[0m14:12:52.657306 [debug] [MainThread]: Command `dbt test` failed at 14:12:52.657152 after 1.60 seconds
[0m14:12:52.657873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f09a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bd0680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bd05d0>]}
[0m14:12:52.658751 [debug] [MainThread]: Flushing usage events
[0m14:12:53.017550 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:15:47.020580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092c9d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a09f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a09f750>]}


============================== 14:15:47.029954 | d75af97d-7f2a-4c9c-a0b8-77859f5cdf00 ==============================
[0m14:15:47.029954 [info ] [MainThread]: Running with dbt=1.10.1
[0m14:15:47.030931 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'profiles_dir': '/Users/puneeth/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:15:47.278814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd75af97d-7f2a-4c9c-a0b8-77859f5cdf00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10957d220>]}
[0m14:15:47.317182 [debug] [MainThread]: Set downloads directory='/var/folders/n2/8rvp5mcs7xb1qn0v9nj3m09r0000gn/T/dbt-downloads-zsdim1jr'
[0m14:15:47.318218 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:15:47.433605 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:15:47.435368 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:15:47.484922 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:15:47.506523 [info ] [MainThread]: Updating lock file in file path: /Users/puneeth/Documents/suvera_dbt_project/suvera/package-lock.yml
[0m14:15:47.510462 [debug] [MainThread]: Set downloads directory='/var/folders/n2/8rvp5mcs7xb1qn0v9nj3m09r0000gn/T/dbt-downloads-34u6361z'
[0m14:15:47.516268 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:15:47.800472 [info ] [MainThread]: Installed from version 1.3.0
[0m14:15:47.801159 [info ] [MainThread]: Up to date!
[0m14:15:47.801728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd75af97d-7f2a-4c9c-a0b8-77859f5cdf00', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f8e7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f8e9c0>]}
[0m14:15:47.807278 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.88580346, "process_in_blocks": "0", "process_kernel_time": 0.621529, "process_mem_max_rss": "105713664", "process_out_blocks": "0", "process_user_time": 2.256765}
[0m14:15:47.808405 [debug] [MainThread]: Command `dbt deps` succeeded at 14:15:47.808128 after 0.89 seconds
[0m14:15:47.809136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a235150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0f1f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0f3e30>]}
[0m14:15:47.809850 [debug] [MainThread]: Flushing usage events
[0m14:15:48.179473 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:15:58.450429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d139d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df4b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df4b750>]}


============================== 14:15:58.455886 | 91e32051-785b-4a21-a083-15872f22967e ==============================
[0m14:15:58.455886 [info ] [MainThread]: Running with dbt=1.10.1
[0m14:15:58.456751 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select stg_patients', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:15:58.777248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91e32051-785b-4a21-a083-15872f22967e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d419220>]}
[0m14:15:58.850122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91e32051-785b-4a21-a083-15872f22967e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de33350>]}
[0m14:15:58.877535 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m14:15:59.011042 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m14:15:59.140067 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m14:15:59.141299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '91e32051-785b-4a21-a083-15872f22967e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e253650>]}
[0m14:16:00.976969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91e32051-785b-4a21-a083-15872f22967e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3fd220>]}
[0m14:16:01.075559 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m14:16:01.084759 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m14:16:01.155058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91e32051-785b-4a21-a083-15872f22967e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e521010>]}
[0m14:16:01.155814 [info ] [MainThread]: Found 4 models, 4 seeds, 16 data tests, 544 macros
[0m14:16:01.156316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91e32051-785b-4a21-a083-15872f22967e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8a7ee0>]}
[0m14:16:01.158820 [info ] [MainThread]: 
[0m14:16:01.159369 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:16:01.159767 [info ] [MainThread]: 
[0m14:16:01.160414 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:16:01.167411 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m14:16:01.241330 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:16:01.241824 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:16:01.242199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:01.261557 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m14:16:01.262085 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:16:01.262503 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m14:16:01.277535 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m14:16:01.279283 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:16:01.281079 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:16:01.281524 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:16:01.283305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91e32051-785b-4a21-a083-15872f22967e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8710d0>]}
[0m14:16:01.283793 [debug] [MainThread]: Using duckdb connection "master"
[0m14:16:01.284112 [debug] [MainThread]: On master: BEGIN
[0m14:16:01.284420 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:16:01.285089 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:16:01.285419 [debug] [MainThread]: On master: COMMIT
[0m14:16:01.285736 [debug] [MainThread]: Using duckdb connection "master"
[0m14:16:01.286041 [debug] [MainThread]: On master: COMMIT
[0m14:16:01.286530 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:16:01.286982 [debug] [MainThread]: On master: Close
[0m14:16:01.290771 [debug] [Thread-1 (]: Began running node test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b
[0m14:16:01.291411 [info ] [Thread-1 (]: 1 of 7 START test dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id  [RUN]
[0m14:16:01.292009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b)
[0m14:16:01.292475 [debug] [Thread-1 (]: Began compiling node test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b
[0m14:16:01.302826 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b"
[0m14:16:01.305326 [debug] [Thread-1 (]: Began executing node test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b
[0m14:16:01.329383 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b"
[0m14:16:01.331136 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b"
[0m14:16:01.331663 [debug] [Thread-1 (]: On test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b: BEGIN
[0m14:16:01.332053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:01.332763 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:16:01.333155 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b"
[0m14:16:01.333558 [debug] [Thread-1 (]: On test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        patient_id, practice_id
    from "dev"."main"."stg_patients"
    group by patient_id, practice_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m14:16:01.339242 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:16:01.344237 [debug] [Thread-1 (]: On test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b: ROLLBACK
[0m14:16:01.344970 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b'
[0m14:16:01.345368 [debug] [Thread-1 (]: On test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b: Close
[0m14:16:01.346038 [error] [Thread-1 (]: 1 of 7 FAIL 3 dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id  [[31mFAIL 3[0m in 0.05s]
[0m14:16:01.346849 [debug] [Thread-1 (]: Finished running node test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b
[0m14:16:01.347281 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_age.7a0c6139fb
[0m14:16:01.347682 [info ] [Thread-1 (]: 2 of 7 START test not_null_stg_patients_age .................................... [RUN]
[0m14:16:01.348336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b, now test.suvera.not_null_stg_patients_age.7a0c6139fb)
[0m14:16:01.348745 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_age.7a0c6139fb
[0m14:16:01.355983 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_age.7a0c6139fb"
[0m14:16:01.357430 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_age.7a0c6139fb
[0m14:16:01.362264 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_age.7a0c6139fb"
[0m14:16:01.363372 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_age.7a0c6139fb"
[0m14:16:01.363828 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_age.7a0c6139fb: BEGIN
[0m14:16:01.364210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:01.364869 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:16:01.365260 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_age.7a0c6139fb"
[0m14:16:01.365664 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_age.7a0c6139fb: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_age.7a0c6139fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select age
from "dev"."main"."stg_patients"
where age is null



  
  
      
    ) dbt_internal_test
[0m14:16:01.367357 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:16:01.369002 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_age.7a0c6139fb: ROLLBACK
[0m14:16:01.369689 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_age.7a0c6139fb'
[0m14:16:01.370085 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_age.7a0c6139fb: Close
[0m14:16:01.370735 [info ] [Thread-1 (]: 2 of 7 PASS not_null_stg_patients_age .......................................... [[32mPASS[0m in 0.02s]
[0m14:16:01.371474 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_age.7a0c6139fb
[0m14:16:01.372065 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_email.ce8e444e21
[0m14:16:01.372926 [info ] [Thread-1 (]: 3 of 7 START test not_null_stg_patients_email .................................. [RUN]
[0m14:16:01.374496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_age.7a0c6139fb, now test.suvera.not_null_stg_patients_email.ce8e444e21)
[0m14:16:01.374940 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_email.ce8e444e21
[0m14:16:01.379424 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_email.ce8e444e21"
[0m14:16:01.380208 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_email.ce8e444e21
[0m14:16:01.382833 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_email.ce8e444e21"
[0m14:16:01.383590 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_email.ce8e444e21"
[0m14:16:01.384013 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_email.ce8e444e21: BEGIN
[0m14:16:01.384389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:01.385047 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:16:01.385436 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_email.ce8e444e21"
[0m14:16:01.385830 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_email.ce8e444e21: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_email.ce8e444e21"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from "dev"."main"."stg_patients"
where email is null



  
  
      
    ) dbt_internal_test
[0m14:16:01.387647 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:16:01.389978 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_email.ce8e444e21: ROLLBACK
[0m14:16:01.390804 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_email.ce8e444e21'
[0m14:16:01.391412 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_email.ce8e444e21: Close
[0m14:16:01.392082 [info ] [Thread-1 (]: 3 of 7 PASS not_null_stg_patients_email ........................................ [[32mPASS[0m in 0.02s]
[0m14:16:01.393374 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_email.ce8e444e21
[0m14:16:01.394225 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_patient_id.e578180344
[0m14:16:01.395355 [info ] [Thread-1 (]: 4 of 7 START test not_null_stg_patients_patient_id ............................. [RUN]
[0m14:16:01.395984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_email.ce8e444e21, now test.suvera.not_null_stg_patients_patient_id.e578180344)
[0m14:16:01.396388 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_patient_id.e578180344
[0m14:16:01.400698 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_patient_id.e578180344"
[0m14:16:01.401518 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_patient_id.e578180344
[0m14:16:01.403751 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_patient_id.e578180344"
[0m14:16:01.405025 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_patient_id.e578180344"
[0m14:16:01.405998 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_patient_id.e578180344: BEGIN
[0m14:16:01.406869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:01.408161 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:16:01.408756 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_patient_id.e578180344"
[0m14:16:01.409468 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_patient_id.e578180344: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_patient_id.e578180344"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "dev"."main"."stg_patients"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m14:16:01.412700 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:16:01.414938 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_patient_id.e578180344: ROLLBACK
[0m14:16:01.415620 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_patient_id.e578180344'
[0m14:16:01.416011 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_patient_id.e578180344: Close
[0m14:16:01.416631 [info ] [Thread-1 (]: 4 of 7 PASS not_null_stg_patients_patient_id ................................... [[32mPASS[0m in 0.02s]
[0m14:16:01.417267 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_patient_id.e578180344
[0m14:16:01.417687 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_phone.4e628022ba
[0m14:16:01.418081 [info ] [Thread-1 (]: 5 of 7 START test not_null_stg_patients_phone .................................. [RUN]
[0m14:16:01.418598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_patient_id.e578180344, now test.suvera.not_null_stg_patients_phone.4e628022ba)
[0m14:16:01.419013 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_phone.4e628022ba
[0m14:16:01.423318 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_phone.4e628022ba"
[0m14:16:01.425535 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_phone.4e628022ba
[0m14:16:01.428115 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_phone.4e628022ba"
[0m14:16:01.429606 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_phone.4e628022ba"
[0m14:16:01.430455 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_phone.4e628022ba: BEGIN
[0m14:16:01.430847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:01.431550 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:16:01.431930 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_phone.4e628022ba"
[0m14:16:01.432310 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_phone.4e628022ba: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_phone.4e628022ba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select phone
from "dev"."main"."stg_patients"
where phone is null



  
  
      
    ) dbt_internal_test
[0m14:16:01.434083 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:16:01.435658 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_phone.4e628022ba: ROLLBACK
[0m14:16:01.436466 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_phone.4e628022ba'
[0m14:16:01.436861 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_phone.4e628022ba: Close
[0m14:16:01.437475 [info ] [Thread-1 (]: 5 of 7 PASS not_null_stg_patients_phone ........................................ [[32mPASS[0m in 0.02s]
[0m14:16:01.438274 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_phone.4e628022ba
[0m14:16:01.438746 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3
[0m14:16:01.439398 [info ] [Thread-1 (]: 6 of 7 START test not_null_stg_patients_practice_id ............................ [RUN]
[0m14:16:01.441003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_phone.4e628022ba, now test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3)
[0m14:16:01.442344 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3
[0m14:16:01.447080 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3"
[0m14:16:01.448617 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3
[0m14:16:01.451340 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3"
[0m14:16:01.452763 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3"
[0m14:16:01.453275 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3: BEGIN
[0m14:16:01.453704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:01.454470 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:16:01.454921 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3"
[0m14:16:01.455370 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select practice_id
from "dev"."main"."stg_patients"
where practice_id is null



  
  
      
    ) dbt_internal_test
[0m14:16:01.458240 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:16:01.461320 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3: ROLLBACK
[0m14:16:01.462107 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3'
[0m14:16:01.462508 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3: Close
[0m14:16:01.463158 [info ] [Thread-1 (]: 6 of 7 PASS not_null_stg_patients_practice_id .................................. [[32mPASS[0m in 0.02s]
[0m14:16:01.463798 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3
[0m14:16:01.464230 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_registration_date.51d8eb4a55
[0m14:16:01.464635 [info ] [Thread-1 (]: 7 of 7 START test not_null_stg_patients_registration_date ...................... [RUN]
[0m14:16:01.465161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3, now test.suvera.not_null_stg_patients_registration_date.51d8eb4a55)
[0m14:16:01.465624 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_registration_date.51d8eb4a55
[0m14:16:01.470063 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_registration_date.51d8eb4a55"
[0m14:16:01.470922 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_registration_date.51d8eb4a55
[0m14:16:01.473583 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_registration_date.51d8eb4a55"
[0m14:16:01.475841 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_registration_date.51d8eb4a55"
[0m14:16:01.476516 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_registration_date.51d8eb4a55: BEGIN
[0m14:16:01.477367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:01.478341 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:16:01.478901 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_registration_date.51d8eb4a55"
[0m14:16:01.479332 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_registration_date.51d8eb4a55: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_registration_date.51d8eb4a55"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select registration_date
from "dev"."main"."stg_patients"
where registration_date is null



  
  
      
    ) dbt_internal_test
[0m14:16:01.481285 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:16:01.482950 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_registration_date.51d8eb4a55: ROLLBACK
[0m14:16:01.483621 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_registration_date.51d8eb4a55'
[0m14:16:01.484011 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_registration_date.51d8eb4a55: Close
[0m14:16:01.484634 [info ] [Thread-1 (]: 7 of 7 PASS not_null_stg_patients_registration_date ............................ [[32mPASS[0m in 0.02s]
[0m14:16:01.485279 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_registration_date.51d8eb4a55
[0m14:16:01.486506 [debug] [MainThread]: Using duckdb connection "master"
[0m14:16:01.486859 [debug] [MainThread]: On master: BEGIN
[0m14:16:01.487179 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:16:01.487789 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:16:01.488130 [debug] [MainThread]: On master: COMMIT
[0m14:16:01.488465 [debug] [MainThread]: Using duckdb connection "master"
[0m14:16:01.488802 [debug] [MainThread]: On master: COMMIT
[0m14:16:01.489455 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:16:01.490184 [debug] [MainThread]: On master: Close
[0m14:16:01.491381 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:16:01.491910 [debug] [MainThread]: Connection 'test.suvera.not_null_stg_patients_registration_date.51d8eb4a55' was properly closed.
[0m14:16:01.492281 [info ] [MainThread]: 
[0m14:16:01.492650 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m14:16:01.494735 [debug] [MainThread]: Command end result
[0m14:16:01.532414 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m14:16:01.534998 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m14:16:01.544814 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m14:16:01.545256 [info ] [MainThread]: 
[0m14:16:01.545687 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:16:01.546171 [info ] [MainThread]: 
[0m14:16:01.546682 [error] [MainThread]: [31mFailure in test dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id (models/staging/schema.yml)[0m
[0m14:16:01.547179 [error] [MainThread]:   Got 3 results, configured to fail if != 0
[0m14:16:01.547542 [info ] [MainThread]: 
[0m14:16:01.548001 [info ] [MainThread]:   compiled code at target/compiled/suvera/models/staging/schema.yml/dbt_utils_unique_combination_o_9bcb3333c5bdd713339ad9c078f2a49d.sql
[0m14:16:01.548438 [info ] [MainThread]: 
[0m14:16:01.548845 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m14:16:01.552630 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 3.1831176, "process_in_blocks": "0", "process_kernel_time": 0.513023, "process_mem_max_rss": "142012416", "process_out_blocks": "0", "process_user_time": 4.533581}
[0m14:16:01.553815 [debug] [MainThread]: Command `dbt test` failed at 14:16:01.553626 after 3.18 seconds
[0m14:16:01.554847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e921860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebbdc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecef6b0>]}
[0m14:16:01.555421 [debug] [MainThread]: Flushing usage events
[0m14:16:01.916991 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:35:56.034101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca5dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d86f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d86f750>]}


============================== 14:35:56.042214 | 846fe039-ce0e-4811-a507-48fe69d16efa ==============================
[0m14:35:56.042214 [info ] [MainThread]: Running with dbt=1.10.1
[0m14:35:56.043199 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'version_check': 'True', 'profiles_dir': '/Users/puneeth/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --select stg_patients', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:35:56.514073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '846fe039-ce0e-4811-a507-48fe69d16efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd3d220>]}
[0m14:35:56.589381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '846fe039-ce0e-4811-a507-48fe69d16efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d757350>]}
[0m14:35:56.621455 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m14:35:56.771312 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m14:35:57.036678 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m14:35:57.037510 [debug] [MainThread]: Partial parsing: added file: suvera://models/staging/stg_pcns.sql
[0m14:35:57.038269 [debug] [MainThread]: Partial parsing: updated file: suvera://models/staging/schema.yml
[0m14:35:57.528076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '846fe039-ce0e-4811-a507-48fe69d16efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e14c850>]}
[0m14:35:57.710279 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m14:35:57.717572 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m14:35:57.788404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '846fe039-ce0e-4811-a507-48fe69d16efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e01f3e0>]}
[0m14:35:57.789155 [info ] [MainThread]: Found 5 models, 4 seeds, 15 data tests, 544 macros
[0m14:35:57.789654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '846fe039-ce0e-4811-a507-48fe69d16efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d95dfd0>]}
[0m14:35:57.792067 [info ] [MainThread]: 
[0m14:35:57.792493 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:35:57.792856 [info ] [MainThread]: 
[0m14:35:57.793446 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:35:57.800279 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m14:35:57.880726 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:35:57.881424 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:35:57.881925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:57.905565 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m14:35:57.906035 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:35:57.906374 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m14:35:57.920841 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m14:35:57.922525 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:35:57.924346 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:35:57.924831 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:35:57.927179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '846fe039-ce0e-4811-a507-48fe69d16efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e35cef0>]}
[0m14:35:57.927847 [debug] [MainThread]: Using duckdb connection "master"
[0m14:35:57.928284 [debug] [MainThread]: On master: BEGIN
[0m14:35:57.928659 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:35:57.929391 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:35:57.929794 [debug] [MainThread]: On master: COMMIT
[0m14:35:57.930182 [debug] [MainThread]: Using duckdb connection "master"
[0m14:35:57.930548 [debug] [MainThread]: On master: COMMIT
[0m14:35:57.931094 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:35:57.931492 [debug] [MainThread]: On master: Close
[0m14:35:57.935782 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_age.7a0c6139fb
[0m14:35:57.936399 [info ] [Thread-1 (]: 1 of 6 START test not_null_stg_patients_age .................................... [RUN]
[0m14:35:57.936990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now test.suvera.not_null_stg_patients_age.7a0c6139fb)
[0m14:35:57.937441 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_age.7a0c6139fb
[0m14:35:57.959069 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_age.7a0c6139fb"
[0m14:35:57.960582 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_age.7a0c6139fb
[0m14:35:57.979805 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_age.7a0c6139fb"
[0m14:35:57.980712 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_age.7a0c6139fb"
[0m14:35:57.981107 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_age.7a0c6139fb: BEGIN
[0m14:35:57.981472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:57.982197 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:57.982572 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_age.7a0c6139fb"
[0m14:35:57.982947 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_age.7a0c6139fb: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_age.7a0c6139fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select age
from "dev"."main"."stg_patients"
where age is null



  
  
      
    ) dbt_internal_test
[0m14:35:57.986096 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:35:57.990887 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_age.7a0c6139fb: ROLLBACK
[0m14:35:57.991889 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_age.7a0c6139fb'
[0m14:35:57.992276 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_age.7a0c6139fb: Close
[0m14:35:57.993061 [info ] [Thread-1 (]: 1 of 6 PASS not_null_stg_patients_age .......................................... [[32mPASS[0m in 0.06s]
[0m14:35:57.993857 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_age.7a0c6139fb
[0m14:35:57.994313 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_email.ce8e444e21
[0m14:35:57.995037 [info ] [Thread-1 (]: 2 of 6 START test not_null_stg_patients_email .................................. [RUN]
[0m14:35:57.995668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_age.7a0c6139fb, now test.suvera.not_null_stg_patients_email.ce8e444e21)
[0m14:35:57.996054 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_email.ce8e444e21
[0m14:35:58.000516 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_email.ce8e444e21"
[0m14:35:58.001541 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_email.ce8e444e21
[0m14:35:58.004146 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_email.ce8e444e21"
[0m14:35:58.005058 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_email.ce8e444e21"
[0m14:35:58.005459 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_email.ce8e444e21: BEGIN
[0m14:35:58.006353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:58.007933 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:35:58.008587 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_email.ce8e444e21"
[0m14:35:58.008984 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_email.ce8e444e21: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_email.ce8e444e21"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from "dev"."main"."stg_patients"
where email is null



  
  
      
    ) dbt_internal_test
[0m14:35:58.010916 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:35:58.012655 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_email.ce8e444e21: ROLLBACK
[0m14:35:58.013311 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_email.ce8e444e21'
[0m14:35:58.013694 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_email.ce8e444e21: Close
[0m14:35:58.014323 [info ] [Thread-1 (]: 2 of 6 PASS not_null_stg_patients_email ........................................ [[32mPASS[0m in 0.02s]
[0m14:35:58.015052 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_email.ce8e444e21
[0m14:35:58.015485 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_patient_id.e578180344
[0m14:35:58.015876 [info ] [Thread-1 (]: 3 of 6 START test not_null_stg_patients_patient_id ............................. [RUN]
[0m14:35:58.016513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_email.ce8e444e21, now test.suvera.not_null_stg_patients_patient_id.e578180344)
[0m14:35:58.016907 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_patient_id.e578180344
[0m14:35:58.021856 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_patient_id.e578180344"
[0m14:35:58.023026 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_patient_id.e578180344
[0m14:35:58.025911 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_patient_id.e578180344"
[0m14:35:58.026736 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_patient_id.e578180344"
[0m14:35:58.027156 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_patient_id.e578180344: BEGIN
[0m14:35:58.027532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:58.028200 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:58.028589 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_patient_id.e578180344"
[0m14:35:58.028979 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_patient_id.e578180344: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_patient_id.e578180344"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "dev"."main"."stg_patients"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m14:35:58.030717 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:58.032289 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_patient_id.e578180344: ROLLBACK
[0m14:35:58.032933 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_patient_id.e578180344'
[0m14:35:58.033312 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_patient_id.e578180344: Close
[0m14:35:58.034076 [info ] [Thread-1 (]: 3 of 6 PASS not_null_stg_patients_patient_id ................................... [[32mPASS[0m in 0.02s]
[0m14:35:58.035170 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_patient_id.e578180344
[0m14:35:58.035733 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_phone.4e628022ba
[0m14:35:58.036315 [info ] [Thread-1 (]: 4 of 6 START test not_null_stg_patients_phone .................................. [RUN]
[0m14:35:58.037019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_patient_id.e578180344, now test.suvera.not_null_stg_patients_phone.4e628022ba)
[0m14:35:58.037692 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_phone.4e628022ba
[0m14:35:58.043031 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_phone.4e628022ba"
[0m14:35:58.043853 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_phone.4e628022ba
[0m14:35:58.049950 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_phone.4e628022ba"
[0m14:35:58.050785 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_phone.4e628022ba"
[0m14:35:58.051304 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_phone.4e628022ba: BEGIN
[0m14:35:58.051747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:58.052641 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:58.053121 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_phone.4e628022ba"
[0m14:35:58.053530 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_phone.4e628022ba: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_phone.4e628022ba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select phone
from "dev"."main"."stg_patients"
where phone is null



  
  
      
    ) dbt_internal_test
[0m14:35:58.056650 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:35:58.059544 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_phone.4e628022ba: ROLLBACK
[0m14:35:58.060326 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_phone.4e628022ba'
[0m14:35:58.060723 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_phone.4e628022ba: Close
[0m14:35:58.061361 [info ] [Thread-1 (]: 4 of 6 PASS not_null_stg_patients_phone ........................................ [[32mPASS[0m in 0.02s]
[0m14:35:58.061996 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_phone.4e628022ba
[0m14:35:58.062418 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3
[0m14:35:58.062838 [info ] [Thread-1 (]: 5 of 6 START test not_null_stg_patients_practice_id ............................ [RUN]
[0m14:35:58.063368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_phone.4e628022ba, now test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3)
[0m14:35:58.063782 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3
[0m14:35:58.067811 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3"
[0m14:35:58.068648 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3
[0m14:35:58.071226 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3"
[0m14:35:58.073528 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3"
[0m14:35:58.074540 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3: BEGIN
[0m14:35:58.075379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:58.076659 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:58.077289 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3"
[0m14:35:58.077709 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select practice_id
from "dev"."main"."stg_patients"
where practice_id is null



  
  
      
    ) dbt_internal_test
[0m14:35:58.079573 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:58.081233 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3: ROLLBACK
[0m14:35:58.081909 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3'
[0m14:35:58.082300 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3: Close
[0m14:35:58.082937 [info ] [Thread-1 (]: 5 of 6 PASS not_null_stg_patients_practice_id .................................. [[32mPASS[0m in 0.02s]
[0m14:35:58.083574 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3
[0m14:35:58.084002 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_registration_date.51d8eb4a55
[0m14:35:58.084445 [info ] [Thread-1 (]: 6 of 6 START test not_null_stg_patients_registration_date ...................... [RUN]
[0m14:35:58.085052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3, now test.suvera.not_null_stg_patients_registration_date.51d8eb4a55)
[0m14:35:58.085568 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_registration_date.51d8eb4a55
[0m14:35:58.091049 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_registration_date.51d8eb4a55"
[0m14:35:58.091912 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_registration_date.51d8eb4a55
[0m14:35:58.094312 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_registration_date.51d8eb4a55"
[0m14:35:58.095062 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_registration_date.51d8eb4a55"
[0m14:35:58.095462 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_registration_date.51d8eb4a55: BEGIN
[0m14:35:58.095844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:58.096505 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:58.096899 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_registration_date.51d8eb4a55"
[0m14:35:58.097301 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_registration_date.51d8eb4a55: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_registration_date.51d8eb4a55"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select registration_date
from "dev"."main"."stg_patients"
where registration_date is null



  
  
      
    ) dbt_internal_test
[0m14:35:58.099146 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:35:58.100771 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_registration_date.51d8eb4a55: ROLLBACK
[0m14:35:58.101422 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_registration_date.51d8eb4a55'
[0m14:35:58.101969 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_registration_date.51d8eb4a55: Close
[0m14:35:58.102897 [info ] [Thread-1 (]: 6 of 6 PASS not_null_stg_patients_registration_date ............................ [[32mPASS[0m in 0.02s]
[0m14:35:58.104153 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_registration_date.51d8eb4a55
[0m14:35:58.106898 [debug] [MainThread]: Using duckdb connection "master"
[0m14:35:58.107471 [debug] [MainThread]: On master: BEGIN
[0m14:35:58.107826 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:35:58.108510 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:35:58.108907 [debug] [MainThread]: On master: COMMIT
[0m14:35:58.109237 [debug] [MainThread]: Using duckdb connection "master"
[0m14:35:58.109547 [debug] [MainThread]: On master: COMMIT
[0m14:35:58.110176 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:35:58.110593 [debug] [MainThread]: On master: Close
[0m14:35:58.111052 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:35:58.111362 [debug] [MainThread]: Connection 'test.suvera.not_null_stg_patients_registration_date.51d8eb4a55' was properly closed.
[0m14:35:58.111714 [info ] [MainThread]: 
[0m14:35:58.112079 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m14:35:58.113646 [debug] [MainThread]: Command end result
[0m14:35:58.147349 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m14:35:58.151615 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m14:35:58.164632 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m14:35:58.165133 [info ] [MainThread]: 
[0m14:35:58.165648 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:35:58.166067 [info ] [MainThread]: 
[0m14:35:58.166586 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m14:35:58.170511 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.2365725, "process_in_blocks": "0", "process_kernel_time": 0.702434, "process_mem_max_rss": "140914688", "process_out_blocks": "0", "process_user_time": 3.643451}
[0m14:35:58.171555 [debug] [MainThread]: Command `dbt test` succeeded at 14:35:58.171347 after 2.24 seconds
[0m14:35:58.172165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d715a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfc5ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfc5f40>]}
[0m14:35:58.172702 [debug] [MainThread]: Flushing usage events
[0m14:35:58.568968 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:36:37.580780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0c5d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bed7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bed7750>]}


============================== 14:36:37.590068 | 247d33f2-3c46-4e07-916d-5302cd5e6cd6 ==============================
[0m14:36:37.590068 [info ] [MainThread]: Running with dbt=1.10.1
[0m14:36:37.591051 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'version_check': 'True', 'profiles_dir': '/Users/puneeth/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select stg_patients', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:36:37.918255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '247d33f2-3c46-4e07-916d-5302cd5e6cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3a5220>]}
[0m14:36:37.994334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '247d33f2-3c46-4e07-916d-5302cd5e6cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdbf350>]}
[0m14:36:38.020624 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m14:36:38.174482 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m14:36:38.417716 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:36:38.418910 [debug] [MainThread]: Partial parsing: updated file: suvera://models/staging/schema.yml
[0m14:36:38.958900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '247d33f2-3c46-4e07-916d-5302cd5e6cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c698d50>]}
[0m14:36:39.131813 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m14:36:39.135740 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m14:36:39.194160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '247d33f2-3c46-4e07-916d-5302cd5e6cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c66ba70>]}
[0m14:36:39.194766 [info ] [MainThread]: Found 5 models, 4 seeds, 16 data tests, 544 macros
[0m14:36:39.195201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '247d33f2-3c46-4e07-916d-5302cd5e6cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c624c90>]}
[0m14:36:39.197501 [info ] [MainThread]: 
[0m14:36:39.197925 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:36:39.198287 [info ] [MainThread]: 
[0m14:36:39.198867 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:36:39.205258 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m14:36:39.273531 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:36:39.274123 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:36:39.274517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:39.294146 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m14:36:39.294703 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:36:39.295078 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m14:36:39.310011 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m14:36:39.312021 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:36:39.313809 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:36:39.314218 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:36:39.315988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '247d33f2-3c46-4e07-916d-5302cd5e6cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9a18b0>]}
[0m14:36:39.316489 [debug] [MainThread]: Using duckdb connection "master"
[0m14:36:39.316817 [debug] [MainThread]: On master: BEGIN
[0m14:36:39.317132 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:36:39.317779 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:36:39.318117 [debug] [MainThread]: On master: COMMIT
[0m14:36:39.318446 [debug] [MainThread]: Using duckdb connection "master"
[0m14:36:39.318763 [debug] [MainThread]: On master: COMMIT
[0m14:36:39.319268 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:36:39.319608 [debug] [MainThread]: On master: Close
[0m14:36:39.323523 [debug] [Thread-1 (]: Began running node test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b
[0m14:36:39.324085 [info ] [Thread-1 (]: 1 of 7 START test dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id  [RUN]
[0m14:36:39.324783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b)
[0m14:36:39.325178 [debug] [Thread-1 (]: Began compiling node test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b
[0m14:36:39.335423 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b"
[0m14:36:39.337223 [debug] [Thread-1 (]: Began executing node test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b
[0m14:36:39.364406 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b"
[0m14:36:39.365453 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b"
[0m14:36:39.366088 [debug] [Thread-1 (]: On test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b: BEGIN
[0m14:36:39.366492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:39.367257 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:36:39.367657 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b"
[0m14:36:39.368067 [debug] [Thread-1 (]: On test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        patient_id, practice_id
    from "dev"."main"."stg_patients"
    group by patient_id, practice_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m14:36:39.373468 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:36:39.378725 [debug] [Thread-1 (]: On test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b: ROLLBACK
[0m14:36:39.379553 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b'
[0m14:36:39.379964 [debug] [Thread-1 (]: On test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b: Close
[0m14:36:39.380693 [error] [Thread-1 (]: 1 of 7 FAIL 3 dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id  [[31mFAIL 3[0m in 0.06s]
[0m14:36:39.381473 [debug] [Thread-1 (]: Finished running node test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b
[0m14:36:39.381981 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_age.7a0c6139fb
[0m14:36:39.382389 [info ] [Thread-1 (]: 2 of 7 START test not_null_stg_patients_age .................................... [RUN]
[0m14:36:39.383111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b, now test.suvera.not_null_stg_patients_age.7a0c6139fb)
[0m14:36:39.383519 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_age.7a0c6139fb
[0m14:36:39.391152 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_age.7a0c6139fb"
[0m14:36:39.392078 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_age.7a0c6139fb
[0m14:36:39.394519 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_age.7a0c6139fb"
[0m14:36:39.395325 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_age.7a0c6139fb"
[0m14:36:39.395726 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_age.7a0c6139fb: BEGIN
[0m14:36:39.396093 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:39.396838 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:36:39.397223 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_age.7a0c6139fb"
[0m14:36:39.397606 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_age.7a0c6139fb: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_age.7a0c6139fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select age
from "dev"."main"."stg_patients"
where age is null



  
  
      
    ) dbt_internal_test
[0m14:36:39.399479 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:36:39.401487 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_age.7a0c6139fb: ROLLBACK
[0m14:36:39.402204 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_age.7a0c6139fb'
[0m14:36:39.402594 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_age.7a0c6139fb: Close
[0m14:36:39.403434 [info ] [Thread-1 (]: 2 of 7 PASS not_null_stg_patients_age .......................................... [[32mPASS[0m in 0.02s]
[0m14:36:39.404198 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_age.7a0c6139fb
[0m14:36:39.404684 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_email.ce8e444e21
[0m14:36:39.405081 [info ] [Thread-1 (]: 3 of 7 START test not_null_stg_patients_email .................................. [RUN]
[0m14:36:39.405718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_age.7a0c6139fb, now test.suvera.not_null_stg_patients_email.ce8e444e21)
[0m14:36:39.406131 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_email.ce8e444e21
[0m14:36:39.410626 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_email.ce8e444e21"
[0m14:36:39.411640 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_email.ce8e444e21
[0m14:36:39.414490 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_email.ce8e444e21"
[0m14:36:39.415252 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_email.ce8e444e21"
[0m14:36:39.415653 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_email.ce8e444e21: BEGIN
[0m14:36:39.416024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:39.416793 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:36:39.417214 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_email.ce8e444e21"
[0m14:36:39.417605 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_email.ce8e444e21: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_email.ce8e444e21"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from "dev"."main"."stg_patients"
where email is null



  
  
      
    ) dbt_internal_test
[0m14:36:39.419501 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:36:39.421128 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_email.ce8e444e21: ROLLBACK
[0m14:36:39.421789 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_email.ce8e444e21'
[0m14:36:39.422178 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_email.ce8e444e21: Close
[0m14:36:39.423008 [info ] [Thread-1 (]: 3 of 7 PASS not_null_stg_patients_email ........................................ [[32mPASS[0m in 0.02s]
[0m14:36:39.423830 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_email.ce8e444e21
[0m14:36:39.424341 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_patient_id.e578180344
[0m14:36:39.424725 [info ] [Thread-1 (]: 4 of 7 START test not_null_stg_patients_patient_id ............................. [RUN]
[0m14:36:39.425426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_email.ce8e444e21, now test.suvera.not_null_stg_patients_patient_id.e578180344)
[0m14:36:39.425848 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_patient_id.e578180344
[0m14:36:39.430226 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_patient_id.e578180344"
[0m14:36:39.431154 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_patient_id.e578180344
[0m14:36:39.437309 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_patient_id.e578180344"
[0m14:36:39.438166 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_patient_id.e578180344"
[0m14:36:39.438560 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_patient_id.e578180344: BEGIN
[0m14:36:39.438929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:39.439620 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:36:39.440006 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_patient_id.e578180344"
[0m14:36:39.440395 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_patient_id.e578180344: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_patient_id.e578180344"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "dev"."main"."stg_patients"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m14:36:39.442208 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:36:39.444212 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_patient_id.e578180344: ROLLBACK
[0m14:36:39.444904 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_patient_id.e578180344'
[0m14:36:39.445290 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_patient_id.e578180344: Close
[0m14:36:39.445943 [info ] [Thread-1 (]: 4 of 7 PASS not_null_stg_patients_patient_id ................................... [[32mPASS[0m in 0.02s]
[0m14:36:39.446742 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_patient_id.e578180344
[0m14:36:39.447196 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_phone.4e628022ba
[0m14:36:39.447613 [info ] [Thread-1 (]: 5 of 7 START test not_null_stg_patients_phone .................................. [RUN]
[0m14:36:39.448275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_patient_id.e578180344, now test.suvera.not_null_stg_patients_phone.4e628022ba)
[0m14:36:39.448657 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_phone.4e628022ba
[0m14:36:39.453104 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_phone.4e628022ba"
[0m14:36:39.454007 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_phone.4e628022ba
[0m14:36:39.456253 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_phone.4e628022ba"
[0m14:36:39.456957 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_phone.4e628022ba"
[0m14:36:39.457350 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_phone.4e628022ba: BEGIN
[0m14:36:39.457721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:39.458436 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:36:39.458815 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_phone.4e628022ba"
[0m14:36:39.459199 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_phone.4e628022ba: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_phone.4e628022ba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select phone
from "dev"."main"."stg_patients"
where phone is null



  
  
      
    ) dbt_internal_test
[0m14:36:39.461155 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:36:39.462876 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_phone.4e628022ba: ROLLBACK
[0m14:36:39.463564 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_phone.4e628022ba'
[0m14:36:39.463965 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_phone.4e628022ba: Close
[0m14:36:39.464616 [info ] [Thread-1 (]: 5 of 7 PASS not_null_stg_patients_phone ........................................ [[32mPASS[0m in 0.02s]
[0m14:36:39.465615 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_phone.4e628022ba
[0m14:36:39.466070 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3
[0m14:36:39.466656 [info ] [Thread-1 (]: 6 of 7 START test not_null_stg_patients_practice_id ............................ [RUN]
[0m14:36:39.467268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_phone.4e628022ba, now test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3)
[0m14:36:39.467659 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3
[0m14:36:39.472348 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3"
[0m14:36:39.473264 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3
[0m14:36:39.475537 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3"
[0m14:36:39.476381 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3"
[0m14:36:39.476785 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3: BEGIN
[0m14:36:39.477152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:39.477884 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:36:39.478330 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3"
[0m14:36:39.478722 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select practice_id
from "dev"."main"."stg_patients"
where practice_id is null



  
  
      
    ) dbt_internal_test
[0m14:36:39.480666 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:36:39.482323 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3: ROLLBACK
[0m14:36:39.482991 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3'
[0m14:36:39.483382 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3: Close
[0m14:36:39.484084 [info ] [Thread-1 (]: 6 of 7 PASS not_null_stg_patients_practice_id .................................. [[32mPASS[0m in 0.02s]
[0m14:36:39.485111 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3
[0m14:36:39.485649 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_registration_date.51d8eb4a55
[0m14:36:39.486248 [info ] [Thread-1 (]: 7 of 7 START test not_null_stg_patients_registration_date ...................... [RUN]
[0m14:36:39.487017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3, now test.suvera.not_null_stg_patients_registration_date.51d8eb4a55)
[0m14:36:39.487462 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_registration_date.51d8eb4a55
[0m14:36:39.492149 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_registration_date.51d8eb4a55"
[0m14:36:39.493169 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_registration_date.51d8eb4a55
[0m14:36:39.495430 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_registration_date.51d8eb4a55"
[0m14:36:39.496173 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_registration_date.51d8eb4a55"
[0m14:36:39.496565 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_registration_date.51d8eb4a55: BEGIN
[0m14:36:39.496928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:39.497615 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:36:39.497994 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_registration_date.51d8eb4a55"
[0m14:36:39.498379 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_registration_date.51d8eb4a55: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_registration_date.51d8eb4a55"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select registration_date
from "dev"."main"."stg_patients"
where registration_date is null



  
  
      
    ) dbt_internal_test
[0m14:36:39.500229 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:36:39.501823 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_registration_date.51d8eb4a55: ROLLBACK
[0m14:36:39.502481 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_registration_date.51d8eb4a55'
[0m14:36:39.502868 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_registration_date.51d8eb4a55: Close
[0m14:36:39.503487 [info ] [Thread-1 (]: 7 of 7 PASS not_null_stg_patients_registration_date ............................ [[32mPASS[0m in 0.02s]
[0m14:36:39.504369 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_registration_date.51d8eb4a55
[0m14:36:39.506149 [debug] [MainThread]: Using duckdb connection "master"
[0m14:36:39.506627 [debug] [MainThread]: On master: BEGIN
[0m14:36:39.507080 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:36:39.507869 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:36:39.508350 [debug] [MainThread]: On master: COMMIT
[0m14:36:39.508700 [debug] [MainThread]: Using duckdb connection "master"
[0m14:36:39.509071 [debug] [MainThread]: On master: COMMIT
[0m14:36:39.509981 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:36:39.510490 [debug] [MainThread]: On master: Close
[0m14:36:39.510984 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:36:39.511356 [debug] [MainThread]: Connection 'test.suvera.not_null_stg_patients_registration_date.51d8eb4a55' was properly closed.
[0m14:36:39.511850 [info ] [MainThread]: 
[0m14:36:39.512294 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m14:36:39.514104 [debug] [MainThread]: Command end result
[0m14:36:39.542247 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m14:36:39.544790 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m14:36:39.551871 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m14:36:39.552219 [info ] [MainThread]: 
[0m14:36:39.552648 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:36:39.553294 [info ] [MainThread]: 
[0m14:36:39.554117 [error] [MainThread]: [31mFailure in test dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id (models/staging/schema.yml)[0m
[0m14:36:39.554668 [error] [MainThread]:   Got 3 results, configured to fail if != 0
[0m14:36:39.555152 [info ] [MainThread]: 
[0m14:36:39.555676 [info ] [MainThread]:   compiled code at target/compiled/suvera/models/staging/schema.yml/dbt_utils_unique_combination_o_9bcb3333c5bdd713339ad9c078f2a49d.sql
[0m14:36:39.556180 [info ] [MainThread]: 
[0m14:36:39.556724 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m14:36:39.561053 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.078497, "process_in_blocks": "0", "process_kernel_time": 0.664602, "process_mem_max_rss": "141127680", "process_out_blocks": "0", "process_user_time": 3.847298}
[0m14:36:39.561656 [debug] [MainThread]: Command `dbt test` failed at 14:36:39.561535 after 2.08 seconds
[0m14:36:39.562087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd7da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c649b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c649910>]}
[0m14:36:39.562501 [debug] [MainThread]: Flushing usage events
[0m14:36:39.926131 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:49:28.567798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046cdd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056a7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056a7750>]}


============================== 14:49:28.578998 | 77b912fd-8b62-456f-93da-699d535f1c9b ==============================
[0m14:49:28.578998 [info ] [MainThread]: Running with dbt=1.10.1
[0m14:49:28.580065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select cleaned_patients', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:49:28.974638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77b912fd-8b62-456f-93da-699d535f1c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b55220>]}
[0m14:49:29.050802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77b912fd-8b62-456f-93da-699d535f1c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10558f350>]}
[0m14:49:29.077364 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m14:49:29.211060 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m14:49:29.459915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:49:29.460672 [debug] [MainThread]: Partial parsing: added file: suvera://models/intermediate/cleaned_patients.sql
[0m14:49:29.787368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77b912fd-8b62-456f-93da-699d535f1c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ebc250>]}
[0m14:49:29.886169 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m14:49:29.891345 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m14:49:29.945182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77b912fd-8b62-456f-93da-699d535f1c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10597ed50>]}
[0m14:49:29.945949 [info ] [MainThread]: Found 6 models, 4 seeds, 16 data tests, 544 macros
[0m14:49:29.946452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77b912fd-8b62-456f-93da-699d535f1c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f35390>]}
[0m14:49:29.948856 [info ] [MainThread]: 
[0m14:49:29.949380 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:49:29.949830 [info ] [MainThread]: 
[0m14:49:29.950573 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:49:29.951820 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m14:49:30.035127 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m14:49:30.035786 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m14:49:30.036315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:30.050226 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m14:49:30.050745 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m14:49:30.051680 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:49:30.052081 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m14:49:30.052454 [info ] [MainThread]: 
[0m14:49:30.052889 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m14:49:30.053535 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/puneeth/Documents/suvera_dbt_project/suvera/dev.duckdb": Conflicting lock is held in /usr/local/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 21330) by user puneeth. See also https://duckdb.org/docs/stable/connect/concurrency
[0m14:49:30.057405 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6005844, "process_in_blocks": "0", "process_kernel_time": 0.647587, "process_mem_max_rss": "130043904", "process_out_blocks": "0", "process_user_time": 3.09305}
[0m14:49:30.058234 [debug] [MainThread]: Command `dbt run` failed at 14:49:30.057978 after 1.60 seconds
[0m14:49:30.059139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e37ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105551a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10611cad0>]}
[0m14:49:30.059760 [debug] [MainThread]: Flushing usage events
[0m14:49:30.457115 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:56:43.088739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa29d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b803610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b803750>]}


============================== 14:56:43.098442 | 152dd349-9cfb-4ed4-8a44-d9dc1522981e ==============================
[0m14:56:43.098442 [info ] [MainThread]: Running with dbt=1.10.1
[0m14:56:43.099404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:56:43.506489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '152dd349-9cfb-4ed4-8a44-d9dc1522981e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acdd220>]}
[0m14:56:43.585029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '152dd349-9cfb-4ed4-8a44-d9dc1522981e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6ef350>]}
[0m14:56:43.612953 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m14:56:43.763307 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m14:56:44.006259 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:56:44.006697 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:56:44.062101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '152dd349-9cfb-4ed4-8a44-d9dc1522981e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10baff650>]}
[0m14:56:44.165494 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m14:56:44.170142 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m14:56:44.216934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '152dd349-9cfb-4ed4-8a44-d9dc1522981e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10baced50>]}
[0m14:56:44.217664 [info ] [MainThread]: Found 6 models, 4 seeds, 16 data tests, 544 macros
[0m14:56:44.218178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '152dd349-9cfb-4ed4-8a44-d9dc1522981e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf012b0>]}
[0m14:56:44.221298 [info ] [MainThread]: 
[0m14:56:44.221771 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:56:44.222160 [info ] [MainThread]: 
[0m14:56:44.222987 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:56:44.229733 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m14:56:44.304522 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m14:56:44.304989 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m14:56:44.305343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:44.326974 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m14:56:44.328478 [debug] [ThreadPool]: On list_dev: Close
[0m14:56:44.329223 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m14:56:44.329767 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m14:56:44.336352 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:56:44.336715 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m14:56:44.337028 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:56:44.338083 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:56:44.339474 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:56:44.339797 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m14:56:44.340310 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:56:44.340623 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:56:44.340928 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m14:56:44.341492 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:56:44.342383 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:56:44.342712 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:56:44.343018 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:56:44.343511 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:56:44.343844 [debug] [ThreadPool]: On create_dev_main: Close
[0m14:56:44.345680 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m14:56:44.351764 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:56:44.352213 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:56:44.352533 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:56:44.353249 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:56:44.353579 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:56:44.353903 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m14:56:44.368617 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m14:56:44.370274 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:56:44.372788 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:56:44.373375 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:56:44.375619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '152dd349-9cfb-4ed4-8a44-d9dc1522981e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c225640>]}
[0m14:56:44.376210 [debug] [MainThread]: Using duckdb connection "master"
[0m14:56:44.376589 [debug] [MainThread]: On master: BEGIN
[0m14:56:44.376943 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:56:44.377651 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:56:44.378049 [debug] [MainThread]: On master: COMMIT
[0m14:56:44.378424 [debug] [MainThread]: Using duckdb connection "master"
[0m14:56:44.378781 [debug] [MainThread]: On master: COMMIT
[0m14:56:44.379353 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:56:44.379771 [debug] [MainThread]: On master: Close
[0m14:56:44.384399 [debug] [Thread-1 (]: Began running node model.suvera.my_first_dbt_model
[0m14:56:44.385253 [info ] [Thread-1 (]: 1 of 5 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m14:56:44.385929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.my_first_dbt_model)
[0m14:56:44.386452 [debug] [Thread-1 (]: Began compiling node model.suvera.my_first_dbt_model
[0m14:56:44.395679 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.my_first_dbt_model"
[0m14:56:44.397185 [debug] [Thread-1 (]: Began executing node model.suvera.my_first_dbt_model
[0m14:56:44.436844 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.my_first_dbt_model"
[0m14:56:44.438589 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.my_first_dbt_model"
[0m14:56:44.439222 [debug] [Thread-1 (]: On model.suvera.my_first_dbt_model: BEGIN
[0m14:56:44.439730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:44.440577 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:56:44.441092 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.my_first_dbt_model"
[0m14:56:44.441634 [debug] [Thread-1 (]: On model.suvera.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m14:56:44.451392 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m14:56:44.458616 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.my_first_dbt_model"
[0m14:56:44.459057 [debug] [Thread-1 (]: On model.suvera.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:56:44.462925 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:56:44.478586 [debug] [Thread-1 (]: On model.suvera.my_first_dbt_model: COMMIT
[0m14:56:44.479079 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.my_first_dbt_model"
[0m14:56:44.479540 [debug] [Thread-1 (]: On model.suvera.my_first_dbt_model: COMMIT
[0m14:56:44.483522 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:56:44.489244 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.my_first_dbt_model"
[0m14:56:44.489700 [debug] [Thread-1 (]: On model.suvera.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m14:56:44.490459 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:56:44.492971 [debug] [Thread-1 (]: On model.suvera.my_first_dbt_model: Close
[0m14:56:44.495762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '152dd349-9cfb-4ed4-8a44-d9dc1522981e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c200410>]}
[0m14:56:44.497491 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.11s]
[0m14:56:44.498780 [debug] [Thread-1 (]: Finished running node model.suvera.my_first_dbt_model
[0m14:56:44.499366 [debug] [Thread-1 (]: Began running node model.suvera.stg_activities
[0m14:56:44.500019 [info ] [Thread-1 (]: 2 of 5 START sql view model main.stg_activities ................................ [RUN]
[0m14:56:44.500828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.my_first_dbt_model, now model.suvera.stg_activities)
[0m14:56:44.501370 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_activities
[0m14:56:44.504740 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_activities"
[0m14:56:44.506414 [debug] [Thread-1 (]: Began executing node model.suvera.stg_activities
[0m14:56:44.529506 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_activities"
[0m14:56:44.530851 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m14:56:44.531475 [debug] [Thread-1 (]: On model.suvera.stg_activities: BEGIN
[0m14:56:44.531839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:44.532657 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:56:44.533268 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m14:56:44.533645 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */

  
  create view "dev"."main"."stg_activities__dbt_tmp" as (
    select * 
from "dev"."main"."raw_activities"
limit 100
  );

[0m14:56:44.534473 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:56:44.537323 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m14:56:44.537708 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
alter view "dev"."main"."stg_activities" rename to "stg_activities__dbt_backup"
[0m14:56:44.538396 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:56:44.541585 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m14:56:44.542015 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
alter view "dev"."main"."stg_activities__dbt_tmp" rename to "stg_activities"
[0m14:56:44.543002 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:56:44.547238 [debug] [Thread-1 (]: On model.suvera.stg_activities: COMMIT
[0m14:56:44.547717 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m14:56:44.548127 [debug] [Thread-1 (]: On model.suvera.stg_activities: COMMIT
[0m14:56:44.549309 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:56:44.551621 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m14:56:44.552015 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
drop view if exists "dev"."main"."stg_activities__dbt_backup" cascade
[0m14:56:44.552937 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:56:44.554346 [debug] [Thread-1 (]: On model.suvera.stg_activities: Close
[0m14:56:44.554919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '152dd349-9cfb-4ed4-8a44-d9dc1522981e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10befa0a0>]}
[0m14:56:44.555563 [info ] [Thread-1 (]: 2 of 5 OK created sql view model main.stg_activities ........................... [[32mOK[0m in 0.05s]
[0m14:56:44.556280 [debug] [Thread-1 (]: Finished running node model.suvera.stg_activities
[0m14:56:44.556755 [debug] [Thread-1 (]: Began running node model.suvera.stg_patients
[0m14:56:44.557254 [info ] [Thread-1 (]: 3 of 5 START sql view model main.stg_patients .................................. [RUN]
[0m14:56:44.557958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_activities, now model.suvera.stg_patients)
[0m14:56:44.558362 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_patients
[0m14:56:44.561487 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_patients"
[0m14:56:44.563198 [debug] [Thread-1 (]: Began executing node model.suvera.stg_patients
[0m14:56:44.567334 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_patients"
[0m14:56:44.568772 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m14:56:44.569257 [debug] [Thread-1 (]: On model.suvera.stg_patients: BEGIN
[0m14:56:44.569623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:44.570299 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:56:44.570686 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m14:56:44.571095 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */

  
  create view "dev"."main"."stg_patients__dbt_tmp" as (
    with source as (
    select * from "dev"."main"."raw_patients"
),

parsed as (
    select
        regexp_extract(data, '"patient_id": ([0-9]+)', 1) as patient_id,
        regexp_extract(data, '"practice_id": ([0-9]+|null)', 1) as practice_id,
        regexp_extract(data, '"age": ([0-9]+)', 1) as age,
        regexp_extract(data, '"gender": "([^""]*)"', 1) as gender,
        regexp_extract(data, '"registration_date": "([^"]+)"', 1) as registration_date,
        regexp_extract(data, '"email": "([^"]+)"', 1) as email,
        regexp_extract(data, '"phone": "([^"]+)"', 1) as phone,
        string_split(replace(regexp_extract(data, '"conditions": \[(.*?)\]', 1),'"',''), ', ') as conditions
    from source
)

select * from parsed
  );

[0m14:56:44.572229 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:56:44.578509 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m14:56:44.578990 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients" rename to "stg_patients__dbt_backup"
[0m14:56:44.579738 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:56:44.583870 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m14:56:44.584486 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m14:56:44.585230 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:56:44.587075 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m14:56:44.587481 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m14:56:44.587846 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m14:56:44.588813 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:56:44.591045 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m14:56:44.591431 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
drop view if exists "dev"."main"."stg_patients__dbt_backup" cascade
[0m14:56:44.592411 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:56:44.593880 [debug] [Thread-1 (]: On model.suvera.stg_patients: Close
[0m14:56:44.594436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '152dd349-9cfb-4ed4-8a44-d9dc1522981e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2a6ad0>]}
[0m14:56:44.595058 [info ] [Thread-1 (]: 3 of 5 OK created sql view model main.stg_patients ............................. [[32mOK[0m in 0.04s]
[0m14:56:44.595883 [debug] [Thread-1 (]: Finished running node model.suvera.stg_patients
[0m14:56:44.596367 [debug] [Thread-1 (]: Began running node model.suvera.my_second_dbt_model
[0m14:56:44.596850 [info ] [Thread-1 (]: 4 of 5 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m14:56:44.597435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_patients, now model.suvera.my_second_dbt_model)
[0m14:56:44.597822 [debug] [Thread-1 (]: Began compiling node model.suvera.my_second_dbt_model
[0m14:56:44.670496 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.my_second_dbt_model"
[0m14:56:44.671539 [debug] [Thread-1 (]: Began executing node model.suvera.my_second_dbt_model
[0m14:56:44.675624 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.my_second_dbt_model"
[0m14:56:44.676539 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.my_second_dbt_model"
[0m14:56:44.677063 [debug] [Thread-1 (]: On model.suvera.my_second_dbt_model: BEGIN
[0m14:56:44.677554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:44.678388 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:56:44.678885 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.my_second_dbt_model"
[0m14:56:44.679391 [debug] [Thread-1 (]: On model.suvera.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m14:56:44.680369 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:56:44.684490 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.my_second_dbt_model"
[0m14:56:44.685030 [debug] [Thread-1 (]: On model.suvera.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:56:44.685981 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:56:44.687924 [debug] [Thread-1 (]: On model.suvera.my_second_dbt_model: COMMIT
[0m14:56:44.688487 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.my_second_dbt_model"
[0m14:56:44.688975 [debug] [Thread-1 (]: On model.suvera.my_second_dbt_model: COMMIT
[0m14:56:44.690153 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:56:44.692958 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.my_second_dbt_model"
[0m14:56:44.693461 [debug] [Thread-1 (]: On model.suvera.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m14:56:44.694201 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:56:44.695824 [debug] [Thread-1 (]: On model.suvera.my_second_dbt_model: Close
[0m14:56:44.696500 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '152dd349-9cfb-4ed4-8a44-d9dc1522981e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c19ead0>]}
[0m14:56:44.697267 [info ] [Thread-1 (]: 4 of 5 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.10s]
[0m14:56:44.697965 [debug] [Thread-1 (]: Finished running node model.suvera.my_second_dbt_model
[0m14:56:44.698428 [debug] [Thread-1 (]: Began running node model.suvera.cleaned_patients
[0m14:56:44.698954 [info ] [Thread-1 (]: 5 of 5 START sql view model main.cleaned_patients .............................. [RUN]
[0m14:56:44.699531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.my_second_dbt_model, now model.suvera.cleaned_patients)
[0m14:56:44.699981 [debug] [Thread-1 (]: Began compiling node model.suvera.cleaned_patients
[0m14:56:44.703279 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.cleaned_patients"
[0m14:56:44.704458 [debug] [Thread-1 (]: Began executing node model.suvera.cleaned_patients
[0m14:56:44.708946 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.cleaned_patients"
[0m14:56:44.710385 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m14:56:44.710846 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: BEGIN
[0m14:56:44.711246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:44.711969 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:56:44.712399 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m14:56:44.712834 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */

  
  create view "dev"."main"."cleaned_patients__dbt_tmp" as (
    with deduplicated as (
    select *
    from (
        select *,
               row_number() over (
                   partition by patient_id, practice_id
                   order by registration_date desc
               ) as row_num
        from "dev"."main"."stg_patients"
    )
    where row_num = 1
),

filtered as (
    select *
    from deduplicated
    where cast(age as integer) between 0 and 120
)

select
    patient_id,
    practice_id,
    cast(age as integer) as age,
    gender,
    registration_date,
    email,
    phone,
    conditions
from filtered
  );

[0m14:56:44.717313 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:56:44.721279 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m14:56:44.721756 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */
alter view "dev"."main"."cleaned_patients__dbt_tmp" rename to "cleaned_patients"
[0m14:56:44.722512 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:56:44.724026 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: COMMIT
[0m14:56:44.724432 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m14:56:44.724814 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: COMMIT
[0m14:56:44.725841 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:56:44.728123 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m14:56:44.728524 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */
drop view if exists "dev"."main"."cleaned_patients__dbt_backup" cascade
[0m14:56:44.729151 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:56:44.730570 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: Close
[0m14:56:44.731127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '152dd349-9cfb-4ed4-8a44-d9dc1522981e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2fe040>]}
[0m14:56:44.731759 [info ] [Thread-1 (]: 5 of 5 OK created sql view model main.cleaned_patients ......................... [[32mOK[0m in 0.03s]
[0m14:56:44.732427 [debug] [Thread-1 (]: Finished running node model.suvera.cleaned_patients
[0m14:56:44.733836 [debug] [MainThread]: Using duckdb connection "master"
[0m14:56:44.734182 [debug] [MainThread]: On master: BEGIN
[0m14:56:44.734494 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:56:44.735096 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:56:44.735426 [debug] [MainThread]: On master: COMMIT
[0m14:56:44.735748 [debug] [MainThread]: Using duckdb connection "master"
[0m14:56:44.736057 [debug] [MainThread]: On master: COMMIT
[0m14:56:44.736799 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:56:44.737205 [debug] [MainThread]: On master: Close
[0m14:56:44.737675 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:56:44.737988 [debug] [MainThread]: Connection 'model.suvera.cleaned_patients' was properly closed.
[0m14:56:44.738579 [info ] [MainThread]: 
[0m14:56:44.739296 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m14:56:44.741291 [debug] [MainThread]: Command end result
[0m14:56:44.775559 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m14:56:44.778444 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m14:56:44.789424 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m14:56:44.789847 [info ] [MainThread]: 
[0m14:56:44.790259 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:56:44.790617 [info ] [MainThread]: 
[0m14:56:44.790998 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m14:56:44.794439 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8057595, "process_in_blocks": "0", "process_kernel_time": 0.656341, "process_mem_max_rss": "135438336", "process_out_blocks": "0", "process_user_time": 3.253791}
[0m14:56:44.794971 [debug] [MainThread]: Command `dbt run` succeeded at 14:56:44.794852 after 1.81 seconds
[0m14:56:44.795517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109707d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c176450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1e6150>]}
[0m14:56:44.795999 [debug] [MainThread]: Flushing usage events
[0m14:56:45.207280 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:56:47.630300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7d1d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5e3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5e3750>]}


============================== 14:56:47.637850 | 73f29718-fe5e-4ede-bcdb-f0c5448f02fd ==============================
[0m14:56:47.637850 [info ] [MainThread]: Running with dbt=1.10.1
[0m14:56:47.638631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'profiles_dir': '/Users/puneeth/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:56:47.969865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73f29718-fe5e-4ede-bcdb-f0c5448f02fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eab5220>]}
[0m14:56:48.054587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73f29718-fe5e-4ede-bcdb-f0c5448f02fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4cb350>]}
[0m14:56:48.065706 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m14:56:48.192694 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m14:56:48.357253 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:56:48.357716 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:56:48.418948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73f29718-fe5e-4ede-bcdb-f0c5448f02fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8ebc50>]}
[0m14:56:48.541609 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m14:56:48.544240 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m14:56:48.579485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73f29718-fe5e-4ede-bcdb-f0c5448f02fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fcf77a0>]}
[0m14:56:48.580215 [info ] [MainThread]: Found 6 models, 4 seeds, 16 data tests, 544 macros
[0m14:56:48.580814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73f29718-fe5e-4ede-bcdb-f0c5448f02fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd652b0>]}
[0m14:56:48.584248 [info ] [MainThread]: 
[0m14:56:48.584794 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:56:48.585193 [info ] [MainThread]: 
[0m14:56:48.585996 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:56:48.592230 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m14:56:48.648093 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:56:48.648551 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:56:48.648890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:48.667928 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m14:56:48.668477 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:56:48.668821 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m14:56:48.684234 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m14:56:48.686326 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:56:48.687409 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:56:48.687748 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:56:48.689862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73f29718-fe5e-4ede-bcdb-f0c5448f02fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110100870>]}
[0m14:56:48.690350 [debug] [MainThread]: Using duckdb connection "master"
[0m14:56:48.690675 [debug] [MainThread]: On master: BEGIN
[0m14:56:48.690982 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:56:48.691661 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:56:48.692005 [debug] [MainThread]: On master: COMMIT
[0m14:56:48.692329 [debug] [MainThread]: Using duckdb connection "master"
[0m14:56:48.692639 [debug] [MainThread]: On master: COMMIT
[0m14:56:48.693153 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:56:48.693490 [debug] [MainThread]: On master: Close
[0m14:56:48.695746 [debug] [Thread-1 (]: Began running node test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b
[0m14:56:48.696206 [info ] [Thread-1 (]: 1 of 16 START test dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id  [RUN]
[0m14:56:48.696981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b)
[0m14:56:48.697587 [debug] [Thread-1 (]: Began compiling node test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b
[0m14:56:48.721542 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b"
[0m14:56:48.723605 [debug] [Thread-1 (]: Began executing node test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b
[0m14:56:48.746262 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b"
[0m14:56:48.747404 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b"
[0m14:56:48.748119 [debug] [Thread-1 (]: On test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b: BEGIN
[0m14:56:48.748695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:48.749887 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:56:48.750576 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b"
[0m14:56:48.751045 [debug] [Thread-1 (]: On test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        patient_id, practice_id
    from "dev"."main"."stg_patients"
    group by patient_id, practice_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m14:56:48.755064 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:56:48.759850 [debug] [Thread-1 (]: On test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b: ROLLBACK
[0m14:56:48.760594 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b'
[0m14:56:48.760997 [debug] [Thread-1 (]: On test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b: Close
[0m14:56:48.761670 [error] [Thread-1 (]: 1 of 16 FAIL 3 dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id  [[31mFAIL 3[0m in 0.06s]
[0m14:56:48.762511 [debug] [Thread-1 (]: Finished running node test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b
[0m14:56:48.762944 [debug] [Thread-1 (]: Began running node test.suvera.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:56:48.763346 [info ] [Thread-1 (]: 2 of 16 START test not_null_my_first_dbt_model_id .............................. [RUN]
[0m14:56:48.764175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id.e9e76b3e6b, now test.suvera.not_null_my_first_dbt_model_id.5fb22c2710)
[0m14:56:48.764831 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:56:48.772791 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:56:48.773657 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:56:48.775997 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:56:48.776782 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:56:48.777179 [debug] [Thread-1 (]: On test.suvera.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m14:56:48.777548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:48.778243 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:56:48.778641 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:56:48.779040 [debug] [Thread-1 (]: On test.suvera.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_my_first_dbt_model_id.5fb22c2710"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "dev"."main"."my_first_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m14:56:48.780870 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:56:48.783972 [debug] [Thread-1 (]: On test.suvera.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m14:56:48.785078 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_my_first_dbt_model_id.5fb22c2710'
[0m14:56:48.785477 [debug] [Thread-1 (]: On test.suvera.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m14:56:48.786142 [error] [Thread-1 (]: 2 of 16 FAIL 1 not_null_my_first_dbt_model_id .................................. [[31mFAIL 1[0m in 0.02s]
[0m14:56:48.786866 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:56:48.787289 [debug] [Thread-1 (]: Began running node test.suvera.not_null_my_second_dbt_model_id.151b76d778
[0m14:56:48.787680 [info ] [Thread-1 (]: 3 of 16 START test not_null_my_second_dbt_model_id ............................. [RUN]
[0m14:56:48.788327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_my_first_dbt_model_id.5fb22c2710, now test.suvera.not_null_my_second_dbt_model_id.151b76d778)
[0m14:56:48.788729 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_my_second_dbt_model_id.151b76d778
[0m14:56:48.793200 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_my_second_dbt_model_id.151b76d778"
[0m14:56:48.795326 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_my_second_dbt_model_id.151b76d778
[0m14:56:48.798089 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_my_second_dbt_model_id.151b76d778"
[0m14:56:48.799135 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_my_second_dbt_model_id.151b76d778"
[0m14:56:48.800619 [debug] [Thread-1 (]: On test.suvera.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m14:56:48.801511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:48.802671 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:56:48.803284 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_my_second_dbt_model_id.151b76d778"
[0m14:56:48.803688 [debug] [Thread-1 (]: On test.suvera.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_my_second_dbt_model_id.151b76d778"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "dev"."main"."my_second_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m14:56:48.805730 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:56:48.807708 [debug] [Thread-1 (]: On test.suvera.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m14:56:48.808457 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_my_second_dbt_model_id.151b76d778'
[0m14:56:48.808836 [debug] [Thread-1 (]: On test.suvera.not_null_my_second_dbt_model_id.151b76d778: Close
[0m14:56:48.809441 [info ] [Thread-1 (]: 3 of 16 PASS not_null_my_second_dbt_model_id ................................... [[32mPASS[0m in 0.02s]
[0m14:56:48.810141 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_my_second_dbt_model_id.151b76d778
[0m14:56:48.810598 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_activities_activity_date.51ab13376e
[0m14:56:48.810984 [info ] [Thread-1 (]: 4 of 16 START test not_null_stg_activities_activity_date ....................... [RUN]
[0m14:56:48.811610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_my_second_dbt_model_id.151b76d778, now test.suvera.not_null_stg_activities_activity_date.51ab13376e)
[0m14:56:48.812017 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_activities_activity_date.51ab13376e
[0m14:56:48.817971 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_activities_activity_date.51ab13376e"
[0m14:56:48.820322 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_activities_activity_date.51ab13376e
[0m14:56:48.823196 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_activities_activity_date.51ab13376e"
[0m14:56:48.824042 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_activity_date.51ab13376e"
[0m14:56:48.824458 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_date.51ab13376e: BEGIN
[0m14:56:48.824829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:48.825504 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:56:48.825894 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_activity_date.51ab13376e"
[0m14:56:48.826301 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_date.51ab13376e: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_activities_activity_date.51ab13376e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_date
from "dev"."main"."stg_activities"
where activity_date is null



  
  
      
    ) dbt_internal_test
[0m14:56:48.827446 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:56:48.829066 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_date.51ab13376e: ROLLBACK
[0m14:56:48.829725 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_activities_activity_date.51ab13376e'
[0m14:56:48.830270 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_date.51ab13376e: Close
[0m14:56:48.831106 [info ] [Thread-1 (]: 4 of 16 PASS not_null_stg_activities_activity_date ............................. [[32mPASS[0m in 0.02s]
[0m14:56:48.831982 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_activities_activity_date.51ab13376e
[0m14:56:48.832819 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a
[0m14:56:48.833955 [info ] [Thread-1 (]: 5 of 16 START test not_null_stg_activities_activity_id ......................... [RUN]
[0m14:56:48.835196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_activities_activity_date.51ab13376e, now test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a)
[0m14:56:48.835644 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a
[0m14:56:48.839724 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a"
[0m14:56:48.840538 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a
[0m14:56:48.846686 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a"
[0m14:56:48.848096 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a"
[0m14:56:48.848675 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a: BEGIN
[0m14:56:48.849936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:48.851436 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:56:48.851959 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a"
[0m14:56:48.852643 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_id
from "dev"."main"."stg_activities"
where activity_id is null



  
  
      
    ) dbt_internal_test
[0m14:56:48.854052 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:56:48.855781 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a: ROLLBACK
[0m14:56:48.856449 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a'
[0m14:56:48.856834 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a: Close
[0m14:56:48.857446 [info ] [Thread-1 (]: 5 of 16 PASS not_null_stg_activities_activity_id ............................... [[32mPASS[0m in 0.02s]
[0m14:56:48.858205 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a
[0m14:56:48.858623 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_activities_activity_type.69907e08a2
[0m14:56:48.859014 [info ] [Thread-1 (]: 6 of 16 START test not_null_stg_activities_activity_type ....................... [RUN]
[0m14:56:48.859666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_activities_activity_id.ad3ed58e2a, now test.suvera.not_null_stg_activities_activity_type.69907e08a2)
[0m14:56:48.860085 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_activities_activity_type.69907e08a2
[0m14:56:48.864131 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_activities_activity_type.69907e08a2"
[0m14:56:48.865826 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_activities_activity_type.69907e08a2
[0m14:56:48.868522 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_activities_activity_type.69907e08a2"
[0m14:56:48.869404 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_activity_type.69907e08a2"
[0m14:56:48.870028 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_type.69907e08a2: BEGIN
[0m14:56:48.870509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:48.871220 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:56:48.871649 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_activity_type.69907e08a2"
[0m14:56:48.872057 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_type.69907e08a2: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_activities_activity_type.69907e08a2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_type
from "dev"."main"."stg_activities"
where activity_type is null



  
  
      
    ) dbt_internal_test
[0m14:56:48.873277 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:56:48.874924 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_type.69907e08a2: ROLLBACK
[0m14:56:48.875595 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_activities_activity_type.69907e08a2'
[0m14:56:48.875991 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_activity_type.69907e08a2: Close
[0m14:56:48.876677 [info ] [Thread-1 (]: 6 of 16 PASS not_null_stg_activities_activity_type ............................. [[32mPASS[0m in 0.02s]
[0m14:56:48.877352 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_activities_activity_type.69907e08a2
[0m14:56:48.877822 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_activities_patient_id.199695ff40
[0m14:56:48.878235 [info ] [Thread-1 (]: 7 of 16 START test not_null_stg_activities_patient_id .......................... [RUN]
[0m14:56:48.878805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_activities_activity_type.69907e08a2, now test.suvera.not_null_stg_activities_patient_id.199695ff40)
[0m14:56:48.879367 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_activities_patient_id.199695ff40
[0m14:56:48.958225 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_activities_patient_id.199695ff40"
[0m14:56:48.959297 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_activities_patient_id.199695ff40
[0m14:56:48.962133 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_activities_patient_id.199695ff40"
[0m14:56:48.963100 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_patient_id.199695ff40"
[0m14:56:48.963643 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_patient_id.199695ff40: BEGIN
[0m14:56:48.964134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:48.966265 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:56:48.966930 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_activities_patient_id.199695ff40"
[0m14:56:48.967490 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_patient_id.199695ff40: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_activities_patient_id.199695ff40"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "dev"."main"."stg_activities"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m14:56:48.970559 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:56:48.973457 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_patient_id.199695ff40: ROLLBACK
[0m14:56:48.974614 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_activities_patient_id.199695ff40'
[0m14:56:48.975214 [debug] [Thread-1 (]: On test.suvera.not_null_stg_activities_patient_id.199695ff40: Close
[0m14:56:48.976039 [info ] [Thread-1 (]: 7 of 16 PASS not_null_stg_activities_patient_id ................................ [[32mPASS[0m in 0.10s]
[0m14:56:48.976910 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_activities_patient_id.199695ff40
[0m14:56:48.977457 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_age.7a0c6139fb
[0m14:56:48.977934 [info ] [Thread-1 (]: 8 of 16 START test not_null_stg_patients_age ................................... [RUN]
[0m14:56:48.978601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_activities_patient_id.199695ff40, now test.suvera.not_null_stg_patients_age.7a0c6139fb)
[0m14:56:48.979116 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_age.7a0c6139fb
[0m14:56:48.985538 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_age.7a0c6139fb"
[0m14:56:48.986428 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_age.7a0c6139fb
[0m14:56:48.988870 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_age.7a0c6139fb"
[0m14:56:48.990052 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_age.7a0c6139fb"
[0m14:56:48.990670 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_age.7a0c6139fb: BEGIN
[0m14:56:48.991094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:48.991801 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:56:48.992218 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_age.7a0c6139fb"
[0m14:56:48.992640 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_age.7a0c6139fb: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_age.7a0c6139fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select age
from "dev"."main"."stg_patients"
where age is null



  
  
      
    ) dbt_internal_test
[0m14:56:48.994361 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:56:48.996056 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_age.7a0c6139fb: ROLLBACK
[0m14:56:48.996899 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_age.7a0c6139fb'
[0m14:56:48.997782 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_age.7a0c6139fb: Close
[0m14:56:48.999599 [info ] [Thread-1 (]: 8 of 16 PASS not_null_stg_patients_age ......................................... [[32mPASS[0m in 0.02s]
[0m14:56:49.001046 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_age.7a0c6139fb
[0m14:56:49.002084 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_email.ce8e444e21
[0m14:56:49.002682 [info ] [Thread-1 (]: 9 of 16 START test not_null_stg_patients_email ................................. [RUN]
[0m14:56:49.003269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_age.7a0c6139fb, now test.suvera.not_null_stg_patients_email.ce8e444e21)
[0m14:56:49.003707 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_email.ce8e444e21
[0m14:56:49.009133 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_email.ce8e444e21"
[0m14:56:49.009971 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_email.ce8e444e21
[0m14:56:49.012212 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_email.ce8e444e21"
[0m14:56:49.013465 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_email.ce8e444e21"
[0m14:56:49.014424 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_email.ce8e444e21: BEGIN
[0m14:56:49.015075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:49.016237 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:56:49.016992 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_email.ce8e444e21"
[0m14:56:49.017787 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_email.ce8e444e21: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_email.ce8e444e21"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from "dev"."main"."stg_patients"
where email is null



  
  
      
    ) dbt_internal_test
[0m14:56:49.020304 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:56:49.023136 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_email.ce8e444e21: ROLLBACK
[0m14:56:49.024011 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_email.ce8e444e21'
[0m14:56:49.024542 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_email.ce8e444e21: Close
[0m14:56:49.025263 [info ] [Thread-1 (]: 9 of 16 PASS not_null_stg_patients_email ....................................... [[32mPASS[0m in 0.02s]
[0m14:56:49.025983 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_email.ce8e444e21
[0m14:56:49.026475 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_patient_id.e578180344
[0m14:56:49.026915 [info ] [Thread-1 (]: 10 of 16 START test not_null_stg_patients_patient_id ........................... [RUN]
[0m14:56:49.027536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_email.ce8e444e21, now test.suvera.not_null_stg_patients_patient_id.e578180344)
[0m14:56:49.028016 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_patient_id.e578180344
[0m14:56:49.035213 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_patient_id.e578180344"
[0m14:56:49.036214 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_patient_id.e578180344
[0m14:56:49.040185 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_patient_id.e578180344"
[0m14:56:49.041191 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_patient_id.e578180344"
[0m14:56:49.041613 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_patient_id.e578180344: BEGIN
[0m14:56:49.041982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:49.042704 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:56:49.043094 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_patient_id.e578180344"
[0m14:56:49.043487 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_patient_id.e578180344: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_patient_id.e578180344"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "dev"."main"."stg_patients"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m14:56:49.045204 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:56:49.048650 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_patient_id.e578180344: ROLLBACK
[0m14:56:49.049993 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_patient_id.e578180344'
[0m14:56:49.050887 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_patient_id.e578180344: Close
[0m14:56:49.051925 [info ] [Thread-1 (]: 10 of 16 PASS not_null_stg_patients_patient_id ................................. [[32mPASS[0m in 0.02s]
[0m14:56:49.052787 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_patient_id.e578180344
[0m14:56:49.053475 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_phone.4e628022ba
[0m14:56:49.054308 [info ] [Thread-1 (]: 11 of 16 START test not_null_stg_patients_phone ................................ [RUN]
[0m14:56:49.055428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_patient_id.e578180344, now test.suvera.not_null_stg_patients_phone.4e628022ba)
[0m14:56:49.056134 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_phone.4e628022ba
[0m14:56:49.061249 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_phone.4e628022ba"
[0m14:56:49.062472 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_phone.4e628022ba
[0m14:56:49.068440 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_phone.4e628022ba"
[0m14:56:49.069432 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_phone.4e628022ba"
[0m14:56:49.069999 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_phone.4e628022ba: BEGIN
[0m14:56:49.070625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:49.071561 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:56:49.072337 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_phone.4e628022ba"
[0m14:56:49.072815 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_phone.4e628022ba: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_phone.4e628022ba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select phone
from "dev"."main"."stg_patients"
where phone is null



  
  
      
    ) dbt_internal_test
[0m14:56:49.074841 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:56:49.076671 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_phone.4e628022ba: ROLLBACK
[0m14:56:49.077494 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_phone.4e628022ba'
[0m14:56:49.077949 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_phone.4e628022ba: Close
[0m14:56:49.078707 [info ] [Thread-1 (]: 11 of 16 PASS not_null_stg_patients_phone ...................................... [[32mPASS[0m in 0.02s]
[0m14:56:49.080351 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_phone.4e628022ba
[0m14:56:49.081310 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3
[0m14:56:49.082061 [info ] [Thread-1 (]: 12 of 16 START test not_null_stg_patients_practice_id .......................... [RUN]
[0m14:56:49.082640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_phone.4e628022ba, now test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3)
[0m14:56:49.083063 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3
[0m14:56:49.088687 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3"
[0m14:56:49.089463 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3
[0m14:56:49.092232 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3"
[0m14:56:49.093062 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3"
[0m14:56:49.093470 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3: BEGIN
[0m14:56:49.093848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:49.094519 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:56:49.094922 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3"
[0m14:56:49.095369 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select practice_id
from "dev"."main"."stg_patients"
where practice_id is null



  
  
      
    ) dbt_internal_test
[0m14:56:49.098130 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:56:49.101025 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3: ROLLBACK
[0m14:56:49.102026 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3'
[0m14:56:49.102551 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3: Close
[0m14:56:49.104006 [info ] [Thread-1 (]: 12 of 16 PASS not_null_stg_patients_practice_id ................................ [[32mPASS[0m in 0.02s]
[0m14:56:49.105729 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3
[0m14:56:49.106290 [debug] [Thread-1 (]: Began running node test.suvera.not_null_stg_patients_registration_date.51d8eb4a55
[0m14:56:49.106840 [info ] [Thread-1 (]: 13 of 16 START test not_null_stg_patients_registration_date .................... [RUN]
[0m14:56:49.107440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_practice_id.cb04c4a5e3, now test.suvera.not_null_stg_patients_registration_date.51d8eb4a55)
[0m14:56:49.107889 [debug] [Thread-1 (]: Began compiling node test.suvera.not_null_stg_patients_registration_date.51d8eb4a55
[0m14:56:49.113051 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.not_null_stg_patients_registration_date.51d8eb4a55"
[0m14:56:49.114151 [debug] [Thread-1 (]: Began executing node test.suvera.not_null_stg_patients_registration_date.51d8eb4a55
[0m14:56:49.117377 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.not_null_stg_patients_registration_date.51d8eb4a55"
[0m14:56:49.118641 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_registration_date.51d8eb4a55"
[0m14:56:49.119142 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_registration_date.51d8eb4a55: BEGIN
[0m14:56:49.119966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:49.121150 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:56:49.121918 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.not_null_stg_patients_registration_date.51d8eb4a55"
[0m14:56:49.122411 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_registration_date.51d8eb4a55: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.not_null_stg_patients_registration_date.51d8eb4a55"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select registration_date
from "dev"."main"."stg_patients"
where registration_date is null



  
  
      
    ) dbt_internal_test
[0m14:56:49.124458 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:56:49.126883 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_registration_date.51d8eb4a55: ROLLBACK
[0m14:56:49.128105 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.not_null_stg_patients_registration_date.51d8eb4a55'
[0m14:56:49.128955 [debug] [Thread-1 (]: On test.suvera.not_null_stg_patients_registration_date.51d8eb4a55: Close
[0m14:56:49.129731 [info ] [Thread-1 (]: 13 of 16 PASS not_null_stg_patients_registration_date .......................... [[32mPASS[0m in 0.02s]
[0m14:56:49.130587 [debug] [Thread-1 (]: Finished running node test.suvera.not_null_stg_patients_registration_date.51d8eb4a55
[0m14:56:49.131227 [debug] [Thread-1 (]: Began running node test.suvera.unique_my_first_dbt_model_id.16e066b321
[0m14:56:49.132073 [info ] [Thread-1 (]: 14 of 16 START test unique_my_first_dbt_model_id ............................... [RUN]
[0m14:56:49.132844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.not_null_stg_patients_registration_date.51d8eb4a55, now test.suvera.unique_my_first_dbt_model_id.16e066b321)
[0m14:56:49.133302 [debug] [Thread-1 (]: Began compiling node test.suvera.unique_my_first_dbt_model_id.16e066b321
[0m14:56:49.141377 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.unique_my_first_dbt_model_id.16e066b321"
[0m14:56:49.142236 [debug] [Thread-1 (]: Began executing node test.suvera.unique_my_first_dbt_model_id.16e066b321
[0m14:56:49.144845 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.unique_my_first_dbt_model_id.16e066b321"
[0m14:56:49.146016 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.unique_my_first_dbt_model_id.16e066b321"
[0m14:56:49.146545 [debug] [Thread-1 (]: On test.suvera.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m14:56:49.147170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:49.148166 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:56:49.148896 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.unique_my_first_dbt_model_id.16e066b321"
[0m14:56:49.149872 [debug] [Thread-1 (]: On test.suvera.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.unique_my_first_dbt_model_id.16e066b321"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."main"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:56:49.154660 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:56:49.156971 [debug] [Thread-1 (]: On test.suvera.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m14:56:49.157764 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.unique_my_first_dbt_model_id.16e066b321'
[0m14:56:49.158186 [debug] [Thread-1 (]: On test.suvera.unique_my_first_dbt_model_id.16e066b321: Close
[0m14:56:49.158851 [info ] [Thread-1 (]: 14 of 16 PASS unique_my_first_dbt_model_id ..................................... [[32mPASS[0m in 0.03s]
[0m14:56:49.159585 [debug] [Thread-1 (]: Finished running node test.suvera.unique_my_first_dbt_model_id.16e066b321
[0m14:56:49.160151 [debug] [Thread-1 (]: Began running node test.suvera.unique_my_second_dbt_model_id.57a0f8c493
[0m14:56:49.160806 [info ] [Thread-1 (]: 15 of 16 START test unique_my_second_dbt_model_id .............................. [RUN]
[0m14:56:49.161680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.unique_my_first_dbt_model_id.16e066b321, now test.suvera.unique_my_second_dbt_model_id.57a0f8c493)
[0m14:56:49.162157 [debug] [Thread-1 (]: Began compiling node test.suvera.unique_my_second_dbt_model_id.57a0f8c493
[0m14:56:49.167447 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:56:49.168377 [debug] [Thread-1 (]: Began executing node test.suvera.unique_my_second_dbt_model_id.57a0f8c493
[0m14:56:49.171674 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:56:49.172620 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:56:49.173097 [debug] [Thread-1 (]: On test.suvera.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m14:56:49.173498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:49.174214 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:56:49.174635 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:56:49.175050 [debug] [Thread-1 (]: On test.suvera.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.unique_my_second_dbt_model_id.57a0f8c493"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."main"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:56:49.176602 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:56:49.178762 [debug] [Thread-1 (]: On test.suvera.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m14:56:49.179548 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.unique_my_second_dbt_model_id.57a0f8c493'
[0m14:56:49.180014 [debug] [Thread-1 (]: On test.suvera.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m14:56:49.180854 [info ] [Thread-1 (]: 15 of 16 PASS unique_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.02s]
[0m14:56:49.182080 [debug] [Thread-1 (]: Finished running node test.suvera.unique_my_second_dbt_model_id.57a0f8c493
[0m14:56:49.182701 [debug] [Thread-1 (]: Began running node test.suvera.unique_stg_activities_activity_id.896c965cc8
[0m14:56:49.183554 [info ] [Thread-1 (]: 16 of 16 START test unique_stg_activities_activity_id .......................... [RUN]
[0m14:56:49.184894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.suvera.unique_my_second_dbt_model_id.57a0f8c493, now test.suvera.unique_stg_activities_activity_id.896c965cc8)
[0m14:56:49.185702 [debug] [Thread-1 (]: Began compiling node test.suvera.unique_stg_activities_activity_id.896c965cc8
[0m14:56:49.191548 [debug] [Thread-1 (]: Writing injected SQL for node "test.suvera.unique_stg_activities_activity_id.896c965cc8"
[0m14:56:49.192405 [debug] [Thread-1 (]: Began executing node test.suvera.unique_stg_activities_activity_id.896c965cc8
[0m14:56:49.196563 [debug] [Thread-1 (]: Writing runtime sql for node "test.suvera.unique_stg_activities_activity_id.896c965cc8"
[0m14:56:49.197882 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.unique_stg_activities_activity_id.896c965cc8"
[0m14:56:49.198517 [debug] [Thread-1 (]: On test.suvera.unique_stg_activities_activity_id.896c965cc8: BEGIN
[0m14:56:49.199176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:49.200338 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:56:49.201403 [debug] [Thread-1 (]: Using duckdb connection "test.suvera.unique_stg_activities_activity_id.896c965cc8"
[0m14:56:49.202719 [debug] [Thread-1 (]: On test.suvera.unique_stg_activities_activity_id.896c965cc8: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "test.suvera.unique_stg_activities_activity_id.896c965cc8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_activities"
where activity_id is not null
group by activity_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:56:49.205858 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:56:49.207892 [debug] [Thread-1 (]: On test.suvera.unique_stg_activities_activity_id.896c965cc8: ROLLBACK
[0m14:56:49.209071 [debug] [Thread-1 (]: Failed to rollback 'test.suvera.unique_stg_activities_activity_id.896c965cc8'
[0m14:56:49.209860 [debug] [Thread-1 (]: On test.suvera.unique_stg_activities_activity_id.896c965cc8: Close
[0m14:56:49.211013 [info ] [Thread-1 (]: 16 of 16 PASS unique_stg_activities_activity_id ................................ [[32mPASS[0m in 0.03s]
[0m14:56:49.211725 [debug] [Thread-1 (]: Finished running node test.suvera.unique_stg_activities_activity_id.896c965cc8
[0m14:56:49.213268 [debug] [MainThread]: Using duckdb connection "master"
[0m14:56:49.214071 [debug] [MainThread]: On master: BEGIN
[0m14:56:49.214809 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:56:49.215690 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:56:49.216099 [debug] [MainThread]: On master: COMMIT
[0m14:56:49.216454 [debug] [MainThread]: Using duckdb connection "master"
[0m14:56:49.216781 [debug] [MainThread]: On master: COMMIT
[0m14:56:49.217731 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:56:49.218363 [debug] [MainThread]: On master: Close
[0m14:56:49.218999 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:56:49.219364 [debug] [MainThread]: Connection 'test.suvera.unique_stg_activities_activity_id.896c965cc8' was properly closed.
[0m14:56:49.219817 [info ] [MainThread]: 
[0m14:56:49.220421 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m14:56:49.223878 [debug] [MainThread]: Command end result
[0m14:56:49.262136 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m14:56:49.264575 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m14:56:49.273553 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m14:56:49.274166 [info ] [MainThread]: 
[0m14:56:49.274735 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m14:56:49.275157 [info ] [MainThread]: 
[0m14:56:49.275676 [error] [MainThread]: [31mFailure in test dbt_utils_unique_combination_of_columns_stg_patients_patient_id__practice_id (models/staging/schema.yml)[0m
[0m14:56:49.276158 [error] [MainThread]:   Got 3 results, configured to fail if != 0
[0m14:56:49.276508 [info ] [MainThread]: 
[0m14:56:49.276950 [info ] [MainThread]:   compiled code at target/compiled/suvera/models/staging/schema.yml/dbt_utils_unique_combination_o_9bcb3333c5bdd713339ad9c078f2a49d.sql
[0m14:56:49.277495 [info ] [MainThread]: 
[0m14:56:49.277985 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m14:56:49.278424 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m14:56:49.278771 [info ] [MainThread]: 
[0m14:56:49.279292 [info ] [MainThread]:   compiled code at target/compiled/suvera/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m14:56:49.279728 [info ] [MainThread]: 
[0m14:56:49.280438 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=16
[0m14:56:49.284891 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.7480292, "process_in_blocks": "0", "process_kernel_time": 0.411176, "process_mem_max_rss": "139149312", "process_out_blocks": "0", "process_user_time": 3.117646}
[0m14:56:49.286291 [debug] [MainThread]: Command `dbt test` failed at 14:56:49.285482 after 1.75 seconds
[0m14:56:49.287382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f489a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110169020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110168f70>]}
[0m14:56:49.288098 [debug] [MainThread]: Flushing usage events
[0m14:56:49.647384 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:57:54.138885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10722dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10803f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10803f750>]}


============================== 14:57:54.148401 | 14b79826-2053-40a8-85e5-8e78726f0b0b ==============================
[0m14:57:54.148401 [info ] [MainThread]: Running with dbt=1.10.1
[0m14:57:54.149382 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select cleaned_patients', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:57:54.577401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14b79826-2053-40a8-85e5-8e78726f0b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107511220>]}
[0m14:57:54.654672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14b79826-2053-40a8-85e5-8e78726f0b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f27350>]}
[0m14:57:54.683726 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m14:57:54.827377 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m14:57:55.082193 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:57:55.082702 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:57:55.138858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14b79826-2053-40a8-85e5-8e78726f0b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108347650>]}
[0m14:57:55.242578 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m14:57:55.247677 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m14:57:55.290833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14b79826-2053-40a8-85e5-8e78726f0b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108316d50>]}
[0m14:57:55.291430 [info ] [MainThread]: Found 6 models, 4 seeds, 16 data tests, 544 macros
[0m14:57:55.291845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14b79826-2053-40a8-85e5-8e78726f0b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087652b0>]}
[0m14:57:55.293884 [info ] [MainThread]: 
[0m14:57:55.294314 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:57:55.294662 [info ] [MainThread]: 
[0m14:57:55.295268 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:57:55.296237 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m14:57:55.376020 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m14:57:55.376676 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m14:57:55.377395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:55.407255 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m14:57:55.408943 [debug] [ThreadPool]: On list_dev: Close
[0m14:57:55.409628 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m14:57:55.410114 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m14:57:55.416600 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:57:55.416971 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m14:57:55.417284 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:55.418384 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:57:55.419741 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:57:55.420062 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m14:57:55.420583 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:57:55.420895 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:57:55.421200 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m14:57:55.421811 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:57:55.422679 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:57:55.423005 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:57:55.423308 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:57:55.423812 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:57:55.424138 [debug] [ThreadPool]: On create_dev_main: Close
[0m14:57:55.430046 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m14:57:55.437068 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:57:55.437476 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:57:55.437779 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:55.438613 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:57:55.438936 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:57:55.439253 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m14:57:55.453356 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m14:57:55.455052 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:57:55.457651 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:57:55.458307 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:57:55.461477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14b79826-2053-40a8-85e5-8e78726f0b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a89710>]}
[0m14:57:55.462105 [debug] [MainThread]: Using duckdb connection "master"
[0m14:57:55.462532 [debug] [MainThread]: On master: BEGIN
[0m14:57:55.462935 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:57:55.463724 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:57:55.464168 [debug] [MainThread]: On master: COMMIT
[0m14:57:55.464592 [debug] [MainThread]: Using duckdb connection "master"
[0m14:57:55.465078 [debug] [MainThread]: On master: COMMIT
[0m14:57:55.465776 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:57:55.466251 [debug] [MainThread]: On master: Close
[0m14:57:55.470667 [debug] [Thread-1 (]: Began running node model.suvera.cleaned_patients
[0m14:57:55.471446 [info ] [Thread-1 (]: 1 of 1 START sql view model main.cleaned_patients .............................. [RUN]
[0m14:57:55.472057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.cleaned_patients)
[0m14:57:55.472515 [debug] [Thread-1 (]: Began compiling node model.suvera.cleaned_patients
[0m14:57:55.481659 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.cleaned_patients"
[0m14:57:55.482686 [debug] [Thread-1 (]: Began executing node model.suvera.cleaned_patients
[0m14:57:55.519530 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.cleaned_patients"
[0m14:57:55.520515 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m14:57:55.520917 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: BEGIN
[0m14:57:55.521281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:55.522003 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:57:55.522383 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m14:57:55.522900 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */

  
  create view "dev"."main"."cleaned_patients__dbt_tmp" as (
    with deduplicated as (
    select *
    from (
        select *,
               row_number() over (
                   partition by patient_id, practice_id
                   order by registration_date desc
               ) as row_num
        from "dev"."main"."stg_patients"
    )
    where row_num = 1
),

filtered as (
    select *
    from deduplicated
    where cast(age as integer) between 0 and 120
)

select
    patient_id,
    practice_id,
    cast(age as integer) as age,
    gender,
    registration_date,
    email,
    phone,
    conditions
from filtered
  );

[0m14:57:55.524477 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:57:55.530832 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m14:57:55.531573 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */
alter view "dev"."main"."cleaned_patients" rename to "cleaned_patients__dbt_backup"
[0m14:57:55.532393 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:57:55.535646 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m14:57:55.536059 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */
alter view "dev"."main"."cleaned_patients__dbt_tmp" rename to "cleaned_patients"
[0m14:57:55.536727 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:57:55.549486 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: COMMIT
[0m14:57:55.549936 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m14:57:55.550308 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: COMMIT
[0m14:57:55.551700 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:57:55.556603 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m14:57:55.556996 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */
drop view if exists "dev"."main"."cleaned_patients__dbt_backup" cascade
[0m14:57:55.558121 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:57:55.560619 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: Close
[0m14:57:55.563676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14b79826-2053-40a8-85e5-8e78726f0b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a21250>]}
[0m14:57:55.564617 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.cleaned_patients ......................... [[32mOK[0m in 0.09s]
[0m14:57:55.565744 [debug] [Thread-1 (]: Finished running node model.suvera.cleaned_patients
[0m14:57:55.567863 [debug] [MainThread]: Using duckdb connection "master"
[0m14:57:55.568403 [debug] [MainThread]: On master: BEGIN
[0m14:57:55.568850 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:57:55.569572 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:57:55.569908 [debug] [MainThread]: On master: COMMIT
[0m14:57:55.570228 [debug] [MainThread]: Using duckdb connection "master"
[0m14:57:55.570532 [debug] [MainThread]: On master: COMMIT
[0m14:57:55.571037 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:57:55.571366 [debug] [MainThread]: On master: Close
[0m14:57:55.571861 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:57:55.572395 [debug] [MainThread]: Connection 'model.suvera.cleaned_patients' was properly closed.
[0m14:57:55.572945 [info ] [MainThread]: 
[0m14:57:55.573457 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m14:57:55.574768 [debug] [MainThread]: Command end result
[0m14:57:55.612035 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m14:57:55.614068 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m14:57:55.620583 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m14:57:55.620940 [info ] [MainThread]: 
[0m14:57:55.621441 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:57:55.621847 [info ] [MainThread]: 
[0m14:57:55.622401 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:57:55.626403 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.59221, "process_in_blocks": "0", "process_kernel_time": 0.674354, "process_mem_max_rss": "134881280", "process_out_blocks": "0", "process_user_time": 3.088295}
[0m14:57:55.627133 [debug] [MainThread]: Command `dbt run` succeeded at 14:57:55.626991 after 1.59 seconds
[0m14:57:55.627630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10875a4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108adbf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108adb070>]}
[0m14:57:55.628098 [debug] [MainThread]: Flushing usage events
[0m14:57:55.998695 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:03:14.417605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d47dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e28f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e28f750>]}


============================== 15:03:14.425630 | 9290fa29-f797-43d6-8c0e-e35c5ebe0855 ==============================
[0m15:03:14.425630 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:03:14.426337 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select stg_patients', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:03:14.839428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9290fa29-f797-43d6-8c0e-e35c5ebe0855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d761220>]}
[0m15:03:14.927949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9290fa29-f797-43d6-8c0e-e35c5ebe0855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e177350>]}
[0m15:03:14.951295 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m15:03:15.095484 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:03:15.396411 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:03:15.398847 [debug] [MainThread]: Partial parsing: updated file: suvera://models/staging/stg_patients.sql
[0m15:03:16.033392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9290fa29-f797-43d6-8c0e-e35c5ebe0855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea54f50>]}
[0m15:03:16.211374 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m15:03:16.215853 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m15:03:16.270689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9290fa29-f797-43d6-8c0e-e35c5ebe0855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d222b70>]}
[0m15:03:16.271576 [info ] [MainThread]: Found 6 models, 4 seeds, 16 data tests, 544 macros
[0m15:03:16.272206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9290fa29-f797-43d6-8c0e-e35c5ebe0855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3d83d0>]}
[0m15:03:16.275146 [info ] [MainThread]: 
[0m15:03:16.275696 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:03:16.276147 [info ] [MainThread]: 
[0m15:03:16.277004 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:03:16.278368 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:03:16.355922 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:03:16.356464 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:03:16.356961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:16.378054 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m15:03:16.379626 [debug] [ThreadPool]: On list_dev: Close
[0m15:03:16.380373 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:03:16.381467 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:03:16.390397 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:03:16.390902 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m15:03:16.391286 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:03:16.392257 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:03:16.393663 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:03:16.393996 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:03:16.394619 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:03:16.394981 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:03:16.395299 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m15:03:16.395908 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:03:16.396849 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:03:16.397193 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:03:16.397512 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:03:16.398027 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:03:16.398373 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:03:16.404924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m15:03:16.410979 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:03:16.411367 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:03:16.411680 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:03:16.412314 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:03:16.412640 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:03:16.412971 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m15:03:16.427612 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m15:03:16.429266 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:03:16.430898 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:03:16.431261 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:03:16.433380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9290fa29-f797-43d6-8c0e-e35c5ebe0855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecb21a0>]}
[0m15:03:16.434014 [debug] [MainThread]: Using duckdb connection "master"
[0m15:03:16.434393 [debug] [MainThread]: On master: BEGIN
[0m15:03:16.434758 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:03:16.435453 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:03:16.435866 [debug] [MainThread]: On master: COMMIT
[0m15:03:16.436250 [debug] [MainThread]: Using duckdb connection "master"
[0m15:03:16.436614 [debug] [MainThread]: On master: COMMIT
[0m15:03:16.437167 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:03:16.437567 [debug] [MainThread]: On master: Close
[0m15:03:16.441270 [debug] [Thread-1 (]: Began running node model.suvera.stg_patients
[0m15:03:16.442013 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_patients .................................. [RUN]
[0m15:03:16.442631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.stg_patients)
[0m15:03:16.443093 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_patients
[0m15:03:16.451471 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_patients"
[0m15:03:16.453096 [debug] [Thread-1 (]: Began executing node model.suvera.stg_patients
[0m15:03:16.491276 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_patients"
[0m15:03:16.492191 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m15:03:16.492590 [debug] [Thread-1 (]: On model.suvera.stg_patients: BEGIN
[0m15:03:16.492958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:03:16.493654 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:03:16.494037 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m15:03:16.494448 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */

  
  create view "dev"."main"."stg_patients__dbt_tmp" as (
    with source as (
    select * from "dev"."main"."raw_patients"
),

parsed as (
    select
        cast(nullif(regexp_extract(data, '"patient_id": ([0-9]+)', 1), '') as integer) as patient_id,
        cast(nullif(regexp_extract(data, '"practice_id": ([0-9]+)', 1), '') as integer) as practice_id,
        cast(nullif(regexp_extract(data, '"age": ([0-9]+)', 1), '') as integer) as age,
        regexp_extract(data, '"gender": "([^""]*)"', 1) as gender,
        cast(nullif(regexp_extract(data, '"registration_date": "([^"]+)"', 1), '') as date) as registration_date,
        regexp_extract(data, '"email": "([^"]+)"', 1) as email,
        regexp_extract(data, '"phone": "([^"]+)"', 1) as phone,
        string_split(
            replace(
                regexp_extract(data, '"conditions": \[(.*?)\]', 1),
                '"',
                ''
            ),
            ', '
        ) as conditions
    from source
)

select * from parsed
  );

[0m15:03:16.495916 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:03:16.503045 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m15:03:16.503617 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients" rename to "stg_patients__dbt_backup"
[0m15:03:16.504752 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:03:16.507622 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m15:03:16.508008 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m15:03:16.508703 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:03:16.521256 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m15:03:16.521699 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m15:03:16.522076 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m15:03:16.523494 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:03:16.528692 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m15:03:16.529108 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
drop view if exists "dev"."main"."stg_patients__dbt_backup" cascade
[0m15:03:16.530208 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:03:16.532647 [debug] [Thread-1 (]: On model.suvera.stg_patients: Close
[0m15:03:16.535338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9290fa29-f797-43d6-8c0e-e35c5ebe0855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eca6150>]}
[0m15:03:16.536415 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_patients ............................. [[32mOK[0m in 0.09s]
[0m15:03:16.537351 [debug] [Thread-1 (]: Finished running node model.suvera.stg_patients
[0m15:03:16.538985 [debug] [MainThread]: Using duckdb connection "master"
[0m15:03:16.539522 [debug] [MainThread]: On master: BEGIN
[0m15:03:16.539851 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:03:16.540592 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:03:16.540937 [debug] [MainThread]: On master: COMMIT
[0m15:03:16.541280 [debug] [MainThread]: Using duckdb connection "master"
[0m15:03:16.541594 [debug] [MainThread]: On master: COMMIT
[0m15:03:16.542163 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:03:16.542606 [debug] [MainThread]: On master: Close
[0m15:03:16.543093 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:03:16.543565 [debug] [MainThread]: Connection 'model.suvera.stg_patients' was properly closed.
[0m15:03:16.544258 [info ] [MainThread]: 
[0m15:03:16.544873 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m15:03:16.546032 [debug] [MainThread]: Command end result
[0m15:03:16.587011 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m15:03:16.589282 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m15:03:16.597003 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m15:03:16.597441 [info ] [MainThread]: 
[0m15:03:16.598074 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:03:16.598531 [info ] [MainThread]: 
[0m15:03:16.599087 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:03:16.603345 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.300323, "process_in_blocks": "0", "process_kernel_time": 0.71038, "process_mem_max_rss": "139124736", "process_out_blocks": "0", "process_user_time": 3.760613}
[0m15:03:16.604339 [debug] [MainThread]: Command `dbt run` succeeded at 15:03:16.604132 after 2.30 seconds
[0m15:03:16.604850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e923960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e434370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e434410>]}
[0m15:03:16.605457 [debug] [MainThread]: Flushing usage events
[0m15:03:17.000483 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:04:05.904876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a89d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105863610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105863750>]}


============================== 15:04:05.914924 | a992e270-bfcb-4bd6-b1df-529387e962cf ==============================
[0m15:04:05.914924 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:04:05.915994 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select cleaned_patients', 'send_anonymous_usage_stats': 'True'}
[0m15:04:06.297324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a992e270-bfcb-4bd6-b1df-529387e962cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d49220>]}
[0m15:04:06.372178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a992e270-bfcb-4bd6-b1df-529387e962cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10574f350>]}
[0m15:04:06.397769 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m15:04:06.549193 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:04:06.815081 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:04:06.815622 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:04:06.881390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a992e270-bfcb-4bd6-b1df-529387e962cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b5f650>]}
[0m15:04:07.000225 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m15:04:07.004742 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m15:04:07.058788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a992e270-bfcb-4bd6-b1df-529387e962cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b2ed50>]}
[0m15:04:07.059453 [info ] [MainThread]: Found 6 models, 4 seeds, 16 data tests, 544 macros
[0m15:04:07.059922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a992e270-bfcb-4bd6-b1df-529387e962cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f612b0>]}
[0m15:04:07.062190 [info ] [MainThread]: 
[0m15:04:07.062665 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:04:07.063060 [info ] [MainThread]: 
[0m15:04:07.063727 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:04:07.064781 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:04:07.158237 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:04:07.158901 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:04:07.159432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:07.175888 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:04:07.176507 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m15:04:07.177605 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:04:07.178040 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m15:04:07.178470 [info ] [MainThread]: 
[0m15:04:07.178965 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m15:04:07.179676 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/puneeth/Documents/suvera_dbt_project/suvera/dev.duckdb": Conflicting lock is held in /usr/local/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 23113) by user puneeth. See also https://duckdb.org/docs/stable/connect/concurrency
[0m15:04:07.184144 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3739645, "process_in_blocks": "0", "process_kernel_time": 0.640253, "process_mem_max_rss": "125743104", "process_out_blocks": "0", "process_user_time": 2.869682}
[0m15:04:07.184923 [debug] [MainThread]: Command `dbt run` failed at 15:04:07.184770 after 1.37 seconds
[0m15:04:07.185485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106284a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105711a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d87f50>]}
[0m15:04:07.186098 [debug] [MainThread]: Flushing usage events
[0m15:04:07.547263 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:04:25.594987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f2dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f07610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f07750>]}


============================== 15:04:25.600556 | 71ce141b-bbe9-45e8-8cc3-3746b7177d95 ==============================
[0m15:04:25.600556 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:04:25.601335 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'version_check': 'True', 'profiles_dir': '/Users/puneeth/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select cleaned_patients', 'send_anonymous_usage_stats': 'True'}
[0m15:04:25.901182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71ce141b-bbe9-45e8-8cc3-3746b7177d95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073b5220>]}
[0m15:04:25.974823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71ce141b-bbe9-45e8-8cc3-3746b7177d95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107def350>]}
[0m15:04:25.985185 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m15:04:26.096984 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:04:26.249118 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:04:26.249555 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:04:26.304389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71ce141b-bbe9-45e8-8cc3-3746b7177d95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108213650>]}
[0m15:04:26.402563 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m15:04:26.405114 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m15:04:26.422556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71ce141b-bbe9-45e8-8cc3-3746b7177d95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081e2d50>]}
[0m15:04:26.423103 [info ] [MainThread]: Found 6 models, 4 seeds, 16 data tests, 544 macros
[0m15:04:26.423528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71ce141b-bbe9-45e8-8cc3-3746b7177d95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085fd2b0>]}
[0m15:04:26.425583 [info ] [MainThread]: 
[0m15:04:26.426180 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:04:26.426596 [info ] [MainThread]: 
[0m15:04:26.427358 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:04:26.428332 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:04:26.496041 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:04:26.496553 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:04:26.496948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:26.516021 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m15:04:26.517534 [debug] [ThreadPool]: On list_dev: Close
[0m15:04:26.518217 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:04:26.519194 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:04:26.525776 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:04:26.526131 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m15:04:26.526445 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:04:26.527503 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:04:26.528871 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:04:26.529345 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:04:26.529946 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:04:26.530262 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:04:26.530577 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m15:04:26.531213 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:04:26.532118 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:04:26.532451 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:04:26.532758 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:04:26.533315 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:04:26.533680 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:04:26.539902 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m15:04:26.545840 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:04:26.546299 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:04:26.546610 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:04:26.547320 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:04:26.547646 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:04:26.547963 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m15:04:26.561842 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m15:04:26.563474 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:04:26.565261 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:04:26.565677 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:04:26.567831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71ce141b-bbe9-45e8-8cc3-3746b7177d95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108955570>]}
[0m15:04:26.568315 [debug] [MainThread]: Using duckdb connection "master"
[0m15:04:26.568634 [debug] [MainThread]: On master: BEGIN
[0m15:04:26.568944 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:04:26.569777 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:04:26.570120 [debug] [MainThread]: On master: COMMIT
[0m15:04:26.570477 [debug] [MainThread]: Using duckdb connection "master"
[0m15:04:26.570782 [debug] [MainThread]: On master: COMMIT
[0m15:04:26.571307 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:04:26.571641 [debug] [MainThread]: On master: Close
[0m15:04:26.575873 [debug] [Thread-1 (]: Began running node model.suvera.cleaned_patients
[0m15:04:26.576649 [info ] [Thread-1 (]: 1 of 1 START sql view model main.cleaned_patients .............................. [RUN]
[0m15:04:26.577252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.cleaned_patients)
[0m15:04:26.577715 [debug] [Thread-1 (]: Began compiling node model.suvera.cleaned_patients
[0m15:04:26.586575 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.cleaned_patients"
[0m15:04:26.587880 [debug] [Thread-1 (]: Began executing node model.suvera.cleaned_patients
[0m15:04:26.624333 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.cleaned_patients"
[0m15:04:26.625964 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m15:04:26.626496 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: BEGIN
[0m15:04:26.626893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:26.627609 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:04:26.627992 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m15:04:26.628399 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */

  
  create view "dev"."main"."cleaned_patients__dbt_tmp" as (
    with deduplicated as (
    select *
    from (
        select *,
               row_number() over (
                   partition by patient_id, practice_id
                   order by registration_date desc
               ) as row_num
        from "dev"."main"."stg_patients"
    )
    where row_num = 1
),

filtered as (
    select *
    from deduplicated
    where cast(age as integer) between 0 and 120
)

select
    patient_id,
    practice_id,
    cast(age as integer) as age,
    gender,
    registration_date,
    email,
    phone,
    conditions
from filtered
  );

[0m15:04:26.630516 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:04:26.637450 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m15:04:26.637923 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */
alter view "dev"."main"."cleaned_patients" rename to "cleaned_patients__dbt_backup"
[0m15:04:26.638781 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:04:26.642128 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m15:04:26.642540 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */
alter view "dev"."main"."cleaned_patients__dbt_tmp" rename to "cleaned_patients"
[0m15:04:26.643260 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:04:26.657605 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: COMMIT
[0m15:04:26.658097 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m15:04:26.658473 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: COMMIT
[0m15:04:26.659795 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:04:26.664754 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m15:04:26.665159 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */
drop view if exists "dev"."main"."cleaned_patients__dbt_backup" cascade
[0m15:04:26.666193 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:04:26.668809 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: Close
[0m15:04:26.671699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71ce141b-bbe9-45e8-8cc3-3746b7177d95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10891d250>]}
[0m15:04:26.672600 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.cleaned_patients ......................... [[32mOK[0m in 0.09s]
[0m15:04:26.673339 [debug] [Thread-1 (]: Finished running node model.suvera.cleaned_patients
[0m15:04:26.674744 [debug] [MainThread]: Using duckdb connection "master"
[0m15:04:26.675092 [debug] [MainThread]: On master: BEGIN
[0m15:04:26.675405 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:04:26.676032 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:04:26.676368 [debug] [MainThread]: On master: COMMIT
[0m15:04:26.676691 [debug] [MainThread]: Using duckdb connection "master"
[0m15:04:26.677003 [debug] [MainThread]: On master: COMMIT
[0m15:04:26.677498 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:04:26.677835 [debug] [MainThread]: On master: Close
[0m15:04:26.678247 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:04:26.678552 [debug] [MainThread]: Connection 'model.suvera.cleaned_patients' was properly closed.
[0m15:04:26.678880 [info ] [MainThread]: 
[0m15:04:26.679241 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m15:04:26.680289 [debug] [MainThread]: Command end result
[0m15:04:26.717139 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m15:04:26.719228 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m15:04:26.726006 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m15:04:26.726392 [info ] [MainThread]: 
[0m15:04:26.726822 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:04:26.727300 [info ] [MainThread]: 
[0m15:04:26.727761 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:04:26.731454 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2176338, "process_in_blocks": "0", "process_kernel_time": 0.339141, "process_mem_max_rss": "136327168", "process_out_blocks": "0", "process_user_time": 2.532571}
[0m15:04:26.732126 [debug] [MainThread]: Command `dbt run` succeeded at 15:04:26.731974 after 1.22 seconds
[0m15:04:26.732684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085f64c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108913f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108913070>]}
[0m15:04:26.733166 [debug] [MainThread]: Flushing usage events
[0m15:04:27.096581 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:17:50.674385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a55d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108867610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108867750>]}


============================== 15:17:50.687300 | 354f6e82-5704-4ed0-be5e-04b101062f16 ==============================
[0m15:17:50.687300 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:17:50.688336 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select qa_flagged_patients', 'send_anonymous_usage_stats': 'True'}
[0m15:17:51.089131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '354f6e82-5704-4ed0-be5e-04b101062f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d35220>]}
[0m15:17:51.163827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '354f6e82-5704-4ed0-be5e-04b101062f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10874f350>]}
[0m15:17:51.192244 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m15:17:51.329619 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:17:51.586704 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:17:51.587386 [debug] [MainThread]: Partial parsing: added file: suvera://models/qa/qa_flagged_patients.sql
[0m15:17:51.920024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '354f6e82-5704-4ed0-be5e-04b101062f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fec350>]}
[0m15:17:52.017837 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m15:17:52.022688 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m15:17:52.072224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '354f6e82-5704-4ed0-be5e-04b101062f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b3ed50>]}
[0m15:17:52.072936 [info ] [MainThread]: Found 7 models, 4 seeds, 16 data tests, 544 macros
[0m15:17:52.073405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '354f6e82-5704-4ed0-be5e-04b101062f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090f1390>]}
[0m15:17:52.075722 [info ] [MainThread]: 
[0m15:17:52.076188 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:17:52.076571 [info ] [MainThread]: 
[0m15:17:52.077286 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:17:52.078741 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:17:52.162813 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:17:52.163363 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:17:52.163773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:52.176482 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:17:52.176984 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m15:17:52.177913 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:17:52.178252 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m15:17:52.178578 [info ] [MainThread]: 
[0m15:17:52.179085 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m15:17:52.179732 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/puneeth/Documents/suvera_dbt_project/suvera/dev.duckdb": Conflicting lock is held in /usr/local/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 23334) by user puneeth. See also https://duckdb.org/docs/stable/connect/concurrency
[0m15:17:52.184021 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6200035, "process_in_blocks": "0", "process_kernel_time": 0.646756, "process_mem_max_rss": "129445888", "process_out_blocks": "0", "process_user_time": 3.097304}
[0m15:17:52.184795 [debug] [MainThread]: Command `dbt run` failed at 15:17:52.184643 after 1.62 seconds
[0m15:17:52.185319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10904fe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10870da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092d4b90>]}
[0m15:17:52.185906 [debug] [MainThread]: Flushing usage events
[0m15:17:52.623930 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:18:08.815070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e25d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bff610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bff750>]}


============================== 15:18:08.824185 | 30eca8c3-d4a3-4341-a40c-9beb569a8058 ==============================
[0m15:18:08.824185 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:18:08.825207 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select qa_flagged_patients', 'send_anonymous_usage_stats': 'True'}
[0m15:18:09.220895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30eca8c3-d4a3-4341-a40c-9beb569a8058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050d9220>]}
[0m15:18:09.325971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30eca8c3-d4a3-4341-a40c-9beb569a8058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aeb350>]}
[0m15:18:09.349089 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m15:18:09.500551 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:18:09.806151 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:18:09.807151 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:18:09.885967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30eca8c3-d4a3-4341-a40c-9beb569a8058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105efb650>]}
[0m15:18:10.008175 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m15:18:10.011994 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m15:18:10.054712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30eca8c3-d4a3-4341-a40c-9beb569a8058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eced50>]}
[0m15:18:10.055527 [info ] [MainThread]: Found 7 models, 4 seeds, 16 data tests, 544 macros
[0m15:18:10.056501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30eca8c3-d4a3-4341-a40c-9beb569a8058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062fd2b0>]}
[0m15:18:10.059210 [info ] [MainThread]: 
[0m15:18:10.060272 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:18:10.060838 [info ] [MainThread]: 
[0m15:18:10.061590 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:18:10.062561 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:18:10.138248 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:18:10.138904 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:18:10.139372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:10.161047 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m15:18:10.163118 [debug] [ThreadPool]: On list_dev: Close
[0m15:18:10.164248 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:18:10.164992 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:18:10.172499 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:18:10.172965 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m15:18:10.173315 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:10.174656 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:18:10.176238 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:18:10.176596 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:18:10.177101 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:18:10.177424 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:18:10.177746 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m15:18:10.178283 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:18:10.179215 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:18:10.179562 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:18:10.179885 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:18:10.180385 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:18:10.180813 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:18:10.187944 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m15:18:10.197080 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:18:10.197988 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:18:10.198673 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:10.199939 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:18:10.200326 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:18:10.200660 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m15:18:10.216589 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m15:18:10.218252 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:18:10.221063 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:18:10.221538 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:18:10.225895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30eca8c3-d4a3-4341-a40c-9beb569a8058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062a7d40>]}
[0m15:18:10.226647 [debug] [MainThread]: Using duckdb connection "master"
[0m15:18:10.227311 [debug] [MainThread]: On master: BEGIN
[0m15:18:10.227637 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:18:10.228327 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:18:10.228673 [debug] [MainThread]: On master: COMMIT
[0m15:18:10.229000 [debug] [MainThread]: Using duckdb connection "master"
[0m15:18:10.229308 [debug] [MainThread]: On master: COMMIT
[0m15:18:10.229812 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:18:10.230498 [debug] [MainThread]: On master: Close
[0m15:18:10.234432 [debug] [Thread-1 (]: Began running node model.suvera.qa_flagged_patients
[0m15:18:10.235079 [info ] [Thread-1 (]: 1 of 1 START sql view model main.qa_flagged_patients ........................... [RUN]
[0m15:18:10.235599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.qa_flagged_patients)
[0m15:18:10.236018 [debug] [Thread-1 (]: Began compiling node model.suvera.qa_flagged_patients
[0m15:18:10.244530 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.qa_flagged_patients"
[0m15:18:10.246610 [debug] [Thread-1 (]: Began executing node model.suvera.qa_flagged_patients
[0m15:18:10.287359 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.qa_flagged_patients"
[0m15:18:10.288615 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m15:18:10.289074 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: BEGIN
[0m15:18:10.289456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:10.290156 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:18:10.290563 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m15:18:10.290971 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */

  
  create view "dev"."main"."qa_flagged_patients__dbt_tmp" as (
    with source as (
    select *
    from "dev"."main"."stg_patients"
),

deduplicated as (
    select *
    from (
        select *,
               row_number() over (
                   partition by patient_id, practice_id
                   order by registration_date desc
               ) as row_num
        from source
    )
),

filtered_out as (
    select *
    from deduplicated
    where row_num > 1
       or try_cast(age as integer) not between 0 and 120
)

select * from filtered_out
  );

[0m15:18:10.292908 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:18:10.299510 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m15:18:10.299960 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */
alter view "dev"."main"."qa_flagged_patients__dbt_tmp" rename to "qa_flagged_patients"
[0m15:18:10.301133 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:18:10.315719 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: COMMIT
[0m15:18:10.316236 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m15:18:10.316625 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: COMMIT
[0m15:18:10.317971 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:18:10.323242 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m15:18:10.323695 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */
drop view if exists "dev"."main"."qa_flagged_patients__dbt_backup" cascade
[0m15:18:10.324444 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:18:10.326926 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: Close
[0m15:18:10.329411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30eca8c3-d4a3-4341-a40c-9beb569a8058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106551250>]}
[0m15:18:10.330709 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.qa_flagged_patients ...................... [[32mOK[0m in 0.09s]
[0m15:18:10.331623 [debug] [Thread-1 (]: Finished running node model.suvera.qa_flagged_patients
[0m15:18:10.333321 [debug] [MainThread]: Using duckdb connection "master"
[0m15:18:10.333752 [debug] [MainThread]: On master: BEGIN
[0m15:18:10.334077 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:18:10.334761 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:18:10.335282 [debug] [MainThread]: On master: COMMIT
[0m15:18:10.335633 [debug] [MainThread]: Using duckdb connection "master"
[0m15:18:10.335954 [debug] [MainThread]: On master: COMMIT
[0m15:18:10.336856 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:18:10.337383 [debug] [MainThread]: On master: Close
[0m15:18:10.338103 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:10.339198 [debug] [MainThread]: Connection 'model.suvera.qa_flagged_patients' was properly closed.
[0m15:18:10.340156 [info ] [MainThread]: 
[0m15:18:10.340739 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m15:18:10.341797 [debug] [MainThread]: Command end result
[0m15:18:10.377995 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m15:18:10.380678 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m15:18:10.388788 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m15:18:10.389778 [info ] [MainThread]: 
[0m15:18:10.390894 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:18:10.391633 [info ] [MainThread]: 
[0m15:18:10.392124 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:18:10.395840 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6891174, "process_in_blocks": "0", "process_kernel_time": 0.659712, "process_mem_max_rss": "134250496", "process_out_blocks": "0", "process_user_time": 3.265978}
[0m15:18:10.396491 [debug] [MainThread]: Command `dbt run` succeeded at 15:18:10.396359 after 1.69 seconds
[0m15:18:10.397241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062f64c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106673250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106673e30>]}
[0m15:18:10.397795 [debug] [MainThread]: Flushing usage events
[0m15:18:10.759963 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:26:43.173272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b61d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b3b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b3b750>]}


============================== 15:26:43.182797 | 9843a592-8c24-41fb-93ee-9c3d9143676b ==============================
[0m15:26:43.182797 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:26:43.183747 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_practices', 'send_anonymous_usage_stats': 'True'}
[0m15:26:43.577540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9843a592-8c24-41fb-93ee-9c3d9143676b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fe9220>]}
[0m15:26:43.664995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9843a592-8c24-41fb-93ee-9c3d9143676b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a23350>]}
[0m15:26:43.692150 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m15:26:43.832333 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:26:44.035217 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:26:44.036026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9843a592-8c24-41fb-93ee-9c3d9143676b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e47950>]}
[0m15:26:46.313522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9843a592-8c24-41fb-93ee-9c3d9143676b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0da990>]}
[0m15:26:46.435505 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m15:26:46.440402 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m15:26:46.484648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9843a592-8c24-41fb-93ee-9c3d9143676b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a419fd0>]}
[0m15:26:46.485399 [info ] [MainThread]: Found 6 models, 4 seeds, 12 data tests, 544 macros
[0m15:26:46.486068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9843a592-8c24-41fb-93ee-9c3d9143676b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a33b6c0>]}
[0m15:26:46.488875 [info ] [MainThread]: 
[0m15:26:46.489469 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:26:46.489827 [info ] [MainThread]: 
[0m15:26:46.490412 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:26:46.491351 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:26:46.573170 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:26:46.573726 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:26:46.574112 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:46.587728 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:26:46.588241 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m15:26:46.589181 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:26:46.589505 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m15:26:46.589826 [info ] [MainThread]: 
[0m15:26:46.590191 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m15:26:46.590814 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/puneeth/Documents/suvera_dbt_project/suvera/dev.duckdb": Conflicting lock is held in /usr/local/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 24258) by user puneeth. See also https://duckdb.org/docs/stable/connect/concurrency
[0m15:26:46.595987 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.5351856, "process_in_blocks": "0", "process_kernel_time": 0.68865, "process_mem_max_rss": "132399104", "process_out_blocks": "0", "process_user_time": 4.988866}
[0m15:26:46.596872 [debug] [MainThread]: Command `dbt run` failed at 15:26:46.596727 after 3.54 seconds
[0m15:26:46.597330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099e5a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3726d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a372780>]}
[0m15:26:46.597802 [debug] [MainThread]: Flushing usage events
[0m15:26:47.006521 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:26:54.089143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105859d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10666b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10666b750>]}


============================== 15:26:54.098224 | c0e7b631-695e-4676-a304-a07c35141077 ==============================
[0m15:26:54.098224 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:26:54.099089 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_practices', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:26:54.425330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0e7b631-695e-4676-a304-a07c35141077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b3d220>]}
[0m15:26:54.504135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0e7b631-695e-4676-a304-a07c35141077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106553350>]}
[0m15:26:54.532305 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m15:26:54.670761 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:26:54.925351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:26:54.925881 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:26:54.987323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0e7b631-695e-4676-a304-a07c35141077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106973650>]}
[0m15:26:55.089936 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m15:26:55.092577 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m15:26:55.140846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0e7b631-695e-4676-a304-a07c35141077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106942d50>]}
[0m15:26:55.141768 [info ] [MainThread]: Found 6 models, 4 seeds, 12 data tests, 544 macros
[0m15:26:55.142388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0e7b631-695e-4676-a304-a07c35141077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d80c90>]}
[0m15:26:55.145246 [info ] [MainThread]: 
[0m15:26:55.145776 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:26:55.146208 [info ] [MainThread]: 
[0m15:26:55.147027 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:26:55.148504 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:26:55.230393 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:26:55.231357 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:26:55.232147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:55.256051 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m15:26:55.257546 [debug] [ThreadPool]: On list_dev: Close
[0m15:26:55.258227 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:26:55.259318 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:26:55.267717 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:26:55.268170 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m15:26:55.268539 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:55.269718 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:26:55.271226 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:26:55.271551 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:26:55.272059 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:26:55.272366 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:26:55.272672 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m15:26:55.273231 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:26:55.274102 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:26:55.274431 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:26:55.274732 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:26:55.275222 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:26:55.275552 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:26:55.281486 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m15:26:55.289264 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:26:55.289664 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:26:55.289976 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:55.290831 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:26:55.291153 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:26:55.291473 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m15:26:55.307108 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m15:26:55.308865 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:26:55.310765 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:26:55.311258 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:26:55.314187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0e7b631-695e-4676-a304-a07c35141077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070913d0>]}
[0m15:26:55.314747 [debug] [MainThread]: Using duckdb connection "master"
[0m15:26:55.315124 [debug] [MainThread]: On master: BEGIN
[0m15:26:55.315481 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:26:55.316181 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:26:55.316583 [debug] [MainThread]: On master: COMMIT
[0m15:26:55.316958 [debug] [MainThread]: Using duckdb connection "master"
[0m15:26:55.317318 [debug] [MainThread]: On master: COMMIT
[0m15:26:55.317894 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:26:55.318304 [debug] [MainThread]: On master: Close
[0m15:26:55.322370 [debug] [Thread-1 (]: Began running node model.suvera.stg_practices
[0m15:26:55.323143 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_practices ................................. [RUN]
[0m15:26:55.323753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.stg_practices)
[0m15:26:55.324210 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_practices
[0m15:26:55.333160 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_practices"
[0m15:26:55.334468 [debug] [Thread-1 (]: Began executing node model.suvera.stg_practices
[0m15:26:55.370498 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_practices"
[0m15:26:55.371465 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m15:26:55.371857 [debug] [Thread-1 (]: On model.suvera.stg_practices: BEGIN
[0m15:26:55.372212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:55.372921 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:26:55.373305 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m15:26:55.373678 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */

  
  create view "dev"."main"."stg_practices__dbt_tmp" as (
    select * 
from "dev"."main"."raw_practices"
  );

[0m15:26:55.374847 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:26:55.381363 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m15:26:55.382057 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */
alter view "dev"."main"."stg_practices__dbt_tmp" rename to "stg_practices"
[0m15:26:55.383121 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:26:55.394278 [debug] [Thread-1 (]: On model.suvera.stg_practices: COMMIT
[0m15:26:55.394754 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m15:26:55.395133 [debug] [Thread-1 (]: On model.suvera.stg_practices: COMMIT
[0m15:26:55.396740 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:26:55.406542 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m15:26:55.407285 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */
drop view if exists "dev"."main"."stg_practices__dbt_backup" cascade
[0m15:26:55.408360 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:26:55.412109 [debug] [Thread-1 (]: On model.suvera.stg_practices: Close
[0m15:26:55.415112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0e7b631-695e-4676-a304-a07c35141077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107045250>]}
[0m15:26:55.416175 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_practices ............................ [[32mOK[0m in 0.09s]
[0m15:26:55.417049 [debug] [Thread-1 (]: Finished running node model.suvera.stg_practices
[0m15:26:55.418670 [debug] [MainThread]: Using duckdb connection "master"
[0m15:26:55.419136 [debug] [MainThread]: On master: BEGIN
[0m15:26:55.419553 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:26:55.420336 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:26:55.420786 [debug] [MainThread]: On master: COMMIT
[0m15:26:55.421204 [debug] [MainThread]: Using duckdb connection "master"
[0m15:26:55.421566 [debug] [MainThread]: On master: COMMIT
[0m15:26:55.422197 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:26:55.422647 [debug] [MainThread]: On master: Close
[0m15:26:55.423180 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:26:55.423551 [debug] [MainThread]: Connection 'model.suvera.stg_practices' was properly closed.
[0m15:26:55.423954 [info ] [MainThread]: 
[0m15:26:55.424432 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m15:26:55.425642 [debug] [MainThread]: Command end result
[0m15:26:55.463984 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m15:26:55.466014 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m15:26:55.473452 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m15:26:55.473944 [info ] [MainThread]: 
[0m15:26:55.474596 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:26:55.475098 [info ] [MainThread]: 
[0m15:26:55.475614 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:26:55.479974 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4935677, "process_in_blocks": "0", "process_kernel_time": 0.58094, "process_mem_max_rss": "134680576", "process_out_blocks": "0", "process_user_time": 3.002122}
[0m15:26:55.480799 [debug] [MainThread]: Command `dbt run` succeeded at 15:26:55.480630 after 1.49 seconds
[0m15:26:55.481356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d4e150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10700b6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10700b390>]}
[0m15:26:55.482033 [debug] [MainThread]: Flushing usage events
[0m15:26:55.844740 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:27:27.750377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5cdd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5a7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5a7750>]}


============================== 15:27:27.755702 | 482f2e7f-9a36-4665-b763-81a02d610f35 ==============================
[0m15:27:27.755702 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:27:27.756517 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select stg_pcns', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:27:28.082233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '482f2e7f-9a36-4665-b763-81a02d610f35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba55220>]}
[0m15:27:28.171597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '482f2e7f-9a36-4665-b763-81a02d610f35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c48f350>]}
[0m15:27:28.184808 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m15:27:28.317244 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:27:28.479648 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:27:28.480098 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:27:28.540437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '482f2e7f-9a36-4665-b763-81a02d610f35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8b3650>]}
[0m15:27:28.646516 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m15:27:28.648954 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m15:27:28.668974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '482f2e7f-9a36-4665-b763-81a02d610f35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c882d50>]}
[0m15:27:28.669701 [info ] [MainThread]: Found 6 models, 4 seeds, 12 data tests, 544 macros
[0m15:27:28.670300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '482f2e7f-9a36-4665-b763-81a02d610f35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc90c90>]}
[0m15:27:28.672811 [info ] [MainThread]: 
[0m15:27:28.673316 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:27:28.673729 [info ] [MainThread]: 
[0m15:27:28.674375 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:27:28.675267 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:27:28.746396 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:27:28.747974 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:27:28.748959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:27:28.786681 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m15:27:28.789435 [debug] [ThreadPool]: On list_dev: Close
[0m15:27:28.791159 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:27:28.792425 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:27:28.807530 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:27:28.807998 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m15:27:28.808339 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:27:28.809342 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:27:28.810959 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:27:28.811385 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:27:28.812174 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:27:28.815284 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:27:28.817795 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m15:27:28.820191 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:27:28.822767 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:27:28.823392 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:27:28.823800 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:27:28.824755 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:27:28.825235 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:27:28.834117 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m15:27:28.840937 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:27:28.841376 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:27:28.841706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:27:28.842360 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:27:28.842708 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:27:28.843040 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m15:27:28.869632 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m15:27:28.871435 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:27:28.872611 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:27:28.872960 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:27:28.875462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '482f2e7f-9a36-4665-b763-81a02d610f35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf81160>]}
[0m15:27:28.875989 [debug] [MainThread]: Using duckdb connection "master"
[0m15:27:28.876329 [debug] [MainThread]: On master: BEGIN
[0m15:27:28.876713 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:27:28.877918 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:27:28.878746 [debug] [MainThread]: On master: COMMIT
[0m15:27:28.879446 [debug] [MainThread]: Using duckdb connection "master"
[0m15:27:28.880268 [debug] [MainThread]: On master: COMMIT
[0m15:27:28.881335 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:27:28.882390 [debug] [MainThread]: On master: Close
[0m15:27:28.886229 [debug] [Thread-1 (]: Began running node model.suvera.stg_pcns
[0m15:27:28.887017 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_pcns ...................................... [RUN]
[0m15:27:28.888174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.stg_pcns)
[0m15:27:28.888871 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_pcns
[0m15:27:28.903966 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_pcns"
[0m15:27:28.904870 [debug] [Thread-1 (]: Began executing node model.suvera.stg_pcns
[0m15:27:28.940931 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_pcns"
[0m15:27:28.942014 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m15:27:28.942492 [debug] [Thread-1 (]: On model.suvera.stg_pcns: BEGIN
[0m15:27:28.942937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:28.944029 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:27:28.944524 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m15:27:28.944979 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */

  
  create view "dev"."main"."stg_pcns__dbt_tmp" as (
    select * 
from "dev"."main"."raw_pcns"
  );

[0m15:27:28.946083 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:27:28.952429 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m15:27:28.953027 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */
alter view "dev"."main"."stg_pcns__dbt_tmp" rename to "stg_pcns"
[0m15:27:28.953906 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:27:28.966908 [debug] [Thread-1 (]: On model.suvera.stg_pcns: COMMIT
[0m15:27:28.967389 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m15:27:28.967768 [debug] [Thread-1 (]: On model.suvera.stg_pcns: COMMIT
[0m15:27:28.969094 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:27:28.976454 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m15:27:28.977430 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */
drop view if exists "dev"."main"."stg_pcns__dbt_backup" cascade
[0m15:27:28.978802 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:27:28.983105 [debug] [Thread-1 (]: On model.suvera.stg_pcns: Close
[0m15:27:28.985963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '482f2e7f-9a36-4665-b763-81a02d610f35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfad310>]}
[0m15:27:28.987005 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_pcns ................................. [[32mOK[0m in 0.10s]
[0m15:27:28.987941 [debug] [Thread-1 (]: Finished running node model.suvera.stg_pcns
[0m15:27:28.989444 [debug] [MainThread]: Using duckdb connection "master"
[0m15:27:28.989859 [debug] [MainThread]: On master: BEGIN
[0m15:27:28.990225 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:27:28.990897 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:27:28.991284 [debug] [MainThread]: On master: COMMIT
[0m15:27:28.991663 [debug] [MainThread]: Using duckdb connection "master"
[0m15:27:28.992024 [debug] [MainThread]: On master: COMMIT
[0m15:27:28.992636 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:27:28.993050 [debug] [MainThread]: On master: Close
[0m15:27:28.993881 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:27:28.994431 [debug] [MainThread]: Connection 'model.suvera.stg_pcns' was properly closed.
[0m15:27:28.995044 [info ] [MainThread]: 
[0m15:27:28.995672 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m15:27:28.996770 [debug] [MainThread]: Command end result
[0m15:27:29.028874 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m15:27:29.031143 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m15:27:29.039410 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m15:27:29.039800 [info ] [MainThread]: 
[0m15:27:29.040424 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:27:29.040855 [info ] [MainThread]: 
[0m15:27:29.041314 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:27:29.046546 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3788439, "process_in_blocks": "0", "process_kernel_time": 0.359065, "process_mem_max_rss": "134619136", "process_out_blocks": "0", "process_user_time": 2.635303}
[0m15:27:29.047367 [debug] [MainThread]: Command `dbt run` succeeded at 15:27:29.047206 after 1.38 seconds
[0m15:27:29.047900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccb6150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf476b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf47390>]}
[0m15:27:29.048332 [debug] [MainThread]: Flushing usage events
[0m15:27:29.405625 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:33:17.910331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060add30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ebf610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ebf750>]}


============================== 15:33:17.921210 | 27127365-4b05-4fb2-a555-b2778eca2439 ==============================
[0m15:33:17.921210 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:33:17.922070 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select mart_patient_count_by_pcn', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:33:18.325611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27127365-4b05-4fb2-a555-b2778eca2439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106391220>]}
[0m15:33:18.403825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27127365-4b05-4fb2-a555-b2778eca2439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106da7350>]}
[0m15:33:18.423871 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m15:33:18.561466 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:33:18.819520 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:33:18.820188 [debug] [MainThread]: Partial parsing: added file: suvera://models/marts/mart_patient_count_by_pcn.sql
[0m15:33:19.139425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27127365-4b05-4fb2-a555-b2778eca2439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107644350>]}
[0m15:33:19.235761 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m15:33:19.241012 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m15:33:19.289815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27127365-4b05-4fb2-a555-b2778eca2439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107196d50>]}
[0m15:33:19.290585 [info ] [MainThread]: Found 7 models, 4 seeds, 12 data tests, 544 macros
[0m15:33:19.291089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27127365-4b05-4fb2-a555-b2778eca2439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107724bb0>]}
[0m15:33:19.293245 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:33:19.293963 [debug] [MainThread]: Command end result
[0m15:33:19.406708 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m15:33:19.411181 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m15:33:19.417939 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m15:33:19.423359 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6259915, "process_in_blocks": "0", "process_kernel_time": 0.652716, "process_mem_max_rss": "122716160", "process_out_blocks": "0", "process_user_time": 3.174764}
[0m15:33:19.424143 [debug] [MainThread]: Command `dbt run` succeeded at 15:33:19.423988 after 1.63 seconds
[0m15:33:19.424685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076afd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d65a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075df7d0>]}
[0m15:33:19.425205 [debug] [MainThread]: Flushing usage events
[0m15:33:19.814696 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:33:30.848324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105555d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106367610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106367750>]}


============================== 15:33:30.853680 | c623e40f-03b8-4e8c-9d09-4a02c18d7176 ==============================
[0m15:33:30.853680 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:33:30.854462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select mart_patient_count_by_pcn', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:33:31.146739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c623e40f-03b8-4e8c-9d09-4a02c18d7176', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105835220>]}
[0m15:33:31.221946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c623e40f-03b8-4e8c-9d09-4a02c18d7176', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106253350>]}
[0m15:33:31.232177 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m15:33:31.342965 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:33:31.487737 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:33:31.488465 [debug] [MainThread]: Partial parsing: updated file: suvera://models/marts/mart_patient_count_by_pcn.sql
[0m15:33:31.787705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c623e40f-03b8-4e8c-9d09-4a02c18d7176', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aec350>]}
[0m15:33:31.881919 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m15:33:31.884272 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m15:33:31.903216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c623e40f-03b8-4e8c-9d09-4a02c18d7176', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10663ed50>]}
[0m15:33:31.904053 [info ] [MainThread]: Found 7 models, 4 seeds, 12 data tests, 544 macros
[0m15:33:31.904603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c623e40f-03b8-4e8c-9d09-4a02c18d7176', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd0830>]}
[0m15:33:31.907143 [info ] [MainThread]: 
[0m15:33:31.907642 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:33:31.908024 [info ] [MainThread]: 
[0m15:33:31.908661 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:33:31.909754 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:33:31.993352 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:33:31.993864 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:33:31.994265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:32.007746 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:33:32.008258 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m15:33:32.009213 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:33:32.009555 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m15:33:32.009882 [info ] [MainThread]: 
[0m15:33:32.010450 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m15:33:32.011084 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/puneeth/Documents/suvera_dbt_project/suvera/dev.duckdb": Conflicting lock is held in /usr/local/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 24999) by user puneeth. See also https://duckdb.org/docs/stable/connect/concurrency
[0m15:33:32.014638 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2475908, "process_in_blocks": "0", "process_kernel_time": 0.324006, "process_mem_max_rss": "129949696", "process_out_blocks": "0", "process_user_time": 2.547041}
[0m15:33:32.015242 [debug] [MainThread]: Command `dbt run` failed at 15:33:32.015113 after 1.25 seconds
[0m15:33:32.015901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b4bd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10620da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc0ad0>]}
[0m15:33:32.016529 [debug] [MainThread]: Flushing usage events
[0m15:33:32.378803 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:33:43.504777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3d5d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1e7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1e7750>]}


============================== 15:33:43.514533 | b56bd469-df51-4db2-a0b4-d531ffee1e5b ==============================
[0m15:33:43.514533 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:33:43.515556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'debug': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select mart_patient_count_by_pcn', 'send_anonymous_usage_stats': 'True'}
[0m15:33:43.836905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b56bd469-df51-4db2-a0b4-d531ffee1e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6b9220>]}
[0m15:33:43.909256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b56bd469-df51-4db2-a0b4-d531ffee1e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0cf350>]}
[0m15:33:43.934641 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m15:33:44.066065 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:33:44.312974 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:33:44.313525 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:33:44.373142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b56bd469-df51-4db2-a0b4-d531ffee1e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4ef650>]}
[0m15:33:44.469992 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m15:33:44.474040 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m15:33:44.524480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b56bd469-df51-4db2-a0b4-d531ffee1e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4bed50>]}
[0m15:33:44.525317 [info ] [MainThread]: Found 7 models, 4 seeds, 12 data tests, 544 macros
[0m15:33:44.525877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b56bd469-df51-4db2-a0b4-d531ffee1e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8ecc90>]}
[0m15:33:44.528423 [info ] [MainThread]: 
[0m15:33:44.528968 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:33:44.529432 [info ] [MainThread]: 
[0m15:33:44.530110 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:33:44.531124 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:33:44.602298 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:33:44.602812 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:33:44.603207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:44.621559 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m15:33:44.623074 [debug] [ThreadPool]: On list_dev: Close
[0m15:33:44.623773 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:33:44.624854 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:33:44.633947 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:33:44.634434 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m15:33:44.634847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:33:44.635809 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:33:44.637227 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:33:44.637547 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:33:44.638049 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:33:44.638361 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:33:44.638667 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m15:33:44.639221 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:33:44.640155 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:33:44.640488 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:33:44.640793 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:33:44.641278 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:33:44.641609 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:33:44.647887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m15:33:44.653873 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:33:44.654255 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:33:44.654561 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:33:44.655828 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:33:44.656286 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:33:44.656652 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m15:33:44.673320 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m15:33:44.675138 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:33:44.676952 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:33:44.677346 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:33:44.680056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b56bd469-df51-4db2-a0b4-d531ffee1e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc294a0>]}
[0m15:33:44.680550 [debug] [MainThread]: Using duckdb connection "master"
[0m15:33:44.680866 [debug] [MainThread]: On master: BEGIN
[0m15:33:44.681166 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:33:44.681837 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:33:44.682164 [debug] [MainThread]: On master: COMMIT
[0m15:33:44.682482 [debug] [MainThread]: Using duckdb connection "master"
[0m15:33:44.682781 [debug] [MainThread]: On master: COMMIT
[0m15:33:44.683268 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:33:44.683598 [debug] [MainThread]: On master: Close
[0m15:33:44.687637 [debug] [Thread-1 (]: Began running node model.suvera.mart_patient_count_by_pcn
[0m15:33:44.688409 [info ] [Thread-1 (]: 1 of 1 START sql view model main.mart_patient_count_by_pcn ..................... [RUN]
[0m15:33:44.689005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.mart_patient_count_by_pcn)
[0m15:33:44.689463 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_patient_count_by_pcn
[0m15:33:44.698529 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_patient_count_by_pcn"
[0m15:33:44.700195 [debug] [Thread-1 (]: Began executing node model.suvera.mart_patient_count_by_pcn
[0m15:33:44.738290 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_patient_count_by_pcn"
[0m15:33:44.739300 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m15:33:44.739701 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: BEGIN
[0m15:33:44.740067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:44.740784 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:33:44.741162 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m15:33:44.741558 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patient_count_by_pcn"} */

  
  create view "dev"."main"."mart_patient_count_by_pcn__dbt_tmp" as (
    with patients as (
    select *
    from "dev"."main"."cleaned_patients"
),

practices as (
    select *
    from "dev"."main"."stg_practices"
),

pcns as (
    select *
    from "dev"."main"."stg_pcns"
),

joined as (
    select
        pcn.pcn_id,
        pcn.pcn_name,
        patient.patient_id
    from patients as patient
    left join practices as practice
        on patient.practice_id = practice.practice_id
    left join pcns as pcn
        on practice.pcn_id = pcn.pcn_id
)

select
    pcn_id,
    pcn_name,
    count(distinct patient_id) as num_patients
from joined
group by 1, 2
order by num_patients desc
  );

[0m15:33:44.745872 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patient_count_by_pcn"} */

  
  create view "dev"."main"."mart_patient_count_by_pcn__dbt_tmp" as (
    with patients as (
    select *
    from "dev"."main"."cleaned_patients"
),

practices as (
    select *
    from "dev"."main"."stg_practices"
),

pcns as (
    select *
    from "dev"."main"."stg_pcns"
),

joined as (
    select
        pcn.pcn_id,
        pcn.pcn_name,
        patient.patient_id
    from patients as patient
    left join practices as practice
        on patient.practice_id = practice.practice_id
    left join pcns as pcn
        on practice.pcn_id = pcn.pcn_id
)

select
    pcn_id,
    pcn_name,
    count(distinct patient_id) as num_patients
from joined
group by 1, 2
order by num_patients desc
  );

[0m15:33:44.746668 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:33:44.747176 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: ROLLBACK
[0m15:33:44.768090 [debug] [Thread-1 (]: Failed to rollback 'model.suvera.mart_patient_count_by_pcn'
[0m15:33:44.768632 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: Close
[0m15:33:44.772970 [debug] [Thread-1 (]: Runtime Error in model mart_patient_count_by_pcn (models/marts/mart_patient_count_by_pcn.sql)
  Binder Error: Values list "practice" does not have a column named "practice_id"
  
  LINE 27:         on patient.practice_id = practice.practice_id
                                            ^
[0m15:33:44.775406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b56bd469-df51-4db2-a0b4-d531ffee1e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbcd550>]}
[0m15:33:44.776384 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.mart_patient_count_by_pcn ............ [[31mERROR[0m in 0.08s]
[0m15:33:44.777273 [debug] [Thread-1 (]: Finished running node model.suvera.mart_patient_count_by_pcn
[0m15:33:44.777859 [debug] [Thread-4 (]: Marking all children of 'model.suvera.mart_patient_count_by_pcn' to be skipped because of status 'error'.  Reason: Runtime Error in model mart_patient_count_by_pcn (models/marts/mart_patient_count_by_pcn.sql)
  Binder Error: Values list "practice" does not have a column named "practice_id"
  
  LINE 27:         on patient.practice_id = practice.practice_id
                                            ^.
[0m15:33:44.780072 [debug] [MainThread]: Using duckdb connection "master"
[0m15:33:44.780424 [debug] [MainThread]: On master: BEGIN
[0m15:33:44.780723 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:33:44.781409 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:33:44.781741 [debug] [MainThread]: On master: COMMIT
[0m15:33:44.782056 [debug] [MainThread]: Using duckdb connection "master"
[0m15:33:44.782356 [debug] [MainThread]: On master: COMMIT
[0m15:33:44.782861 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:33:44.783370 [debug] [MainThread]: On master: Close
[0m15:33:44.784052 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:33:44.784361 [debug] [MainThread]: Connection 'model.suvera.mart_patient_count_by_pcn' was properly closed.
[0m15:33:44.784866 [info ] [MainThread]: 
[0m15:33:44.785397 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m15:33:44.786321 [debug] [MainThread]: Command end result
[0m15:33:44.821929 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m15:33:44.823982 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m15:33:44.830637 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m15:33:44.831003 [info ] [MainThread]: 
[0m15:33:44.831500 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:33:44.831940 [info ] [MainThread]: 
[0m15:33:44.832463 [error] [MainThread]: [31mFailure in model mart_patient_count_by_pcn (models/marts/mart_patient_count_by_pcn.sql)[0m
[0m15:33:44.833067 [error] [MainThread]:   Runtime Error in model mart_patient_count_by_pcn (models/marts/mart_patient_count_by_pcn.sql)
  Binder Error: Values list "practice" does not have a column named "practice_id"
  
  LINE 27:         on patient.practice_id = practice.practice_id
                                            ^
[0m15:33:44.833509 [info ] [MainThread]: 
[0m15:33:44.834028 [info ] [MainThread]:   compiled code at target/compiled/suvera/models/marts/mart_patient_count_by_pcn.sql
[0m15:33:44.834503 [info ] [MainThread]: 
[0m15:33:44.834965 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:33:44.838936 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4252152, "process_in_blocks": "0", "process_kernel_time": 0.493229, "process_mem_max_rss": "136503296", "process_out_blocks": "0", "process_user_time": 2.820483}
[0m15:33:44.839847 [debug] [MainThread]: Command `dbt run` failed at 15:33:44.839535 after 1.43 seconds
[0m15:33:44.840576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8ea150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc7da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc7fbb0>]}
[0m15:33:44.841082 [debug] [MainThread]: Flushing usage events
[0m15:33:45.207731 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:37:24.570075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2e9d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2c3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2c3750>]}


============================== 15:37:24.579902 | d3269ea6-5eab-45a0-95e9-42dd9bdd1ae1 ==============================
[0m15:37:24.579902 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:37:24.580881 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'debug': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select mart_patient_count_by_pcn', 'send_anonymous_usage_stats': 'True'}
[0m15:37:25.117205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3269ea6-5eab-45a0-95e9-42dd9bdd1ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d771220>]}
[0m15:37:25.192808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3269ea6-5eab-45a0-95e9-42dd9bdd1ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1af350>]}
[0m15:37:25.220653 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m15:37:25.357153 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:37:25.621485 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:37:25.622383 [debug] [MainThread]: Partial parsing: updated file: suvera://models/marts/mart_patient_count_by_pcn.sql
[0m15:37:25.940812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3269ea6-5eab-45a0-95e9-42dd9bdd1ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea4c350>]}
[0m15:37:26.037709 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m15:37:26.045141 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m15:37:26.100099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3269ea6-5eab-45a0-95e9-42dd9bdd1ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e59ed50>]}
[0m15:37:26.100857 [info ] [MainThread]: Found 7 models, 4 seeds, 12 data tests, 544 macros
[0m15:37:26.101320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3269ea6-5eab-45a0-95e9-42dd9bdd1ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb30830>]}
[0m15:37:26.103613 [info ] [MainThread]: 
[0m15:37:26.104079 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:37:26.104472 [info ] [MainThread]: 
[0m15:37:26.105127 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:37:26.106111 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:37:26.194658 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:37:26.195117 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:37:26.195454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:26.342145 [debug] [ThreadPool]: SQL status: OK in 0.147 seconds
[0m15:37:26.344321 [debug] [ThreadPool]: On list_dev: Close
[0m15:37:26.345181 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:37:26.346116 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:37:26.353256 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:37:26.353637 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m15:37:26.353965 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:37:26.355014 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:37:26.356391 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:37:26.356715 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:37:26.357236 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:37:26.357547 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:37:26.357852 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m15:37:26.360112 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:37:26.361668 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:37:26.362159 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:37:26.362675 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:37:26.363385 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:37:26.363839 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:37:26.370918 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m15:37:26.449088 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:37:26.449717 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:37:26.450238 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:37:26.451027 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:37:26.451495 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:37:26.451939 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m15:37:26.483030 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m15:37:26.485334 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:37:26.487455 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:37:26.487943 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:37:26.490948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3269ea6-5eab-45a0-95e9-42dd9bdd1ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea63c70>]}
[0m15:37:26.491516 [debug] [MainThread]: Using duckdb connection "master"
[0m15:37:26.491893 [debug] [MainThread]: On master: BEGIN
[0m15:37:26.492247 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:37:26.492932 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:37:26.493326 [debug] [MainThread]: On master: COMMIT
[0m15:37:26.493686 [debug] [MainThread]: Using duckdb connection "master"
[0m15:37:26.493990 [debug] [MainThread]: On master: COMMIT
[0m15:37:26.494502 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:37:26.494829 [debug] [MainThread]: On master: Close
[0m15:37:26.498128 [debug] [Thread-1 (]: Began running node model.suvera.mart_patient_count_by_pcn
[0m15:37:26.498799 [info ] [Thread-1 (]: 1 of 1 START sql view model main.mart_patient_count_by_pcn ..................... [RUN]
[0m15:37:26.499517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.mart_patient_count_by_pcn)
[0m15:37:26.500128 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_patient_count_by_pcn
[0m15:37:26.510085 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_patient_count_by_pcn"
[0m15:37:26.511382 [debug] [Thread-1 (]: Began executing node model.suvera.mart_patient_count_by_pcn
[0m15:37:26.550114 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_patient_count_by_pcn"
[0m15:37:26.551218 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m15:37:26.551701 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: BEGIN
[0m15:37:26.552281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:26.553116 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:37:26.553547 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m15:37:26.553976 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patient_count_by_pcn"} */

  
  create view "dev"."main"."mart_patient_count_by_pcn__dbt_tmp" as (
    with patients as (
    select *
    from "dev"."main"."cleaned_patients"
),

practices as (
    select *
    from "dev"."main"."stg_practices"
),

pcns as (
    select *
    from "dev"."main"."stg_pcns"
),

joined as (
    select
        pcn.id as pcn_id,
        pcn.pcn_name pcn_name,
        patient.patient_id
    from patients as patient
    left join practices as practice
        on patient.practice_id = practice.id
    left join pcns as pcn
        on practice.pcn = pcn.id
)

select
    pcn_id,
    pcn_name,
    count(distinct patient_id) as num_patients
from joined
group by 1, 2
order by num_patients desc
  );

[0m15:37:26.558690 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:37:26.566335 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m15:37:26.566970 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patient_count_by_pcn"} */
alter view "dev"."main"."mart_patient_count_by_pcn__dbt_tmp" rename to "mart_patient_count_by_pcn"
[0m15:37:26.567855 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:37:26.579978 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: COMMIT
[0m15:37:26.580507 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m15:37:26.580911 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: COMMIT
[0m15:37:26.583439 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:37:26.588867 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m15:37:26.589289 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patient_count_by_pcn"} */
drop view if exists "dev"."main"."mart_patient_count_by_pcn__dbt_backup" cascade
[0m15:37:26.590708 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:37:26.593684 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: Close
[0m15:37:26.596136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3269ea6-5eab-45a0-95e9-42dd9bdd1ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed25cd0>]}
[0m15:37:26.596960 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.mart_patient_count_by_pcn ................ [[32mOK[0m in 0.10s]
[0m15:37:26.597802 [debug] [Thread-1 (]: Finished running node model.suvera.mart_patient_count_by_pcn
[0m15:37:26.599220 [debug] [MainThread]: Using duckdb connection "master"
[0m15:37:26.599623 [debug] [MainThread]: On master: BEGIN
[0m15:37:26.599988 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:37:26.600732 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:37:26.601074 [debug] [MainThread]: On master: COMMIT
[0m15:37:26.601398 [debug] [MainThread]: Using duckdb connection "master"
[0m15:37:26.601707 [debug] [MainThread]: On master: COMMIT
[0m15:37:26.602213 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:37:26.602544 [debug] [MainThread]: On master: Close
[0m15:37:26.602953 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:37:26.603252 [debug] [MainThread]: Connection 'model.suvera.mart_patient_count_by_pcn' was properly closed.
[0m15:37:26.603576 [info ] [MainThread]: 
[0m15:37:26.603984 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m15:37:26.605179 [debug] [MainThread]: Command end result
[0m15:37:26.640569 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m15:37:26.643647 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m15:37:26.652113 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m15:37:26.652607 [info ] [MainThread]: 
[0m15:37:26.653132 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:37:26.653523 [info ] [MainThread]: 
[0m15:37:26.653940 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:37:26.659235 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1912472, "process_in_blocks": "0", "process_kernel_time": 0.727731, "process_mem_max_rss": "137785344", "process_out_blocks": "0", "process_user_time": 3.465652}
[0m15:37:26.660304 [debug] [MainThread]: Command `dbt run` succeeded at 15:37:26.660105 after 2.19 seconds
[0m15:37:26.660889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb52c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e968050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9684b0>]}
[0m15:37:26.661513 [debug] [MainThread]: Flushing usage events
[0m15:37:27.043869 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:24:38.855011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111955d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11292f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11292f750>]}


============================== 17:24:38.867008 | 7f37fb4a-244d-4ab6-abcc-3274bd447c34 ==============================
[0m17:24:38.867008 [info ] [MainThread]: Running with dbt=1.10.1
[0m17:24:38.868121 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'debug': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select mart_patient_count_by_pcn', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:24:39.385516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f37fb4a-244d-4ab6-abcc-3274bd447c34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ddd220>]}
[0m17:24:39.493881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f37fb4a-244d-4ab6-abcc-3274bd447c34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112817350>]}
[0m17:24:39.523092 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:24:39.711200 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m17:24:40.006397 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:24:40.007412 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:24:40.105943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f37fb4a-244d-4ab6-abcc-3274bd447c34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c3b650>]}
[0m17:24:40.245824 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m17:24:40.252610 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m17:24:40.305805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f37fb4a-244d-4ab6-abcc-3274bd447c34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c06d50>]}
[0m17:24:40.306606 [info ] [MainThread]: Found 7 models, 4 seeds, 12 data tests, 544 macros
[0m17:24:40.307172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f37fb4a-244d-4ab6-abcc-3274bd447c34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113018c90>]}
[0m17:24:40.309897 [info ] [MainThread]: 
[0m17:24:40.310690 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:24:40.311332 [info ] [MainThread]: 
[0m17:24:40.312366 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:24:40.313762 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m17:24:40.410667 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:24:40.411336 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:24:40.411832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:40.445704 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:24:40.446394 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m17:24:40.447661 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:24:40.448174 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m17:24:40.448667 [info ] [MainThread]: 
[0m17:24:40.449246 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m17:24:40.450053 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/puneeth/Documents/suvera_dbt_project/suvera/dev.duckdb": Conflicting lock is held in /usr/local/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 25700) by user puneeth. See also https://duckdb.org/docs/stable/connect/concurrency
[0m17:24:40.455133 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7384155, "process_in_blocks": "0", "process_kernel_time": 0.781535, "process_mem_max_rss": "125534208", "process_out_blocks": "0", "process_user_time": 3.659035}
[0m17:24:40.456072 [debug] [MainThread]: Command `dbt run` failed at 17:24:40.455857 after 1.74 seconds
[0m17:24:40.456729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113374a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127d9a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dcfe90>]}
[0m17:24:40.457329 [debug] [MainThread]: Flushing usage events
[0m17:24:40.853318 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:25:40.310111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057b5d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c7750>]}


============================== 17:25:40.320387 | 7f051292-c2f5-4049-97ec-09260fbd0a20 ==============================
[0m17:25:40.320387 [info ] [MainThread]: Running with dbt=1.10.1
[0m17:25:40.321506 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select mart_avg_age_by_practice', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:25:40.855316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f051292-c2f5-4049-97ec-09260fbd0a20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a95220>]}
[0m17:25:40.961671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f051292-c2f5-4049-97ec-09260fbd0a20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064b3350>]}
[0m17:25:40.982579 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:25:41.167186 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m17:25:41.482873 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:25:41.483786 [debug] [MainThread]: Partial parsing: added file: suvera://models/marts/mart_avg_age_by_practice.sql
[0m17:25:41.920957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f051292-c2f5-4049-97ec-09260fbd0a20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d60350>]}
[0m17:25:42.050869 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m17:25:42.056140 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m17:25:42.104447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f051292-c2f5-4049-97ec-09260fbd0a20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10689ed50>]}
[0m17:25:42.105209 [info ] [MainThread]: Found 8 models, 4 seeds, 12 data tests, 544 macros
[0m17:25:42.105777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f051292-c2f5-4049-97ec-09260fbd0a20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e409f0>]}
[0m17:25:42.108458 [info ] [MainThread]: 
[0m17:25:42.109024 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:25:42.109493 [info ] [MainThread]: 
[0m17:25:42.110258 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:25:42.111499 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m17:25:42.206780 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:25:42.207454 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:25:42.207999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:42.394454 [debug] [ThreadPool]: SQL status: OK in 0.186 seconds
[0m17:25:42.397457 [debug] [ThreadPool]: On list_dev: Close
[0m17:25:42.398561 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m17:25:42.399721 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m17:25:42.409593 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:25:42.410149 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m17:25:42.410609 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:25:42.413500 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:25:42.416960 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:25:42.417736 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m17:25:42.418823 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:25:42.419420 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:25:42.420009 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m17:25:42.423937 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:25:42.425928 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m17:25:42.426463 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:25:42.426950 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m17:25:42.427754 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:25:42.428278 [debug] [ThreadPool]: On create_dev_main: Close
[0m17:25:42.437071 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m17:25:42.520041 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:25:42.520614 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m17:25:42.521066 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:25:42.521878 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:25:42.522379 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:25:42.522852 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m17:25:42.564423 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m17:25:42.566871 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m17:25:42.568982 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m17:25:42.569542 [debug] [ThreadPool]: On list_dev_main: Close
[0m17:25:42.573384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f051292-c2f5-4049-97ec-09260fbd0a20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107118460>]}
[0m17:25:42.574068 [debug] [MainThread]: Using duckdb connection "master"
[0m17:25:42.574529 [debug] [MainThread]: On master: BEGIN
[0m17:25:42.574967 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:25:42.575761 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:25:42.576238 [debug] [MainThread]: On master: COMMIT
[0m17:25:42.576697 [debug] [MainThread]: Using duckdb connection "master"
[0m17:25:42.577141 [debug] [MainThread]: On master: COMMIT
[0m17:25:42.577801 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:25:42.578277 [debug] [MainThread]: On master: Close
[0m17:25:42.582382 [debug] [Thread-1 (]: Began running node model.suvera.mart_avg_age_by_practice
[0m17:25:42.583256 [info ] [Thread-1 (]: 1 of 1 START sql view model main.mart_avg_age_by_practice ...................... [RUN]
[0m17:25:42.584033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.mart_avg_age_by_practice)
[0m17:25:42.584623 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_avg_age_by_practice
[0m17:25:42.595653 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_avg_age_by_practice"
[0m17:25:42.596917 [debug] [Thread-1 (]: Began executing node model.suvera.mart_avg_age_by_practice
[0m17:25:42.646733 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_avg_age_by_practice"
[0m17:25:42.647960 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m17:25:42.648539 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: BEGIN
[0m17:25:42.649064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:42.650002 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:25:42.650577 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m17:25:42.651140 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_avg_age_by_practice"} */

  
  create view "dev"."main"."mart_avg_age_by_practice__dbt_tmp" as (
    with patients as (
    select
        patient_id,
        practice_id,
        age
    from "dev"."main"."cleaned_patients"
),

aggregated as (
    select
        practice_id,
        avg(age) as avg_age,
        count(*) as num_patients
    from patients
    group by practice_id
)

select * from aggregated
order by avg_age desc
  );

[0m17:25:42.658752 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m17:25:42.668063 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m17:25:42.668719 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_avg_age_by_practice"} */
alter view "dev"."main"."mart_avg_age_by_practice__dbt_tmp" rename to "mart_avg_age_by_practice"
[0m17:25:42.671620 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:25:42.686961 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: COMMIT
[0m17:25:42.687627 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m17:25:42.688161 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: COMMIT
[0m17:25:42.691601 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:25:42.700959 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m17:25:42.701631 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_avg_age_by_practice"} */
drop view if exists "dev"."main"."mart_avg_age_by_practice__dbt_backup" cascade
[0m17:25:42.702974 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:25:42.706898 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: Close
[0m17:25:42.710475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f051292-c2f5-4049-97ec-09260fbd0a20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107029d90>]}
[0m17:25:42.711700 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.mart_avg_age_by_practice ................. [[32mOK[0m in 0.12s]
[0m17:25:42.712678 [debug] [Thread-1 (]: Finished running node model.suvera.mart_avg_age_by_practice
[0m17:25:42.714491 [debug] [MainThread]: Using duckdb connection "master"
[0m17:25:42.714994 [debug] [MainThread]: On master: BEGIN
[0m17:25:42.715445 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:25:42.716297 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:25:42.716785 [debug] [MainThread]: On master: COMMIT
[0m17:25:42.717255 [debug] [MainThread]: Using duckdb connection "master"
[0m17:25:42.717709 [debug] [MainThread]: On master: COMMIT
[0m17:25:42.718702 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:25:42.719318 [debug] [MainThread]: On master: Close
[0m17:25:42.719982 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:25:42.720435 [debug] [MainThread]: Connection 'model.suvera.mart_avg_age_by_practice' was properly closed.
[0m17:25:42.720927 [info ] [MainThread]: 
[0m17:25:42.721461 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m17:25:42.722568 [debug] [MainThread]: Command end result
[0m17:25:42.766865 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m17:25:42.769787 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m17:25:42.779605 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m17:25:42.780331 [info ] [MainThread]: 
[0m17:25:42.781078 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:25:42.781653 [info ] [MainThread]: 
[0m17:25:42.782205 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:25:42.786943 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6038475, "process_in_blocks": "0", "process_kernel_time": 0.765971, "process_mem_max_rss": "137445376", "process_out_blocks": "0", "process_user_time": 4.292462}
[0m17:25:42.787817 [debug] [MainThread]: Command `dbt run` succeeded at 17:25:42.787638 after 2.60 seconds
[0m17:25:42.788400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e66e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6b890>]}
[0m17:25:42.788960 [debug] [MainThread]: Flushing usage events
[0m17:25:43.144334 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:35:52.532473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105411d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106223610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106223750>]}


============================== 17:35:52.543439 | faf8e7c1-80c4-4e19-b8f1-8c888cbbe9c4 ==============================
[0m17:35:52.543439 [info ] [MainThread]: Running with dbt=1.10.1
[0m17:35:52.544551 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select mart_age_groups_by_pen', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:35:53.060146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'faf8e7c1-80c4-4e19-b8f1-8c888cbbe9c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056f5220>]}
[0m17:35:53.170991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'faf8e7c1-80c4-4e19-b8f1-8c888cbbe9c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10610b350>]}
[0m17:35:53.199277 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:35:53.374833 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m17:35:53.729948 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:35:53.730844 [debug] [MainThread]: Partial parsing: added file: suvera://models/marts/mart_age_groups_by_pcn.sql
[0m17:35:54.176814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'faf8e7c1-80c4-4e19-b8f1-8c888cbbe9c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069ac350>]}
[0m17:35:54.307775 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m17:35:54.313511 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m17:35:54.364693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'faf8e7c1-80c4-4e19-b8f1-8c888cbbe9c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064fad50>]}
[0m17:35:54.365439 [info ] [MainThread]: Found 9 models, 4 seeds, 12 data tests, 544 macros
[0m17:35:54.366001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'faf8e7c1-80c4-4e19-b8f1-8c888cbbe9c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aacbb0>]}
[0m17:35:54.367106 [warn ] [MainThread]: The selection criterion 'mart_age_groups_by_pen' does not match any enabled nodes
[0m17:35:54.369057 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m17:35:54.369869 [debug] [MainThread]: Command end result
[0m17:35:54.490971 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m17:35:54.493696 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m17:35:54.500026 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m17:35:54.504968 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1022437, "process_in_blocks": "0", "process_kernel_time": 0.721203, "process_mem_max_rss": "123150336", "process_out_blocks": "0", "process_user_time": 4.015983}
[0m17:35:54.505835 [debug] [MainThread]: Command `dbt run` succeeded at 17:35:54.505654 after 2.10 seconds
[0m17:35:54.506449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a17d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060c9a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069937d0>]}
[0m17:35:54.507006 [debug] [MainThread]: Flushing usage events
[0m17:35:54.916324 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:36:02.147489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122e9d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130c3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130c3750>]}


============================== 17:36:02.156772 | 266746fe-2980-4d33-a99b-2153ccecce9b ==============================
[0m17:36:02.156772 [info ] [MainThread]: Running with dbt=1.10.1
[0m17:36:02.157757 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select mart_age_groups_by_pcn', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:36:02.594221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '266746fe-2980-4d33-a99b-2153ccecce9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11259d220>]}
[0m17:36:02.698656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '266746fe-2980-4d33-a99b-2153ccecce9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112faf350>]}
[0m17:36:02.727810 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:36:02.892927 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m17:36:03.201176 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:36:03.201778 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:36:03.287323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '266746fe-2980-4d33-a99b-2153ccecce9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133bf650>]}
[0m17:36:03.427000 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m17:36:03.431984 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m17:36:03.477444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '266746fe-2980-4d33-a99b-2153ccecce9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11338ed50>]}
[0m17:36:03.478228 [info ] [MainThread]: Found 9 models, 4 seeds, 12 data tests, 544 macros
[0m17:36:03.478803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '266746fe-2980-4d33-a99b-2153ccecce9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137b8d70>]}
[0m17:36:03.481544 [info ] [MainThread]: 
[0m17:36:03.482127 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:36:03.482600 [info ] [MainThread]: 
[0m17:36:03.483392 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:36:03.484819 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m17:36:03.584066 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:36:03.584864 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:36:03.585398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:03.610539 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:36:03.611177 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m17:36:03.612320 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:36:03.612765 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m17:36:03.613223 [info ] [MainThread]: 
[0m17:36:03.613757 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m17:36:03.614611 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/puneeth/Documents/suvera_dbt_project/suvera/dev.duckdb": Conflicting lock is held in /usr/local/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 26167) by user puneeth. See also https://duckdb.org/docs/stable/connect/concurrency
[0m17:36:03.619376 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5978765, "process_in_blocks": "0", "process_kernel_time": 0.49723, "process_mem_max_rss": "125382656", "process_out_blocks": "0", "process_user_time": 3.371409}
[0m17:36:03.620312 [debug] [MainThread]: Command `dbt run` failed at 17:36:03.620108 after 1.60 seconds
[0m17:36:03.620952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ae0a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f71a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113aa8050>]}
[0m17:36:03.621535 [debug] [MainThread]: Flushing usage events
[0m17:36:04.008077 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:36:23.321279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bb1d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049c3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049c3750>]}


============================== 17:36:23.330138 | b3629bd8-c635-4ba5-b344-5c88105f26e2 ==============================
[0m17:36:23.330138 [info ] [MainThread]: Running with dbt=1.10.1
[0m17:36:23.331178 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'profiles_dir': '/Users/puneeth/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select mart_age_groups_by_pcn', 'send_anonymous_usage_stats': 'True'}
[0m17:36:23.772091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3629bd8-c635-4ba5-b344-5c88105f26e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e95220>]}
[0m17:36:23.877691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3629bd8-c635-4ba5-b344-5c88105f26e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048af350>]}
[0m17:36:23.903758 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:36:24.083550 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m17:36:24.399161 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:36:24.399766 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:36:24.478991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3629bd8-c635-4ba5-b344-5c88105f26e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ccb650>]}
[0m17:36:24.615594 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m17:36:24.620113 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m17:36:24.664635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3629bd8-c635-4ba5-b344-5c88105f26e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c9ad50>]}
[0m17:36:24.665393 [info ] [MainThread]: Found 9 models, 4 seeds, 12 data tests, 544 macros
[0m17:36:24.665955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3629bd8-c635-4ba5-b344-5c88105f26e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050dcd70>]}
[0m17:36:24.668653 [info ] [MainThread]: 
[0m17:36:24.669218 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:36:24.669689 [info ] [MainThread]: 
[0m17:36:24.670577 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:36:24.672000 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m17:36:24.772430 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:36:24.773081 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:36:24.773727 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:24.809380 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m17:36:24.813995 [debug] [ThreadPool]: On list_dev: Close
[0m17:36:24.815874 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m17:36:24.816703 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m17:36:24.826048 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:36:24.826583 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m17:36:24.827039 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:36:24.830143 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:36:24.833205 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:36:24.833794 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m17:36:24.834576 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:36:24.835038 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:36:24.835488 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m17:36:24.840804 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m17:36:24.842418 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m17:36:24.842942 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:36:24.843396 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m17:36:24.844179 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:36:24.844662 [debug] [ThreadPool]: On create_dev_main: Close
[0m17:36:24.853281 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m17:36:24.861878 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:36:24.862409 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m17:36:24.862849 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:36:24.863678 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:36:24.864302 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:36:24.864800 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m17:36:24.930129 [debug] [ThreadPool]: SQL status: OK in 0.065 seconds
[0m17:36:24.933407 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m17:36:24.935683 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m17:36:24.936276 [debug] [ThreadPool]: On list_dev_main: Close
[0m17:36:24.940350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3629bd8-c635-4ba5-b344-5c88105f26e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105409230>]}
[0m17:36:24.941051 [debug] [MainThread]: Using duckdb connection "master"
[0m17:36:24.941513 [debug] [MainThread]: On master: BEGIN
[0m17:36:24.941941 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:36:24.942783 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:36:24.943265 [debug] [MainThread]: On master: COMMIT
[0m17:36:24.943727 [debug] [MainThread]: Using duckdb connection "master"
[0m17:36:24.944161 [debug] [MainThread]: On master: COMMIT
[0m17:36:24.944804 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:36:24.945287 [debug] [MainThread]: On master: Close
[0m17:36:24.949805 [debug] [Thread-1 (]: Began running node model.suvera.mart_age_groups_by_pcn
[0m17:36:24.950703 [info ] [Thread-1 (]: 1 of 1 START sql view model main.mart_age_groups_by_pcn ........................ [RUN]
[0m17:36:24.951422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.mart_age_groups_by_pcn)
[0m17:36:24.951978 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_age_groups_by_pcn
[0m17:36:24.964006 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_age_groups_by_pcn"
[0m17:36:24.965245 [debug] [Thread-1 (]: Began executing node model.suvera.mart_age_groups_by_pcn
[0m17:36:25.014969 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_age_groups_by_pcn"
[0m17:36:25.016185 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m17:36:25.016755 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: BEGIN
[0m17:36:25.017281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:25.018176 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:36:25.018722 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m17:36:25.019307 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_age_groups_by_pcn"} */

  
  create view "dev"."main"."mart_age_groups_by_pcn__dbt_tmp" as (
    with patients as (
    select
        patient_id,
        practice_id,
        age,
        case
            when age between 0 and 18 then '0-18'
            when age between 19 and 35 then '19-35'
            when age between 36 and 50 then '36-50'
            when age >= 51 then '51+'
            else 'Unknown'
        end as age_group
    from "dev"."main"."cleaned_patients"
),

practices as (
    select *
    from "dev"."main"."stg_practices"
),

pcns as (
    select *
    from "dev"."main"."stg_pcns"
),

joined as (
    select
        pcn.pcn_id,
        pcn.pcn_name,
        p.age_group
    from patients as p
    left join practices pr on p.practice_id = pr.practice_id
    left join pcns pcn on pr.pcn_id = pcn.pcn_id
)

select
    pcn_id,
    pcn_name,
    age_group,
    count(*) as num_patients
from joined
group by pcn_id, pcn_name, age_group
order by pcn_id, age_group
  );

[0m17:36:25.035018 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_age_groups_by_pcn"} */

  
  create view "dev"."main"."mart_age_groups_by_pcn__dbt_tmp" as (
    with patients as (
    select
        patient_id,
        practice_id,
        age,
        case
            when age between 0 and 18 then '0-18'
            when age between 19 and 35 then '19-35'
            when age between 36 and 50 then '36-50'
            when age >= 51 then '51+'
            else 'Unknown'
        end as age_group
    from "dev"."main"."cleaned_patients"
),

practices as (
    select *
    from "dev"."main"."stg_practices"
),

pcns as (
    select *
    from "dev"."main"."stg_pcns"
),

joined as (
    select
        pcn.pcn_id,
        pcn.pcn_name,
        p.age_group
    from patients as p
    left join practices pr on p.practice_id = pr.practice_id
    left join pcns pcn on pr.pcn_id = pcn.pcn_id
)

select
    pcn_id,
    pcn_name,
    age_group,
    count(*) as num_patients
from joined
group by pcn_id, pcn_name, age_group
order by pcn_id, age_group
  );

[0m17:36:25.035792 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:36:25.036520 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: ROLLBACK
[0m17:36:25.059422 [debug] [Thread-1 (]: Failed to rollback 'model.suvera.mart_age_groups_by_pcn'
[0m17:36:25.060057 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: Close
[0m17:36:25.066461 [debug] [Thread-1 (]: Runtime Error in model mart_age_groups_by_pcn (models/marts/mart_age_groups_by_pcn.sql)
  Binder Error: Values list "pr" does not have a column named "practice_id"
  
  LINE 36:     left join practices pr on p.practice_id = pr.practice_id
                                                         ^
[0m17:36:25.070035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3629bd8-c635-4ba5-b344-5c88105f26e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053a16d0>]}
[0m17:36:25.071196 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.mart_age_groups_by_pcn ............... [[31mERROR[0m in 0.12s]
[0m17:36:25.072379 [debug] [Thread-1 (]: Finished running node model.suvera.mart_age_groups_by_pcn
[0m17:36:25.073416 [debug] [Thread-4 (]: Marking all children of 'model.suvera.mart_age_groups_by_pcn' to be skipped because of status 'error'.  Reason: Runtime Error in model mart_age_groups_by_pcn (models/marts/mart_age_groups_by_pcn.sql)
  Binder Error: Values list "pr" does not have a column named "practice_id"
  
  LINE 36:     left join practices pr on p.practice_id = pr.practice_id
                                                         ^.
[0m17:36:25.076258 [debug] [MainThread]: Using duckdb connection "master"
[0m17:36:25.076784 [debug] [MainThread]: On master: BEGIN
[0m17:36:25.077221 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:36:25.078440 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:36:25.079215 [debug] [MainThread]: On master: COMMIT
[0m17:36:25.079856 [debug] [MainThread]: Using duckdb connection "master"
[0m17:36:25.080332 [debug] [MainThread]: On master: COMMIT
[0m17:36:25.081145 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:36:25.081684 [debug] [MainThread]: On master: Close
[0m17:36:25.082365 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:36:25.082831 [debug] [MainThread]: Connection 'model.suvera.mart_age_groups_by_pcn' was properly closed.
[0m17:36:25.083310 [info ] [MainThread]: 
[0m17:36:25.083825 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m17:36:25.084877 [debug] [MainThread]: Command end result
[0m17:36:25.132354 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m17:36:25.135069 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m17:36:25.144506 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m17:36:25.145174 [info ] [MainThread]: 
[0m17:36:25.145904 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:36:25.146502 [info ] [MainThread]: 
[0m17:36:25.147188 [error] [MainThread]: [31mFailure in model mart_age_groups_by_pcn (models/marts/mart_age_groups_by_pcn.sql)[0m
[0m17:36:25.147822 [error] [MainThread]:   Runtime Error in model mart_age_groups_by_pcn (models/marts/mart_age_groups_by_pcn.sql)
  Binder Error: Values list "pr" does not have a column named "practice_id"
  
  LINE 36:     left join practices pr on p.practice_id = pr.practice_id
                                                         ^
[0m17:36:25.148314 [info ] [MainThread]: 
[0m17:36:25.148887 [info ] [MainThread]:   compiled code at target/compiled/suvera/models/marts/mart_age_groups_by_pcn.sql
[0m17:36:25.149362 [info ] [MainThread]: 
[0m17:36:25.149891 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m17:36:25.154956 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.9698058, "process_in_blocks": "0", "process_kernel_time": 0.743519, "process_mem_max_rss": "135401472", "process_out_blocks": "0", "process_user_time": 3.975228}
[0m17:36:25.155870 [debug] [MainThread]: Command `dbt run` failed at 17:36:25.155662 after 1.97 seconds
[0m17:36:25.156561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050d9ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10545be30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10545bd90>]}
[0m17:36:25.157362 [debug] [MainThread]: Flushing usage events
[0m17:36:25.523432 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:39:12.869395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6e5d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6bf610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6bf750>]}


============================== 17:39:12.876743 | 5fbbf4d6-02a2-4ea2-abff-7ed6531adc94 ==============================
[0m17:39:12.876743 [info ] [MainThread]: Running with dbt=1.10.1
[0m17:39:12.877737 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select mart_age_groups_by_pcn', 'send_anonymous_usage_stats': 'True'}
[0m17:39:13.289966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fbbf4d6-02a2-4ea2-abff-7ed6531adc94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb99220>]}
[0m17:39:13.395273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fbbf4d6-02a2-4ea2-abff-7ed6531adc94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5ab350>]}
[0m17:39:13.409304 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:39:13.560268 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m17:39:13.773398 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:39:13.774389 [debug] [MainThread]: Partial parsing: updated file: suvera://models/marts/mart_age_groups_by_pcn.sql
[0m17:39:14.218451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fbbf4d6-02a2-4ea2-abff-7ed6531adc94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de50350>]}
[0m17:39:14.348917 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m17:39:14.352245 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m17:39:14.376040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fbbf4d6-02a2-4ea2-abff-7ed6531adc94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d99ad50>]}
[0m17:39:14.376805 [info ] [MainThread]: Found 9 models, 4 seeds, 12 data tests, 544 macros
[0m17:39:14.377356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fbbf4d6-02a2-4ea2-abff-7ed6531adc94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df4c9f0>]}
[0m17:39:14.380057 [info ] [MainThread]: 
[0m17:39:14.380626 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:39:14.381096 [info ] [MainThread]: 
[0m17:39:14.381861 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:39:14.383086 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m17:39:14.469653 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:39:14.470256 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:39:14.470743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:14.494575 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m17:39:14.496742 [debug] [ThreadPool]: On list_dev: Close
[0m17:39:14.497779 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m17:39:14.498484 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m17:39:14.507947 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:39:14.508499 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m17:39:14.508957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:39:14.510281 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:39:14.512304 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:39:14.512774 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m17:39:14.513474 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:39:14.513954 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:39:14.514479 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m17:39:14.515661 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:39:14.517209 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m17:39:14.517727 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:39:14.518178 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m17:39:14.518975 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:39:14.519462 [debug] [ThreadPool]: On create_dev_main: Close
[0m17:39:14.528193 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m17:39:14.611984 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:39:14.612557 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m17:39:14.613006 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:39:14.613832 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:39:14.614332 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:39:14.614803 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m17:39:14.635270 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m17:39:14.637715 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m17:39:14.639247 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m17:39:14.639745 [debug] [ThreadPool]: On list_dev_main: Close
[0m17:39:14.643783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fbbf4d6-02a2-4ea2-abff-7ed6531adc94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e230390>]}
[0m17:39:14.644446 [debug] [MainThread]: Using duckdb connection "master"
[0m17:39:14.644913 [debug] [MainThread]: On master: BEGIN
[0m17:39:14.645348 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:39:14.646143 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:39:14.646623 [debug] [MainThread]: On master: COMMIT
[0m17:39:14.647086 [debug] [MainThread]: Using duckdb connection "master"
[0m17:39:14.647528 [debug] [MainThread]: On master: COMMIT
[0m17:39:14.648238 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:39:14.648728 [debug] [MainThread]: On master: Close
[0m17:39:14.651467 [debug] [Thread-1 (]: Began running node model.suvera.mart_age_groups_by_pcn
[0m17:39:14.652263 [info ] [Thread-1 (]: 1 of 1 START sql view model main.mart_age_groups_by_pcn ........................ [RUN]
[0m17:39:14.652966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.mart_age_groups_by_pcn)
[0m17:39:14.653526 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_age_groups_by_pcn
[0m17:39:14.665711 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_age_groups_by_pcn"
[0m17:39:14.667378 [debug] [Thread-1 (]: Began executing node model.suvera.mart_age_groups_by_pcn
[0m17:39:14.716158 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_age_groups_by_pcn"
[0m17:39:14.717380 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m17:39:14.717951 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: BEGIN
[0m17:39:14.718493 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:39:14.719391 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:39:14.719950 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m17:39:14.720558 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_age_groups_by_pcn"} */

  
  create view "dev"."main"."mart_age_groups_by_pcn__dbt_tmp" as (
    with patients as (
    select
        patient_id,
        practice_id,
        age,
        case
            when age between 0 and 18 then '0-18'
            when age between 19 and 35 then '19-35'
            when age between 36 and 50 then '36-50'
            when age >= 51 then '51+'
            else 'Unknown'
        end as age_group
    from "dev"."main"."cleaned_patients"
),

practices as (
    select *
    from "dev"."main"."stg_practices"
),

pcns as (
    select *
    from "dev"."main"."stg_pcns"
),

joined as (
    select
        pcn.id as pcn_id,
        pcn.pcn_name,
        p.age_group
    from patients as p
    left join practices pr on p.practice_id = pr.id
    left join pcns pcn on pr.pcn = pcn.id
)

select
    pcn_id,
    pcn_name,
    age_group,
    count(*) as num_patients
from joined
group by pcn_id, pcn_name, age_group
order by pcn_id, age_group
  );

[0m17:39:14.723989 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:39:14.733404 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m17:39:14.734046 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_age_groups_by_pcn"} */
alter view "dev"."main"."mart_age_groups_by_pcn__dbt_tmp" rename to "mart_age_groups_by_pcn"
[0m17:39:14.738329 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:39:14.753571 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: COMMIT
[0m17:39:14.754222 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m17:39:14.754769 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: COMMIT
[0m17:39:14.759143 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:39:14.766261 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m17:39:14.766850 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_age_groups_by_pcn"} */
drop view if exists "dev"."main"."mart_age_groups_by_pcn__dbt_backup" cascade
[0m17:39:14.769042 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:39:14.772852 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: Close
[0m17:39:14.775331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fbbf4d6-02a2-4ea2-abff-7ed6531adc94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e121e50>]}
[0m17:39:14.776291 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.mart_age_groups_by_pcn ................... [[32mOK[0m in 0.12s]
[0m17:39:14.777230 [debug] [Thread-1 (]: Finished running node model.suvera.mart_age_groups_by_pcn
[0m17:39:14.778963 [debug] [MainThread]: Using duckdb connection "master"
[0m17:39:14.779464 [debug] [MainThread]: On master: BEGIN
[0m17:39:14.779915 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:39:14.780738 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:39:14.781214 [debug] [MainThread]: On master: COMMIT
[0m17:39:14.781678 [debug] [MainThread]: Using duckdb connection "master"
[0m17:39:14.782127 [debug] [MainThread]: On master: COMMIT
[0m17:39:14.783286 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:39:14.784195 [debug] [MainThread]: On master: Close
[0m17:39:14.785028 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:39:14.785488 [debug] [MainThread]: Connection 'model.suvera.mart_age_groups_by_pcn' was properly closed.
[0m17:39:14.785978 [info ] [MainThread]: 
[0m17:39:14.786513 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m17:39:14.787593 [debug] [MainThread]: Command end result
[0m17:39:14.833009 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m17:39:14.835758 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m17:39:14.845435 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m17:39:14.846098 [info ] [MainThread]: 
[0m17:39:14.846705 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:39:14.847208 [info ] [MainThread]: 
[0m17:39:14.847745 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:39:14.851918 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0947459, "process_in_blocks": "0", "process_kernel_time": 0.484899, "process_mem_max_rss": "138612736", "process_out_blocks": "0", "process_user_time": 3.974907}
[0m17:39:14.852736 [debug] [MainThread]: Command `dbt run` succeeded at 17:39:14.852560 after 2.10 seconds
[0m17:39:14.853320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de7ee60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd6ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd6f9d0>]}
[0m17:39:14.853886 [debug] [MainThread]: Flushing usage events
[0m17:39:15.241896 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:42:41.708490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067fdd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075d7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075d7750>]}


============================== 17:42:41.719543 | 47cffa7e-cff0-4a25-b3d6-68c47179da22 ==============================
[0m17:42:41.719543 [info ] [MainThread]: Running with dbt=1.10.1
[0m17:42:41.720647 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'profiles_dir': '/Users/puneeth/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select mart_hypertension_pct_by_practice', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:42:42.241474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47cffa7e-cff0-4a25-b3d6-68c47179da22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ab1220>]}
[0m17:42:42.347727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47cffa7e-cff0-4a25-b3d6-68c47179da22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c3350>]}
[0m17:42:42.378673 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:42:42.572533 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m17:42:42.895440 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:42:42.896375 [debug] [MainThread]: Partial parsing: added file: suvera://models/marts/mart_hypertension_pct_by_practice.sql
[0m17:42:43.343363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47cffa7e-cff0-4a25-b3d6-68c47179da22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d5c350>]}
[0m17:42:43.487140 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m17:42:43.494655 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m17:42:43.547757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47cffa7e-cff0-4a25-b3d6-68c47179da22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a2d50>]}
[0m17:42:43.548507 [info ] [MainThread]: Found 10 models, 4 seeds, 12 data tests, 544 macros
[0m17:42:43.549059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47cffa7e-cff0-4a25-b3d6-68c47179da22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e44c90>]}
[0m17:42:43.551718 [info ] [MainThread]: 
[0m17:42:43.552290 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:42:43.552762 [info ] [MainThread]: 
[0m17:42:43.553602 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:42:43.554798 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m17:42:43.649394 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:42:43.650001 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:42:43.650486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:42:43.674356 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:42:43.674960 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m17:42:43.676102 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:42:43.676566 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m17:42:43.677015 [info ] [MainThread]: 
[0m17:42:43.677527 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m17:42:43.678244 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/puneeth/Documents/suvera_dbt_project/suvera/dev.duckdb": Conflicting lock is held in /usr/local/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 28162) by user puneeth. See also https://duckdb.org/docs/stable/connect/concurrency
[0m17:42:43.682970 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.108415, "process_in_blocks": "0", "process_kernel_time": 0.791379, "process_mem_max_rss": "129941504", "process_out_blocks": "0", "process_user_time": 3.98069}
[0m17:42:43.683891 [debug] [MainThread]: Command `dbt run` failed at 17:42:43.683695 after 2.11 seconds
[0m17:42:43.684952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d73c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107485a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10800cc50>]}
[0m17:42:43.685611 [debug] [MainThread]: Flushing usage events
[0m17:42:44.076097 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:43:00.634990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bb1d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079c3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079c3750>]}


============================== 17:43:00.644654 | 5ca4e58f-bb24-499b-bc02-5a0af2f24dad ==============================
[0m17:43:00.644654 [info ] [MainThread]: Running with dbt=1.10.1
[0m17:43:00.645702 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select mart_hypertension_pct_by_practice', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:43:01.073952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ca4e58f-bb24-499b-bc02-5a0af2f24dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e95220>]}
[0m17:43:01.179810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ca4e58f-bb24-499b-bc02-5a0af2f24dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078ab350>]}
[0m17:43:01.205359 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:43:01.379277 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m17:43:01.695828 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:43:01.696455 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:43:01.776288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ca4e58f-bb24-499b-bc02-5a0af2f24dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ccb650>]}
[0m17:43:01.913303 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m17:43:01.917056 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m17:43:01.964964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ca4e58f-bb24-499b-bc02-5a0af2f24dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c9ad50>]}
[0m17:43:01.965729 [info ] [MainThread]: Found 10 models, 4 seeds, 12 data tests, 544 macros
[0m17:43:01.966291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ca4e58f-bb24-499b-bc02-5a0af2f24dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080dce50>]}
[0m17:43:01.969024 [info ] [MainThread]: 
[0m17:43:01.969614 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:43:01.970093 [info ] [MainThread]: 
[0m17:43:01.971001 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:43:01.972507 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m17:43:02.064408 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:43:02.065048 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:43:02.065617 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:02.103445 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m17:43:02.107790 [debug] [ThreadPool]: On list_dev: Close
[0m17:43:02.109844 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m17:43:02.111411 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m17:43:02.121482 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:43:02.122068 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m17:43:02.122531 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:43:02.126075 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:43:02.130177 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:43:02.130920 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m17:43:02.131954 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:43:02.132571 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:43:02.133182 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m17:43:02.139659 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m17:43:02.142050 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m17:43:02.142865 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:43:02.143612 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m17:43:02.144726 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:43:02.145384 [debug] [ThreadPool]: On create_dev_main: Close
[0m17:43:02.155079 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m17:43:02.163694 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:43:02.164256 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m17:43:02.164700 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:43:02.165546 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:43:02.166019 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:43:02.166487 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m17:43:02.220334 [debug] [ThreadPool]: SQL status: OK in 0.053 seconds
[0m17:43:02.223650 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m17:43:02.225937 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m17:43:02.226539 [debug] [ThreadPool]: On list_dev_main: Close
[0m17:43:02.230856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ca4e58f-bb24-499b-bc02-5a0af2f24dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083e1160>]}
[0m17:43:02.231539 [debug] [MainThread]: Using duckdb connection "master"
[0m17:43:02.232000 [debug] [MainThread]: On master: BEGIN
[0m17:43:02.232430 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:43:02.233276 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:43:02.233767 [debug] [MainThread]: On master: COMMIT
[0m17:43:02.234234 [debug] [MainThread]: Using duckdb connection "master"
[0m17:43:02.234672 [debug] [MainThread]: On master: COMMIT
[0m17:43:02.235426 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:43:02.235931 [debug] [MainThread]: On master: Close
[0m17:43:02.240534 [debug] [Thread-1 (]: Began running node model.suvera.mart_hypertension_pct_by_practice
[0m17:43:02.241454 [info ] [Thread-1 (]: 1 of 1 START sql view model main.mart_hypertension_pct_by_practice ............. [RUN]
[0m17:43:02.242190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.mart_hypertension_pct_by_practice)
[0m17:43:02.242759 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_hypertension_pct_by_practice
[0m17:43:02.253946 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_hypertension_pct_by_practice"
[0m17:43:02.255100 [debug] [Thread-1 (]: Began executing node model.suvera.mart_hypertension_pct_by_practice
[0m17:43:02.304003 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_hypertension_pct_by_practice"
[0m17:43:02.305550 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m17:43:02.306167 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: BEGIN
[0m17:43:02.306712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:02.307662 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:43:02.308231 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m17:43:02.308838 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_hypertension_pct_by_practice"} */

  
  create view "dev"."main"."mart_hypertension_pct_by_practice__dbt_tmp" as (
    with patients as (
    select
        patient_id,
        practice_id,
        conditions
    from "dev"."main"."cleaned_patients"
),

exploded as (
    select
        patient_id,
        practice_id,
        unnest(conditions) as condition
    from patients
),

hypertension_counts as (
    select
        practice_id,
        count(distinct patient_id) as patients_with_hypertension
    from exploded
    where lower(condition) = 'hypertension'
    group by practice_id
),

total_patients as (
    select
        practice_id,
        count(distinct patient_id) as total_patients
    from patients
    group by practice_id
)

select
    t.practice_id,
    t.total_patients,
    coalesce(h.patients_with_hypertension, 0) as patients_with_hypertension,
    round(
        coalesce(h.patients_with_hypertension, 0) * 100.0 / t.total_patients,
        1
    ) as pct_with_hypertension
from total_patients t
left join hypertension_counts h
    on t.practice_id = h.practice_id
order by pct_with_hypertension desc
  );

[0m17:43:02.318951 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:43:02.327745 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m17:43:02.328361 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_hypertension_pct_by_practice"} */
alter view "dev"."main"."mart_hypertension_pct_by_practice__dbt_tmp" rename to "mart_hypertension_pct_by_practice"
[0m17:43:02.332458 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:43:02.351021 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: COMMIT
[0m17:43:02.351671 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m17:43:02.352288 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: COMMIT
[0m17:43:02.356723 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:43:02.363918 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m17:43:02.364567 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_hypertension_pct_by_practice"} */
drop view if exists "dev"."main"."mart_hypertension_pct_by_practice__dbt_backup" cascade
[0m17:43:02.367050 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:43:02.370808 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: Close
[0m17:43:02.374185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ca4e58f-bb24-499b-bc02-5a0af2f24dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083d9910>]}
[0m17:43:02.375413 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.mart_hypertension_pct_by_practice ........ [[32mOK[0m in 0.13s]
[0m17:43:02.376639 [debug] [Thread-1 (]: Finished running node model.suvera.mart_hypertension_pct_by_practice
[0m17:43:02.378358 [debug] [MainThread]: Using duckdb connection "master"
[0m17:43:02.378846 [debug] [MainThread]: On master: BEGIN
[0m17:43:02.379289 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:43:02.380166 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:43:02.380680 [debug] [MainThread]: On master: COMMIT
[0m17:43:02.381157 [debug] [MainThread]: Using duckdb connection "master"
[0m17:43:02.381621 [debug] [MainThread]: On master: COMMIT
[0m17:43:02.382505 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:43:02.383090 [debug] [MainThread]: On master: Close
[0m17:43:02.383955 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:43:02.384458 [debug] [MainThread]: Connection 'model.suvera.mart_hypertension_pct_by_practice' was properly closed.
[0m17:43:02.385079 [info ] [MainThread]: 
[0m17:43:02.385705 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m17:43:02.386913 [debug] [MainThread]: Command end result
[0m17:43:02.449077 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m17:43:02.451743 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m17:43:02.461574 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m17:43:02.462157 [info ] [MainThread]: 
[0m17:43:02.462866 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:43:02.463368 [info ] [MainThread]: 
[0m17:43:02.463906 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:43:02.468549 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9610248, "process_in_blocks": "0", "process_kernel_time": 0.703684, "process_mem_max_rss": "134934528", "process_out_blocks": "0", "process_user_time": 3.874999}
[0m17:43:02.469628 [debug] [MainThread]: Command `dbt run` succeeded at 17:43:02.469431 after 1.96 seconds
[0m17:43:02.470272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d6360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f1d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108457430>]}
[0m17:43:02.470868 [debug] [MainThread]: Flushing usage events
[0m17:43:02.820098 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:46:03.693141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ba9d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104983610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104983750>]}


============================== 17:46:03.703802 | e92a2c84-4341-48fc-8b7a-b8a3ec475bdf ==============================
[0m17:46:03.703802 [info ] [MainThread]: Running with dbt=1.10.1
[0m17:46:03.704870 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select mart_recent_activity_by_patient', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:46:04.291119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e92a2c84-4341-48fc-8b7a-b8a3ec475bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e5d220>]}
[0m17:46:04.418299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e92a2c84-4341-48fc-8b7a-b8a3ec475bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10486f350>]}
[0m17:46:04.447300 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:46:04.654997 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m17:46:05.037433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:46:05.038501 [debug] [MainThread]: Partial parsing: added file: suvera://models/marts/mart_recent_activity_by_patient.sql
[0m17:46:05.548267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e92a2c84-4341-48fc-8b7a-b8a3ec475bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105100350>]}
[0m17:46:05.700841 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m17:46:05.706871 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m17:46:05.754561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e92a2c84-4341-48fc-8b7a-b8a3ec475bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c4ed50>]}
[0m17:46:05.755392 [info ] [MainThread]: Found 11 models, 4 seeds, 12 data tests, 544 macros
[0m17:46:05.755973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e92a2c84-4341-48fc-8b7a-b8a3ec475bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051f8750>]}
[0m17:46:05.759443 [info ] [MainThread]: 
[0m17:46:05.760443 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:46:05.761273 [info ] [MainThread]: 
[0m17:46:05.762365 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:46:05.763836 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m17:46:05.875574 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:46:05.876228 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:46:05.876728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:05.977985 [debug] [ThreadPool]: SQL status: OK in 0.101 seconds
[0m17:46:05.981901 [debug] [ThreadPool]: On list_dev: Close
[0m17:46:05.983524 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m17:46:05.984424 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m17:46:05.993943 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:46:05.994517 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m17:46:05.994997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:46:05.997250 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:46:06.000978 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:46:06.001584 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m17:46:06.002355 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:46:06.002824 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:46:06.003273 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m17:46:06.005783 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:46:06.007381 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m17:46:06.007969 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:46:06.008430 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m17:46:06.009453 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:46:06.010440 [debug] [ThreadPool]: On create_dev_main: Close
[0m17:46:06.021117 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m17:46:06.104915 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:46:06.105483 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m17:46:06.105932 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:46:06.106819 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:46:06.107294 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:46:06.107772 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m17:46:06.144131 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m17:46:06.147170 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m17:46:06.149629 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m17:46:06.150284 [debug] [ThreadPool]: On list_dev_main: Close
[0m17:46:06.155136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e92a2c84-4341-48fc-8b7a-b8a3ec475bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054c0460>]}
[0m17:46:06.155798 [debug] [MainThread]: Using duckdb connection "master"
[0m17:46:06.156255 [debug] [MainThread]: On master: BEGIN
[0m17:46:06.156768 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:46:06.157597 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:46:06.158074 [debug] [MainThread]: On master: COMMIT
[0m17:46:06.158532 [debug] [MainThread]: Using duckdb connection "master"
[0m17:46:06.158971 [debug] [MainThread]: On master: COMMIT
[0m17:46:06.159627 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:46:06.160110 [debug] [MainThread]: On master: Close
[0m17:46:06.164615 [debug] [Thread-1 (]: Began running node model.suvera.mart_recent_activity_by_patient
[0m17:46:06.165541 [info ] [Thread-1 (]: 1 of 1 START sql view model main.mart_recent_activity_by_patient ............... [RUN]
[0m17:46:06.166271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.mart_recent_activity_by_patient)
[0m17:46:06.166845 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_recent_activity_by_patient
[0m17:46:06.178431 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_recent_activity_by_patient"
[0m17:46:06.180497 [debug] [Thread-1 (]: Began executing node model.suvera.mart_recent_activity_by_patient
[0m17:46:06.230435 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_recent_activity_by_patient"
[0m17:46:06.232242 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m17:46:06.233098 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: BEGIN
[0m17:46:06.233695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:06.234671 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:46:06.235241 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m17:46:06.235815 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_recent_activity_by_patient"} */

  
  create view "dev"."main"."mart_recent_activity_by_patient__dbt_tmp" as (
    with patients as (
    select patient_id
    from "dev"."main"."cleaned_patients"
),

activities as (
    select
        patient_id,
        activity_date
    from "dev"."main"."stg_activities"
),

filtered as (
    select *
    from activities
    where patient_id in (select patient_id from patients)
)

select
    patient_id,
    max(activity_date) as most_recent_activity
from filtered
group by patient_id
  );

[0m17:46:06.241858 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:46:06.252496 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m17:46:06.253196 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_recent_activity_by_patient"} */
alter view "dev"."main"."mart_recent_activity_by_patient__dbt_tmp" rename to "mart_recent_activity_by_patient"
[0m17:46:06.254779 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:46:06.272663 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: COMMIT
[0m17:46:06.274049 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m17:46:06.275323 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: COMMIT
[0m17:46:06.277173 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:46:06.285202 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m17:46:06.285893 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_recent_activity_by_patient"} */
drop view if exists "dev"."main"."mart_recent_activity_by_patient__dbt_backup" cascade
[0m17:46:06.287159 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:46:06.291749 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: Close
[0m17:46:06.295628 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e92a2c84-4341-48fc-8b7a-b8a3ec475bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c62d0>]}
[0m17:46:06.297015 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.mart_recent_activity_by_patient .......... [[32mOK[0m in 0.13s]
[0m17:46:06.298714 [debug] [Thread-1 (]: Finished running node model.suvera.mart_recent_activity_by_patient
[0m17:46:06.301162 [debug] [MainThread]: Using duckdb connection "master"
[0m17:46:06.302570 [debug] [MainThread]: On master: BEGIN
[0m17:46:06.303368 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:46:06.304843 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:46:06.305826 [debug] [MainThread]: On master: COMMIT
[0m17:46:06.306929 [debug] [MainThread]: Using duckdb connection "master"
[0m17:46:06.307515 [debug] [MainThread]: On master: COMMIT
[0m17:46:06.308404 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:46:06.309128 [debug] [MainThread]: On master: Close
[0m17:46:06.310135 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:46:06.310784 [debug] [MainThread]: Connection 'model.suvera.mart_recent_activity_by_patient' was properly closed.
[0m17:46:06.311420 [info ] [MainThread]: 
[0m17:46:06.312040 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m17:46:06.313622 [debug] [MainThread]: Command end result
[0m17:46:06.370971 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m17:46:06.374698 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m17:46:06.385970 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m17:46:06.386757 [info ] [MainThread]: 
[0m17:46:06.387750 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:46:06.388560 [info ] [MainThread]: 
[0m17:46:06.389140 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:46:06.395626 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.8437738, "process_in_blocks": "0", "process_kernel_time": 0.857652, "process_mem_max_rss": "138432512", "process_out_blocks": "0", "process_user_time": 4.626682}
[0m17:46:06.397004 [debug] [MainThread]: Command `dbt run` succeeded at 17:46:06.396754 after 2.85 seconds
[0m17:46:06.397714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10515ee60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105014410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105014af0>]}
[0m17:46:06.398352 [debug] [MainThread]: Flushing usage events
[0m17:46:06.859930 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:52:15.059722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109145d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a11f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a11f750>]}


============================== 17:52:15.071055 | bedae3e8-60a4-4b7b-b1c1-2188623ae88c ==============================
[0m17:52:15.071055 [info ] [MainThread]: Running with dbt=1.10.1
[0m17:52:15.072173 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'version_check': 'True', 'profiles_dir': '/Users/puneeth/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select mart_patients_inactive_3_months_after_first', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:52:15.654924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bedae3e8-60a4-4b7b-b1c1-2188623ae88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095f9220>]}
[0m17:52:15.759442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bedae3e8-60a4-4b7b-b1c1-2188623ae88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a007350>]}
[0m17:52:15.791191 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:52:15.972006 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m17:52:16.296805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:52:16.297721 [debug] [MainThread]: Partial parsing: added file: suvera://models/marts/mart_patients_inactive_3_months_after_first.sql
[0m17:52:16.736373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bedae3e8-60a4-4b7b-b1c1-2188623ae88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8c0350>]}
[0m17:52:16.878755 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m17:52:16.884416 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m17:52:16.932709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bedae3e8-60a4-4b7b-b1c1-2188623ae88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3f6d50>]}
[0m17:52:16.933515 [info ] [MainThread]: Found 12 models, 4 seeds, 12 data tests, 544 macros
[0m17:52:16.934144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bedae3e8-60a4-4b7b-b1c1-2188623ae88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9bcf30>]}
[0m17:52:16.936847 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m17:52:16.937760 [debug] [MainThread]: Command end result
[0m17:52:17.062837 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m17:52:17.065679 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m17:52:17.071302 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m17:52:17.076038 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.144138, "process_in_blocks": "0", "process_kernel_time": 0.750749, "process_mem_max_rss": "122257408", "process_out_blocks": "0", "process_user_time": 4.037217}
[0m17:52:17.076860 [debug] [MainThread]: Command `dbt run` succeeded at 17:52:17.076673 after 2.15 seconds
[0m17:52:17.077443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8bbd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fc9a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a89f7d0>]}
[0m17:52:17.077997 [debug] [MainThread]: Flushing usage events
[0m17:52:17.476649 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:52:27.845981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f85dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110673610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110673750>]}


============================== 17:52:27.855146 | 6868d69b-1395-4bb3-ba79-9bdd64e9d6dc ==============================
[0m17:52:27.855146 [info ] [MainThread]: Running with dbt=1.10.1
[0m17:52:27.856070 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/puneeth/.dbt', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select mart_patients_inactive_3_months_after_first', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:52:28.293551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6868d69b-1395-4bb3-ba79-9bdd64e9d6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb45220>]}
[0m17:52:28.399653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6868d69b-1395-4bb3-ba79-9bdd64e9d6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11055b350>]}
[0m17:52:28.424724 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:52:28.598981 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m17:52:28.875784 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:52:28.882031 [debug] [MainThread]: Partial parsing: updated file: suvera://models/marts/mart_patients_inactive_3_months_after_first.sql
[0m17:52:29.318401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6868d69b-1395-4bb3-ba79-9bdd64e9d6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e0c350>]}
[0m17:52:29.452438 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m17:52:29.456035 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m17:52:29.503465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6868d69b-1395-4bb3-ba79-9bdd64e9d6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11094ad50>]}
[0m17:52:29.504246 [info ] [MainThread]: Found 12 models, 4 seeds, 12 data tests, 544 macros
[0m17:52:29.504823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6868d69b-1395-4bb3-ba79-9bdd64e9d6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f04bb0>]}
[0m17:52:29.507589 [info ] [MainThread]: 
[0m17:52:29.508171 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:52:29.508651 [info ] [MainThread]: 
[0m17:52:29.509421 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:52:29.510627 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m17:52:29.613032 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:52:29.613722 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:52:29.614215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:52:29.762838 [debug] [ThreadPool]: SQL status: OK in 0.149 seconds
[0m17:52:29.766287 [debug] [ThreadPool]: On list_dev: Close
[0m17:52:29.767295 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m17:52:29.768340 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m17:52:29.777620 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:52:29.778150 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m17:52:29.778617 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:52:29.780395 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:52:29.782629 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:52:29.783121 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m17:52:29.783851 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:52:29.784324 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:52:29.784780 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m17:52:29.785559 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:52:29.786843 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m17:52:29.787329 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:52:29.787783 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m17:52:29.788493 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:52:29.788984 [debug] [ThreadPool]: On create_dev_main: Close
[0m17:52:29.798016 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m17:52:29.880701 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:52:29.881286 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m17:52:29.881738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:52:29.882575 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:52:29.883072 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:52:29.883547 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m17:52:29.912671 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m17:52:29.916003 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m17:52:29.918212 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m17:52:29.918758 [debug] [ThreadPool]: On list_dev_main: Close
[0m17:52:29.923564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6868d69b-1395-4bb3-ba79-9bdd64e9d6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111cc530>]}
[0m17:52:29.924236 [debug] [MainThread]: Using duckdb connection "master"
[0m17:52:29.924698 [debug] [MainThread]: On master: BEGIN
[0m17:52:29.925132 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:52:29.925954 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:52:29.926428 [debug] [MainThread]: On master: COMMIT
[0m17:52:29.926887 [debug] [MainThread]: Using duckdb connection "master"
[0m17:52:29.927326 [debug] [MainThread]: On master: COMMIT
[0m17:52:29.927977 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:52:29.928449 [debug] [MainThread]: On master: Close
[0m17:52:29.932861 [debug] [Thread-1 (]: Began running node model.suvera.mart_patients_inactive_3_months_after_first
[0m17:52:29.933824 [info ] [Thread-1 (]: 1 of 1 START sql view model main.mart_patients_inactive_3_months_after_first ... [RUN]
[0m17:52:29.934549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.mart_patients_inactive_3_months_after_first)
[0m17:52:29.935117 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_patients_inactive_3_months_after_first
[0m17:52:29.946185 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_patients_inactive_3_months_after_first"
[0m17:52:29.947343 [debug] [Thread-1 (]: Began executing node model.suvera.mart_patients_inactive_3_months_after_first
[0m17:52:29.997352 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_patients_inactive_3_months_after_first"
[0m17:52:29.998616 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m17:52:29.999193 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: BEGIN
[0m17:52:29.999731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:30.000767 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:52:30.001339 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m17:52:30.002078 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */

  
  create view "dev"."main"."mart_patients_inactive_3_months_after_first__dbt_tmp" as (
    with activities as (
    select
        patient_id,
        activity_date
    from "dev"."main"."stg_activities"
),

first_activity as (
    select
        patient_id,
        min(activity_date) as first_date
    from activities
    group by patient_id
),

follow_up_activity as (
    select
        a.patient_id
    from activities a
    join first_activity f
        on a.patient_id = f.patient_id
    where a.activity_date > f.first_date
      and a.activity_date <= f.first_date + interval '90 days'
),

inactive_patients as (
    select
        f.patient_id,
        f.first_date
    from first_activity f
    left join follow_up_activity fu
        on f.patient_id = fu.patient_id
    where fu.patient_id is null
)

select *
from inactive_patients
  );

[0m17:52:30.005123 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:52:30.014725 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m17:52:30.015376 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */
alter view "dev"."main"."mart_patients_inactive_3_months_after_first__dbt_tmp" rename to "mart_patients_inactive_3_months_after_first"
[0m17:52:30.017301 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:52:30.033792 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: COMMIT
[0m17:52:30.034436 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m17:52:30.034991 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: COMMIT
[0m17:52:30.037532 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:52:30.046685 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m17:52:30.047389 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */
drop view if exists "dev"."main"."mart_patients_inactive_3_months_after_first__dbt_backup" cascade
[0m17:52:30.048466 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:52:30.052177 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: Close
[0m17:52:30.055720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6868d69b-1395-4bb3-ba79-9bdd64e9d6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110da210>]}
[0m17:52:30.057444 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.mart_patients_inactive_3_months_after_first  [[32mOK[0m in 0.12s]
[0m17:52:30.058796 [debug] [Thread-1 (]: Finished running node model.suvera.mart_patients_inactive_3_months_after_first
[0m17:52:30.061454 [debug] [MainThread]: Using duckdb connection "master"
[0m17:52:30.062110 [debug] [MainThread]: On master: BEGIN
[0m17:52:30.062702 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:52:30.063766 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:52:30.064631 [debug] [MainThread]: On master: COMMIT
[0m17:52:30.065232 [debug] [MainThread]: Using duckdb connection "master"
[0m17:52:30.065742 [debug] [MainThread]: On master: COMMIT
[0m17:52:30.066600 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:52:30.067161 [debug] [MainThread]: On master: Close
[0m17:52:30.068047 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:52:30.068620 [debug] [MainThread]: Connection 'model.suvera.mart_patients_inactive_3_months_after_first' was properly closed.
[0m17:52:30.069153 [info ] [MainThread]: 
[0m17:52:30.069705 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m17:52:30.070748 [debug] [MainThread]: Command end result
[0m17:52:30.119199 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m17:52:30.121980 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m17:52:30.131750 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m17:52:30.132295 [info ] [MainThread]: 
[0m17:52:30.132878 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:52:30.133371 [info ] [MainThread]: 
[0m17:52:30.133897 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:52:30.138550 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4198134, "process_in_blocks": "0", "process_kernel_time": 0.52496, "process_mem_max_rss": "137764864", "process_out_blocks": "0", "process_user_time": 4.046627}
[0m17:52:30.139271 [debug] [MainThread]: Command `dbt run` succeeded at 17:52:30.139106 after 2.42 seconds
[0m17:52:30.139951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e7af10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d24b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d25310>]}
[0m17:52:30.140568 [debug] [MainThread]: Flushing usage events
[0m17:52:30.493703 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:00:33.852525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103e1d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111f3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111f3750>]}


============================== 18:00:33.863822 | 875543fd-7831-4dee-994b-b92c066fc7c4 ==============================
[0m18:00:33.863822 [info ] [MainThread]: Running with dbt=1.10.1
[0m18:00:33.865058 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'version_check': 'True', 'profiles_dir': '/Users/puneeth/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:00:34.448638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '875543fd-7831-4dee-994b-b92c066fc7c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106c1220>]}
[0m18:00:34.592779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '875543fd-7831-4dee-994b-b92c066fc7c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110d7350>]}
[0m18:00:34.616563 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m18:00:34.811321 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m18:00:35.103162 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:00:35.103880 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:00:35.243011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '875543fd-7831-4dee-994b-b92c066fc7c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114fb650>]}
[0m18:00:35.393650 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m18:00:35.399346 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m18:00:35.446637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '875543fd-7831-4dee-994b-b92c066fc7c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114cad50>]}
[0m18:00:35.448282 [info ] [MainThread]: Found 12 models, 4 seeds, 12 data tests, 544 macros
[0m18:00:35.449385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '875543fd-7831-4dee-994b-b92c066fc7c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111914e50>]}
[0m18:00:35.453038 [info ] [MainThread]: 
[0m18:00:35.454091 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:00:35.455063 [info ] [MainThread]: 
[0m18:00:35.456181 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:00:35.471031 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m18:00:35.579286 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m18:00:35.579897 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m18:00:35.580389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:35.606974 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m18:00:35.607586 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m18:00:35.609090 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:35.610376 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m18:00:35.611282 [info ] [MainThread]: 
[0m18:00:35.612397 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m18:00:35.613233 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/puneeth/Documents/suvera_dbt_project/suvera/dev.duckdb": Conflicting lock is held in /usr/local/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 29964) by user puneeth. See also https://duckdb.org/docs/stable/connect/concurrency
[0m18:00:35.618199 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8994194, "process_in_blocks": "0", "process_kernel_time": 0.754964, "process_mem_max_rss": "126644224", "process_out_blocks": "0", "process_user_time": 3.829844}
[0m18:00:35.619174 [debug] [MainThread]: Command `dbt run` failed at 18:00:35.618952 after 1.90 seconds
[0m18:00:35.619925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b14c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111099a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c14290>]}
[0m18:00:35.620520 [debug] [MainThread]: Flushing usage events
[0m18:00:36.015644 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:00:48.270908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eba1d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9b3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9b3750>]}


============================== 18:00:48.281448 | e9aa0d3f-98d7-4003-a34d-6093003b375b ==============================
[0m18:00:48.281448 [info ] [MainThread]: Running with dbt=1.10.1
[0m18:00:48.282579 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:00:48.715955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9aa0d3f-98d7-4003-a34d-6093003b375b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee81220>]}
[0m18:00:48.821729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9aa0d3f-98d7-4003-a34d-6093003b375b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f89b350>]}
[0m18:00:48.850108 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m18:00:49.026063 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m18:00:49.354720 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:00:49.355325 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:00:49.437696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9aa0d3f-98d7-4003-a34d-6093003b375b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fcbb650>]}
[0m18:00:49.578959 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m18:00:49.585065 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m18:00:49.632722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9aa0d3f-98d7-4003-a34d-6093003b375b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc8ad50>]}
[0m18:00:49.633469 [info ] [MainThread]: Found 12 models, 4 seeds, 12 data tests, 544 macros
[0m18:00:49.634034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9aa0d3f-98d7-4003-a34d-6093003b375b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100c8e50>]}
[0m18:00:49.637570 [info ] [MainThread]: 
[0m18:00:49.638139 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:00:49.638610 [info ] [MainThread]: 
[0m18:00:49.639498 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:00:49.648848 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m18:00:49.747742 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m18:00:49.748431 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m18:00:49.748951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:49.782106 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m18:00:49.785933 [debug] [ThreadPool]: On list_dev: Close
[0m18:00:49.787421 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m18:00:49.788629 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m18:00:49.798078 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:00:49.798614 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m18:00:49.799076 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:49.802963 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:00:49.805183 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:00:49.805653 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m18:00:49.806413 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:00:49.806883 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:00:49.807334 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m18:00:49.812856 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m18:00:49.814533 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m18:00:49.815060 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:00:49.815516 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m18:00:49.816299 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:00:49.816795 [debug] [ThreadPool]: On create_dev_main: Close
[0m18:00:49.819920 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m18:00:49.828505 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m18:00:49.829054 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m18:00:49.829502 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:49.830366 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:00:49.830852 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m18:00:49.831328 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m18:00:49.887635 [debug] [ThreadPool]: SQL status: OK in 0.056 seconds
[0m18:00:49.890591 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m18:00:49.892646 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m18:00:49.893133 [debug] [ThreadPool]: On list_dev_main: Close
[0m18:00:49.898013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9aa0d3f-98d7-4003-a34d-6093003b375b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102d54a0>]}
[0m18:00:49.898692 [debug] [MainThread]: Using duckdb connection "master"
[0m18:00:49.899155 [debug] [MainThread]: On master: BEGIN
[0m18:00:49.899594 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:00:49.900405 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:00:49.900882 [debug] [MainThread]: On master: COMMIT
[0m18:00:49.901345 [debug] [MainThread]: Using duckdb connection "master"
[0m18:00:49.901786 [debug] [MainThread]: On master: COMMIT
[0m18:00:49.902449 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:00:49.902928 [debug] [MainThread]: On master: Close
[0m18:00:49.907465 [debug] [Thread-1 (]: Began running node model.suvera.stg_activities
[0m18:00:49.908370 [info ] [Thread-1 (]: 1 of 12 START sql view model main.stg_activities ............................... [RUN]
[0m18:00:49.909094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.stg_activities)
[0m18:00:49.909656 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_activities
[0m18:00:49.920900 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_activities"
[0m18:00:49.923090 [debug] [Thread-1 (]: Began executing node model.suvera.stg_activities
[0m18:00:49.972430 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_activities"
[0m18:00:49.973605 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:00:49.974162 [debug] [Thread-1 (]: On model.suvera.stg_activities: BEGIN
[0m18:00:49.974681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:49.975554 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:49.976092 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:00:49.976626 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */

  
  create view "dev"."main"."stg_activities__dbt_tmp" as (
    select * 
from "dev"."main"."raw_activities"
limit 100
  );

[0m18:00:49.978688 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:49.988192 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:00:49.988856 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
alter view "dev"."main"."stg_activities" rename to "stg_activities__dbt_backup"
[0m18:00:49.991146 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:00:49.995748 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:00:49.996343 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
alter view "dev"."main"."stg_activities__dbt_tmp" rename to "stg_activities"
[0m18:00:49.997290 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:00:50.015381 [debug] [Thread-1 (]: On model.suvera.stg_activities: COMMIT
[0m18:00:50.016013 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:00:50.016541 [debug] [Thread-1 (]: On model.suvera.stg_activities: COMMIT
[0m18:00:50.022157 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:00:50.029468 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:00:50.030122 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
drop view if exists "dev"."main"."stg_activities__dbt_backup" cascade
[0m18:00:50.032524 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:00:50.036197 [debug] [Thread-1 (]: On model.suvera.stg_activities: Close
[0m18:00:50.040312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9aa0d3f-98d7-4003-a34d-6093003b375b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103d9a90>]}
[0m18:00:50.041528 [info ] [Thread-1 (]: 1 of 12 OK created sql view model main.stg_activities .......................... [[32mOK[0m in 0.13s]
[0m18:00:50.042499 [debug] [Thread-1 (]: Finished running node model.suvera.stg_activities
[0m18:00:50.043126 [debug] [Thread-1 (]: Began running node model.suvera.stg_patients
[0m18:00:50.043835 [info ] [Thread-1 (]: 2 of 12 START sql view model main.stg_patients ................................. [RUN]
[0m18:00:50.044681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_activities, now model.suvera.stg_patients)
[0m18:00:50.045265 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_patients
[0m18:00:50.049184 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_patients"
[0m18:00:50.051850 [debug] [Thread-1 (]: Began executing node model.suvera.stg_patients
[0m18:00:50.057285 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_patients"
[0m18:00:50.058690 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:00:50.059354 [debug] [Thread-1 (]: On model.suvera.stg_patients: BEGIN
[0m18:00:50.060385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:50.061502 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.062181 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:00:50.062777 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */

  
  create view "dev"."main"."stg_patients__dbt_tmp" as (
    with source as (
    select * from "dev"."main"."raw_patients"
),

parsed as (
    select
        cast(nullif(regexp_extract(data, '"patient_id": ([0-9]+)', 1), '') as integer) as patient_id,
        cast(nullif(regexp_extract(data, '"practice_id": ([0-9]+)', 1), '') as integer) as practice_id,
        cast(nullif(regexp_extract(data, '"age": ([0-9]+)', 1), '') as integer) as age,
        regexp_extract(data, '"gender": "([^""]*)"', 1) as gender,
        cast(nullif(regexp_extract(data, '"registration_date": "([^"]+)"', 1), '') as date) as registration_date,
        regexp_extract(data, '"email": "([^"]+)"', 1) as email,
        regexp_extract(data, '"phone": "([^"]+)"', 1) as phone,
        string_split(
            replace(
                regexp_extract(data, '"conditions": \[(.*?)\]', 1),
                '"',
                ''
            ),
            ', '
        ) as conditions
    from source
)

select * from parsed
  );

[0m18:00:50.066886 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:00:50.072255 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:00:50.072888 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients" rename to "stg_patients__dbt_backup"
[0m18:00:50.073908 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:00:50.078190 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:00:50.078856 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m18:00:50.079847 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:00:50.082570 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m18:00:50.083340 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:00:50.083891 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m18:00:50.085200 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.088817 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:00:50.089377 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
drop view if exists "dev"."main"."stg_patients__dbt_backup" cascade
[0m18:00:50.090691 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.092726 [debug] [Thread-1 (]: On model.suvera.stg_patients: Close
[0m18:00:50.093525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9aa0d3f-98d7-4003-a34d-6093003b375b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100ce150>]}
[0m18:00:50.094436 [info ] [Thread-1 (]: 2 of 12 OK created sql view model main.stg_patients ............................ [[32mOK[0m in 0.05s]
[0m18:00:50.095471 [debug] [Thread-1 (]: Finished running node model.suvera.stg_patients
[0m18:00:50.096164 [debug] [Thread-1 (]: Began running node model.suvera.stg_pcns
[0m18:00:50.097158 [info ] [Thread-1 (]: 3 of 12 START sql view model main.stg_pcns ..................................... [RUN]
[0m18:00:50.097990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_patients, now model.suvera.stg_pcns)
[0m18:00:50.098624 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_pcns
[0m18:00:50.102741 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_pcns"
[0m18:00:50.104584 [debug] [Thread-1 (]: Began executing node model.suvera.stg_pcns
[0m18:00:50.115066 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_pcns"
[0m18:00:50.116267 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:00:50.117071 [debug] [Thread-1 (]: On model.suvera.stg_pcns: BEGIN
[0m18:00:50.117643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:50.118615 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.119360 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:00:50.119944 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */

  
  create view "dev"."main"."stg_pcns__dbt_tmp" as (
    select * 
from "dev"."main"."raw_pcns"
  );

[0m18:00:50.121267 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.126400 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:00:50.127580 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */
alter view "dev"."main"."stg_pcns" rename to "stg_pcns__dbt_backup"
[0m18:00:50.128645 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:00:50.132656 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:00:50.133245 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */
alter view "dev"."main"."stg_pcns__dbt_tmp" rename to "stg_pcns"
[0m18:00:50.134239 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:00:50.138473 [debug] [Thread-1 (]: On model.suvera.stg_pcns: COMMIT
[0m18:00:50.139140 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:00:50.139681 [debug] [Thread-1 (]: On model.suvera.stg_pcns: COMMIT
[0m18:00:50.140886 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.217803 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:00:50.218448 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */
drop view if exists "dev"."main"."stg_pcns__dbt_backup" cascade
[0m18:00:50.219778 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.221723 [debug] [Thread-1 (]: On model.suvera.stg_pcns: Close
[0m18:00:50.222479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9aa0d3f-98d7-4003-a34d-6093003b375b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110489e50>]}
[0m18:00:50.223355 [info ] [Thread-1 (]: 3 of 12 OK created sql view model main.stg_pcns ................................ [[32mOK[0m in 0.12s]
[0m18:00:50.224224 [debug] [Thread-1 (]: Finished running node model.suvera.stg_pcns
[0m18:00:50.224842 [debug] [Thread-1 (]: Began running node model.suvera.stg_practices
[0m18:00:50.225514 [info ] [Thread-1 (]: 4 of 12 START sql view model main.stg_practices ................................ [RUN]
[0m18:00:50.226244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_pcns, now model.suvera.stg_practices)
[0m18:00:50.226820 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_practices
[0m18:00:50.230316 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_practices"
[0m18:00:50.232226 [debug] [Thread-1 (]: Began executing node model.suvera.stg_practices
[0m18:00:50.237688 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_practices"
[0m18:00:50.239549 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:00:50.240174 [debug] [Thread-1 (]: On model.suvera.stg_practices: BEGIN
[0m18:00:50.240883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:50.242320 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.242962 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:00:50.243529 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */

  
  create view "dev"."main"."stg_practices__dbt_tmp" as (
    select * 
from "dev"."main"."raw_practices"
  );

[0m18:00:50.244623 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:00:50.248809 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:00:50.249471 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */
alter view "dev"."main"."stg_practices" rename to "stg_practices__dbt_backup"
[0m18:00:50.250486 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:00:50.256259 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:00:50.256908 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */
alter view "dev"."main"."stg_practices__dbt_tmp" rename to "stg_practices"
[0m18:00:50.257910 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:00:50.260282 [debug] [Thread-1 (]: On model.suvera.stg_practices: COMMIT
[0m18:00:50.260887 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:00:50.261428 [debug] [Thread-1 (]: On model.suvera.stg_practices: COMMIT
[0m18:00:50.262626 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.265789 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:00:50.266362 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */
drop view if exists "dev"."main"."stg_practices__dbt_backup" cascade
[0m18:00:50.267590 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.270127 [debug] [Thread-1 (]: On model.suvera.stg_practices: Close
[0m18:00:50.271094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9aa0d3f-98d7-4003-a34d-6093003b375b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbb20d0>]}
[0m18:00:50.272016 [info ] [Thread-1 (]: 4 of 12 OK created sql view model main.stg_practices ........................... [[32mOK[0m in 0.04s]
[0m18:00:50.272909 [debug] [Thread-1 (]: Finished running node model.suvera.stg_practices
[0m18:00:50.273519 [debug] [Thread-1 (]: Began running node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:00:50.274212 [info ] [Thread-1 (]: 5 of 12 START sql view model main.mart_patients_inactive_3_months_after_first .. [RUN]
[0m18:00:50.274941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_practices, now model.suvera.mart_patients_inactive_3_months_after_first)
[0m18:00:50.275530 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:00:50.279092 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:00:50.280607 [debug] [Thread-1 (]: Began executing node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:00:50.287027 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:00:50.289033 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:00:50.289632 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: BEGIN
[0m18:00:50.290167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:50.291133 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.291702 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:00:50.292293 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */

  
  create view "dev"."main"."mart_patients_inactive_3_months_after_first__dbt_tmp" as (
    with activities as (
    select
        patient_id,
        activity_date
    from "dev"."main"."stg_activities"
),

first_activity as (
    select
        patient_id,
        min(activity_date) as first_date
    from activities
    group by patient_id
),

follow_up_activity as (
    select
        a.patient_id
    from activities a
    join first_activity f
        on a.patient_id = f.patient_id
    where a.activity_date > f.first_date
      and a.activity_date <= f.first_date + interval '90 days'
),

inactive_patients as (
    select
        f.patient_id,
        f.first_date
    from first_activity f
    left join follow_up_activity fu
        on f.patient_id = fu.patient_id
    where fu.patient_id is null
)

select *
from inactive_patients
  );

[0m18:00:50.294613 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:00:50.298740 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:00:50.299324 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */
alter view "dev"."main"."mart_patients_inactive_3_months_after_first" rename to "mart_patients_inactive_3_months_after_first__dbt_backup"
[0m18:00:50.300273 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:00:50.304911 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:00:50.305640 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */
alter view "dev"."main"."mart_patients_inactive_3_months_after_first__dbt_tmp" rename to "mart_patients_inactive_3_months_after_first"
[0m18:00:50.307129 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.309604 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: COMMIT
[0m18:00:50.310235 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:00:50.310799 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: COMMIT
[0m18:00:50.312222 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.315401 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:00:50.315986 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */
drop view if exists "dev"."main"."mart_patients_inactive_3_months_after_first__dbt_backup" cascade
[0m18:00:50.317292 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.319426 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: Close
[0m18:00:50.320221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9aa0d3f-98d7-4003-a34d-6093003b375b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104bf150>]}
[0m18:00:50.321183 [info ] [Thread-1 (]: 5 of 12 OK created sql view model main.mart_patients_inactive_3_months_after_first  [[32mOK[0m in 0.05s]
[0m18:00:50.322101 [debug] [Thread-1 (]: Finished running node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:00:50.322707 [debug] [Thread-1 (]: Began running node model.suvera.cleaned_patients
[0m18:00:50.323395 [info ] [Thread-1 (]: 6 of 12 START sql view model main.cleaned_patients ............................. [RUN]
[0m18:00:50.324161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_patients_inactive_3_months_after_first, now model.suvera.cleaned_patients)
[0m18:00:50.324743 [debug] [Thread-1 (]: Began compiling node model.suvera.cleaned_patients
[0m18:00:50.328445 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.cleaned_patients"
[0m18:00:50.329955 [debug] [Thread-1 (]: Began executing node model.suvera.cleaned_patients
[0m18:00:50.336732 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.cleaned_patients"
[0m18:00:50.338060 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:00:50.338651 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: BEGIN
[0m18:00:50.339201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:50.340473 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.341084 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:00:50.341847 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */

  
  create view "dev"."main"."cleaned_patients__dbt_tmp" as (
    with deduplicated as (
    select *
    from (
        select *,
               row_number() over (
                   partition by patient_id, practice_id
                   order by registration_date desc
               ) as row_num
        from "dev"."main"."stg_patients"
    )
    where row_num = 1
),

filtered as (
    select *
    from deduplicated
    where cast(age as integer) between 0 and 120
)

select
    patient_id,
    practice_id,
    cast(age as integer) as age,
    gender,
    registration_date,
    email,
    phone,
    conditions
from filtered
  );

[0m18:00:50.347908 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:00:50.352313 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:00:50.352940 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */
alter view "dev"."main"."cleaned_patients" rename to "cleaned_patients__dbt_backup"
[0m18:00:50.353962 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:00:50.358658 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:00:50.359296 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */
alter view "dev"."main"."cleaned_patients__dbt_tmp" rename to "cleaned_patients"
[0m18:00:50.360282 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:00:50.362583 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: COMMIT
[0m18:00:50.363149 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:00:50.363676 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: COMMIT
[0m18:00:50.364924 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.367997 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:00:50.368554 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */
drop view if exists "dev"."main"."cleaned_patients__dbt_backup" cascade
[0m18:00:50.369982 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.371972 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: Close
[0m18:00:50.372766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9aa0d3f-98d7-4003-a34d-6093003b375b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb09370>]}
[0m18:00:50.373654 [info ] [Thread-1 (]: 6 of 12 OK created sql view model main.cleaned_patients ........................ [[32mOK[0m in 0.05s]
[0m18:00:50.374631 [debug] [Thread-1 (]: Finished running node model.suvera.cleaned_patients
[0m18:00:50.375252 [debug] [Thread-1 (]: Began running node model.suvera.qa_flagged_patients
[0m18:00:50.375946 [info ] [Thread-1 (]: 7 of 12 START sql view model main.qa_flagged_patients .......................... [RUN]
[0m18:00:50.376724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.cleaned_patients, now model.suvera.qa_flagged_patients)
[0m18:00:50.377477 [debug] [Thread-1 (]: Began compiling node model.suvera.qa_flagged_patients
[0m18:00:50.382059 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.qa_flagged_patients"
[0m18:00:50.383818 [debug] [Thread-1 (]: Began executing node model.suvera.qa_flagged_patients
[0m18:00:50.389406 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.qa_flagged_patients"
[0m18:00:50.390870 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:00:50.391454 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: BEGIN
[0m18:00:50.391982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:50.392919 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.393494 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:00:50.394134 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */

  
  create view "dev"."main"."qa_flagged_patients__dbt_tmp" as (
    with source as (
    select *
    from "dev"."main"."stg_patients"
),

deduplicated as (
    select *
    from (
        select *,
               row_number() over (
                   partition by patient_id, practice_id
                   order by registration_date desc
               ) as row_num
        from source
    )
),

filtered_out as (
    select *
    from deduplicated
    where row_num > 1
       or try_cast(age as integer) not between 0 and 120
)

select * from filtered_out
  );

[0m18:00:50.398393 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:00:50.403547 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:00:50.404480 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */
alter view "dev"."main"."qa_flagged_patients" rename to "qa_flagged_patients__dbt_backup"
[0m18:00:50.405626 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:00:50.410982 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:00:50.411640 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */
alter view "dev"."main"."qa_flagged_patients__dbt_tmp" rename to "qa_flagged_patients"
[0m18:00:50.412662 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:00:50.415040 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: COMMIT
[0m18:00:50.415648 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:00:50.416181 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: COMMIT
[0m18:00:50.417493 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.421604 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:00:50.422388 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */
drop view if exists "dev"."main"."qa_flagged_patients__dbt_backup" cascade
[0m18:00:50.423885 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.426035 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: Close
[0m18:00:50.426805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9aa0d3f-98d7-4003-a34d-6093003b375b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb1d4f0>]}
[0m18:00:50.427689 [info ] [Thread-1 (]: 7 of 12 OK created sql view model main.qa_flagged_patients ..................... [[32mOK[0m in 0.05s]
[0m18:00:50.428574 [debug] [Thread-1 (]: Finished running node model.suvera.qa_flagged_patients
[0m18:00:50.429173 [debug] [Thread-1 (]: Began running node model.suvera.mart_age_groups_by_pcn
[0m18:00:50.430006 [info ] [Thread-1 (]: 8 of 12 START sql view model main.mart_age_groups_by_pcn ....................... [RUN]
[0m18:00:50.430689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.qa_flagged_patients, now model.suvera.mart_age_groups_by_pcn)
[0m18:00:50.431264 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_age_groups_by_pcn
[0m18:00:50.436522 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_age_groups_by_pcn"
[0m18:00:50.438140 [debug] [Thread-1 (]: Began executing node model.suvera.mart_age_groups_by_pcn
[0m18:00:50.443638 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_age_groups_by_pcn"
[0m18:00:50.445581 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:00:50.446261 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: BEGIN
[0m18:00:50.446806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:50.447954 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.448605 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:00:50.449220 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_age_groups_by_pcn"} */

  
  create view "dev"."main"."mart_age_groups_by_pcn__dbt_tmp" as (
    with patients as (
    select
        patient_id,
        practice_id,
        age,
        case
            when age between 0 and 18 then '0-18'
            when age between 19 and 35 then '19-35'
            when age between 36 and 50 then '36-50'
            when age >= 51 then '51+'
            else 'Unknown'
        end as age_group
    from "dev"."main"."cleaned_patients"
),

practices as (
    select *
    from "dev"."main"."stg_practices"
),

pcns as (
    select *
    from "dev"."main"."stg_pcns"
),

joined as (
    select
        pcn.id as pcn_id,
        pcn.pcn_name,
        p.age_group
    from patients as p
    left join practices pr on p.practice_id = pr.id
    left join pcns pcn on pr.pcn = pcn.id
)

select
    pcn_id,
    pcn_name,
    age_group,
    count(*) as num_patients
from joined
group by pcn_id, pcn_name, age_group
order by pcn_id, age_group
  );

[0m18:00:50.452491 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:00:50.457737 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:00:50.458378 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_age_groups_by_pcn"} */
alter view "dev"."main"."mart_age_groups_by_pcn" rename to "mart_age_groups_by_pcn__dbt_backup"
[0m18:00:50.459631 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.463736 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:00:50.464321 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_age_groups_by_pcn"} */
alter view "dev"."main"."mart_age_groups_by_pcn__dbt_tmp" rename to "mart_age_groups_by_pcn"
[0m18:00:50.465265 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:00:50.467484 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: COMMIT
[0m18:00:50.468044 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:00:50.468569 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: COMMIT
[0m18:00:50.469993 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.473289 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:00:50.473914 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_age_groups_by_pcn"} */
drop view if exists "dev"."main"."mart_age_groups_by_pcn__dbt_backup" cascade
[0m18:00:50.475470 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.477566 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: Close
[0m18:00:50.478344 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9aa0d3f-98d7-4003-a34d-6093003b375b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fac52b0>]}
[0m18:00:50.479232 [info ] [Thread-1 (]: 8 of 12 OK created sql view model main.mart_age_groups_by_pcn .................. [[32mOK[0m in 0.05s]
[0m18:00:50.480127 [debug] [Thread-1 (]: Finished running node model.suvera.mart_age_groups_by_pcn
[0m18:00:50.480752 [debug] [Thread-1 (]: Began running node model.suvera.mart_avg_age_by_practice
[0m18:00:50.481443 [info ] [Thread-1 (]: 9 of 12 START sql view model main.mart_avg_age_by_practice ..................... [RUN]
[0m18:00:50.482229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_age_groups_by_pcn, now model.suvera.mart_avg_age_by_practice)
[0m18:00:50.482815 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_avg_age_by_practice
[0m18:00:50.487287 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_avg_age_by_practice"
[0m18:00:50.489646 [debug] [Thread-1 (]: Began executing node model.suvera.mart_avg_age_by_practice
[0m18:00:50.494476 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_avg_age_by_practice"
[0m18:00:50.495580 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:00:50.496149 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: BEGIN
[0m18:00:50.496679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:50.497617 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.498180 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:00:50.498742 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_avg_age_by_practice"} */

  
  create view "dev"."main"."mart_avg_age_by_practice__dbt_tmp" as (
    with patients as (
    select
        patient_id,
        practice_id,
        age
    from "dev"."main"."cleaned_patients"
),

aggregated as (
    select
        practice_id,
        avg(age) as avg_age,
        count(*) as num_patients
    from patients
    group by practice_id
)

select * from aggregated
order by avg_age desc
  );

[0m18:00:50.501615 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:00:50.511603 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:00:50.512263 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_avg_age_by_practice"} */
alter view "dev"."main"."mart_avg_age_by_practice" rename to "mart_avg_age_by_practice__dbt_backup"
[0m18:00:50.513269 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:00:50.517305 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:00:50.517895 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_avg_age_by_practice"} */
alter view "dev"."main"."mart_avg_age_by_practice__dbt_tmp" rename to "mart_avg_age_by_practice"
[0m18:00:50.518922 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:00:50.521677 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: COMMIT
[0m18:00:50.522343 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:00:50.522884 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: COMMIT
[0m18:00:50.524249 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.528406 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:00:50.529057 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_avg_age_by_practice"} */
drop view if exists "dev"."main"."mart_avg_age_by_practice__dbt_backup" cascade
[0m18:00:50.530329 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.532318 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: Close
[0m18:00:50.533076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9aa0d3f-98d7-4003-a34d-6093003b375b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fac4f50>]}
[0m18:00:50.533960 [info ] [Thread-1 (]: 9 of 12 OK created sql view model main.mart_avg_age_by_practice ................ [[32mOK[0m in 0.05s]
[0m18:00:50.534865 [debug] [Thread-1 (]: Finished running node model.suvera.mart_avg_age_by_practice
[0m18:00:50.535499 [debug] [Thread-1 (]: Began running node model.suvera.mart_hypertension_pct_by_practice
[0m18:00:50.536203 [info ] [Thread-1 (]: 10 of 12 START sql view model main.mart_hypertension_pct_by_practice ........... [RUN]
[0m18:00:50.536966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_avg_age_by_practice, now model.suvera.mart_hypertension_pct_by_practice)
[0m18:00:50.537562 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_hypertension_pct_by_practice
[0m18:00:50.541339 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_hypertension_pct_by_practice"
[0m18:00:50.543235 [debug] [Thread-1 (]: Began executing node model.suvera.mart_hypertension_pct_by_practice
[0m18:00:50.550518 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_hypertension_pct_by_practice"
[0m18:00:50.552837 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:00:50.554262 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: BEGIN
[0m18:00:50.554868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:50.555797 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.556375 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:00:50.557038 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_hypertension_pct_by_practice"} */

  
  create view "dev"."main"."mart_hypertension_pct_by_practice__dbt_tmp" as (
    with patients as (
    select
        patient_id,
        practice_id,
        conditions
    from "dev"."main"."cleaned_patients"
),

exploded as (
    select
        patient_id,
        practice_id,
        unnest(conditions) as condition
    from patients
),

hypertension_counts as (
    select
        practice_id,
        count(distinct patient_id) as patients_with_hypertension
    from exploded
    where lower(condition) = 'hypertension'
    group by practice_id
),

total_patients as (
    select
        practice_id,
        count(distinct patient_id) as total_patients
    from patients
    group by practice_id
)

select
    t.practice_id,
    t.total_patients,
    coalesce(h.patients_with_hypertension, 0) as patients_with_hypertension,
    round(
        coalesce(h.patients_with_hypertension, 0) * 100.0 / t.total_patients,
        1
    ) as pct_with_hypertension
from total_patients t
left join hypertension_counts h
    on t.practice_id = h.practice_id
order by pct_with_hypertension desc
  );

[0m18:00:50.563966 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m18:00:50.569401 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:00:50.570080 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_hypertension_pct_by_practice"} */
alter view "dev"."main"."mart_hypertension_pct_by_practice" rename to "mart_hypertension_pct_by_practice__dbt_backup"
[0m18:00:50.571191 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:00:50.575432 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:00:50.576039 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_hypertension_pct_by_practice"} */
alter view "dev"."main"."mart_hypertension_pct_by_practice__dbt_tmp" rename to "mart_hypertension_pct_by_practice"
[0m18:00:50.577217 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.579718 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: COMMIT
[0m18:00:50.580369 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:00:50.580905 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: COMMIT
[0m18:00:50.582309 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.586079 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:00:50.586694 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_hypertension_pct_by_practice"} */
drop view if exists "dev"."main"."mart_hypertension_pct_by_practice__dbt_backup" cascade
[0m18:00:50.588061 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.590118 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: Close
[0m18:00:50.590888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9aa0d3f-98d7-4003-a34d-6093003b375b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb1d910>]}
[0m18:00:50.591782 [info ] [Thread-1 (]: 10 of 12 OK created sql view model main.mart_hypertension_pct_by_practice ...... [[32mOK[0m in 0.05s]
[0m18:00:50.592680 [debug] [Thread-1 (]: Finished running node model.suvera.mart_hypertension_pct_by_practice
[0m18:00:50.593288 [debug] [Thread-1 (]: Began running node model.suvera.mart_patient_count_by_pcn
[0m18:00:50.593974 [info ] [Thread-1 (]: 11 of 12 START sql view model main.mart_patient_count_by_pcn ................... [RUN]
[0m18:00:50.594748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_hypertension_pct_by_practice, now model.suvera.mart_patient_count_by_pcn)
[0m18:00:50.595360 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_patient_count_by_pcn
[0m18:00:50.599624 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_patient_count_by_pcn"
[0m18:00:50.601713 [debug] [Thread-1 (]: Began executing node model.suvera.mart_patient_count_by_pcn
[0m18:00:50.609090 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_patient_count_by_pcn"
[0m18:00:50.610841 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:00:50.611761 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: BEGIN
[0m18:00:50.612962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:50.614109 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.614856 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:00:50.616597 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patient_count_by_pcn"} */

  
  create view "dev"."main"."mart_patient_count_by_pcn__dbt_tmp" as (
    with patients as (
    select *
    from "dev"."main"."cleaned_patients"
),

practices as (
    select *
    from "dev"."main"."stg_practices"
),

pcns as (
    select *
    from "dev"."main"."stg_pcns"
),

joined as (
    select
        pcn.id as pcn_id,
        pcn.pcn_name pcn_name,
        patient.patient_id
    from patients as patient
    left join practices as practice
        on patient.practice_id = practice.id
    left join pcns as pcn
        on practice.pcn = pcn.id
)

select
    pcn_id,
    pcn_name,
    count(distinct patient_id) as num_patients
from joined
group by 1, 2
order by num_patients desc
  );

[0m18:00:50.621118 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:00:50.626241 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:00:50.627143 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patient_count_by_pcn"} */
alter view "dev"."main"."mart_patient_count_by_pcn" rename to "mart_patient_count_by_pcn__dbt_backup"
[0m18:00:50.628831 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.633286 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:00:50.634004 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patient_count_by_pcn"} */
alter view "dev"."main"."mart_patient_count_by_pcn__dbt_tmp" rename to "mart_patient_count_by_pcn"
[0m18:00:50.635080 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:00:50.637886 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: COMMIT
[0m18:00:50.638676 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:00:50.639255 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: COMMIT
[0m18:00:50.640660 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.644485 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:00:50.645167 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patient_count_by_pcn"} */
drop view if exists "dev"."main"."mart_patient_count_by_pcn__dbt_backup" cascade
[0m18:00:50.646565 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.648660 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: Close
[0m18:00:50.649427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9aa0d3f-98d7-4003-a34d-6093003b375b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f49c1d0>]}
[0m18:00:50.650318 [info ] [Thread-1 (]: 11 of 12 OK created sql view model main.mart_patient_count_by_pcn .............. [[32mOK[0m in 0.05s]
[0m18:00:50.651217 [debug] [Thread-1 (]: Finished running node model.suvera.mart_patient_count_by_pcn
[0m18:00:50.651825 [debug] [Thread-1 (]: Began running node model.suvera.mart_recent_activity_by_patient
[0m18:00:50.652851 [info ] [Thread-1 (]: 12 of 12 START sql view model main.mart_recent_activity_by_patient ............. [RUN]
[0m18:00:50.653567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_patient_count_by_pcn, now model.suvera.mart_recent_activity_by_patient)
[0m18:00:50.654149 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_recent_activity_by_patient
[0m18:00:50.658047 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_recent_activity_by_patient"
[0m18:00:50.659566 [debug] [Thread-1 (]: Began executing node model.suvera.mart_recent_activity_by_patient
[0m18:00:50.664847 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_recent_activity_by_patient"
[0m18:00:50.665945 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:00:50.666551 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: BEGIN
[0m18:00:50.667092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:50.668045 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.668630 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:00:50.669226 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_recent_activity_by_patient"} */

  
  create view "dev"."main"."mart_recent_activity_by_patient__dbt_tmp" as (
    with patients as (
    select patient_id
    from "dev"."main"."cleaned_patients"
),

activities as (
    select
        patient_id,
        activity_date
    from "dev"."main"."stg_activities"
),

filtered as (
    select *
    from activities
    where patient_id in (select patient_id from patients)
)

select
    patient_id,
    max(activity_date) as most_recent_activity
from filtered
group by patient_id
  );

[0m18:00:50.673819 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:00:50.678239 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:00:50.678973 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_recent_activity_by_patient"} */
alter view "dev"."main"."mart_recent_activity_by_patient" rename to "mart_recent_activity_by_patient__dbt_backup"
[0m18:00:50.680682 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.685540 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:00:50.686232 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_recent_activity_by_patient"} */
alter view "dev"."main"."mart_recent_activity_by_patient__dbt_tmp" rename to "mart_recent_activity_by_patient"
[0m18:00:50.687983 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.690489 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: COMMIT
[0m18:00:50.691227 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:00:50.691829 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: COMMIT
[0m18:00:50.693124 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.697581 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:00:50.698358 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_recent_activity_by_patient"} */
drop view if exists "dev"."main"."mart_recent_activity_by_patient__dbt_backup" cascade
[0m18:00:50.699839 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:50.702541 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: Close
[0m18:00:50.703502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9aa0d3f-98d7-4003-a34d-6093003b375b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f882cf0>]}
[0m18:00:50.704700 [info ] [Thread-1 (]: 12 of 12 OK created sql view model main.mart_recent_activity_by_patient ........ [[32mOK[0m in 0.05s]
[0m18:00:50.705837 [debug] [Thread-1 (]: Finished running node model.suvera.mart_recent_activity_by_patient
[0m18:00:50.709148 [debug] [MainThread]: Using duckdb connection "master"
[0m18:00:50.709746 [debug] [MainThread]: On master: BEGIN
[0m18:00:50.710216 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:00:50.711162 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:00:50.712052 [debug] [MainThread]: On master: COMMIT
[0m18:00:50.712765 [debug] [MainThread]: Using duckdb connection "master"
[0m18:00:50.713378 [debug] [MainThread]: On master: COMMIT
[0m18:00:50.714206 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:00:50.714753 [debug] [MainThread]: On master: Close
[0m18:00:50.715398 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:50.715847 [debug] [MainThread]: Connection 'model.suvera.mart_recent_activity_by_patient' was properly closed.
[0m18:00:50.716420 [info ] [MainThread]: 
[0m18:00:50.716957 [info ] [MainThread]: Finished running 12 view models in 0 hours 0 minutes and 1.08 seconds (1.08s).
[0m18:00:50.720805 [debug] [MainThread]: Command end result
[0m18:00:50.773139 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m18:00:50.776599 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m18:00:50.790376 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m18:00:50.790984 [info ] [MainThread]: 
[0m18:00:50.791573 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:00:50.792077 [info ] [MainThread]: 
[0m18:00:50.792675 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m18:00:50.797446 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6488035, "process_in_blocks": "0", "process_kernel_time": 0.762564, "process_mem_max_rss": "135733248", "process_out_blocks": "0", "process_user_time": 4.502078}
[0m18:00:50.798603 [debug] [MainThread]: Command `dbt run` succeeded at 18:00:50.798266 after 2.65 seconds
[0m18:00:50.799319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fac5d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104ac170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104af890>]}
[0m18:00:50.799907 [debug] [MainThread]: Flushing usage events
[0m18:00:51.270362 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:06:07.991719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105a5d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113bb610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113bb750>]}


============================== 18:06:08.002552 | 214f2750-5a3c-4213-bafe-8c511b75b05b ==============================
[0m18:06:08.002552 [info ] [MainThread]: Running with dbt=1.10.1
[0m18:06:08.003785 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:06:08.513921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '214f2750-5a3c-4213-bafe-8c511b75b05b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11088d220>]}
[0m18:06:08.619285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '214f2750-5a3c-4213-bafe-8c511b75b05b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112a3350>]}
[0m18:06:08.647567 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m18:06:08.824466 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m18:06:09.134654 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:06:09.135640 [debug] [MainThread]: Partial parsing: updated file: suvera://models/intermediate/cleaned_patients.sql
[0m18:06:09.577598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '214f2750-5a3c-4213-bafe-8c511b75b05b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b58350>]}
[0m18:06:09.722250 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m18:06:09.727629 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m18:06:09.777660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '214f2750-5a3c-4213-bafe-8c511b75b05b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111696d50>]}
[0m18:06:09.778490 [info ] [MainThread]: Found 12 models, 4 seeds, 12 data tests, 544 macros
[0m18:06:09.779068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '214f2750-5a3c-4213-bafe-8c511b75b05b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c50bb0>]}
[0m18:06:09.782964 [info ] [MainThread]: 
[0m18:06:09.783634 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:06:09.784392 [info ] [MainThread]: 
[0m18:06:09.785242 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:06:09.795714 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m18:06:09.893310 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m18:06:09.893922 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m18:06:09.894409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:09.934660 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m18:06:09.940872 [debug] [ThreadPool]: On list_dev: Close
[0m18:06:09.943151 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m18:06:09.944225 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m18:06:09.953930 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:06:09.954477 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m18:06:09.954938 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:09.958969 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:06:09.963407 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:06:09.964256 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m18:06:09.965215 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:06:09.965810 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:06:09.966391 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m18:06:09.972954 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m18:06:09.975644 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m18:06:09.976446 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:06:09.977188 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m18:06:09.978171 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:06:09.978804 [debug] [ThreadPool]: On create_dev_main: Close
[0m18:06:09.982438 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m18:06:10.064887 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m18:06:10.065476 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m18:06:10.065934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:10.066748 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:06:10.067222 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m18:06:10.067697 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m18:06:10.120279 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m18:06:10.123264 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m18:06:10.125404 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m18:06:10.125940 [debug] [ThreadPool]: On list_dev_main: Close
[0m18:06:10.130906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '214f2750-5a3c-4213-bafe-8c511b75b05b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f246d0>]}
[0m18:06:10.131596 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:10.132061 [debug] [MainThread]: On master: BEGIN
[0m18:06:10.132501 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:06:10.133332 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:06:10.133813 [debug] [MainThread]: On master: COMMIT
[0m18:06:10.134280 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:10.134724 [debug] [MainThread]: On master: COMMIT
[0m18:06:10.135463 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:06:10.135961 [debug] [MainThread]: On master: Close
[0m18:06:10.140108 [debug] [Thread-1 (]: Began running node model.suvera.stg_activities
[0m18:06:10.141001 [info ] [Thread-1 (]: 1 of 12 START sql view model main.stg_activities ............................... [RUN]
[0m18:06:10.141726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.stg_activities)
[0m18:06:10.142281 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_activities
[0m18:06:10.153401 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_activities"
[0m18:06:10.155229 [debug] [Thread-1 (]: Began executing node model.suvera.stg_activities
[0m18:06:10.205094 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_activities"
[0m18:06:10.206313 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:06:10.206887 [debug] [Thread-1 (]: On model.suvera.stg_activities: BEGIN
[0m18:06:10.207423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:10.208333 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:10.208905 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:06:10.209456 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */

  
  create view "dev"."main"."stg_activities__dbt_tmp" as (
    select * 
from "dev"."main"."raw_activities"
limit 100
  );

[0m18:06:10.212035 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:06:10.221653 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:06:10.222285 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
alter view "dev"."main"."stg_activities" rename to "stg_activities__dbt_backup"
[0m18:06:10.225952 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:06:10.230163 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:06:10.230809 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
alter view "dev"."main"."stg_activities__dbt_tmp" rename to "stg_activities"
[0m18:06:10.231786 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:10.249683 [debug] [Thread-1 (]: On model.suvera.stg_activities: COMMIT
[0m18:06:10.250355 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:06:10.250886 [debug] [Thread-1 (]: On model.suvera.stg_activities: COMMIT
[0m18:06:10.256552 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:06:10.264614 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:06:10.265260 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
drop view if exists "dev"."main"."stg_activities__dbt_backup" cascade
[0m18:06:10.268796 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:06:10.272642 [debug] [Thread-1 (]: On model.suvera.stg_activities: Close
[0m18:06:10.275900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '214f2750-5a3c-4213-bafe-8c511b75b05b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e1e5d0>]}
[0m18:06:10.276956 [info ] [Thread-1 (]: 1 of 12 OK created sql view model main.stg_activities .......................... [[32mOK[0m in 0.13s]
[0m18:06:10.277913 [debug] [Thread-1 (]: Finished running node model.suvera.stg_activities
[0m18:06:10.278558 [debug] [Thread-1 (]: Began running node model.suvera.stg_patients
[0m18:06:10.279274 [info ] [Thread-1 (]: 2 of 12 START sql view model main.stg_patients ................................. [RUN]
[0m18:06:10.280160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_activities, now model.suvera.stg_patients)
[0m18:06:10.280853 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_patients
[0m18:06:10.284857 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_patients"
[0m18:06:10.286827 [debug] [Thread-1 (]: Began executing node model.suvera.stg_patients
[0m18:06:10.293371 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_patients"
[0m18:06:10.294989 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:06:10.295749 [debug] [Thread-1 (]: On model.suvera.stg_patients: BEGIN
[0m18:06:10.296285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:10.297264 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:10.297854 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:06:10.298655 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */

  
  create view "dev"."main"."stg_patients__dbt_tmp" as (
    with source as (
    select * from "dev"."main"."raw_patients"
),

parsed as (
    select
        cast(nullif(regexp_extract(data, '"patient_id": ([0-9]+)', 1), '') as integer) as patient_id,
        cast(nullif(regexp_extract(data, '"practice_id": ([0-9]+)', 1), '') as integer) as practice_id,
        cast(nullif(regexp_extract(data, '"age": ([0-9]+)', 1), '') as integer) as age,
        regexp_extract(data, '"gender": "([^""]*)"', 1) as gender,
        cast(nullif(regexp_extract(data, '"registration_date": "([^"]+)"', 1), '') as date) as registration_date,
        regexp_extract(data, '"email": "([^"]+)"', 1) as email,
        regexp_extract(data, '"phone": "([^"]+)"', 1) as phone,
        string_split(
            replace(
                regexp_extract(data, '"conditions": \[(.*?)\]', 1),
                '"',
                ''
            ),
            ', '
        ) as conditions
    from source
)

select * from parsed
  );

[0m18:06:10.301837 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:06:10.306499 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:06:10.307121 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients" rename to "stg_patients__dbt_backup"
[0m18:06:10.308098 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:10.311951 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:06:10.312520 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m18:06:10.313412 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:10.315704 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m18:06:10.316274 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:06:10.316802 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m18:06:10.318154 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:10.321853 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:06:10.322546 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
drop view if exists "dev"."main"."stg_patients__dbt_backup" cascade
[0m18:06:10.323792 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:10.325762 [debug] [Thread-1 (]: On model.suvera.stg_patients: Close
[0m18:06:10.326550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '214f2750-5a3c-4213-bafe-8c511b75b05b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c6eba0>]}
[0m18:06:10.327450 [info ] [Thread-1 (]: 2 of 12 OK created sql view model main.stg_patients ............................ [[32mOK[0m in 0.05s]
[0m18:06:10.328454 [debug] [Thread-1 (]: Finished running node model.suvera.stg_patients
[0m18:06:10.329088 [debug] [Thread-1 (]: Began running node model.suvera.stg_pcns
[0m18:06:10.329784 [info ] [Thread-1 (]: 3 of 12 START sql view model main.stg_pcns ..................................... [RUN]
[0m18:06:10.330619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_patients, now model.suvera.stg_pcns)
[0m18:06:10.331322 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_pcns
[0m18:06:10.334851 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_pcns"
[0m18:06:10.336513 [debug] [Thread-1 (]: Began executing node model.suvera.stg_pcns
[0m18:06:10.341910 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_pcns"
[0m18:06:10.342999 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:06:10.343576 [debug] [Thread-1 (]: On model.suvera.stg_pcns: BEGIN
[0m18:06:10.344106 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:10.345050 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:10.345608 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:06:10.346276 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */

  
  create view "dev"."main"."stg_pcns__dbt_tmp" as (
    select * 
from "dev"."main"."raw_pcns"
  );

[0m18:06:10.347372 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:10.351635 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:06:10.352880 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */
alter view "dev"."main"."stg_pcns" rename to "stg_pcns__dbt_backup"
[0m18:06:10.354315 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:10.358736 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:06:10.359382 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */
alter view "dev"."main"."stg_pcns__dbt_tmp" rename to "stg_pcns"
[0m18:06:10.361075 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:10.363396 [debug] [Thread-1 (]: On model.suvera.stg_pcns: COMMIT
[0m18:06:10.364033 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:06:10.364602 [debug] [Thread-1 (]: On model.suvera.stg_pcns: COMMIT
[0m18:06:10.366164 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:10.369360 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:06:10.369921 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */
drop view if exists "dev"."main"."stg_pcns__dbt_backup" cascade
[0m18:06:10.371221 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:10.373435 [debug] [Thread-1 (]: On model.suvera.stg_pcns: Close
[0m18:06:10.374613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '214f2750-5a3c-4213-bafe-8c511b75b05b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11192f7f0>]}
[0m18:06:10.375558 [info ] [Thread-1 (]: 3 of 12 OK created sql view model main.stg_pcns ................................ [[32mOK[0m in 0.04s]
[0m18:06:10.376451 [debug] [Thread-1 (]: Finished running node model.suvera.stg_pcns
[0m18:06:10.377073 [debug] [Thread-1 (]: Began running node model.suvera.stg_practices
[0m18:06:10.377761 [info ] [Thread-1 (]: 4 of 12 START sql view model main.stg_practices ................................ [RUN]
[0m18:06:10.378502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_pcns, now model.suvera.stg_practices)
[0m18:06:10.379058 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_practices
[0m18:06:10.382856 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_practices"
[0m18:06:10.384363 [debug] [Thread-1 (]: Began executing node model.suvera.stg_practices
[0m18:06:10.391149 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_practices"
[0m18:06:10.392324 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:06:10.392891 [debug] [Thread-1 (]: On model.suvera.stg_practices: BEGIN
[0m18:06:10.393427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:10.394329 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:10.394876 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:06:10.395503 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */

  
  create view "dev"."main"."stg_practices__dbt_tmp" as (
    select * 
from "dev"."main"."raw_practices"
  );

[0m18:06:10.397131 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:10.402364 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:06:10.403037 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */
alter view "dev"."main"."stg_practices" rename to "stg_practices__dbt_backup"
[0m18:06:10.404052 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:10.408695 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:06:10.409519 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */
alter view "dev"."main"."stg_practices__dbt_tmp" rename to "stg_practices"
[0m18:06:10.410548 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:10.412882 [debug] [Thread-1 (]: On model.suvera.stg_practices: COMMIT
[0m18:06:10.413463 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:06:10.414075 [debug] [Thread-1 (]: On model.suvera.stg_practices: COMMIT
[0m18:06:10.415339 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:10.418467 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:06:10.419023 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */
drop view if exists "dev"."main"."stg_practices__dbt_backup" cascade
[0m18:06:10.420290 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:10.422318 [debug] [Thread-1 (]: On model.suvera.stg_practices: Close
[0m18:06:10.423088 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '214f2750-5a3c-4213-bafe-8c511b75b05b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115c9c50>]}
[0m18:06:10.424058 [info ] [Thread-1 (]: 4 of 12 OK created sql view model main.stg_practices ........................... [[32mOK[0m in 0.04s]
[0m18:06:10.424967 [debug] [Thread-1 (]: Finished running node model.suvera.stg_practices
[0m18:06:10.425579 [debug] [Thread-1 (]: Began running node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:06:10.426270 [info ] [Thread-1 (]: 5 of 12 START sql view model main.mart_patients_inactive_3_months_after_first .. [RUN]
[0m18:06:10.427016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_practices, now model.suvera.mart_patients_inactive_3_months_after_first)
[0m18:06:10.427611 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:06:10.431432 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:06:10.432689 [debug] [Thread-1 (]: Began executing node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:06:10.438092 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:06:10.439207 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:06:10.439813 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: BEGIN
[0m18:06:10.440349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:10.441251 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:10.441808 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:06:10.442408 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */

  
  create view "dev"."main"."mart_patients_inactive_3_months_after_first__dbt_tmp" as (
    with activities as (
    select
        patient_id,
        activity_date
    from "dev"."main"."stg_activities"
),

first_activity as (
    select
        patient_id,
        min(activity_date) as first_date
    from activities
    group by patient_id
),

follow_up_activity as (
    select
        a.patient_id
    from activities a
    join first_activity f
        on a.patient_id = f.patient_id
    where a.activity_date > f.first_date
      and a.activity_date <= f.first_date + interval '90 days'
),

inactive_patients as (
    select
        f.patient_id,
        f.first_date
    from first_activity f
    left join follow_up_activity fu
        on f.patient_id = fu.patient_id
    where fu.patient_id is null
)

select *
from inactive_patients
  );

[0m18:06:10.448515 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:06:10.453240 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:06:10.454239 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */
alter view "dev"."main"."mart_patients_inactive_3_months_after_first" rename to "mart_patients_inactive_3_months_after_first__dbt_backup"
[0m18:06:10.455297 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:10.460226 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:06:10.461007 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */
alter view "dev"."main"."mart_patients_inactive_3_months_after_first__dbt_tmp" rename to "mart_patients_inactive_3_months_after_first"
[0m18:06:10.462013 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:10.464428 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: COMMIT
[0m18:06:10.465102 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:06:10.465921 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: COMMIT
[0m18:06:10.467525 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:10.470735 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:06:10.471315 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */
drop view if exists "dev"."main"."mart_patients_inactive_3_months_after_first__dbt_backup" cascade
[0m18:06:10.472631 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:10.474900 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: Close
[0m18:06:10.475931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '214f2750-5a3c-4213-bafe-8c511b75b05b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c39ef0>]}
[0m18:06:10.476932 [info ] [Thread-1 (]: 5 of 12 OK created sql view model main.mart_patients_inactive_3_months_after_first  [[32mOK[0m in 0.05s]
[0m18:06:10.477843 [debug] [Thread-1 (]: Finished running node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:06:10.478462 [debug] [Thread-1 (]: Began running node model.suvera.cleaned_patients
[0m18:06:10.479159 [info ] [Thread-1 (]: 6 of 12 START sql view model main.cleaned_patients ............................. [RUN]
[0m18:06:10.480000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_patients_inactive_3_months_after_first, now model.suvera.cleaned_patients)
[0m18:06:10.480590 [debug] [Thread-1 (]: Began compiling node model.suvera.cleaned_patients
[0m18:06:10.484358 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.cleaned_patients"
[0m18:06:10.485958 [debug] [Thread-1 (]: Began executing node model.suvera.cleaned_patients
[0m18:06:10.497190 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.cleaned_patients"
[0m18:06:10.499003 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:06:10.499686 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: BEGIN
[0m18:06:10.500263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:10.501234 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:10.501828 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:06:10.502436 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */

  
  create view "dev"."main"."cleaned_patients__dbt_tmp" as (
    with deduplicated as (
    select *
    from (
        select *,
               row_number() over (
                   partition by patient_id, practice_id
                   order by registration_date desc
               ) as row_num
        from "dev"."main"."stg_patients"
    )
    where row_num = 1
),

filtered as (
    select *
    from deduplicated
    where age between 0 and 120 and practice_id is not null and age != 999 and practice_id ! = "<NA>"
)

select
    patient_id,
    practice_id,
    age,
    gender,
    registration_date,
    email,
    phone,
    conditions
from filtered
  );

[0m18:06:10.519230 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */

  
  create view "dev"."main"."cleaned_patients__dbt_tmp" as (
    with deduplicated as (
    select *
    from (
        select *,
               row_number() over (
                   partition by patient_id, practice_id
                   order by registration_date desc
               ) as row_num
        from "dev"."main"."stg_patients"
    )
    where row_num = 1
),

filtered as (
    select *
    from deduplicated
    where age between 0 and 120 and practice_id is not null and age != 999 and practice_id ! = "<NA>"
)

select
    patient_id,
    practice_id,
    age,
    gender,
    registration_date,
    email,
    phone,
    conditions
from filtered
  );

[0m18:06:10.519955 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:06:10.520664 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: ROLLBACK
[0m18:06:10.540939 [debug] [Thread-1 (]: Failed to rollback 'model.suvera.cleaned_patients'
[0m18:06:10.541580 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: Close
[0m18:06:10.547826 [debug] [Thread-1 (]: Runtime Error in model cleaned_patients (models/intermediate/cleaned_patients.sql)
  Binder Error: Referenced column "<NA>" not found in FROM clause!
  Candidate bindings: "age"
  
  LINE 21: ... practice_id is not null and age != 999 and practice_id ! = "<NA>"
                                                                          ^
[0m18:06:10.548561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '214f2750-5a3c-4213-bafe-8c511b75b05b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fdef90>]}
[0m18:06:10.549552 [error] [Thread-1 (]: 6 of 12 ERROR creating sql view model main.cleaned_patients .................... [[31mERROR[0m in 0.07s]
[0m18:06:10.550502 [debug] [Thread-1 (]: Finished running node model.suvera.cleaned_patients
[0m18:06:10.551111 [debug] [Thread-1 (]: Began running node model.suvera.qa_flagged_patients
[0m18:06:10.551795 [info ] [Thread-1 (]: 7 of 12 START sql view model main.qa_flagged_patients .......................... [RUN]
[0m18:06:10.552655 [debug] [Thread-4 (]: Marking all children of 'model.suvera.cleaned_patients' to be skipped because of status 'error'.  Reason: Runtime Error in model cleaned_patients (models/intermediate/cleaned_patients.sql)
  Binder Error: Referenced column "<NA>" not found in FROM clause!
  Candidate bindings: "age"
  
  LINE 21: ... practice_id is not null and age != 999 and practice_id ! = "<NA>"
                                                                          ^.
[0m18:06:10.553282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.cleaned_patients, now model.suvera.qa_flagged_patients)
[0m18:06:10.554862 [debug] [Thread-1 (]: Began compiling node model.suvera.qa_flagged_patients
[0m18:06:10.558885 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.qa_flagged_patients"
[0m18:06:10.561051 [debug] [Thread-1 (]: Began executing node model.suvera.qa_flagged_patients
[0m18:06:10.567564 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.qa_flagged_patients"
[0m18:06:10.568712 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:06:10.569272 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: BEGIN
[0m18:06:10.569790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:10.570671 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:10.571267 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:06:10.571830 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */

  
  create view "dev"."main"."qa_flagged_patients__dbt_tmp" as (
    with source as (
    select *
    from "dev"."main"."stg_patients"
),

deduplicated as (
    select *
    from (
        select *,
               row_number() over (
                   partition by patient_id, practice_id
                   order by registration_date desc
               ) as row_num
        from source
    )
),

filtered_out as (
    select *
    from deduplicated
    where row_num > 1
       or try_cast(age as integer) not between 0 and 120
)

select * from filtered_out
  );

[0m18:06:10.574635 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:06:10.581289 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:06:10.581977 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */
alter view "dev"."main"."qa_flagged_patients" rename to "qa_flagged_patients__dbt_backup"
[0m18:06:10.583006 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:10.587759 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:06:10.588428 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */
alter view "dev"."main"."qa_flagged_patients__dbt_tmp" rename to "qa_flagged_patients"
[0m18:06:10.589517 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:10.591942 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: COMMIT
[0m18:06:10.592542 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:06:10.593138 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: COMMIT
[0m18:06:10.594473 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:10.597808 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:06:10.598392 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */
drop view if exists "dev"."main"."qa_flagged_patients__dbt_backup" cascade
[0m18:06:10.599739 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:10.601796 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: Close
[0m18:06:10.602567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '214f2750-5a3c-4213-bafe-8c511b75b05b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113d41d0>]}
[0m18:06:10.603468 [info ] [Thread-1 (]: 7 of 12 OK created sql view model main.qa_flagged_patients ..................... [[32mOK[0m in 0.05s]
[0m18:06:10.604361 [debug] [Thread-1 (]: Finished running node model.suvera.qa_flagged_patients
[0m18:06:10.604965 [debug] [Thread-1 (]: Began running node model.suvera.mart_age_groups_by_pcn
[0m18:06:10.605578 [info ] [Thread-1 (]: 8 of 12 SKIP relation main.mart_age_groups_by_pcn .............................. [[33mSKIP[0m]
[0m18:06:10.606277 [debug] [Thread-1 (]: Finished running node model.suvera.mart_age_groups_by_pcn
[0m18:06:10.606875 [debug] [Thread-1 (]: Began running node model.suvera.mart_avg_age_by_practice
[0m18:06:10.607469 [info ] [Thread-1 (]: 9 of 12 SKIP relation main.mart_avg_age_by_practice ............................ [[33mSKIP[0m]
[0m18:06:10.608213 [debug] [Thread-1 (]: Finished running node model.suvera.mart_avg_age_by_practice
[0m18:06:10.608854 [debug] [Thread-1 (]: Began running node model.suvera.mart_hypertension_pct_by_practice
[0m18:06:10.609471 [info ] [Thread-1 (]: 10 of 12 SKIP relation main.mart_hypertension_pct_by_practice .................. [[33mSKIP[0m]
[0m18:06:10.610420 [debug] [Thread-1 (]: Finished running node model.suvera.mart_hypertension_pct_by_practice
[0m18:06:10.611160 [debug] [Thread-1 (]: Began running node model.suvera.mart_patient_count_by_pcn
[0m18:06:10.611886 [info ] [Thread-1 (]: 11 of 12 SKIP relation main.mart_patient_count_by_pcn .......................... [[33mSKIP[0m]
[0m18:06:10.612574 [debug] [Thread-1 (]: Finished running node model.suvera.mart_patient_count_by_pcn
[0m18:06:10.613355 [debug] [Thread-1 (]: Began running node model.suvera.mart_recent_activity_by_patient
[0m18:06:10.614137 [info ] [Thread-1 (]: 12 of 12 SKIP relation main.mart_recent_activity_by_patient .................... [[33mSKIP[0m]
[0m18:06:10.615032 [debug] [Thread-1 (]: Finished running node model.suvera.mart_recent_activity_by_patient
[0m18:06:10.616983 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:10.617852 [debug] [MainThread]: On master: BEGIN
[0m18:06:10.618850 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:06:10.620126 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:06:10.621009 [debug] [MainThread]: On master: COMMIT
[0m18:06:10.621643 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:10.622587 [debug] [MainThread]: On master: COMMIT
[0m18:06:10.623783 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:06:10.624350 [debug] [MainThread]: On master: Close
[0m18:06:10.624979 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:10.625421 [debug] [MainThread]: Connection 'model.suvera.qa_flagged_patients' was properly closed.
[0m18:06:10.625987 [info ] [MainThread]: 
[0m18:06:10.626511 [info ] [MainThread]: Finished running 12 view models in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m18:06:10.629152 [debug] [MainThread]: Command end result
[0m18:06:10.676304 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m18:06:10.679119 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m18:06:10.692163 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m18:06:10.692787 [info ] [MainThread]: 
[0m18:06:10.693386 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:06:10.693891 [info ] [MainThread]: 
[0m18:06:10.694494 [error] [MainThread]: [31mFailure in model cleaned_patients (models/intermediate/cleaned_patients.sql)[0m
[0m18:06:10.695088 [error] [MainThread]:   Runtime Error in model cleaned_patients (models/intermediate/cleaned_patients.sql)
  Binder Error: Referenced column "<NA>" not found in FROM clause!
  Candidate bindings: "age"
  
  LINE 21: ... practice_id is not null and age != 999 and practice_id ! = "<NA>"
                                                                          ^
[0m18:06:10.695580 [info ] [MainThread]: 
[0m18:06:10.696379 [info ] [MainThread]:   compiled code at target/compiled/suvera/models/intermediate/cleaned_patients.sql
[0m18:06:10.696891 [info ] [MainThread]: 
[0m18:06:10.697440 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=5 NO-OP=0 TOTAL=12
[0m18:06:10.702358 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.845466, "process_in_blocks": "0", "process_kernel_time": 0.797604, "process_mem_max_rss": "140566528", "process_out_blocks": "0", "process_user_time": 4.622255}
[0m18:06:10.703194 [debug] [MainThread]: Command `dbt run` failed at 18:06:10.703014 after 2.85 seconds
[0m18:06:10.703824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8fa2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11127ffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11204be30>]}
[0m18:06:10.704500 [debug] [MainThread]: Flushing usage events
[0m18:06:11.170234 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:06:32.356258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d445d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e41f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e41f750>]}


============================== 18:06:32.363441 | 5e655cce-5b4d-4e34-bd72-c3931e6789b0 ==============================
[0m18:06:32.363441 [info ] [MainThread]: Running with dbt=1.10.1
[0m18:06:32.364401 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:06:32.775726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e655cce-5b4d-4e34-bd72-c3931e6789b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8cd220>]}
[0m18:06:32.880877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e655cce-5b4d-4e34-bd72-c3931e6789b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e307350>]}
[0m18:06:32.894712 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m18:06:33.046116 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m18:06:33.256828 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:06:33.257420 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:06:33.337218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e655cce-5b4d-4e34-bd72-c3931e6789b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e72b650>]}
[0m18:06:33.483094 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m18:06:33.486340 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m18:06:33.510460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e655cce-5b4d-4e34-bd72-c3931e6789b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6f6d50>]}
[0m18:06:33.511205 [info ] [MainThread]: Found 12 models, 4 seeds, 12 data tests, 544 macros
[0m18:06:33.511770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e655cce-5b4d-4e34-bd72-c3931e6789b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb0ce50>]}
[0m18:06:33.515254 [info ] [MainThread]: 
[0m18:06:33.515848 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:06:33.516328 [info ] [MainThread]: 
[0m18:06:33.517269 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:06:33.527131 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m18:06:33.602338 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m18:06:33.602941 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m18:06:33.603438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:33.627128 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m18:06:33.629236 [debug] [ThreadPool]: On list_dev: Close
[0m18:06:33.630280 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m18:06:33.631000 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m18:06:33.640035 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:06:33.640592 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m18:06:33.641053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:33.642401 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:06:33.644402 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:06:33.644884 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m18:06:33.645627 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:06:33.646106 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:06:33.646568 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m18:06:33.647432 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:06:33.648741 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m18:06:33.649229 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:06:33.649680 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m18:06:33.650349 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:06:33.650836 [debug] [ThreadPool]: On create_dev_main: Close
[0m18:06:33.653882 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m18:06:33.662507 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m18:06:33.663065 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m18:06:33.663586 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:33.664511 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:06:33.664993 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m18:06:33.665469 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m18:06:33.685945 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m18:06:33.688403 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m18:06:33.689940 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m18:06:33.690438 [debug] [ThreadPool]: On list_dev_main: Close
[0m18:06:33.695579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e655cce-5b4d-4e34-bd72-c3931e6789b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed45980>]}
[0m18:06:33.696266 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:33.696790 [debug] [MainThread]: On master: BEGIN
[0m18:06:33.697272 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:06:33.698125 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:06:33.698622 [debug] [MainThread]: On master: COMMIT
[0m18:06:33.699094 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:33.699544 [debug] [MainThread]: On master: COMMIT
[0m18:06:33.700217 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:06:33.700703 [debug] [MainThread]: On master: Close
[0m18:06:33.703456 [debug] [Thread-1 (]: Began running node model.suvera.stg_activities
[0m18:06:33.704258 [info ] [Thread-1 (]: 1 of 12 START sql view model main.stg_activities ............................... [RUN]
[0m18:06:33.704952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.stg_activities)
[0m18:06:33.705517 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_activities
[0m18:06:33.716687 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_activities"
[0m18:06:33.717812 [debug] [Thread-1 (]: Began executing node model.suvera.stg_activities
[0m18:06:33.766952 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_activities"
[0m18:06:33.768136 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:06:33.768706 [debug] [Thread-1 (]: On model.suvera.stg_activities: BEGIN
[0m18:06:33.769238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:33.770138 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:33.770688 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:06:33.771227 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */

  
  create view "dev"."main"."stg_activities__dbt_tmp" as (
    select * 
from "dev"."main"."raw_activities"
limit 100
  );

[0m18:06:33.772269 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:33.781176 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:06:33.781808 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
alter view "dev"."main"."stg_activities" rename to "stg_activities__dbt_backup"
[0m18:06:33.782809 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:33.787195 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:06:33.787769 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
alter view "dev"."main"."stg_activities__dbt_tmp" rename to "stg_activities"
[0m18:06:33.788655 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:33.806687 [debug] [Thread-1 (]: On model.suvera.stg_activities: COMMIT
[0m18:06:33.807356 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:06:33.807896 [debug] [Thread-1 (]: On model.suvera.stg_activities: COMMIT
[0m18:06:33.809494 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:33.816476 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:06:33.817076 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
drop view if exists "dev"."main"."stg_activities__dbt_backup" cascade
[0m18:06:33.818407 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:33.822021 [debug] [Thread-1 (]: On model.suvera.stg_activities: Close
[0m18:06:33.825093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e655cce-5b4d-4e34-bd72-c3931e6789b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee05a90>]}
[0m18:06:33.826071 [info ] [Thread-1 (]: 1 of 12 OK created sql view model main.stg_activities .......................... [[32mOK[0m in 0.12s]
[0m18:06:33.827158 [debug] [Thread-1 (]: Finished running node model.suvera.stg_activities
[0m18:06:33.827840 [debug] [Thread-1 (]: Began running node model.suvera.stg_patients
[0m18:06:33.828579 [info ] [Thread-1 (]: 2 of 12 START sql view model main.stg_patients ................................. [RUN]
[0m18:06:33.829295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_activities, now model.suvera.stg_patients)
[0m18:06:33.829995 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_patients
[0m18:06:33.834026 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_patients"
[0m18:06:33.835193 [debug] [Thread-1 (]: Began executing node model.suvera.stg_patients
[0m18:06:33.840092 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_patients"
[0m18:06:33.841939 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:06:33.842572 [debug] [Thread-1 (]: On model.suvera.stg_patients: BEGIN
[0m18:06:33.843227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:33.844597 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:33.845225 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:06:33.845821 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */

  
  create view "dev"."main"."stg_patients__dbt_tmp" as (
    with source as (
    select * from "dev"."main"."raw_patients"
),

parsed as (
    select
        cast(nullif(regexp_extract(data, '"patient_id": ([0-9]+)', 1), '') as integer) as patient_id,
        cast(nullif(regexp_extract(data, '"practice_id": ([0-9]+)', 1), '') as integer) as practice_id,
        cast(nullif(regexp_extract(data, '"age": ([0-9]+)', 1), '') as integer) as age,
        regexp_extract(data, '"gender": "([^""]*)"', 1) as gender,
        cast(nullif(regexp_extract(data, '"registration_date": "([^"]+)"', 1), '') as date) as registration_date,
        regexp_extract(data, '"email": "([^"]+)"', 1) as email,
        regexp_extract(data, '"phone": "([^"]+)"', 1) as phone,
        string_split(
            replace(
                regexp_extract(data, '"conditions": \[(.*?)\]', 1),
                '"',
                ''
            ),
            ', '
        ) as conditions
    from source
)

select * from parsed
  );

[0m18:06:33.848893 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:06:33.853921 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:06:33.854586 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients" rename to "stg_patients__dbt_backup"
[0m18:06:33.855665 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:33.859561 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:06:33.860138 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m18:06:33.861112 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:33.863531 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m18:06:33.864159 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:06:33.864696 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m18:06:33.866042 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:33.869612 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:06:33.870173 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
drop view if exists "dev"."main"."stg_patients__dbt_backup" cascade
[0m18:06:33.871612 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:33.873630 [debug] [Thread-1 (]: On model.suvera.stg_patients: Close
[0m18:06:33.874433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e655cce-5b4d-4e34-bd72-c3931e6789b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb02150>]}
[0m18:06:33.875331 [info ] [Thread-1 (]: 2 of 12 OK created sql view model main.stg_patients ............................ [[32mOK[0m in 0.05s]
[0m18:06:33.876236 [debug] [Thread-1 (]: Finished running node model.suvera.stg_patients
[0m18:06:33.876887 [debug] [Thread-1 (]: Began running node model.suvera.stg_pcns
[0m18:06:33.877807 [info ] [Thread-1 (]: 3 of 12 START sql view model main.stg_pcns ..................................... [RUN]
[0m18:06:33.878476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_patients, now model.suvera.stg_pcns)
[0m18:06:33.879024 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_pcns
[0m18:06:33.882484 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_pcns"
[0m18:06:33.883735 [debug] [Thread-1 (]: Began executing node model.suvera.stg_pcns
[0m18:06:33.893009 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_pcns"
[0m18:06:33.894212 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:06:33.894786 [debug] [Thread-1 (]: On model.suvera.stg_pcns: BEGIN
[0m18:06:33.895307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:33.896322 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:33.896896 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:06:33.897444 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */

  
  create view "dev"."main"."stg_pcns__dbt_tmp" as (
    select * 
from "dev"."main"."raw_pcns"
  );

[0m18:06:33.898490 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:33.903493 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:06:33.904173 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */
alter view "dev"."main"."stg_pcns" rename to "stg_pcns__dbt_backup"
[0m18:06:33.905134 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:33.909636 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:06:33.910243 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */
alter view "dev"."main"."stg_pcns__dbt_tmp" rename to "stg_pcns"
[0m18:06:33.911194 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:33.913487 [debug] [Thread-1 (]: On model.suvera.stg_pcns: COMMIT
[0m18:06:33.914107 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:06:33.914667 [debug] [Thread-1 (]: On model.suvera.stg_pcns: COMMIT
[0m18:06:33.916176 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:33.992002 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:06:33.992656 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */
drop view if exists "dev"."main"."stg_pcns__dbt_backup" cascade
[0m18:06:33.994614 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:33.996822 [debug] [Thread-1 (]: On model.suvera.stg_pcns: Close
[0m18:06:33.997620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e655cce-5b4d-4e34-bd72-c3931e6789b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eef5e50>]}
[0m18:06:33.998495 [info ] [Thread-1 (]: 3 of 12 OK created sql view model main.stg_pcns ................................ [[32mOK[0m in 0.12s]
[0m18:06:33.999562 [debug] [Thread-1 (]: Finished running node model.suvera.stg_pcns
[0m18:06:34.000189 [debug] [Thread-1 (]: Began running node model.suvera.stg_practices
[0m18:06:34.000889 [info ] [Thread-1 (]: 4 of 12 START sql view model main.stg_practices ................................ [RUN]
[0m18:06:34.001651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_pcns, now model.suvera.stg_practices)
[0m18:06:34.002231 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_practices
[0m18:06:34.005736 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_practices"
[0m18:06:34.006840 [debug] [Thread-1 (]: Began executing node model.suvera.stg_practices
[0m18:06:34.011938 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_practices"
[0m18:06:34.013043 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:06:34.013651 [debug] [Thread-1 (]: On model.suvera.stg_practices: BEGIN
[0m18:06:34.014284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:34.015279 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:34.015889 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:06:34.016441 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */

  
  create view "dev"."main"."stg_practices__dbt_tmp" as (
    select * 
from "dev"."main"."raw_practices"
  );

[0m18:06:34.017454 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:34.022645 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:06:34.023520 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */
alter view "dev"."main"."stg_practices" rename to "stg_practices__dbt_backup"
[0m18:06:34.025233 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:34.029933 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:06:34.030647 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */
alter view "dev"."main"."stg_practices__dbt_tmp" rename to "stg_practices"
[0m18:06:34.031839 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:34.034515 [debug] [Thread-1 (]: On model.suvera.stg_practices: COMMIT
[0m18:06:34.035113 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:06:34.035646 [debug] [Thread-1 (]: On model.suvera.stg_practices: COMMIT
[0m18:06:34.036915 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:34.039991 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:06:34.040693 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */
drop view if exists "dev"."main"."stg_practices__dbt_backup" cascade
[0m18:06:34.042170 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:34.044322 [debug] [Thread-1 (]: On model.suvera.stg_practices: Close
[0m18:06:34.045097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e655cce-5b4d-4e34-bd72-c3931e6789b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e61f2d0>]}
[0m18:06:34.045969 [info ] [Thread-1 (]: 4 of 12 OK created sql view model main.stg_practices ........................... [[32mOK[0m in 0.04s]
[0m18:06:34.047016 [debug] [Thread-1 (]: Finished running node model.suvera.stg_practices
[0m18:06:34.047639 [debug] [Thread-1 (]: Began running node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:06:34.048341 [info ] [Thread-1 (]: 5 of 12 START sql view model main.mart_patients_inactive_3_months_after_first .. [RUN]
[0m18:06:34.049104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_practices, now model.suvera.mart_patients_inactive_3_months_after_first)
[0m18:06:34.049694 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:06:34.053273 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:06:34.054356 [debug] [Thread-1 (]: Began executing node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:06:34.060069 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:06:34.062022 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:06:34.062709 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: BEGIN
[0m18:06:34.063255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:34.064329 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:34.065341 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:06:34.066135 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */

  
  create view "dev"."main"."mart_patients_inactive_3_months_after_first__dbt_tmp" as (
    with activities as (
    select
        patient_id,
        activity_date
    from "dev"."main"."stg_activities"
),

first_activity as (
    select
        patient_id,
        min(activity_date) as first_date
    from activities
    group by patient_id
),

follow_up_activity as (
    select
        a.patient_id
    from activities a
    join first_activity f
        on a.patient_id = f.patient_id
    where a.activity_date > f.first_date
      and a.activity_date <= f.first_date + interval '90 days'
),

inactive_patients as (
    select
        f.patient_id,
        f.first_date
    from first_activity f
    left join follow_up_activity fu
        on f.patient_id = fu.patient_id
    where fu.patient_id is null
)

select *
from inactive_patients
  );

[0m18:06:34.068182 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:34.072439 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:06:34.073095 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */
alter view "dev"."main"."mart_patients_inactive_3_months_after_first" rename to "mart_patients_inactive_3_months_after_first__dbt_backup"
[0m18:06:34.074121 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:34.079638 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:06:34.080784 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */
alter view "dev"."main"."mart_patients_inactive_3_months_after_first__dbt_tmp" rename to "mart_patients_inactive_3_months_after_first"
[0m18:06:34.082071 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:34.085144 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: COMMIT
[0m18:06:34.085993 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:06:34.086738 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: COMMIT
[0m18:06:34.088528 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:34.092280 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:06:34.093064 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */
drop view if exists "dev"."main"."mart_patients_inactive_3_months_after_first__dbt_backup" cascade
[0m18:06:34.094494 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:34.096620 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: Close
[0m18:06:34.097484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e655cce-5b4d-4e34-bd72-c3931e6789b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee43cb0>]}
[0m18:06:34.098453 [info ] [Thread-1 (]: 5 of 12 OK created sql view model main.mart_patients_inactive_3_months_after_first  [[32mOK[0m in 0.05s]
[0m18:06:34.099518 [debug] [Thread-1 (]: Finished running node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:06:34.100158 [debug] [Thread-1 (]: Began running node model.suvera.cleaned_patients
[0m18:06:34.100874 [info ] [Thread-1 (]: 6 of 12 START sql view model main.cleaned_patients ............................. [RUN]
[0m18:06:34.101681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_patients_inactive_3_months_after_first, now model.suvera.cleaned_patients)
[0m18:06:34.102275 [debug] [Thread-1 (]: Began compiling node model.suvera.cleaned_patients
[0m18:06:34.106129 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.cleaned_patients"
[0m18:06:34.107190 [debug] [Thread-1 (]: Began executing node model.suvera.cleaned_patients
[0m18:06:34.113694 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.cleaned_patients"
[0m18:06:34.115557 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:06:34.116211 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: BEGIN
[0m18:06:34.116751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:34.117795 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:34.118377 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:06:34.118955 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */

  
  create view "dev"."main"."cleaned_patients__dbt_tmp" as (
    with deduplicated as (
    select *
    from (
        select *,
               row_number() over (
                   partition by patient_id, practice_id
                   order by registration_date desc
               ) as row_num
        from "dev"."main"."stg_patients"
    )
    where row_num = 1
),

filtered as (
    select *
    from deduplicated
    where age between 0 and 120 and practice_id is not null and age != 999 and practice_id ! = "<NA>"
)

select
    patient_id,
    practice_id,
    age,
    gender,
    registration_date,
    email,
    phone,
    conditions
from filtered
  );

[0m18:06:34.123128 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */

  
  create view "dev"."main"."cleaned_patients__dbt_tmp" as (
    with deduplicated as (
    select *
    from (
        select *,
               row_number() over (
                   partition by patient_id, practice_id
                   order by registration_date desc
               ) as row_num
        from "dev"."main"."stg_patients"
    )
    where row_num = 1
),

filtered as (
    select *
    from deduplicated
    where age between 0 and 120 and practice_id is not null and age != 999 and practice_id ! = "<NA>"
)

select
    patient_id,
    practice_id,
    age,
    gender,
    registration_date,
    email,
    phone,
    conditions
from filtered
  );

[0m18:06:34.124000 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:06:34.124710 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: ROLLBACK
[0m18:06:34.134737 [debug] [Thread-1 (]: Failed to rollback 'model.suvera.cleaned_patients'
[0m18:06:34.135397 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: Close
[0m18:06:34.141376 [debug] [Thread-1 (]: Runtime Error in model cleaned_patients (models/intermediate/cleaned_patients.sql)
  Binder Error: Referenced column "<NA>" not found in FROM clause!
  Candidate bindings: "age"
  
  LINE 21: ... practice_id is not null and age != 999 and practice_id ! = "<NA>"
                                                                          ^
[0m18:06:34.142046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e655cce-5b4d-4e34-bd72-c3931e6789b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef6e690>]}
[0m18:06:34.143081 [error] [Thread-1 (]: 6 of 12 ERROR creating sql view model main.cleaned_patients .................... [[31mERROR[0m in 0.04s]
[0m18:06:34.144073 [debug] [Thread-1 (]: Finished running node model.suvera.cleaned_patients
[0m18:06:34.144952 [debug] [Thread-1 (]: Began running node model.suvera.qa_flagged_patients
[0m18:06:34.146010 [debug] [Thread-4 (]: Marking all children of 'model.suvera.cleaned_patients' to be skipped because of status 'error'.  Reason: Runtime Error in model cleaned_patients (models/intermediate/cleaned_patients.sql)
  Binder Error: Referenced column "<NA>" not found in FROM clause!
  Candidate bindings: "age"
  
  LINE 21: ... practice_id is not null and age != 999 and practice_id ! = "<NA>"
                                                                          ^.
[0m18:06:34.146979 [info ] [Thread-1 (]: 7 of 12 START sql view model main.qa_flagged_patients .......................... [RUN]
[0m18:06:34.149069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.cleaned_patients, now model.suvera.qa_flagged_patients)
[0m18:06:34.149808 [debug] [Thread-1 (]: Began compiling node model.suvera.qa_flagged_patients
[0m18:06:34.153356 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.qa_flagged_patients"
[0m18:06:34.154375 [debug] [Thread-1 (]: Began executing node model.suvera.qa_flagged_patients
[0m18:06:34.159631 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.qa_flagged_patients"
[0m18:06:34.160946 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:06:34.161672 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: BEGIN
[0m18:06:34.162206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:34.163154 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:34.163752 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:06:34.164329 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */

  
  create view "dev"."main"."qa_flagged_patients__dbt_tmp" as (
    with source as (
    select *
    from "dev"."main"."stg_patients"
),

deduplicated as (
    select *
    from (
        select *,
               row_number() over (
                   partition by patient_id, practice_id
                   order by registration_date desc
               ) as row_num
        from source
    )
),

filtered_out as (
    select *
    from deduplicated
    where row_num > 1
       or try_cast(age as integer) not between 0 and 120
)

select * from filtered_out
  );

[0m18:06:34.168656 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:06:34.173090 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:06:34.173773 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */
alter view "dev"."main"."qa_flagged_patients" rename to "qa_flagged_patients__dbt_backup"
[0m18:06:34.174817 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:34.179919 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:06:34.180717 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */
alter view "dev"."main"."qa_flagged_patients__dbt_tmp" rename to "qa_flagged_patients"
[0m18:06:34.182313 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:34.184720 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: COMMIT
[0m18:06:34.185311 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:06:34.185856 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: COMMIT
[0m18:06:34.187145 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:34.190220 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:06:34.190779 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */
drop view if exists "dev"."main"."qa_flagged_patients__dbt_backup" cascade
[0m18:06:34.191985 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:34.194049 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: Close
[0m18:06:34.194882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e655cce-5b4d-4e34-bd72-c3931e6789b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5815b0>]}
[0m18:06:34.196232 [info ] [Thread-1 (]: 7 of 12 OK created sql view model main.qa_flagged_patients ..................... [[32mOK[0m in 0.05s]
[0m18:06:34.197817 [debug] [Thread-1 (]: Finished running node model.suvera.qa_flagged_patients
[0m18:06:34.198647 [debug] [Thread-1 (]: Began running node model.suvera.mart_age_groups_by_pcn
[0m18:06:34.199393 [info ] [Thread-1 (]: 8 of 12 SKIP relation main.mart_age_groups_by_pcn .............................. [[33mSKIP[0m]
[0m18:06:34.200087 [debug] [Thread-1 (]: Finished running node model.suvera.mart_age_groups_by_pcn
[0m18:06:34.200681 [debug] [Thread-1 (]: Began running node model.suvera.mart_avg_age_by_practice
[0m18:06:34.201285 [info ] [Thread-1 (]: 9 of 12 SKIP relation main.mart_avg_age_by_practice ............................ [[33mSKIP[0m]
[0m18:06:34.202034 [debug] [Thread-1 (]: Finished running node model.suvera.mart_avg_age_by_practice
[0m18:06:34.202820 [debug] [Thread-1 (]: Began running node model.suvera.mart_hypertension_pct_by_practice
[0m18:06:34.203551 [info ] [Thread-1 (]: 10 of 12 SKIP relation main.mart_hypertension_pct_by_practice .................. [[33mSKIP[0m]
[0m18:06:34.204252 [debug] [Thread-1 (]: Finished running node model.suvera.mart_hypertension_pct_by_practice
[0m18:06:34.204873 [debug] [Thread-1 (]: Began running node model.suvera.mart_patient_count_by_pcn
[0m18:06:34.205553 [info ] [Thread-1 (]: 11 of 12 SKIP relation main.mart_patient_count_by_pcn .......................... [[33mSKIP[0m]
[0m18:06:34.206235 [debug] [Thread-1 (]: Finished running node model.suvera.mart_patient_count_by_pcn
[0m18:06:34.206832 [debug] [Thread-1 (]: Began running node model.suvera.mart_recent_activity_by_patient
[0m18:06:34.207418 [info ] [Thread-1 (]: 12 of 12 SKIP relation main.mart_recent_activity_by_patient .................... [[33mSKIP[0m]
[0m18:06:34.208133 [debug] [Thread-1 (]: Finished running node model.suvera.mart_recent_activity_by_patient
[0m18:06:34.209944 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:34.210580 [debug] [MainThread]: On master: BEGIN
[0m18:06:34.211129 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:06:34.212290 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:06:34.212863 [debug] [MainThread]: On master: COMMIT
[0m18:06:34.213635 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:34.214142 [debug] [MainThread]: On master: COMMIT
[0m18:06:34.214943 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:06:34.215466 [debug] [MainThread]: On master: Close
[0m18:06:34.216112 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:34.216570 [debug] [MainThread]: Connection 'model.suvera.qa_flagged_patients' was properly closed.
[0m18:06:34.217147 [info ] [MainThread]: 
[0m18:06:34.217675 [info ] [MainThread]: Finished running 12 view models in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m18:06:34.221017 [debug] [MainThread]: Command end result
[0m18:06:34.266459 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m18:06:34.269163 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m18:06:34.279085 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m18:06:34.279758 [info ] [MainThread]: 
[0m18:06:34.280322 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:06:34.280826 [info ] [MainThread]: 
[0m18:06:34.281429 [error] [MainThread]: [31mFailure in model cleaned_patients (models/intermediate/cleaned_patients.sql)[0m
[0m18:06:34.282022 [error] [MainThread]:   Runtime Error in model cleaned_patients (models/intermediate/cleaned_patients.sql)
  Binder Error: Referenced column "<NA>" not found in FROM clause!
  Candidate bindings: "age"
  
  LINE 21: ... practice_id is not null and age != 999 and practice_id ! = "<NA>"
                                                                          ^
[0m18:06:34.282505 [info ] [MainThread]: 
[0m18:06:34.283066 [info ] [MainThread]:   compiled code at target/compiled/suvera/models/intermediate/cleaned_patients.sql
[0m18:06:34.283545 [info ] [MainThread]: 
[0m18:06:34.284077 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=5 NO-OP=0 TOTAL=12
[0m18:06:34.288515 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.0453644, "process_in_blocks": "0", "process_kernel_time": 0.502738, "process_mem_max_rss": "136212480", "process_out_blocks": "0", "process_user_time": 3.976437}
[0m18:06:34.289427 [debug] [MainThread]: Command `dbt run` failed at 18:06:34.289216 after 2.05 seconds
[0m18:06:34.290060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e439190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efc3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efc3a10>]}
[0m18:06:34.290643 [debug] [MainThread]: Flushing usage events
[0m18:06:34.782269 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:10:23.629132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11099dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111977610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111977750>]}


============================== 18:10:23.640408 | 8eab7375-e32b-4a80-b21e-178b7e30d71a ==============================
[0m18:10:23.640408 [info ] [MainThread]: Running with dbt=1.10.1
[0m18:10:23.641504 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'version_check': 'True', 'profiles_dir': '/Users/puneeth/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:10:24.248350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8eab7375-e32b-4a80-b21e-178b7e30d71a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e25220>]}
[0m18:10:24.355289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8eab7375-e32b-4a80-b21e-178b7e30d71a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11185f350>]}
[0m18:10:24.385690 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m18:10:24.567620 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m18:10:24.890198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:10:24.891301 [debug] [MainThread]: Partial parsing: updated file: suvera://models/staging/stg_patients.sql
[0m18:10:24.891924 [debug] [MainThread]: Partial parsing: updated file: suvera://models/intermediate/cleaned_patients.sql
[0m18:10:25.613600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8eab7375-e32b-4a80-b21e-178b7e30d71a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112138b50>]}
[0m18:10:25.837299 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m18:10:25.843124 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m18:10:25.895533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8eab7375-e32b-4a80-b21e-178b7e30d71a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c52d50>]}
[0m18:10:25.896370 [info ] [MainThread]: Found 12 models, 4 seeds, 12 data tests, 544 macros
[0m18:10:25.896957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8eab7375-e32b-4a80-b21e-178b7e30d71a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ac5c50>]}
[0m18:10:25.900390 [info ] [MainThread]: 
[0m18:10:25.901047 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:10:25.901568 [info ] [MainThread]: 
[0m18:10:25.902435 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:10:25.911674 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m18:10:26.006388 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m18:10:26.007009 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m18:10:26.007565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:26.216606 [debug] [ThreadPool]: SQL status: OK in 0.209 seconds
[0m18:10:26.219398 [debug] [ThreadPool]: On list_dev: Close
[0m18:10:26.220567 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m18:10:26.221715 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m18:10:26.231410 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:10:26.231986 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m18:10:26.232443 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:26.234847 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:10:26.237454 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:10:26.237958 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m18:10:26.238711 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:10:26.239172 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:10:26.239620 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m18:10:26.242807 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:10:26.244274 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m18:10:26.244794 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:10:26.245249 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m18:10:26.245951 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:10:26.246436 [debug] [ThreadPool]: On create_dev_main: Close
[0m18:10:26.249518 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m18:10:26.258120 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m18:10:26.258677 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m18:10:26.259120 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:26.260076 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:10:26.260557 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m18:10:26.261030 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m18:10:26.297864 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m18:10:26.300345 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m18:10:26.302627 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m18:10:26.303184 [debug] [ThreadPool]: On list_dev_main: Close
[0m18:10:26.308033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8eab7375-e32b-4a80-b21e-178b7e30d71a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123a6340>]}
[0m18:10:26.308752 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:26.309781 [debug] [MainThread]: On master: BEGIN
[0m18:10:26.310753 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:10:26.311666 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:10:26.312165 [debug] [MainThread]: On master: COMMIT
[0m18:10:26.312639 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:26.313085 [debug] [MainThread]: On master: COMMIT
[0m18:10:26.313765 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:10:26.314246 [debug] [MainThread]: On master: Close
[0m18:10:26.318713 [debug] [Thread-1 (]: Began running node model.suvera.stg_activities
[0m18:10:26.319558 [info ] [Thread-1 (]: 1 of 12 START sql view model main.stg_activities ............................... [RUN]
[0m18:10:26.320261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.stg_activities)
[0m18:10:26.320815 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_activities
[0m18:10:26.332168 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_activities"
[0m18:10:26.335372 [debug] [Thread-1 (]: Began executing node model.suvera.stg_activities
[0m18:10:26.393975 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_activities"
[0m18:10:26.396668 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:10:26.398046 [debug] [Thread-1 (]: On model.suvera.stg_activities: BEGIN
[0m18:10:26.399205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:26.400338 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:26.400919 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:10:26.401472 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */

  
  create view "dev"."main"."stg_activities__dbt_tmp" as (
    select * 
from "dev"."main"."raw_activities"
limit 100
  );

[0m18:10:26.402543 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:26.412804 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:10:26.413473 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
alter view "dev"."main"."stg_activities" rename to "stg_activities__dbt_backup"
[0m18:10:26.415918 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:10:26.420178 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:10:26.420758 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
alter view "dev"."main"."stg_activities__dbt_tmp" rename to "stg_activities"
[0m18:10:26.421750 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:26.440465 [debug] [Thread-1 (]: On model.suvera.stg_activities: COMMIT
[0m18:10:26.441130 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:10:26.441672 [debug] [Thread-1 (]: On model.suvera.stg_activities: COMMIT
[0m18:10:26.444448 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:10:26.452123 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:10:26.452733 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
drop view if exists "dev"."main"."stg_activities__dbt_backup" cascade
[0m18:10:26.455219 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:10:26.458875 [debug] [Thread-1 (]: On model.suvera.stg_activities: Close
[0m18:10:26.462358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8eab7375-e32b-4a80-b21e-178b7e30d71a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123a2810>]}
[0m18:10:26.463485 [info ] [Thread-1 (]: 1 of 12 OK created sql view model main.stg_activities .......................... [[32mOK[0m in 0.14s]
[0m18:10:26.464445 [debug] [Thread-1 (]: Finished running node model.suvera.stg_activities
[0m18:10:26.465073 [debug] [Thread-1 (]: Began running node model.suvera.stg_patients
[0m18:10:26.465786 [info ] [Thread-1 (]: 2 of 12 START sql view model main.stg_patients ................................. [RUN]
[0m18:10:26.466625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_activities, now model.suvera.stg_patients)
[0m18:10:26.467319 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_patients
[0m18:10:26.471324 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_patients"
[0m18:10:26.472920 [debug] [Thread-1 (]: Began executing node model.suvera.stg_patients
[0m18:10:26.478638 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_patients"
[0m18:10:26.479834 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:10:26.480443 [debug] [Thread-1 (]: On model.suvera.stg_patients: BEGIN
[0m18:10:26.480980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:26.481908 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:26.482474 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:10:26.483813 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */

  
  create view "dev"."main"."stg_patients__dbt_tmp" as (
    with source as (
    select * from "dev"."main"."raw_patients"
),

parsed as (
    select
        case
            when regexp_extract(data, '"patient_id": ([0-9]+)', 1) ~ '^[0-9]+$'
            then cast(regexp_extract(data, '"patient_id": ([0-9]+)', 1) as integer)
        end as patient_id,
        case
            when regexp_extract(data, '"practice_id": ([0-9]+)', 1) ~ '^[0-9]+$'
            then cast(regexp_extract(data, '"practice_id": ([0-9]+)', 1) as integer)
        end as practice_id,
        case
            when regexp_extract(data, '"age": ([0-9]+)', 1) ~ '^[0-9]+$'
            then cast(regexp_extract(data, '"age": ([0-9]+)', 1) as integer)
        end as age,
        regexp_extract(data, '"gender": "([^""]*)"', 1) as gender,
        cast(nullif(regexp_extract(data, '"registration_date": "([^"]+)"', 1), '') as date) as registration_date,
        regexp_extract(data, '"email": "([^"]+)"', 1) as email,
        regexp_extract(data, '"phone": "([^"]+)"', 1) as phone,
        string_split(
            replace(
                regexp_extract(data, '"conditions": \[(.*?)\]', 1),
                '"',
                ''
            ),
            ', '
        ) as conditions
    from source
)

select * from parsed
  );

[0m18:10:26.492147 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:10:26.496933 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:10:26.497611 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients" rename to "stg_patients__dbt_backup"
[0m18:10:26.498981 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:26.503092 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:10:26.503669 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m18:10:26.504612 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:26.506883 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m18:10:26.507452 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:10:26.507982 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m18:10:26.509388 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:26.517068 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:10:26.517727 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
drop view if exists "dev"."main"."stg_patients__dbt_backup" cascade
[0m18:10:26.519106 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:26.521155 [debug] [Thread-1 (]: On model.suvera.stg_patients: Close
[0m18:10:26.521959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8eab7375-e32b-4a80-b21e-178b7e30d71a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ffb750>]}
[0m18:10:26.522850 [info ] [Thread-1 (]: 2 of 12 OK created sql view model main.stg_patients ............................ [[32mOK[0m in 0.06s]
[0m18:10:26.523774 [debug] [Thread-1 (]: Finished running node model.suvera.stg_patients
[0m18:10:26.524402 [debug] [Thread-1 (]: Began running node model.suvera.stg_pcns
[0m18:10:26.525107 [info ] [Thread-1 (]: 3 of 12 START sql view model main.stg_pcns ..................................... [RUN]
[0m18:10:26.526244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_patients, now model.suvera.stg_pcns)
[0m18:10:26.526841 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_pcns
[0m18:10:26.530264 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_pcns"
[0m18:10:26.531859 [debug] [Thread-1 (]: Began executing node model.suvera.stg_pcns
[0m18:10:26.537175 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_pcns"
[0m18:10:26.538310 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:10:26.538931 [debug] [Thread-1 (]: On model.suvera.stg_pcns: BEGIN
[0m18:10:26.539466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:26.540365 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:26.540912 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:10:26.541454 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */

  
  create view "dev"."main"."stg_pcns__dbt_tmp" as (
    select * 
from "dev"."main"."raw_pcns"
  );

[0m18:10:26.542530 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:26.546824 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:10:26.547460 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */
alter view "dev"."main"."stg_pcns" rename to "stg_pcns__dbt_backup"
[0m18:10:26.548553 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:26.553384 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:10:26.554000 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */
alter view "dev"."main"."stg_pcns__dbt_tmp" rename to "stg_pcns"
[0m18:10:26.554953 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:26.557170 [debug] [Thread-1 (]: On model.suvera.stg_pcns: COMMIT
[0m18:10:26.557733 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:10:26.558256 [debug] [Thread-1 (]: On model.suvera.stg_pcns: COMMIT
[0m18:10:26.559484 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:26.563223 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:10:26.563794 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */
drop view if exists "dev"."main"."stg_pcns__dbt_backup" cascade
[0m18:10:26.565097 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:26.567116 [debug] [Thread-1 (]: On model.suvera.stg_pcns: Close
[0m18:10:26.568053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8eab7375-e32b-4a80-b21e-178b7e30d71a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ab1d10>]}
[0m18:10:26.569143 [info ] [Thread-1 (]: 3 of 12 OK created sql view model main.stg_pcns ................................ [[32mOK[0m in 0.04s]
[0m18:10:26.570596 [debug] [Thread-1 (]: Finished running node model.suvera.stg_pcns
[0m18:10:26.571312 [debug] [Thread-1 (]: Began running node model.suvera.stg_practices
[0m18:10:26.572029 [info ] [Thread-1 (]: 4 of 12 START sql view model main.stg_practices ................................ [RUN]
[0m18:10:26.572724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_pcns, now model.suvera.stg_practices)
[0m18:10:26.573285 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_practices
[0m18:10:26.577113 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_practices"
[0m18:10:26.578838 [debug] [Thread-1 (]: Began executing node model.suvera.stg_practices
[0m18:10:26.584313 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_practices"
[0m18:10:26.585449 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:10:26.586265 [debug] [Thread-1 (]: On model.suvera.stg_practices: BEGIN
[0m18:10:26.586933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:26.587908 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:26.588477 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:10:26.589073 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */

  
  create view "dev"."main"."stg_practices__dbt_tmp" as (
    select * 
from "dev"."main"."raw_practices"
  );

[0m18:10:26.590079 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:26.594890 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:10:26.595920 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */
alter view "dev"."main"."stg_practices" rename to "stg_practices__dbt_backup"
[0m18:10:26.596971 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:26.602025 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:10:26.603232 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */
alter view "dev"."main"."stg_practices__dbt_tmp" rename to "stg_practices"
[0m18:10:26.604688 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:26.607401 [debug] [Thread-1 (]: On model.suvera.stg_practices: COMMIT
[0m18:10:26.607992 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:10:26.608526 [debug] [Thread-1 (]: On model.suvera.stg_practices: COMMIT
[0m18:10:26.609748 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:26.614678 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:10:26.615704 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */
drop view if exists "dev"."main"."stg_practices__dbt_backup" cascade
[0m18:10:26.618122 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:26.621502 [debug] [Thread-1 (]: On model.suvera.stg_practices: Close
[0m18:10:26.622349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8eab7375-e32b-4a80-b21e-178b7e30d71a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e4e050>]}
[0m18:10:26.623296 [info ] [Thread-1 (]: 4 of 12 OK created sql view model main.stg_practices ........................... [[32mOK[0m in 0.05s]
[0m18:10:26.624252 [debug] [Thread-1 (]: Finished running node model.suvera.stg_practices
[0m18:10:26.624874 [debug] [Thread-1 (]: Began running node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:10:26.625585 [info ] [Thread-1 (]: 5 of 12 START sql view model main.mart_patients_inactive_3_months_after_first .. [RUN]
[0m18:10:26.626740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_practices, now model.suvera.mart_patients_inactive_3_months_after_first)
[0m18:10:26.628329 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:10:26.632833 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:10:26.634361 [debug] [Thread-1 (]: Began executing node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:10:26.640784 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:10:26.641950 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:10:26.642525 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: BEGIN
[0m18:10:26.643625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:26.645444 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:10:26.646111 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:10:26.646754 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */

  
  create view "dev"."main"."mart_patients_inactive_3_months_after_first__dbt_tmp" as (
    with activities as (
    select
        patient_id,
        activity_date
    from "dev"."main"."stg_activities"
),

first_activity as (
    select
        patient_id,
        min(activity_date) as first_date
    from activities
    group by patient_id
),

follow_up_activity as (
    select
        a.patient_id
    from activities a
    join first_activity f
        on a.patient_id = f.patient_id
    where a.activity_date > f.first_date
      and a.activity_date <= f.first_date + interval '90 days'
),

inactive_patients as (
    select
        f.patient_id,
        f.first_date
    from first_activity f
    left join follow_up_activity fu
        on f.patient_id = fu.patient_id
    where fu.patient_id is null
)

select *
from inactive_patients
  );

[0m18:10:26.650737 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:10:26.656567 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:10:26.657244 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */
alter view "dev"."main"."mart_patients_inactive_3_months_after_first" rename to "mart_patients_inactive_3_months_after_first__dbt_backup"
[0m18:10:26.658271 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:26.664117 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:10:26.664794 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */
alter view "dev"."main"."mart_patients_inactive_3_months_after_first__dbt_tmp" rename to "mart_patients_inactive_3_months_after_first"
[0m18:10:26.665821 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:26.669284 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: COMMIT
[0m18:10:26.670048 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:10:26.670648 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: COMMIT
[0m18:10:26.672334 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:26.675529 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:10:26.676172 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */
drop view if exists "dev"."main"."mart_patients_inactive_3_months_after_first__dbt_backup" cascade
[0m18:10:26.678477 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:26.680730 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: Close
[0m18:10:26.681548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8eab7375-e32b-4a80-b21e-178b7e30d71a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11142f460>]}
[0m18:10:26.682850 [info ] [Thread-1 (]: 5 of 12 OK created sql view model main.mart_patients_inactive_3_months_after_first  [[32mOK[0m in 0.06s]
[0m18:10:26.684570 [debug] [Thread-1 (]: Finished running node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:10:26.685511 [debug] [Thread-1 (]: Began running node model.suvera.cleaned_patients
[0m18:10:26.686387 [info ] [Thread-1 (]: 6 of 12 START sql view model main.cleaned_patients ............................. [RUN]
[0m18:10:26.687144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_patients_inactive_3_months_after_first, now model.suvera.cleaned_patients)
[0m18:10:26.687900 [debug] [Thread-1 (]: Began compiling node model.suvera.cleaned_patients
[0m18:10:26.691787 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.cleaned_patients"
[0m18:10:26.693862 [debug] [Thread-1 (]: Began executing node model.suvera.cleaned_patients
[0m18:10:26.701399 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.cleaned_patients"
[0m18:10:26.703319 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:10:26.704084 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: BEGIN
[0m18:10:26.704815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:26.706002 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:26.706620 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:10:26.707201 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */

  
  create view "dev"."main"."cleaned_patients__dbt_tmp" as (
    with deduplicated as (
    select *
    from (
        select *,
               row_number() over (
                   partition by patient_id, practice_id
                   order by registration_date desc
               ) as row_num
        from "dev"."main"."stg_patients"
    )
    where row_num = 1
),

filtered as (
    select *
    from deduplicated
    where age between 0 and 120 and practice_id is not null and age != 999 and practice_id != "<NA>"
)

select
    patient_id,
    practice_id,
    age,
    gender,
    registration_date,
    email,
    phone,
    conditions
from filtered
  );

[0m18:10:26.721114 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */

  
  create view "dev"."main"."cleaned_patients__dbt_tmp" as (
    with deduplicated as (
    select *
    from (
        select *,
               row_number() over (
                   partition by patient_id, practice_id
                   order by registration_date desc
               ) as row_num
        from "dev"."main"."stg_patients"
    )
    where row_num = 1
),

filtered as (
    select *
    from deduplicated
    where age between 0 and 120 and practice_id is not null and age != 999 and practice_id != "<NA>"
)

select
    patient_id,
    practice_id,
    age,
    gender,
    registration_date,
    email,
    phone,
    conditions
from filtered
  );

[0m18:10:26.722003 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:10:26.723379 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: ROLLBACK
[0m18:10:26.741662 [debug] [Thread-1 (]: Failed to rollback 'model.suvera.cleaned_patients'
[0m18:10:26.742555 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: Close
[0m18:10:26.749234 [debug] [Thread-1 (]: Runtime Error in model cleaned_patients (models/intermediate/cleaned_patients.sql)
  Binder Error: Referenced column "<NA>" not found in FROM clause!
  Candidate bindings: "age"
  
  LINE 21: ... and practice_id is not null and age != 999 and practice_id != "<NA>"
                                                                             ^
[0m18:10:26.750295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8eab7375-e32b-4a80-b21e-178b7e30d71a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125f10d0>]}
[0m18:10:26.751359 [error] [Thread-1 (]: 6 of 12 ERROR creating sql view model main.cleaned_patients .................... [[31mERROR[0m in 0.06s]
[0m18:10:26.752309 [debug] [Thread-1 (]: Finished running node model.suvera.cleaned_patients
[0m18:10:26.753206 [debug] [Thread-1 (]: Began running node model.suvera.qa_flagged_patients
[0m18:10:26.754621 [debug] [Thread-4 (]: Marking all children of 'model.suvera.cleaned_patients' to be skipped because of status 'error'.  Reason: Runtime Error in model cleaned_patients (models/intermediate/cleaned_patients.sql)
  Binder Error: Referenced column "<NA>" not found in FROM clause!
  Candidate bindings: "age"
  
  LINE 21: ... and practice_id is not null and age != 999 and practice_id != "<NA>"
                                                                             ^.
[0m18:10:26.755546 [info ] [Thread-1 (]: 7 of 12 START sql view model main.qa_flagged_patients .......................... [RUN]
[0m18:10:26.758536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.cleaned_patients, now model.suvera.qa_flagged_patients)
[0m18:10:26.759562 [debug] [Thread-1 (]: Began compiling node model.suvera.qa_flagged_patients
[0m18:10:26.765861 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.qa_flagged_patients"
[0m18:10:26.767702 [debug] [Thread-1 (]: Began executing node model.suvera.qa_flagged_patients
[0m18:10:26.773654 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.qa_flagged_patients"
[0m18:10:26.774881 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:10:26.775452 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: BEGIN
[0m18:10:26.775978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:26.776916 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:26.777615 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:10:26.778782 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */

  
  create view "dev"."main"."qa_flagged_patients__dbt_tmp" as (
    with source as (
    select *
    from "dev"."main"."stg_patients"
),

deduplicated as (
    select *
    from (
        select *,
               row_number() over (
                   partition by patient_id, practice_id
                   order by registration_date desc
               ) as row_num
        from source
    )
),

filtered_out as (
    select *
    from deduplicated
    where row_num > 1
       or try_cast(age as integer) not between 0 and 120
)

select * from filtered_out
  );

[0m18:10:26.782627 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:10:26.787809 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:10:26.788995 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */
alter view "dev"."main"."qa_flagged_patients" rename to "qa_flagged_patients__dbt_backup"
[0m18:10:26.790461 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:26.796750 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:10:26.797634 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */
alter view "dev"."main"."qa_flagged_patients__dbt_tmp" rename to "qa_flagged_patients"
[0m18:10:26.798884 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:26.802537 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: COMMIT
[0m18:10:26.803422 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:10:26.804472 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: COMMIT
[0m18:10:26.806274 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:26.811787 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:10:26.812482 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */
drop view if exists "dev"."main"."qa_flagged_patients__dbt_backup" cascade
[0m18:10:26.813891 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:26.816016 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: Close
[0m18:10:26.816852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8eab7375-e32b-4a80-b21e-178b7e30d71a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124d4650>]}
[0m18:10:26.817754 [info ] [Thread-1 (]: 7 of 12 OK created sql view model main.qa_flagged_patients ..................... [[32mOK[0m in 0.06s]
[0m18:10:26.818670 [debug] [Thread-1 (]: Finished running node model.suvera.qa_flagged_patients
[0m18:10:26.819361 [debug] [Thread-1 (]: Began running node model.suvera.mart_age_groups_by_pcn
[0m18:10:26.820147 [info ] [Thread-1 (]: 8 of 12 SKIP relation main.mart_age_groups_by_pcn .............................. [[33mSKIP[0m]
[0m18:10:26.821135 [debug] [Thread-1 (]: Finished running node model.suvera.mart_age_groups_by_pcn
[0m18:10:26.821875 [debug] [Thread-1 (]: Began running node model.suvera.mart_avg_age_by_practice
[0m18:10:26.822623 [info ] [Thread-1 (]: 9 of 12 SKIP relation main.mart_avg_age_by_practice ............................ [[33mSKIP[0m]
[0m18:10:26.823363 [debug] [Thread-1 (]: Finished running node model.suvera.mart_avg_age_by_practice
[0m18:10:26.824087 [debug] [Thread-1 (]: Began running node model.suvera.mart_hypertension_pct_by_practice
[0m18:10:26.824925 [info ] [Thread-1 (]: 10 of 12 SKIP relation main.mart_hypertension_pct_by_practice .................. [[33mSKIP[0m]
[0m18:10:26.825829 [debug] [Thread-1 (]: Finished running node model.suvera.mart_hypertension_pct_by_practice
[0m18:10:26.826693 [debug] [Thread-1 (]: Began running node model.suvera.mart_patient_count_by_pcn
[0m18:10:26.827453 [info ] [Thread-1 (]: 11 of 12 SKIP relation main.mart_patient_count_by_pcn .......................... [[33mSKIP[0m]
[0m18:10:26.828618 [debug] [Thread-1 (]: Finished running node model.suvera.mart_patient_count_by_pcn
[0m18:10:26.829539 [debug] [Thread-1 (]: Began running node model.suvera.mart_recent_activity_by_patient
[0m18:10:26.830267 [info ] [Thread-1 (]: 12 of 12 SKIP relation main.mart_recent_activity_by_patient .................... [[33mSKIP[0m]
[0m18:10:26.831848 [debug] [Thread-1 (]: Finished running node model.suvera.mart_recent_activity_by_patient
[0m18:10:26.839284 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:26.839868 [debug] [MainThread]: On master: BEGIN
[0m18:10:26.840326 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:10:26.841198 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:10:26.841709 [debug] [MainThread]: On master: COMMIT
[0m18:10:26.842190 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:26.842643 [debug] [MainThread]: On master: COMMIT
[0m18:10:26.844070 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:10:26.844653 [debug] [MainThread]: On master: Close
[0m18:10:26.845345 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:26.846850 [debug] [MainThread]: Connection 'model.suvera.qa_flagged_patients' was properly closed.
[0m18:10:26.847598 [info ] [MainThread]: 
[0m18:10:26.848447 [info ] [MainThread]: Finished running 12 view models in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m18:10:26.851156 [debug] [MainThread]: Command end result
[0m18:10:26.903302 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m18:10:26.906340 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m18:10:26.918542 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m18:10:26.919112 [info ] [MainThread]: 
[0m18:10:26.919851 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:10:26.920511 [info ] [MainThread]: 
[0m18:10:26.921325 [error] [MainThread]: [31mFailure in model cleaned_patients (models/intermediate/cleaned_patients.sql)[0m
[0m18:10:26.921978 [error] [MainThread]:   Runtime Error in model cleaned_patients (models/intermediate/cleaned_patients.sql)
  Binder Error: Referenced column "<NA>" not found in FROM clause!
  Candidate bindings: "age"
  
  LINE 21: ... and practice_id is not null and age != 999 and practice_id != "<NA>"
                                                                             ^
[0m18:10:26.922507 [info ] [MainThread]: 
[0m18:10:26.923353 [info ] [MainThread]:   compiled code at target/compiled/suvera/models/intermediate/cleaned_patients.sql
[0m18:10:26.924315 [info ] [MainThread]: 
[0m18:10:26.925395 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=5 NO-OP=0 TOTAL=12
[0m18:10:26.933036 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.4389648, "process_in_blocks": "0", "process_kernel_time": 0.856721, "process_mem_max_rss": "140218368", "process_out_blocks": "0", "process_user_time": 4.968857}
[0m18:10:26.934272 [debug] [MainThread]: Command `dbt run` failed at 18:10:26.933966 after 3.44 seconds
[0m18:10:26.935289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114131d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11266fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11266f8f0>]}
[0m18:10:26.937444 [debug] [MainThread]: Flushing usage events
[0m18:10:27.420810 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:10:37.065399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110be1d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bbb610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bbb750>]}


============================== 18:10:37.074584 | e3b182c9-7bdc-4c48-8942-ad8c4a979653 ==============================
[0m18:10:37.074584 [info ] [MainThread]: Running with dbt=1.10.1
[0m18:10:37.075515 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'profiles_dir': '/Users/puneeth/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:10:37.509816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3b182c9-7bdc-4c48-8942-ad8c4a979653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111069220>]}
[0m18:10:37.615474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3b182c9-7bdc-4c48-8942-ad8c4a979653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111aa3350>]}
[0m18:10:37.642622 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m18:10:37.817814 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m18:10:38.120630 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:10:38.121646 [debug] [MainThread]: Partial parsing: updated file: suvera://models/intermediate/cleaned_patients.sql
[0m18:10:38.563325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3b182c9-7bdc-4c48-8942-ad8c4a979653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112340350>]}
[0m18:10:38.695171 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m18:10:38.698835 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m18:10:38.743368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3b182c9-7bdc-4c48-8942-ad8c4a979653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e96d50>]}
[0m18:10:38.744240 [info ] [MainThread]: Found 12 models, 4 seeds, 12 data tests, 544 macros
[0m18:10:38.744825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3b182c9-7bdc-4c48-8942-ad8c4a979653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112454590>]}
[0m18:10:38.748373 [info ] [MainThread]: 
[0m18:10:38.748954 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:10:38.749587 [info ] [MainThread]: 
[0m18:10:38.750491 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:10:38.761349 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m18:10:38.848158 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m18:10:38.848780 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m18:10:38.849274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:38.875092 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m18:10:38.877351 [debug] [ThreadPool]: On list_dev: Close
[0m18:10:38.878392 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m18:10:38.879112 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m18:10:38.888595 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:10:38.889188 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m18:10:38.889649 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:38.891029 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:10:38.893191 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:10:38.893680 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m18:10:38.894400 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:10:38.894861 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:10:38.895314 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m18:10:38.896114 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:10:38.897438 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m18:10:38.897922 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:10:38.898370 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m18:10:38.899091 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:10:38.899592 [debug] [ThreadPool]: On create_dev_main: Close
[0m18:10:38.902662 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m18:10:38.986924 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m18:10:38.987519 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m18:10:38.987976 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:38.988862 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:10:38.989346 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m18:10:38.989822 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m18:10:39.010425 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m18:10:39.012902 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m18:10:39.015586 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m18:10:39.016212 [debug] [ThreadPool]: On list_dev_main: Close
[0m18:10:39.021187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3b182c9-7bdc-4c48-8942-ad8c4a979653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11236fee0>]}
[0m18:10:39.021870 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:39.022334 [debug] [MainThread]: On master: BEGIN
[0m18:10:39.022769 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:10:39.023639 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:10:39.024125 [debug] [MainThread]: On master: COMMIT
[0m18:10:39.024587 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:39.025028 [debug] [MainThread]: On master: COMMIT
[0m18:10:39.025681 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:10:39.026155 [debug] [MainThread]: On master: Close
[0m18:10:39.030653 [debug] [Thread-1 (]: Began running node model.suvera.stg_activities
[0m18:10:39.031534 [info ] [Thread-1 (]: 1 of 12 START sql view model main.stg_activities ............................... [RUN]
[0m18:10:39.032247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.stg_activities)
[0m18:10:39.032808 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_activities
[0m18:10:39.043794 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_activities"
[0m18:10:39.044876 [debug] [Thread-1 (]: Began executing node model.suvera.stg_activities
[0m18:10:39.093775 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_activities"
[0m18:10:39.094970 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:10:39.095541 [debug] [Thread-1 (]: On model.suvera.stg_activities: BEGIN
[0m18:10:39.096064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:39.096952 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.097498 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:10:39.098038 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */

  
  create view "dev"."main"."stg_activities__dbt_tmp" as (
    select * 
from "dev"."main"."raw_activities"
limit 100
  );

[0m18:10:39.099091 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:39.108592 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:10:39.109239 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
alter view "dev"."main"."stg_activities" rename to "stg_activities__dbt_backup"
[0m18:10:39.110354 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:39.114297 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:10:39.114861 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
alter view "dev"."main"."stg_activities__dbt_tmp" rename to "stg_activities"
[0m18:10:39.115749 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:39.133861 [debug] [Thread-1 (]: On model.suvera.stg_activities: COMMIT
[0m18:10:39.134538 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:10:39.135095 [debug] [Thread-1 (]: On model.suvera.stg_activities: COMMIT
[0m18:10:39.136714 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.144269 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:10:39.144864 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
drop view if exists "dev"."main"."stg_activities__dbt_backup" cascade
[0m18:10:39.146160 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.149743 [debug] [Thread-1 (]: On model.suvera.stg_activities: Close
[0m18:10:39.152424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3b182c9-7bdc-4c48-8942-ad8c4a979653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112626390>]}
[0m18:10:39.153425 [info ] [Thread-1 (]: 1 of 12 OK created sql view model main.stg_activities .......................... [[32mOK[0m in 0.12s]
[0m18:10:39.154352 [debug] [Thread-1 (]: Finished running node model.suvera.stg_activities
[0m18:10:39.154977 [debug] [Thread-1 (]: Began running node model.suvera.stg_patients
[0m18:10:39.155670 [info ] [Thread-1 (]: 2 of 12 START sql view model main.stg_patients ................................. [RUN]
[0m18:10:39.156490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_activities, now model.suvera.stg_patients)
[0m18:10:39.157173 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_patients
[0m18:10:39.161405 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_patients"
[0m18:10:39.162494 [debug] [Thread-1 (]: Began executing node model.suvera.stg_patients
[0m18:10:39.168764 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_patients"
[0m18:10:39.169961 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:10:39.170990 [debug] [Thread-1 (]: On model.suvera.stg_patients: BEGIN
[0m18:10:39.171826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:39.172762 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.173372 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:10:39.174002 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */

  
  create view "dev"."main"."stg_patients__dbt_tmp" as (
    with source as (
    select * from "dev"."main"."raw_patients"
),

parsed as (
    select
        case
            when regexp_extract(data, '"patient_id": ([0-9]+)', 1) ~ '^[0-9]+$'
            then cast(regexp_extract(data, '"patient_id": ([0-9]+)', 1) as integer)
        end as patient_id,
        case
            when regexp_extract(data, '"practice_id": ([0-9]+)', 1) ~ '^[0-9]+$'
            then cast(regexp_extract(data, '"practice_id": ([0-9]+)', 1) as integer)
        end as practice_id,
        case
            when regexp_extract(data, '"age": ([0-9]+)', 1) ~ '^[0-9]+$'
            then cast(regexp_extract(data, '"age": ([0-9]+)', 1) as integer)
        end as age,
        regexp_extract(data, '"gender": "([^""]*)"', 1) as gender,
        cast(nullif(regexp_extract(data, '"registration_date": "([^"]+)"', 1), '') as date) as registration_date,
        regexp_extract(data, '"email": "([^"]+)"', 1) as email,
        regexp_extract(data, '"phone": "([^"]+)"', 1) as phone,
        string_split(
            replace(
                regexp_extract(data, '"conditions": \[(.*?)\]', 1),
                '"',
                ''
            ),
            ', '
        ) as conditions
    from source
)

select * from parsed
  );

[0m18:10:39.176629 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:10:39.181044 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:10:39.181625 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients" rename to "stg_patients__dbt_backup"
[0m18:10:39.182605 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:39.186467 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:10:39.187072 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m18:10:39.188111 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:39.190467 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m18:10:39.191045 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:10:39.191571 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m18:10:39.192944 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.196876 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:10:39.197455 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
drop view if exists "dev"."main"."stg_patients__dbt_backup" cascade
[0m18:10:39.198812 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.200856 [debug] [Thread-1 (]: On model.suvera.stg_patients: Close
[0m18:10:39.201665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3b182c9-7bdc-4c48-8942-ad8c4a979653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112376c50>]}
[0m18:10:39.202551 [info ] [Thread-1 (]: 2 of 12 OK created sql view model main.stg_patients ............................ [[32mOK[0m in 0.05s]
[0m18:10:39.203455 [debug] [Thread-1 (]: Finished running node model.suvera.stg_patients
[0m18:10:39.204058 [debug] [Thread-1 (]: Began running node model.suvera.stg_pcns
[0m18:10:39.204741 [info ] [Thread-1 (]: 3 of 12 START sql view model main.stg_pcns ..................................... [RUN]
[0m18:10:39.205561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_patients, now model.suvera.stg_pcns)
[0m18:10:39.206261 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_pcns
[0m18:10:39.209763 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_pcns"
[0m18:10:39.211004 [debug] [Thread-1 (]: Began executing node model.suvera.stg_pcns
[0m18:10:39.216771 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_pcns"
[0m18:10:39.218798 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:10:39.219670 [debug] [Thread-1 (]: On model.suvera.stg_pcns: BEGIN
[0m18:10:39.220397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:39.221379 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.221960 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:10:39.222511 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */

  
  create view "dev"."main"."stg_pcns__dbt_tmp" as (
    select * 
from "dev"."main"."raw_pcns"
  );

[0m18:10:39.223489 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:39.227623 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:10:39.228214 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */
alter view "dev"."main"."stg_pcns" rename to "stg_pcns__dbt_backup"
[0m18:10:39.229153 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:39.233535 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:10:39.234137 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */
alter view "dev"."main"."stg_pcns__dbt_tmp" rename to "stg_pcns"
[0m18:10:39.235662 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:39.237946 [debug] [Thread-1 (]: On model.suvera.stg_pcns: COMMIT
[0m18:10:39.238513 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:10:39.239046 [debug] [Thread-1 (]: On model.suvera.stg_pcns: COMMIT
[0m18:10:39.240349 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.243627 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:10:39.244213 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */
drop view if exists "dev"."main"."stg_pcns__dbt_backup" cascade
[0m18:10:39.245571 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.247542 [debug] [Thread-1 (]: On model.suvera.stg_pcns: Close
[0m18:10:39.248313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3b182c9-7bdc-4c48-8942-ad8c4a979653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120537f0>]}
[0m18:10:39.249207 [info ] [Thread-1 (]: 3 of 12 OK created sql view model main.stg_pcns ................................ [[32mOK[0m in 0.04s]
[0m18:10:39.250102 [debug] [Thread-1 (]: Finished running node model.suvera.stg_pcns
[0m18:10:39.250699 [debug] [Thread-1 (]: Began running node model.suvera.stg_practices
[0m18:10:39.251380 [info ] [Thread-1 (]: 4 of 12 START sql view model main.stg_practices ................................ [RUN]
[0m18:10:39.252083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_pcns, now model.suvera.stg_practices)
[0m18:10:39.252635 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_practices
[0m18:10:39.256169 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_practices"
[0m18:10:39.257265 [debug] [Thread-1 (]: Began executing node model.suvera.stg_practices
[0m18:10:39.262823 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_practices"
[0m18:10:39.263952 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:10:39.264515 [debug] [Thread-1 (]: On model.suvera.stg_practices: BEGIN
[0m18:10:39.265042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:39.266584 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.267501 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:10:39.268130 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */

  
  create view "dev"."main"."stg_practices__dbt_tmp" as (
    select * 
from "dev"."main"."raw_practices"
  );

[0m18:10:39.269281 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.273716 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:10:39.274333 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */
alter view "dev"."main"."stg_practices" rename to "stg_practices__dbt_backup"
[0m18:10:39.275308 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:39.281058 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:10:39.281754 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */
alter view "dev"."main"."stg_practices__dbt_tmp" rename to "stg_practices"
[0m18:10:39.282814 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:39.285227 [debug] [Thread-1 (]: On model.suvera.stg_practices: COMMIT
[0m18:10:39.285835 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:10:39.286375 [debug] [Thread-1 (]: On model.suvera.stg_practices: COMMIT
[0m18:10:39.287589 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.290773 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:10:39.291353 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */
drop view if exists "dev"."main"."stg_practices__dbt_backup" cascade
[0m18:10:39.292657 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.294777 [debug] [Thread-1 (]: On model.suvera.stg_practices: Close
[0m18:10:39.295588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3b182c9-7bdc-4c48-8942-ad8c4a979653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dce350>]}
[0m18:10:39.296631 [info ] [Thread-1 (]: 4 of 12 OK created sql view model main.stg_practices ........................... [[32mOK[0m in 0.04s]
[0m18:10:39.297550 [debug] [Thread-1 (]: Finished running node model.suvera.stg_practices
[0m18:10:39.298172 [debug] [Thread-1 (]: Began running node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:10:39.298873 [info ] [Thread-1 (]: 5 of 12 START sql view model main.mart_patients_inactive_3_months_after_first .. [RUN]
[0m18:10:39.299598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_practices, now model.suvera.mart_patients_inactive_3_months_after_first)
[0m18:10:39.300172 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:10:39.303861 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:10:39.304924 [debug] [Thread-1 (]: Began executing node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:10:39.310588 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:10:39.312483 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:10:39.313804 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: BEGIN
[0m18:10:39.314445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:39.315406 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.315969 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:10:39.316569 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */

  
  create view "dev"."main"."mart_patients_inactive_3_months_after_first__dbt_tmp" as (
    with activities as (
    select
        patient_id,
        activity_date
    from "dev"."main"."stg_activities"
),

first_activity as (
    select
        patient_id,
        min(activity_date) as first_date
    from activities
    group by patient_id
),

follow_up_activity as (
    select
        a.patient_id
    from activities a
    join first_activity f
        on a.patient_id = f.patient_id
    where a.activity_date > f.first_date
      and a.activity_date <= f.first_date + interval '90 days'
),

inactive_patients as (
    select
        f.patient_id,
        f.first_date
    from first_activity f
    left join follow_up_activity fu
        on f.patient_id = fu.patient_id
    where fu.patient_id is null
)

select *
from inactive_patients
  );

[0m18:10:39.318403 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.322484 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:10:39.323062 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */
alter view "dev"."main"."mart_patients_inactive_3_months_after_first" rename to "mart_patients_inactive_3_months_after_first__dbt_backup"
[0m18:10:39.324001 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:39.328499 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:10:39.329156 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */
alter view "dev"."main"."mart_patients_inactive_3_months_after_first__dbt_tmp" rename to "mart_patients_inactive_3_months_after_first"
[0m18:10:39.330176 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:39.332932 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: COMMIT
[0m18:10:39.333680 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:10:39.334243 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: COMMIT
[0m18:10:39.335618 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.338739 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:10:39.339308 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */
drop view if exists "dev"."main"."mart_patients_inactive_3_months_after_first__dbt_backup" cascade
[0m18:10:39.340610 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.342655 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: Close
[0m18:10:39.343608 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3b182c9-7bdc-4c48-8942-ad8c4a979653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11274d1d0>]}
[0m18:10:39.344513 [info ] [Thread-1 (]: 5 of 12 OK created sql view model main.mart_patients_inactive_3_months_after_first  [[32mOK[0m in 0.04s]
[0m18:10:39.345417 [debug] [Thread-1 (]: Finished running node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:10:39.346021 [debug] [Thread-1 (]: Began running node model.suvera.cleaned_patients
[0m18:10:39.346712 [info ] [Thread-1 (]: 6 of 12 START sql view model main.cleaned_patients ............................. [RUN]
[0m18:10:39.347582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_patients_inactive_3_months_after_first, now model.suvera.cleaned_patients)
[0m18:10:39.348163 [debug] [Thread-1 (]: Began compiling node model.suvera.cleaned_patients
[0m18:10:39.351710 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.cleaned_patients"
[0m18:10:39.352880 [debug] [Thread-1 (]: Began executing node model.suvera.cleaned_patients
[0m18:10:39.363852 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.cleaned_patients"
[0m18:10:39.365017 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:10:39.365680 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: BEGIN
[0m18:10:39.366604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:39.367603 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.368226 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:10:39.368818 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */

  
  create view "dev"."main"."cleaned_patients__dbt_tmp" as (
    with deduplicated as (
    select *
    from (
        select *,
               row_number() over (
                   partition by patient_id, practice_id
                   order by registration_date desc
               ) as row_num
        from "dev"."main"."stg_patients"
    )
    where row_num = 1
),

filtered as (
    select *
    from deduplicated
    where age between 0 and 120 and practice_id is not null and age != 999
)

select
    patient_id,
    practice_id,
    age,
    gender,
    registration_date,
    email,
    phone,
    conditions
from filtered
  );

[0m18:10:39.371439 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:10:39.375613 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:10:39.376366 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */
alter view "dev"."main"."cleaned_patients" rename to "cleaned_patients__dbt_backup"
[0m18:10:39.377409 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:39.382027 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:10:39.382661 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */
alter view "dev"."main"."cleaned_patients__dbt_tmp" rename to "cleaned_patients"
[0m18:10:39.383749 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.386046 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: COMMIT
[0m18:10:39.386618 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:10:39.387163 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: COMMIT
[0m18:10:39.388617 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.391782 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:10:39.392344 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */
drop view if exists "dev"."main"."cleaned_patients__dbt_backup" cascade
[0m18:10:39.393821 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.395844 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: Close
[0m18:10:39.396628 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3b182c9-7bdc-4c48-8942-ad8c4a979653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112276bd0>]}
[0m18:10:39.397529 [info ] [Thread-1 (]: 6 of 12 OK created sql view model main.cleaned_patients ........................ [[32mOK[0m in 0.05s]
[0m18:10:39.398427 [debug] [Thread-1 (]: Finished running node model.suvera.cleaned_patients
[0m18:10:39.399039 [debug] [Thread-1 (]: Began running node model.suvera.qa_flagged_patients
[0m18:10:39.399719 [info ] [Thread-1 (]: 7 of 12 START sql view model main.qa_flagged_patients .......................... [RUN]
[0m18:10:39.400696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.cleaned_patients, now model.suvera.qa_flagged_patients)
[0m18:10:39.401312 [debug] [Thread-1 (]: Began compiling node model.suvera.qa_flagged_patients
[0m18:10:39.405440 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.qa_flagged_patients"
[0m18:10:39.406626 [debug] [Thread-1 (]: Began executing node model.suvera.qa_flagged_patients
[0m18:10:39.411728 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.qa_flagged_patients"
[0m18:10:39.413523 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:10:39.414176 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: BEGIN
[0m18:10:39.414707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:39.415602 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.416156 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:10:39.416818 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */

  
  create view "dev"."main"."qa_flagged_patients__dbt_tmp" as (
    with source as (
    select *
    from "dev"."main"."stg_patients"
),

deduplicated as (
    select *
    from (
        select *,
               row_number() over (
                   partition by patient_id, practice_id
                   order by registration_date desc
               ) as row_num
        from source
    )
),

filtered_out as (
    select *
    from deduplicated
    where row_num > 1
       or try_cast(age as integer) not between 0 and 120
)

select * from filtered_out
  );

[0m18:10:39.420229 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:10:39.424922 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:10:39.425541 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */
alter view "dev"."main"."qa_flagged_patients" rename to "qa_flagged_patients__dbt_backup"
[0m18:10:39.426669 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.431292 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:10:39.432060 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */
alter view "dev"."main"."qa_flagged_patients__dbt_tmp" rename to "qa_flagged_patients"
[0m18:10:39.433156 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:39.435841 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: COMMIT
[0m18:10:39.436458 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:10:39.436996 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: COMMIT
[0m18:10:39.438363 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.441614 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:10:39.442241 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */
drop view if exists "dev"."main"."qa_flagged_patients__dbt_backup" cascade
[0m18:10:39.443757 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.445783 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: Close
[0m18:10:39.446563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3b182c9-7bdc-4c48-8942-ad8c4a979653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cd6930>]}
[0m18:10:39.447443 [info ] [Thread-1 (]: 7 of 12 OK created sql view model main.qa_flagged_patients ..................... [[32mOK[0m in 0.05s]
[0m18:10:39.448329 [debug] [Thread-1 (]: Finished running node model.suvera.qa_flagged_patients
[0m18:10:39.448931 [debug] [Thread-1 (]: Began running node model.suvera.mart_age_groups_by_pcn
[0m18:10:39.449615 [info ] [Thread-1 (]: 8 of 12 START sql view model main.mart_age_groups_by_pcn ....................... [RUN]
[0m18:10:39.450383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.qa_flagged_patients, now model.suvera.mart_age_groups_by_pcn)
[0m18:10:39.450954 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_age_groups_by_pcn
[0m18:10:39.455940 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_age_groups_by_pcn"
[0m18:10:39.457528 [debug] [Thread-1 (]: Began executing node model.suvera.mart_age_groups_by_pcn
[0m18:10:39.463484 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_age_groups_by_pcn"
[0m18:10:39.465308 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:10:39.465992 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: BEGIN
[0m18:10:39.466525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:39.467575 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.468261 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:10:39.469104 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_age_groups_by_pcn"} */

  
  create view "dev"."main"."mart_age_groups_by_pcn__dbt_tmp" as (
    with patients as (
    select
        patient_id,
        practice_id,
        age,
        case
            when age between 0 and 18 then '0-18'
            when age between 19 and 35 then '19-35'
            when age between 36 and 50 then '36-50'
            when age >= 51 then '51+'
            else 'Unknown'
        end as age_group
    from "dev"."main"."cleaned_patients"
),

practices as (
    select *
    from "dev"."main"."stg_practices"
),

pcns as (
    select *
    from "dev"."main"."stg_pcns"
),

joined as (
    select
        pcn.id as pcn_id,
        pcn.pcn_name,
        p.age_group
    from patients as p
    left join practices pr on p.practice_id = pr.id
    left join pcns pcn on pr.pcn = pcn.id
)

select
    pcn_id,
    pcn_name,
    age_group,
    count(*) as num_patients
from joined
group by pcn_id, pcn_name, age_group
order by pcn_id, age_group
  );

[0m18:10:39.473965 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:10:39.479135 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:10:39.479805 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_age_groups_by_pcn"} */
alter view "dev"."main"."mart_age_groups_by_pcn" rename to "mart_age_groups_by_pcn__dbt_backup"
[0m18:10:39.480871 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:39.485006 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:10:39.485650 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_age_groups_by_pcn"} */
alter view "dev"."main"."mart_age_groups_by_pcn__dbt_tmp" rename to "mart_age_groups_by_pcn"
[0m18:10:39.486661 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:39.488938 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: COMMIT
[0m18:10:39.489506 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:10:39.490049 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: COMMIT
[0m18:10:39.491302 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.494640 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:10:39.495233 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_age_groups_by_pcn"} */
drop view if exists "dev"."main"."mart_age_groups_by_pcn__dbt_backup" cascade
[0m18:10:39.496607 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.498648 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: Close
[0m18:10:39.499435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3b182c9-7bdc-4c48-8942-ad8c4a979653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112275550>]}
[0m18:10:39.500315 [info ] [Thread-1 (]: 8 of 12 OK created sql view model main.mart_age_groups_by_pcn .................. [[32mOK[0m in 0.05s]
[0m18:10:39.501209 [debug] [Thread-1 (]: Finished running node model.suvera.mart_age_groups_by_pcn
[0m18:10:39.501807 [debug] [Thread-1 (]: Began running node model.suvera.mart_avg_age_by_practice
[0m18:10:39.502488 [info ] [Thread-1 (]: 9 of 12 START sql view model main.mart_avg_age_by_practice ..................... [RUN]
[0m18:10:39.503236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_age_groups_by_pcn, now model.suvera.mart_avg_age_by_practice)
[0m18:10:39.503805 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_avg_age_by_practice
[0m18:10:39.508067 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_avg_age_by_practice"
[0m18:10:39.510023 [debug] [Thread-1 (]: Began executing node model.suvera.mart_avg_age_by_practice
[0m18:10:39.515694 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_avg_age_by_practice"
[0m18:10:39.516852 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:10:39.517437 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: BEGIN
[0m18:10:39.518062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:39.519171 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.519829 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:10:39.520520 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_avg_age_by_practice"} */

  
  create view "dev"."main"."mart_avg_age_by_practice__dbt_tmp" as (
    with patients as (
    select
        patient_id,
        practice_id,
        age
    from "dev"."main"."cleaned_patients"
),

aggregated as (
    select
        practice_id,
        avg(age) as avg_age,
        count(*) as num_patients
    from patients
    group by practice_id
)

select * from aggregated
order by avg_age desc
  );

[0m18:10:39.523462 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:10:39.529342 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:10:39.530071 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_avg_age_by_practice"} */
alter view "dev"."main"."mart_avg_age_by_practice" rename to "mart_avg_age_by_practice__dbt_backup"
[0m18:10:39.531195 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:39.537359 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:10:39.538203 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_avg_age_by_practice"} */
alter view "dev"."main"."mart_avg_age_by_practice__dbt_tmp" rename to "mart_avg_age_by_practice"
[0m18:10:39.539509 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.542101 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: COMMIT
[0m18:10:39.542970 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:10:39.543605 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: COMMIT
[0m18:10:39.544938 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.548706 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:10:39.549281 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_avg_age_by_practice"} */
drop view if exists "dev"."main"."mart_avg_age_by_practice__dbt_backup" cascade
[0m18:10:39.550688 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.552928 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: Close
[0m18:10:39.553755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3b182c9-7bdc-4c48-8942-ad8c4a979653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112275130>]}
[0m18:10:39.554655 [info ] [Thread-1 (]: 9 of 12 OK created sql view model main.mart_avg_age_by_practice ................ [[32mOK[0m in 0.05s]
[0m18:10:39.555562 [debug] [Thread-1 (]: Finished running node model.suvera.mart_avg_age_by_practice
[0m18:10:39.556170 [debug] [Thread-1 (]: Began running node model.suvera.mart_hypertension_pct_by_practice
[0m18:10:39.556860 [info ] [Thread-1 (]: 10 of 12 START sql view model main.mart_hypertension_pct_by_practice ........... [RUN]
[0m18:10:39.557588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_avg_age_by_practice, now model.suvera.mart_hypertension_pct_by_practice)
[0m18:10:39.558170 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_hypertension_pct_by_practice
[0m18:10:39.562912 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_hypertension_pct_by_practice"
[0m18:10:39.565306 [debug] [Thread-1 (]: Began executing node model.suvera.mart_hypertension_pct_by_practice
[0m18:10:39.570322 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_hypertension_pct_by_practice"
[0m18:10:39.571706 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:10:39.572281 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: BEGIN
[0m18:10:39.572804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:39.573686 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.574229 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:10:39.574818 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_hypertension_pct_by_practice"} */

  
  create view "dev"."main"."mart_hypertension_pct_by_practice__dbt_tmp" as (
    with patients as (
    select
        patient_id,
        practice_id,
        conditions
    from "dev"."main"."cleaned_patients"
),

exploded as (
    select
        patient_id,
        practice_id,
        unnest(conditions) as condition
    from patients
),

hypertension_counts as (
    select
        practice_id,
        count(distinct patient_id) as patients_with_hypertension
    from exploded
    where lower(condition) = 'hypertension'
    group by practice_id
),

total_patients as (
    select
        practice_id,
        count(distinct patient_id) as total_patients
    from patients
    group by practice_id
)

select
    t.practice_id,
    t.total_patients,
    coalesce(h.patients_with_hypertension, 0) as patients_with_hypertension,
    round(
        coalesce(h.patients_with_hypertension, 0) * 100.0 / t.total_patients,
        1
    ) as pct_with_hypertension
from total_patients t
left join hypertension_counts h
    on t.practice_id = h.practice_id
order by pct_with_hypertension desc
  );

[0m18:10:39.585111 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m18:10:39.594700 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:10:39.595470 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_hypertension_pct_by_practice"} */
alter view "dev"."main"."mart_hypertension_pct_by_practice" rename to "mart_hypertension_pct_by_practice__dbt_backup"
[0m18:10:39.596620 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.601248 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:10:39.601936 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_hypertension_pct_by_practice"} */
alter view "dev"."main"."mart_hypertension_pct_by_practice__dbt_tmp" rename to "mart_hypertension_pct_by_practice"
[0m18:10:39.603278 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.605677 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: COMMIT
[0m18:10:39.606263 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:10:39.606813 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: COMMIT
[0m18:10:39.608256 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.612234 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:10:39.612857 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_hypertension_pct_by_practice"} */
drop view if exists "dev"."main"."mart_hypertension_pct_by_practice__dbt_backup" cascade
[0m18:10:39.614188 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.616240 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: Close
[0m18:10:39.617019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3b182c9-7bdc-4c48-8942-ad8c4a979653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112275190>]}
[0m18:10:39.617900 [info ] [Thread-1 (]: 10 of 12 OK created sql view model main.mart_hypertension_pct_by_practice ...... [[32mOK[0m in 0.06s]
[0m18:10:39.618800 [debug] [Thread-1 (]: Finished running node model.suvera.mart_hypertension_pct_by_practice
[0m18:10:39.619504 [debug] [Thread-1 (]: Began running node model.suvera.mart_patient_count_by_pcn
[0m18:10:39.620202 [info ] [Thread-1 (]: 11 of 12 START sql view model main.mart_patient_count_by_pcn ................... [RUN]
[0m18:10:39.620863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_hypertension_pct_by_practice, now model.suvera.mart_patient_count_by_pcn)
[0m18:10:39.621422 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_patient_count_by_pcn
[0m18:10:39.625672 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_patient_count_by_pcn"
[0m18:10:39.626974 [debug] [Thread-1 (]: Began executing node model.suvera.mart_patient_count_by_pcn
[0m18:10:39.633057 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_patient_count_by_pcn"
[0m18:10:39.634193 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:10:39.634764 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: BEGIN
[0m18:10:39.635291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:39.636186 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.636828 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:10:39.637795 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patient_count_by_pcn"} */

  
  create view "dev"."main"."mart_patient_count_by_pcn__dbt_tmp" as (
    with patients as (
    select *
    from "dev"."main"."cleaned_patients"
),

practices as (
    select *
    from "dev"."main"."stg_practices"
),

pcns as (
    select *
    from "dev"."main"."stg_pcns"
),

joined as (
    select
        pcn.id as pcn_id,
        pcn.pcn_name pcn_name,
        patient.patient_id
    from patients as patient
    left join practices as practice
        on patient.practice_id = practice.id
    left join pcns as pcn
        on practice.pcn = pcn.id
)

select
    pcn_id,
    pcn_name,
    count(distinct patient_id) as num_patients
from joined
group by 1, 2
order by num_patients desc
  );

[0m18:10:39.641387 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:10:39.646526 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:10:39.647218 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patient_count_by_pcn"} */
alter view "dev"."main"."mart_patient_count_by_pcn" rename to "mart_patient_count_by_pcn__dbt_backup"
[0m18:10:39.648265 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:39.652431 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:10:39.653283 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patient_count_by_pcn"} */
alter view "dev"."main"."mart_patient_count_by_pcn__dbt_tmp" rename to "mart_patient_count_by_pcn"
[0m18:10:39.655154 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.657767 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: COMMIT
[0m18:10:39.658409 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:10:39.659026 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: COMMIT
[0m18:10:39.660481 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.668337 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:10:39.668965 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patient_count_by_pcn"} */
drop view if exists "dev"."main"."mart_patient_count_by_pcn__dbt_backup" cascade
[0m18:10:39.670398 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.672416 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: Close
[0m18:10:39.673174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3b182c9-7bdc-4c48-8942-ad8c4a979653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cd4fb0>]}
[0m18:10:39.674049 [info ] [Thread-1 (]: 11 of 12 OK created sql view model main.mart_patient_count_by_pcn .............. [[32mOK[0m in 0.05s]
[0m18:10:39.674922 [debug] [Thread-1 (]: Finished running node model.suvera.mart_patient_count_by_pcn
[0m18:10:39.675516 [debug] [Thread-1 (]: Began running node model.suvera.mart_recent_activity_by_patient
[0m18:10:39.676449 [info ] [Thread-1 (]: 12 of 12 START sql view model main.mart_recent_activity_by_patient ............. [RUN]
[0m18:10:39.677128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_patient_count_by_pcn, now model.suvera.mart_recent_activity_by_patient)
[0m18:10:39.677686 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_recent_activity_by_patient
[0m18:10:39.681677 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_recent_activity_by_patient"
[0m18:10:39.684015 [debug] [Thread-1 (]: Began executing node model.suvera.mart_recent_activity_by_patient
[0m18:10:39.689592 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_recent_activity_by_patient"
[0m18:10:39.690875 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:10:39.691609 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: BEGIN
[0m18:10:39.692230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:39.693479 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.694277 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:10:39.695503 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_recent_activity_by_patient"} */

  
  create view "dev"."main"."mart_recent_activity_by_patient__dbt_tmp" as (
    with patients as (
    select patient_id
    from "dev"."main"."cleaned_patients"
),

activities as (
    select
        patient_id,
        activity_date
    from "dev"."main"."stg_activities"
),

filtered as (
    select *
    from activities
    where patient_id in (select patient_id from patients)
)

select
    patient_id,
    max(activity_date) as most_recent_activity
from filtered
group by patient_id
  );

[0m18:10:39.700848 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:10:39.705684 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:10:39.706478 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_recent_activity_by_patient"} */
alter view "dev"."main"."mart_recent_activity_by_patient" rename to "mart_recent_activity_by_patient__dbt_backup"
[0m18:10:39.707518 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:39.711871 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:10:39.712550 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_recent_activity_by_patient"} */
alter view "dev"."main"."mart_recent_activity_by_patient__dbt_tmp" rename to "mart_recent_activity_by_patient"
[0m18:10:39.713584 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:39.716021 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: COMMIT
[0m18:10:39.716942 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:10:39.717657 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: COMMIT
[0m18:10:39.719224 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.723699 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:10:39.724384 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_recent_activity_by_patient"} */
drop view if exists "dev"."main"."mart_recent_activity_by_patient__dbt_backup" cascade
[0m18:10:39.725978 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:39.729104 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: Close
[0m18:10:39.729967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3b182c9-7bdc-4c48-8942-ad8c4a979653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d19670>]}
[0m18:10:39.730873 [info ] [Thread-1 (]: 12 of 12 OK created sql view model main.mart_recent_activity_by_patient ........ [[32mOK[0m in 0.05s]
[0m18:10:39.731811 [debug] [Thread-1 (]: Finished running node model.suvera.mart_recent_activity_by_patient
[0m18:10:39.733890 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:39.734417 [debug] [MainThread]: On master: BEGIN
[0m18:10:39.734865 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:10:39.735697 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:10:39.736193 [debug] [MainThread]: On master: COMMIT
[0m18:10:39.736664 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:39.737121 [debug] [MainThread]: On master: COMMIT
[0m18:10:39.738677 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:10:39.739529 [debug] [MainThread]: On master: Close
[0m18:10:39.740199 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:39.740642 [debug] [MainThread]: Connection 'model.suvera.mart_recent_activity_by_patient' was properly closed.
[0m18:10:39.741221 [info ] [MainThread]: 
[0m18:10:39.741793 [info ] [MainThread]: Finished running 12 view models in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m18:10:39.745442 [debug] [MainThread]: Command end result
[0m18:10:39.792237 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m18:10:39.795375 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m18:10:39.805762 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m18:10:39.806351 [info ] [MainThread]: 
[0m18:10:39.806932 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:10:39.807440 [info ] [MainThread]: 
[0m18:10:39.807982 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m18:10:39.812965 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.8753748, "process_in_blocks": "0", "process_kernel_time": 0.662202, "process_mem_max_rss": "139681792", "process_out_blocks": "0", "process_user_time": 4.788509}
[0m18:10:39.813959 [debug] [MainThread]: Command `dbt run` succeeded at 18:10:39.813766 after 2.88 seconds
[0m18:10:39.814654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fceab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127e1670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127e0c50>]}
[0m18:10:39.815293 [debug] [MainThread]: Flushing usage events
[0m18:10:40.322226 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:13:19.555694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a95d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058ab610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058ab750>]}


============================== 18:13:19.567235 | c67c8955-82db-4503-a68b-37ef3d23f3a3 ==============================
[0m18:13:19.567235 [info ] [MainThread]: Running with dbt=1.10.1
[0m18:13:19.568539 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:13:20.268538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c67c8955-82db-4503-a68b-37ef3d23f3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d79220>]}
[0m18:13:20.420650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c67c8955-82db-4503-a68b-37ef3d23f3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105797350>]}
[0m18:13:20.445196 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m18:13:20.729304 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m18:13:21.117233 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:13:21.118264 [debug] [MainThread]: Partial parsing: updated file: suvera://models/intermediate/cleaned_patients.sql
[0m18:13:21.993023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c67c8955-82db-4503-a68b-37ef3d23f3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10604c350>]}
[0m18:13:22.165311 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m18:13:22.169364 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m18:13:22.207362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c67c8955-82db-4503-a68b-37ef3d23f3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b86d50>]}
[0m18:13:22.208107 [info ] [MainThread]: Found 12 models, 4 seeds, 12 data tests, 544 macros
[0m18:13:22.208690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c67c8955-82db-4503-a68b-37ef3d23f3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10613c590>]}
[0m18:13:22.212438 [info ] [MainThread]: 
[0m18:13:22.213141 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:13:22.213670 [info ] [MainThread]: 
[0m18:13:22.214953 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:13:22.226754 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m18:13:22.328400 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m18:13:22.329029 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m18:13:22.329580 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:22.363109 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m18:13:22.366304 [debug] [ThreadPool]: On list_dev: Close
[0m18:13:22.367743 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m18:13:22.368868 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m18:13:22.378793 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:13:22.379398 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m18:13:22.379878 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:22.382354 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:13:22.385144 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:13:22.385676 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m18:13:22.386450 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:13:22.386945 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:13:22.387404 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m18:13:22.391105 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:13:22.392534 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m18:13:22.393065 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:13:22.393549 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m18:13:22.394325 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:13:22.394841 [debug] [ThreadPool]: On create_dev_main: Close
[0m18:13:22.399900 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m18:13:22.488525 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m18:13:22.489091 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m18:13:22.489545 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:22.490483 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:13:22.490980 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m18:13:22.491465 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m18:13:22.532012 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m18:13:22.534736 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m18:13:22.536460 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m18:13:22.537009 [debug] [ThreadPool]: On list_dev_main: Close
[0m18:13:22.542295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c67c8955-82db-4503-a68b-37ef3d23f3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106097ee0>]}
[0m18:13:22.543063 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:22.543574 [debug] [MainThread]: On master: BEGIN
[0m18:13:22.544029 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:13:22.544887 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:13:22.545393 [debug] [MainThread]: On master: COMMIT
[0m18:13:22.545883 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:22.546341 [debug] [MainThread]: On master: COMMIT
[0m18:13:22.547094 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:13:22.547609 [debug] [MainThread]: On master: Close
[0m18:13:22.550969 [debug] [Thread-1 (]: Began running node model.suvera.stg_activities
[0m18:13:22.551846 [info ] [Thread-1 (]: 1 of 12 START sql view model main.stg_activities ............................... [RUN]
[0m18:13:22.553021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.stg_activities)
[0m18:13:22.554209 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_activities
[0m18:13:22.572094 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_activities"
[0m18:13:22.573689 [debug] [Thread-1 (]: Began executing node model.suvera.stg_activities
[0m18:13:22.629103 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_activities"
[0m18:13:22.630268 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:13:22.630925 [debug] [Thread-1 (]: On model.suvera.stg_activities: BEGIN
[0m18:13:22.631460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:22.632403 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:22.633053 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:13:22.633611 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */

  
  create view "dev"."main"."stg_activities__dbt_tmp" as (
    select * 
from "dev"."main"."raw_activities"
limit 100
  );

[0m18:13:22.635442 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:22.645635 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:13:22.646312 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
alter view "dev"."main"."stg_activities" rename to "stg_activities__dbt_backup"
[0m18:13:22.648895 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:13:22.653323 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:13:22.653986 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
alter view "dev"."main"."stg_activities__dbt_tmp" rename to "stg_activities"
[0m18:13:22.655074 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:13:22.675213 [debug] [Thread-1 (]: On model.suvera.stg_activities: COMMIT
[0m18:13:22.675932 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:13:22.676554 [debug] [Thread-1 (]: On model.suvera.stg_activities: COMMIT
[0m18:13:22.680150 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:13:22.688078 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:13:22.688731 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
drop view if exists "dev"."main"."stg_activities__dbt_backup" cascade
[0m18:13:22.691214 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:13:22.695103 [debug] [Thread-1 (]: On model.suvera.stg_activities: Close
[0m18:13:22.698247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c67c8955-82db-4503-a68b-37ef3d23f3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10630e510>]}
[0m18:13:22.699298 [info ] [Thread-1 (]: 1 of 12 OK created sql view model main.stg_activities .......................... [[32mOK[0m in 0.14s]
[0m18:13:22.700317 [debug] [Thread-1 (]: Finished running node model.suvera.stg_activities
[0m18:13:22.700960 [debug] [Thread-1 (]: Began running node model.suvera.stg_patients
[0m18:13:22.701688 [info ] [Thread-1 (]: 2 of 12 START sql view model main.stg_patients ................................. [RUN]
[0m18:13:22.702531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_activities, now model.suvera.stg_patients)
[0m18:13:22.703250 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_patients
[0m18:13:22.707316 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_patients"
[0m18:13:22.709809 [debug] [Thread-1 (]: Began executing node model.suvera.stg_patients
[0m18:13:22.718466 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_patients"
[0m18:13:22.719560 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:13:22.720123 [debug] [Thread-1 (]: On model.suvera.stg_patients: BEGIN
[0m18:13:22.720773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:22.721683 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:22.722251 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:13:22.722858 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */

  
  create view "dev"."main"."stg_patients__dbt_tmp" as (
    with source as (
    select * from "dev"."main"."raw_patients"
),

parsed as (
    select
        case
            when regexp_extract(data, '"patient_id": ([0-9]+)', 1) ~ '^[0-9]+$'
            then cast(regexp_extract(data, '"patient_id": ([0-9]+)', 1) as integer)
        end as patient_id,
        case
            when regexp_extract(data, '"practice_id": ([0-9]+)', 1) ~ '^[0-9]+$'
            then cast(regexp_extract(data, '"practice_id": ([0-9]+)', 1) as integer)
        end as practice_id,
        case
            when regexp_extract(data, '"age": ([0-9]+)', 1) ~ '^[0-9]+$'
            then cast(regexp_extract(data, '"age": ([0-9]+)', 1) as integer)
        end as age,
        regexp_extract(data, '"gender": "([^""]*)"', 1) as gender,
        cast(nullif(regexp_extract(data, '"registration_date": "([^"]+)"', 1), '') as date) as registration_date,
        regexp_extract(data, '"email": "([^"]+)"', 1) as email,
        regexp_extract(data, '"phone": "([^"]+)"', 1) as phone,
        string_split(
            replace(
                regexp_extract(data, '"conditions": \[(.*?)\]', 1),
                '"',
                ''
            ),
            ', '
        ) as conditions
    from source
)

select * from parsed
  );

[0m18:13:22.725901 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:13:22.730940 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:13:22.731601 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients" rename to "stg_patients__dbt_backup"
[0m18:13:22.732707 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:22.736731 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:13:22.737310 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m18:13:22.738305 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:13:22.740798 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m18:13:22.741418 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:13:22.741953 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m18:13:22.743281 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:22.747093 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:13:22.747790 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
drop view if exists "dev"."main"."stg_patients__dbt_backup" cascade
[0m18:13:22.749422 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:22.751494 [debug] [Thread-1 (]: On model.suvera.stg_patients: Close
[0m18:13:22.752331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c67c8955-82db-4503-a68b-37ef3d23f3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060a6c50>]}
[0m18:13:22.753248 [info ] [Thread-1 (]: 2 of 12 OK created sql view model main.stg_patients ............................ [[32mOK[0m in 0.05s]
[0m18:13:22.754237 [debug] [Thread-1 (]: Finished running node model.suvera.stg_patients
[0m18:13:22.754871 [debug] [Thread-1 (]: Began running node model.suvera.stg_pcns
[0m18:13:22.755681 [info ] [Thread-1 (]: 3 of 12 START sql view model main.stg_pcns ..................................... [RUN]
[0m18:13:22.756696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_patients, now model.suvera.stg_pcns)
[0m18:13:22.757333 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_pcns
[0m18:13:22.763686 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_pcns"
[0m18:13:22.765673 [debug] [Thread-1 (]: Began executing node model.suvera.stg_pcns
[0m18:13:22.775012 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_pcns"
[0m18:13:22.777170 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:13:22.778567 [debug] [Thread-1 (]: On model.suvera.stg_pcns: BEGIN
[0m18:13:22.779677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:22.781276 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:13:22.781937 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:13:22.782532 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */

  
  create view "dev"."main"."stg_pcns__dbt_tmp" as (
    select * 
from "dev"."main"."raw_pcns"
  );

[0m18:13:22.784066 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:22.788518 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:13:22.789149 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */
alter view "dev"."main"."stg_pcns" rename to "stg_pcns__dbt_backup"
[0m18:13:22.790142 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:13:22.794953 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:13:22.795581 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */
alter view "dev"."main"."stg_pcns__dbt_tmp" rename to "stg_pcns"
[0m18:13:22.797172 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:13:22.799772 [debug] [Thread-1 (]: On model.suvera.stg_pcns: COMMIT
[0m18:13:22.800720 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:13:22.801278 [debug] [Thread-1 (]: On model.suvera.stg_pcns: COMMIT
[0m18:13:22.802449 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:22.805614 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:13:22.806187 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */
drop view if exists "dev"."main"."stg_pcns__dbt_backup" cascade
[0m18:13:22.807492 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:22.809657 [debug] [Thread-1 (]: On model.suvera.stg_pcns: Close
[0m18:13:22.810478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c67c8955-82db-4503-a68b-37ef3d23f3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e177f0>]}
[0m18:13:22.811387 [info ] [Thread-1 (]: 3 of 12 OK created sql view model main.stg_pcns ................................ [[32mOK[0m in 0.05s]
[0m18:13:22.812304 [debug] [Thread-1 (]: Finished running node model.suvera.stg_pcns
[0m18:13:22.812930 [debug] [Thread-1 (]: Began running node model.suvera.stg_practices
[0m18:13:22.813789 [info ] [Thread-1 (]: 4 of 12 START sql view model main.stg_practices ................................ [RUN]
[0m18:13:22.814543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_pcns, now model.suvera.stg_practices)
[0m18:13:22.815130 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_practices
[0m18:13:22.818765 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_practices"
[0m18:13:22.820304 [debug] [Thread-1 (]: Began executing node model.suvera.stg_practices
[0m18:13:22.830185 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_practices"
[0m18:13:22.831316 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:13:22.831898 [debug] [Thread-1 (]: On model.suvera.stg_practices: BEGIN
[0m18:13:22.832428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:22.833392 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:22.834011 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:13:22.834832 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */

  
  create view "dev"."main"."stg_practices__dbt_tmp" as (
    select * 
from "dev"."main"."raw_practices"
  );

[0m18:13:22.836235 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:22.840620 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:13:22.841666 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */
alter view "dev"."main"."stg_practices" rename to "stg_practices__dbt_backup"
[0m18:13:22.842940 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:13:22.847509 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:13:22.848109 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */
alter view "dev"."main"."stg_practices__dbt_tmp" rename to "stg_practices"
[0m18:13:22.849106 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:13:22.851952 [debug] [Thread-1 (]: On model.suvera.stg_practices: COMMIT
[0m18:13:22.852964 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:13:22.853821 [debug] [Thread-1 (]: On model.suvera.stg_practices: COMMIT
[0m18:13:22.855382 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:22.858828 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:13:22.859555 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */
drop view if exists "dev"."main"."stg_practices__dbt_backup" cascade
[0m18:13:22.860833 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:22.862962 [debug] [Thread-1 (]: On model.suvera.stg_practices: Close
[0m18:13:22.863811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c67c8955-82db-4503-a68b-37ef3d23f3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ab5d50>]}
[0m18:13:22.864744 [info ] [Thread-1 (]: 4 of 12 OK created sql view model main.stg_practices ........................... [[32mOK[0m in 0.05s]
[0m18:13:22.865674 [debug] [Thread-1 (]: Finished running node model.suvera.stg_practices
[0m18:13:22.866357 [debug] [Thread-1 (]: Began running node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:13:22.867243 [info ] [Thread-1 (]: 5 of 12 START sql view model main.mart_patients_inactive_3_months_after_first .. [RUN]
[0m18:13:22.868259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_practices, now model.suvera.mart_patients_inactive_3_months_after_first)
[0m18:13:22.868896 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:13:22.873536 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:13:22.875047 [debug] [Thread-1 (]: Began executing node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:13:22.882641 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:13:22.883796 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:13:22.884440 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: BEGIN
[0m18:13:22.885406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:22.886556 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:22.887229 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:13:22.887936 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */

  
  create view "dev"."main"."mart_patients_inactive_3_months_after_first__dbt_tmp" as (
    with activities as (
    select
        patient_id,
        activity_date
    from "dev"."main"."stg_activities"
),

first_activity as (
    select
        patient_id,
        min(activity_date) as first_date
    from activities
    group by patient_id
),

follow_up_activity as (
    select
        a.patient_id
    from activities a
    join first_activity f
        on a.patient_id = f.patient_id
    where a.activity_date > f.first_date
      and a.activity_date <= f.first_date + interval '90 days'
),

inactive_patients as (
    select
        f.patient_id,
        f.first_date
    from first_activity f
    left join follow_up_activity fu
        on f.patient_id = fu.patient_id
    where fu.patient_id is null
)

select *
from inactive_patients
  );

[0m18:13:22.893610 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:13:22.897902 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:13:22.898511 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */
alter view "dev"."main"."mart_patients_inactive_3_months_after_first" rename to "mart_patients_inactive_3_months_after_first__dbt_backup"
[0m18:13:22.899516 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:13:22.904672 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:13:22.905316 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */
alter view "dev"."main"."mart_patients_inactive_3_months_after_first__dbt_tmp" rename to "mart_patients_inactive_3_months_after_first"
[0m18:13:22.906532 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:22.909023 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: COMMIT
[0m18:13:22.909670 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:13:22.910228 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: COMMIT
[0m18:13:22.911540 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:22.914756 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:13:22.915358 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */
drop view if exists "dev"."main"."mart_patients_inactive_3_months_after_first__dbt_backup" cascade
[0m18:13:22.916694 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:22.918771 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: Close
[0m18:13:22.919595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c67c8955-82db-4503-a68b-37ef3d23f3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de7e70>]}
[0m18:13:22.920536 [info ] [Thread-1 (]: 5 of 12 OK created sql view model main.mart_patients_inactive_3_months_after_first  [[32mOK[0m in 0.05s]
[0m18:13:22.921545 [debug] [Thread-1 (]: Finished running node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:13:22.922195 [debug] [Thread-1 (]: Began running node model.suvera.cleaned_patients
[0m18:13:22.922917 [info ] [Thread-1 (]: 6 of 12 START sql view model main.cleaned_patients ............................. [RUN]
[0m18:13:22.923820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_patients_inactive_3_months_after_first, now model.suvera.cleaned_patients)
[0m18:13:22.924483 [debug] [Thread-1 (]: Began compiling node model.suvera.cleaned_patients
[0m18:13:22.928419 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.cleaned_patients"
[0m18:13:22.929994 [debug] [Thread-1 (]: Began executing node model.suvera.cleaned_patients
[0m18:13:22.943485 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.cleaned_patients"
[0m18:13:22.945108 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:13:22.946015 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: BEGIN
[0m18:13:22.946685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:22.947947 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:22.948605 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:13:22.949365 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */

  
  create view "dev"."main"."cleaned_patients__dbt_tmp" as (
    with deduplicated as (
    select *
    from (
        select *,
               row_number() over (
                   partition by patient_id, practice_id
                   order by registration_date desc
               ) as row_num
        from "dev"."main"."stg_patients"
    )
    where row_num = 1
),

filtered as (
    select *
    from deduplicated
    where age between 0 and 120 and practice_id between 1 and 5 and age != 999
)

select
    patient_id,
    practice_id,
    age,
    gender,
    registration_date,
    email,
    phone,
    conditions
from filtered
  );

[0m18:13:22.954254 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:13:22.960499 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:13:22.961484 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */
alter view "dev"."main"."cleaned_patients" rename to "cleaned_patients__dbt_backup"
[0m18:13:22.963069 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:22.969652 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:13:22.970637 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */
alter view "dev"."main"."cleaned_patients__dbt_tmp" rename to "cleaned_patients"
[0m18:13:22.971762 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:13:22.974276 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: COMMIT
[0m18:13:22.974916 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:13:22.975477 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: COMMIT
[0m18:13:22.976856 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:22.980171 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:13:22.980855 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */
drop view if exists "dev"."main"."cleaned_patients__dbt_backup" cascade
[0m18:13:22.982174 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:22.984223 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: Close
[0m18:13:22.985015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c67c8955-82db-4503-a68b-37ef3d23f3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058c0350>]}
[0m18:13:22.985912 [info ] [Thread-1 (]: 6 of 12 OK created sql view model main.cleaned_patients ........................ [[32mOK[0m in 0.06s]
[0m18:13:22.986819 [debug] [Thread-1 (]: Finished running node model.suvera.cleaned_patients
[0m18:13:22.987427 [debug] [Thread-1 (]: Began running node model.suvera.qa_flagged_patients
[0m18:13:22.988124 [info ] [Thread-1 (]: 7 of 12 START sql view model main.qa_flagged_patients .......................... [RUN]
[0m18:13:22.988913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.cleaned_patients, now model.suvera.qa_flagged_patients)
[0m18:13:22.989739 [debug] [Thread-1 (]: Began compiling node model.suvera.qa_flagged_patients
[0m18:13:22.994548 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.qa_flagged_patients"
[0m18:13:22.998701 [debug] [Thread-1 (]: Began executing node model.suvera.qa_flagged_patients
[0m18:13:23.004526 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.qa_flagged_patients"
[0m18:13:23.005637 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:13:23.006218 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: BEGIN
[0m18:13:23.006912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:23.007936 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:23.009168 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:13:23.010631 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */

  
  create view "dev"."main"."qa_flagged_patients__dbt_tmp" as (
    with source as (
    select *
    from "dev"."main"."stg_patients"
),

deduplicated as (
    select *
    from (
        select *,
               row_number() over (
                   partition by patient_id, practice_id
                   order by registration_date desc
               ) as row_num
        from source
    )
),

filtered_out as (
    select *
    from deduplicated
    where row_num > 1
       or try_cast(age as integer) not between 0 and 120
)

select * from filtered_out
  );

[0m18:13:23.013621 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:13:23.020440 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:13:23.021286 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */
alter view "dev"."main"."qa_flagged_patients" rename to "qa_flagged_patients__dbt_backup"
[0m18:13:23.022563 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:23.028128 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:13:23.028773 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */
alter view "dev"."main"."qa_flagged_patients__dbt_tmp" rename to "qa_flagged_patients"
[0m18:13:23.029811 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:13:23.032265 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: COMMIT
[0m18:13:23.032902 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:13:23.033445 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: COMMIT
[0m18:13:23.034702 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:23.038099 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:13:23.038715 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */
drop view if exists "dev"."main"."qa_flagged_patients__dbt_backup" cascade
[0m18:13:23.040063 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:23.042386 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: Close
[0m18:13:23.043386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c67c8955-82db-4503-a68b-37ef3d23f3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059c22d0>]}
[0m18:13:23.044505 [info ] [Thread-1 (]: 7 of 12 OK created sql view model main.qa_flagged_patients ..................... [[32mOK[0m in 0.05s]
[0m18:13:23.045899 [debug] [Thread-1 (]: Finished running node model.suvera.qa_flagged_patients
[0m18:13:23.046843 [debug] [Thread-1 (]: Began running node model.suvera.mart_age_groups_by_pcn
[0m18:13:23.047861 [info ] [Thread-1 (]: 8 of 12 START sql view model main.mart_age_groups_by_pcn ....................... [RUN]
[0m18:13:23.048953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.qa_flagged_patients, now model.suvera.mart_age_groups_by_pcn)
[0m18:13:23.049574 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_age_groups_by_pcn
[0m18:13:23.055564 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_age_groups_by_pcn"
[0m18:13:23.056892 [debug] [Thread-1 (]: Began executing node model.suvera.mart_age_groups_by_pcn
[0m18:13:23.063044 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_age_groups_by_pcn"
[0m18:13:23.064516 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:13:23.065108 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: BEGIN
[0m18:13:23.065646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:23.066575 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:23.067143 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:13:23.067810 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_age_groups_by_pcn"} */

  
  create view "dev"."main"."mart_age_groups_by_pcn__dbt_tmp" as (
    with patients as (
    select
        patient_id,
        practice_id,
        age,
        case
            when age between 0 and 18 then '0-18'
            when age between 19 and 35 then '19-35'
            when age between 36 and 50 then '36-50'
            when age >= 51 then '51+'
            else 'Unknown'
        end as age_group
    from "dev"."main"."cleaned_patients"
),

practices as (
    select *
    from "dev"."main"."stg_practices"
),

pcns as (
    select *
    from "dev"."main"."stg_pcns"
),

joined as (
    select
        pcn.id as pcn_id,
        pcn.pcn_name,
        p.age_group
    from patients as p
    left join practices pr on p.practice_id = pr.id
    left join pcns pcn on pr.pcn = pcn.id
)

select
    pcn_id,
    pcn_name,
    age_group,
    count(*) as num_patients
from joined
group by pcn_id, pcn_name, age_group
order by pcn_id, age_group
  );

[0m18:13:23.072898 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:13:23.080440 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:13:23.081388 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_age_groups_by_pcn"} */
alter view "dev"."main"."mart_age_groups_by_pcn" rename to "mart_age_groups_by_pcn__dbt_backup"
[0m18:13:23.083119 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:23.089080 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:13:23.089754 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_age_groups_by_pcn"} */
alter view "dev"."main"."mart_age_groups_by_pcn__dbt_tmp" rename to "mart_age_groups_by_pcn"
[0m18:13:23.090984 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:13:23.093487 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: COMMIT
[0m18:13:23.094172 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:13:23.094787 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: COMMIT
[0m18:13:23.096213 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:23.099546 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:13:23.100187 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_age_groups_by_pcn"} */
drop view if exists "dev"."main"."mart_age_groups_by_pcn__dbt_backup" cascade
[0m18:13:23.101466 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:23.103820 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: Close
[0m18:13:23.104713 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c67c8955-82db-4503-a68b-37ef3d23f3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f64bf0>]}
[0m18:13:23.105766 [info ] [Thread-1 (]: 8 of 12 OK created sql view model main.mart_age_groups_by_pcn .................. [[32mOK[0m in 0.06s]
[0m18:13:23.106925 [debug] [Thread-1 (]: Finished running node model.suvera.mart_age_groups_by_pcn
[0m18:13:23.107597 [debug] [Thread-1 (]: Began running node model.suvera.mart_avg_age_by_practice
[0m18:13:23.108408 [info ] [Thread-1 (]: 9 of 12 START sql view model main.mart_avg_age_by_practice ..................... [RUN]
[0m18:13:23.109150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_age_groups_by_pcn, now model.suvera.mart_avg_age_by_practice)
[0m18:13:23.109731 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_avg_age_by_practice
[0m18:13:23.114431 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_avg_age_by_practice"
[0m18:13:23.115872 [debug] [Thread-1 (]: Began executing node model.suvera.mart_avg_age_by_practice
[0m18:13:23.120763 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_avg_age_by_practice"
[0m18:13:23.122258 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:13:23.122918 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: BEGIN
[0m18:13:23.123457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:23.124489 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:23.125238 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:13:23.126382 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_avg_age_by_practice"} */

  
  create view "dev"."main"."mart_avg_age_by_practice__dbt_tmp" as (
    with patients as (
    select
        patient_id,
        practice_id,
        age
    from "dev"."main"."cleaned_patients"
),

aggregated as (
    select
        practice_id,
        avg(age) as avg_age,
        count(*) as num_patients
    from patients
    group by practice_id
)

select * from aggregated
order by avg_age desc
  );

[0m18:13:23.129906 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:13:23.136779 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:13:23.137809 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_avg_age_by_practice"} */
alter view "dev"."main"."mart_avg_age_by_practice" rename to "mart_avg_age_by_practice__dbt_backup"
[0m18:13:23.140135 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:23.145999 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:13:23.146646 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_avg_age_by_practice"} */
alter view "dev"."main"."mart_avg_age_by_practice__dbt_tmp" rename to "mart_avg_age_by_practice"
[0m18:13:23.147817 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:23.150300 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: COMMIT
[0m18:13:23.150935 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:13:23.151495 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: COMMIT
[0m18:13:23.152816 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:23.157423 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:13:23.158106 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_avg_age_by_practice"} */
drop view if exists "dev"."main"."mart_avg_age_by_practice__dbt_backup" cascade
[0m18:13:23.159557 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:23.161807 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: Close
[0m18:13:23.162726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c67c8955-82db-4503-a68b-37ef3d23f3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f64110>]}
[0m18:13:23.163741 [info ] [Thread-1 (]: 9 of 12 OK created sql view model main.mart_avg_age_by_practice ................ [[32mOK[0m in 0.05s]
[0m18:13:23.165680 [debug] [Thread-1 (]: Finished running node model.suvera.mart_avg_age_by_practice
[0m18:13:23.166872 [debug] [Thread-1 (]: Began running node model.suvera.mart_hypertension_pct_by_practice
[0m18:13:23.168240 [info ] [Thread-1 (]: 10 of 12 START sql view model main.mart_hypertension_pct_by_practice ........... [RUN]
[0m18:13:23.169484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_avg_age_by_practice, now model.suvera.mart_hypertension_pct_by_practice)
[0m18:13:23.170434 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_hypertension_pct_by_practice
[0m18:13:23.176577 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_hypertension_pct_by_practice"
[0m18:13:23.178236 [debug] [Thread-1 (]: Began executing node model.suvera.mart_hypertension_pct_by_practice
[0m18:13:23.183144 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_hypertension_pct_by_practice"
[0m18:13:23.184655 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:13:23.185272 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: BEGIN
[0m18:13:23.185809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:23.186719 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:23.187284 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:13:23.187885 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_hypertension_pct_by_practice"} */

  
  create view "dev"."main"."mart_hypertension_pct_by_practice__dbt_tmp" as (
    with patients as (
    select
        patient_id,
        practice_id,
        conditions
    from "dev"."main"."cleaned_patients"
),

exploded as (
    select
        patient_id,
        practice_id,
        unnest(conditions) as condition
    from patients
),

hypertension_counts as (
    select
        practice_id,
        count(distinct patient_id) as patients_with_hypertension
    from exploded
    where lower(condition) = 'hypertension'
    group by practice_id
),

total_patients as (
    select
        practice_id,
        count(distinct patient_id) as total_patients
    from patients
    group by practice_id
)

select
    t.practice_id,
    t.total_patients,
    coalesce(h.patients_with_hypertension, 0) as patients_with_hypertension,
    round(
        coalesce(h.patients_with_hypertension, 0) * 100.0 / t.total_patients,
        1
    ) as pct_with_hypertension
from total_patients t
left join hypertension_counts h
    on t.practice_id = h.practice_id
order by pct_with_hypertension desc
  );

[0m18:13:23.195186 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m18:13:23.200922 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:13:23.201601 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_hypertension_pct_by_practice"} */
alter view "dev"."main"."mart_hypertension_pct_by_practice" rename to "mart_hypertension_pct_by_practice__dbt_backup"
[0m18:13:23.202660 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:13:23.207888 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:13:23.208548 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_hypertension_pct_by_practice"} */
alter view "dev"."main"."mart_hypertension_pct_by_practice__dbt_tmp" rename to "mart_hypertension_pct_by_practice"
[0m18:13:23.209636 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:13:23.212012 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: COMMIT
[0m18:13:23.212614 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:13:23.213164 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: COMMIT
[0m18:13:23.214516 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:23.218836 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:13:23.219615 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_hypertension_pct_by_practice"} */
drop view if exists "dev"."main"."mart_hypertension_pct_by_practice__dbt_backup" cascade
[0m18:13:23.221471 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:23.224691 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: Close
[0m18:13:23.225827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c67c8955-82db-4503-a68b-37ef3d23f3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dc21b0>]}
[0m18:13:23.227043 [info ] [Thread-1 (]: 10 of 12 OK created sql view model main.mart_hypertension_pct_by_practice ...... [[32mOK[0m in 0.06s]
[0m18:13:23.228963 [debug] [Thread-1 (]: Finished running node model.suvera.mart_hypertension_pct_by_practice
[0m18:13:23.229679 [debug] [Thread-1 (]: Began running node model.suvera.mart_patient_count_by_pcn
[0m18:13:23.230535 [info ] [Thread-1 (]: 11 of 12 START sql view model main.mart_patient_count_by_pcn ................... [RUN]
[0m18:13:23.231500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_hypertension_pct_by_practice, now model.suvera.mart_patient_count_by_pcn)
[0m18:13:23.232168 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_patient_count_by_pcn
[0m18:13:23.236923 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_patient_count_by_pcn"
[0m18:13:23.238097 [debug] [Thread-1 (]: Began executing node model.suvera.mart_patient_count_by_pcn
[0m18:13:23.244904 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_patient_count_by_pcn"
[0m18:13:23.246205 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:13:23.246851 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: BEGIN
[0m18:13:23.247423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:23.248591 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:23.249323 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:13:23.250081 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patient_count_by_pcn"} */

  
  create view "dev"."main"."mart_patient_count_by_pcn__dbt_tmp" as (
    with patients as (
    select *
    from "dev"."main"."cleaned_patients"
),

practices as (
    select *
    from "dev"."main"."stg_practices"
),

pcns as (
    select *
    from "dev"."main"."stg_pcns"
),

joined as (
    select
        pcn.id as pcn_id,
        pcn.pcn_name pcn_name,
        patient.patient_id
    from patients as patient
    left join practices as practice
        on patient.practice_id = practice.id
    left join pcns as pcn
        on practice.pcn = pcn.id
)

select
    pcn_id,
    pcn_name,
    count(distinct patient_id) as num_patients
from joined
group by 1, 2
order by num_patients desc
  );

[0m18:13:23.255107 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:13:23.260903 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:13:23.261556 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patient_count_by_pcn"} */
alter view "dev"."main"."mart_patient_count_by_pcn" rename to "mart_patient_count_by_pcn__dbt_backup"
[0m18:13:23.262568 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:13:23.266562 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:13:23.267145 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patient_count_by_pcn"} */
alter view "dev"."main"."mart_patient_count_by_pcn__dbt_tmp" rename to "mart_patient_count_by_pcn"
[0m18:13:23.268105 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:13:23.270468 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: COMMIT
[0m18:13:23.271061 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:13:23.271613 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: COMMIT
[0m18:13:23.273181 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:23.282435 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:13:23.283114 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patient_count_by_pcn"} */
drop view if exists "dev"."main"."mart_patient_count_by_pcn__dbt_backup" cascade
[0m18:13:23.284393 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:23.286487 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: Close
[0m18:13:23.287276 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c67c8955-82db-4503-a68b-37ef3d23f3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058c05f0>]}
[0m18:13:23.288181 [info ] [Thread-1 (]: 11 of 12 OK created sql view model main.mart_patient_count_by_pcn .............. [[32mOK[0m in 0.06s]
[0m18:13:23.289103 [debug] [Thread-1 (]: Finished running node model.suvera.mart_patient_count_by_pcn
[0m18:13:23.289862 [debug] [Thread-1 (]: Began running node model.suvera.mart_recent_activity_by_patient
[0m18:13:23.290602 [info ] [Thread-1 (]: 12 of 12 START sql view model main.mart_recent_activity_by_patient ............. [RUN]
[0m18:13:23.291478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_patient_count_by_pcn, now model.suvera.mart_recent_activity_by_patient)
[0m18:13:23.292101 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_recent_activity_by_patient
[0m18:13:23.297061 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_recent_activity_by_patient"
[0m18:13:23.298466 [debug] [Thread-1 (]: Began executing node model.suvera.mart_recent_activity_by_patient
[0m18:13:23.304427 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_recent_activity_by_patient"
[0m18:13:23.305588 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:13:23.306550 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: BEGIN
[0m18:13:23.307288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:23.308702 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:23.309691 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:13:23.310830 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_recent_activity_by_patient"} */

  
  create view "dev"."main"."mart_recent_activity_by_patient__dbt_tmp" as (
    with patients as (
    select patient_id
    from "dev"."main"."cleaned_patients"
),

activities as (
    select
        patient_id,
        activity_date
    from "dev"."main"."stg_activities"
),

filtered as (
    select *
    from activities
    where patient_id in (select patient_id from patients)
)

select
    patient_id,
    max(activity_date) as most_recent_activity
from filtered
group by patient_id
  );

[0m18:13:23.315367 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:13:23.322168 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:13:23.323720 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_recent_activity_by_patient"} */
alter view "dev"."main"."mart_recent_activity_by_patient" rename to "mart_recent_activity_by_patient__dbt_backup"
[0m18:13:23.325468 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:23.330769 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:13:23.331460 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_recent_activity_by_patient"} */
alter view "dev"."main"."mart_recent_activity_by_patient__dbt_tmp" rename to "mart_recent_activity_by_patient"
[0m18:13:23.332500 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:13:23.334826 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: COMMIT
[0m18:13:23.335414 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:13:23.335949 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: COMMIT
[0m18:13:23.337142 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:23.341040 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:13:23.341702 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_recent_activity_by_patient"} */
drop view if exists "dev"."main"."mart_recent_activity_by_patient__dbt_backup" cascade
[0m18:13:23.343073 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:23.345178 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: Close
[0m18:13:23.346010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c67c8955-82db-4503-a68b-37ef3d23f3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dc1df0>]}
[0m18:13:23.346944 [info ] [Thread-1 (]: 12 of 12 OK created sql view model main.mart_recent_activity_by_patient ........ [[32mOK[0m in 0.05s]
[0m18:13:23.347889 [debug] [Thread-1 (]: Finished running node model.suvera.mart_recent_activity_by_patient
[0m18:13:23.349691 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:23.350229 [debug] [MainThread]: On master: BEGIN
[0m18:13:23.350688 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:13:23.351530 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:13:23.352218 [debug] [MainThread]: On master: COMMIT
[0m18:13:23.352781 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:23.353317 [debug] [MainThread]: On master: COMMIT
[0m18:13:23.354156 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:13:23.354677 [debug] [MainThread]: On master: Close
[0m18:13:23.355497 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:23.356279 [debug] [MainThread]: Connection 'model.suvera.mart_recent_activity_by_patient' was properly closed.
[0m18:13:23.357702 [info ] [MainThread]: 
[0m18:13:23.358715 [info ] [MainThread]: Finished running 12 view models in 0 hours 0 minutes and 1.14 seconds (1.14s).
[0m18:13:23.363329 [debug] [MainThread]: Command end result
[0m18:13:23.410198 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m18:13:23.413229 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m18:13:23.425122 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m18:13:23.425746 [info ] [MainThread]: 
[0m18:13:23.426527 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:13:23.427068 [info ] [MainThread]: 
[0m18:13:23.427609 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m18:13:23.431700 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.004614, "process_in_blocks": "0", "process_kernel_time": 0.895142, "process_mem_max_rss": "139300864", "process_out_blocks": "0", "process_user_time": 5.587307}
[0m18:13:23.432682 [debug] [MainThread]: Command `dbt run` succeeded at 18:13:23.432474 after 4.01 seconds
[0m18:13:23.433325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d34d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058c05f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a07710>]}
[0m18:13:23.434196 [debug] [MainThread]: Flushing usage events
[0m18:13:23.988331 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:28:11.358133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ca9d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105abf610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105abf750>]}


============================== 18:28:11.369225 | f8c92b7b-6da1-4687-a215-a0b0bcba4bee ==============================
[0m18:28:11.369225 [info ] [MainThread]: Running with dbt=1.10.1
[0m18:28:11.370330 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'debug': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:28:11.982885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8c92b7b-6da1-4687-a215-a0b0bcba4bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f8d220>]}
[0m18:28:12.088225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8c92b7b-6da1-4687-a215-a0b0bcba4bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059a7350>]}
[0m18:28:12.117891 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m18:28:12.300214 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m18:28:12.620313 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:28:12.621510 [debug] [MainThread]: Partial parsing: updated file: suvera://models/staging/stg_activities.sql
[0m18:28:13.323959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8c92b7b-6da1-4687-a215-a0b0bcba4bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10627d250>]}
[0m18:28:13.540063 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m18:28:13.546671 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m18:28:13.598316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8c92b7b-6da1-4687-a215-a0b0bcba4bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fdd4f0>]}
[0m18:28:13.599146 [info ] [MainThread]: Found 12 models, 4 seeds, 12 data tests, 544 macros
[0m18:28:13.599735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8c92b7b-6da1-4687-a215-a0b0bcba4bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105baf3f0>]}
[0m18:28:13.603180 [info ] [MainThread]: 
[0m18:28:13.603732 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:28:13.604211 [info ] [MainThread]: 
[0m18:28:13.605402 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:28:13.615391 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m18:28:13.709089 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m18:28:13.709697 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m18:28:13.710258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:28:13.736896 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m18:28:13.738960 [debug] [ThreadPool]: On list_dev: Close
[0m18:28:13.740027 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m18:28:13.741282 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m18:28:13.750933 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:28:13.751525 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m18:28:13.751984 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:28:13.753316 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:28:13.755311 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:28:13.755788 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m18:28:13.756472 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:28:13.756928 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:28:13.757373 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m18:28:13.758155 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:28:13.759452 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m18:28:13.759969 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:28:13.760492 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m18:28:13.761189 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:28:13.761682 [debug] [ThreadPool]: On create_dev_main: Close
[0m18:28:13.764714 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m18:28:13.773192 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m18:28:13.773730 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m18:28:13.774172 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:28:13.774988 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:28:13.775453 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m18:28:13.775923 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m18:28:13.796235 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m18:28:13.798703 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m18:28:13.801284 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m18:28:13.801946 [debug] [ThreadPool]: On list_dev_main: Close
[0m18:28:13.807053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8c92b7b-6da1-4687-a215-a0b0bcba4bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106509e60>]}
[0m18:28:13.807740 [debug] [MainThread]: Using duckdb connection "master"
[0m18:28:13.808223 [debug] [MainThread]: On master: BEGIN
[0m18:28:13.808673 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:28:13.809541 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:28:13.810050 [debug] [MainThread]: On master: COMMIT
[0m18:28:13.810519 [debug] [MainThread]: Using duckdb connection "master"
[0m18:28:13.810964 [debug] [MainThread]: On master: COMMIT
[0m18:28:13.811652 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:28:13.812131 [debug] [MainThread]: On master: Close
[0m18:28:13.816711 [debug] [Thread-1 (]: Began running node model.suvera.stg_activities
[0m18:28:13.817595 [info ] [Thread-1 (]: 1 of 12 START sql view model main.stg_activities ............................... [RUN]
[0m18:28:13.818314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.stg_activities)
[0m18:28:13.818873 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_activities
[0m18:28:13.829832 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_activities"
[0m18:28:13.832426 [debug] [Thread-1 (]: Began executing node model.suvera.stg_activities
[0m18:28:13.882302 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_activities"
[0m18:28:13.883611 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:28:13.884187 [debug] [Thread-1 (]: On model.suvera.stg_activities: BEGIN
[0m18:28:13.884712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:13.885645 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:13.886195 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:28:13.886735 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */

  
  create view "dev"."main"."stg_activities__dbt_tmp" as (
    select * 
from "dev"."main"."raw_activities"
  );

[0m18:28:13.887776 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:28:13.897695 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:28:13.898407 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
alter view "dev"."main"."stg_activities" rename to "stg_activities__dbt_backup"
[0m18:28:13.899496 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:28:13.903614 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:28:13.904188 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
alter view "dev"."main"."stg_activities__dbt_tmp" rename to "stg_activities"
[0m18:28:13.905080 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:28:13.923098 [debug] [Thread-1 (]: On model.suvera.stg_activities: COMMIT
[0m18:28:13.923760 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:28:13.924354 [debug] [Thread-1 (]: On model.suvera.stg_activities: COMMIT
[0m18:28:13.926120 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:13.934765 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:28:13.935454 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
drop view if exists "dev"."main"."stg_activities__dbt_backup" cascade
[0m18:28:13.937154 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:13.941047 [debug] [Thread-1 (]: On model.suvera.stg_activities: Close
[0m18:28:13.944763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8c92b7b-6da1-4687-a215-a0b0bcba4bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10613e990>]}
[0m18:28:13.945898 [info ] [Thread-1 (]: 1 of 12 OK created sql view model main.stg_activities .......................... [[32mOK[0m in 0.12s]
[0m18:28:13.946912 [debug] [Thread-1 (]: Finished running node model.suvera.stg_activities
[0m18:28:13.947554 [debug] [Thread-1 (]: Began running node model.suvera.stg_patients
[0m18:28:13.948262 [info ] [Thread-1 (]: 2 of 12 START sql view model main.stg_patients ................................. [RUN]
[0m18:28:13.949104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_activities, now model.suvera.stg_patients)
[0m18:28:13.949700 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_patients
[0m18:28:13.953532 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_patients"
[0m18:28:13.955510 [debug] [Thread-1 (]: Began executing node model.suvera.stg_patients
[0m18:28:13.962188 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_patients"
[0m18:28:13.963638 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:28:13.964596 [debug] [Thread-1 (]: On model.suvera.stg_patients: BEGIN
[0m18:28:13.965151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:13.966131 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:13.966728 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:28:13.967354 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */

  
  create view "dev"."main"."stg_patients__dbt_tmp" as (
    with source as (
    select * from "dev"."main"."raw_patients"
),

parsed as (
    select
        case
            when regexp_extract(data, '"patient_id": ([0-9]+)', 1) ~ '^[0-9]+$'
            then cast(regexp_extract(data, '"patient_id": ([0-9]+)', 1) as integer)
        end as patient_id,
        case
            when regexp_extract(data, '"practice_id": ([0-9]+)', 1) ~ '^[0-9]+$'
            then cast(regexp_extract(data, '"practice_id": ([0-9]+)', 1) as integer)
        end as practice_id,
        case
            when regexp_extract(data, '"age": ([0-9]+)', 1) ~ '^[0-9]+$'
            then cast(regexp_extract(data, '"age": ([0-9]+)', 1) as integer)
        end as age,
        regexp_extract(data, '"gender": "([^""]*)"', 1) as gender,
        cast(nullif(regexp_extract(data, '"registration_date": "([^"]+)"', 1), '') as date) as registration_date,
        regexp_extract(data, '"email": "([^"]+)"', 1) as email,
        regexp_extract(data, '"phone": "([^"]+)"', 1) as phone,
        string_split(
            replace(
                regexp_extract(data, '"conditions": \[(.*?)\]', 1),
                '"',
                ''
            ),
            ', '
        ) as conditions
    from source
)

select * from parsed
  );

[0m18:28:13.969654 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:28:13.973725 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:28:13.974374 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients" rename to "stg_patients__dbt_backup"
[0m18:28:13.975953 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:28:13.980728 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:28:13.981327 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m18:28:13.982321 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:28:13.984586 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m18:28:13.985156 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:28:13.985683 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m18:28:13.986995 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:13.990812 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:28:13.991748 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
drop view if exists "dev"."main"."stg_patients__dbt_backup" cascade
[0m18:28:13.993463 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:13.995544 [debug] [Thread-1 (]: On model.suvera.stg_patients: Close
[0m18:28:13.996346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8c92b7b-6da1-4687-a215-a0b0bcba4bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f8f6a0>]}
[0m18:28:13.997267 [info ] [Thread-1 (]: 2 of 12 OK created sql view model main.stg_patients ............................ [[32mOK[0m in 0.05s]
[0m18:28:13.998173 [debug] [Thread-1 (]: Finished running node model.suvera.stg_patients
[0m18:28:13.998779 [debug] [Thread-1 (]: Began running node model.suvera.stg_pcns
[0m18:28:13.999462 [info ] [Thread-1 (]: 3 of 12 START sql view model main.stg_pcns ..................................... [RUN]
[0m18:28:14.000351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_patients, now model.suvera.stg_pcns)
[0m18:28:14.001064 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_pcns
[0m18:28:14.004511 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_pcns"
[0m18:28:14.005971 [debug] [Thread-1 (]: Began executing node model.suvera.stg_pcns
[0m18:28:14.018377 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_pcns"
[0m18:28:14.019557 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:28:14.020122 [debug] [Thread-1 (]: On model.suvera.stg_pcns: BEGIN
[0m18:28:14.020646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:14.021531 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.022077 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:28:14.022621 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */

  
  create view "dev"."main"."stg_pcns__dbt_tmp" as (
    select * 
from "dev"."main"."raw_pcns"
  );

[0m18:28:14.023684 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:28:14.028826 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:28:14.029507 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */
alter view "dev"."main"."stg_pcns" rename to "stg_pcns__dbt_backup"
[0m18:28:14.030628 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:28:14.034608 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:28:14.035171 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */
alter view "dev"."main"."stg_pcns__dbt_tmp" rename to "stg_pcns"
[0m18:28:14.036055 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:28:14.038249 [debug] [Thread-1 (]: On model.suvera.stg_pcns: COMMIT
[0m18:28:14.038807 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:28:14.039329 [debug] [Thread-1 (]: On model.suvera.stg_pcns: COMMIT
[0m18:28:14.040475 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.044467 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:28:14.045109 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */
drop view if exists "dev"."main"."stg_pcns__dbt_backup" cascade
[0m18:28:14.046464 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.052796 [debug] [Thread-1 (]: On model.suvera.stg_pcns: Close
[0m18:28:14.053586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8c92b7b-6da1-4687-a215-a0b0bcba4bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d18550>]}
[0m18:28:14.054486 [info ] [Thread-1 (]: 3 of 12 OK created sql view model main.stg_pcns ................................ [[32mOK[0m in 0.05s]
[0m18:28:14.055380 [debug] [Thread-1 (]: Finished running node model.suvera.stg_pcns
[0m18:28:14.055981 [debug] [Thread-1 (]: Began running node model.suvera.stg_practices
[0m18:28:14.056659 [info ] [Thread-1 (]: 4 of 12 START sql view model main.stg_practices ................................ [RUN]
[0m18:28:14.057400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_pcns, now model.suvera.stg_practices)
[0m18:28:14.058040 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_practices
[0m18:28:14.062301 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_practices"
[0m18:28:14.063796 [debug] [Thread-1 (]: Began executing node model.suvera.stg_practices
[0m18:28:14.069299 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_practices"
[0m18:28:14.070436 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:28:14.070999 [debug] [Thread-1 (]: On model.suvera.stg_practices: BEGIN
[0m18:28:14.071526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:14.072431 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.072977 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:28:14.073530 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */

  
  create view "dev"."main"."stg_practices__dbt_tmp" as (
    select * 
from "dev"."main"."raw_practices"
  );

[0m18:28:14.074641 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:28:14.079047 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:28:14.079692 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */
alter view "dev"."main"."stg_practices" rename to "stg_practices__dbt_backup"
[0m18:28:14.080696 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:28:14.085556 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:28:14.086175 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */
alter view "dev"."main"."stg_practices__dbt_tmp" rename to "stg_practices"
[0m18:28:14.087137 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:28:14.089359 [debug] [Thread-1 (]: On model.suvera.stg_practices: COMMIT
[0m18:28:14.089914 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:28:14.090438 [debug] [Thread-1 (]: On model.suvera.stg_practices: COMMIT
[0m18:28:14.091602 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.097709 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:28:14.098379 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */
drop view if exists "dev"."main"."stg_practices__dbt_backup" cascade
[0m18:28:14.099653 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.101669 [debug] [Thread-1 (]: On model.suvera.stg_practices: Close
[0m18:28:14.102449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8c92b7b-6da1-4687-a215-a0b0bcba4bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065774d0>]}
[0m18:28:14.103335 [info ] [Thread-1 (]: 4 of 12 OK created sql view model main.stg_practices ........................... [[32mOK[0m in 0.05s]
[0m18:28:14.104227 [debug] [Thread-1 (]: Finished running node model.suvera.stg_practices
[0m18:28:14.104851 [debug] [Thread-1 (]: Began running node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:28:14.105539 [info ] [Thread-1 (]: 5 of 12 START sql view model main.mart_patients_inactive_3_months_after_first .. [RUN]
[0m18:28:14.106285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_practices, now model.suvera.mart_patients_inactive_3_months_after_first)
[0m18:28:14.106875 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:28:14.111052 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:28:14.112908 [debug] [Thread-1 (]: Began executing node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:28:14.119624 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:28:14.120847 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:28:14.121432 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: BEGIN
[0m18:28:14.121969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:14.122883 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.123443 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:28:14.124044 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */

  
  create view "dev"."main"."mart_patients_inactive_3_months_after_first__dbt_tmp" as (
    with activities as (
    select
        patient_id,
        activity_date
    from "dev"."main"."stg_activities"
),

first_activity as (
    select
        patient_id,
        min(activity_date) as first_date
    from activities
    group by patient_id
),

follow_up_activity as (
    select
        a.patient_id
    from activities a
    join first_activity f
        on a.patient_id = f.patient_id
    where a.activity_date > f.first_date
      and a.activity_date <= f.first_date + interval '90 days'
),

inactive_patients as (
    select
        f.patient_id,
        f.first_date
    from first_activity f
    left join follow_up_activity fu
        on f.patient_id = fu.patient_id
    where fu.patient_id is null
)

select *
from inactive_patients
  );

[0m18:28:14.125947 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.131517 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:28:14.132161 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */
alter view "dev"."main"."mart_patients_inactive_3_months_after_first" rename to "mart_patients_inactive_3_months_after_first__dbt_backup"
[0m18:28:14.133171 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:28:14.136963 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:28:14.137541 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */
alter view "dev"."main"."mart_patients_inactive_3_months_after_first__dbt_tmp" rename to "mart_patients_inactive_3_months_after_first"
[0m18:28:14.138435 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:28:14.141302 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: COMMIT
[0m18:28:14.141903 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:28:14.142457 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: COMMIT
[0m18:28:14.143746 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.147354 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:28:14.148008 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */
drop view if exists "dev"."main"."mart_patients_inactive_3_months_after_first__dbt_backup" cascade
[0m18:28:14.149345 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.151362 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: Close
[0m18:28:14.152135 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8c92b7b-6da1-4687-a215-a0b0bcba4bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062565f0>]}
[0m18:28:14.153031 [info ] [Thread-1 (]: 5 of 12 OK created sql view model main.mart_patients_inactive_3_months_after_first  [[32mOK[0m in 0.05s]
[0m18:28:14.153933 [debug] [Thread-1 (]: Finished running node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:28:14.154539 [debug] [Thread-1 (]: Began running node model.suvera.cleaned_patients
[0m18:28:14.155221 [info ] [Thread-1 (]: 6 of 12 START sql view model main.cleaned_patients ............................. [RUN]
[0m18:28:14.156094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_patients_inactive_3_months_after_first, now model.suvera.cleaned_patients)
[0m18:28:14.156683 [debug] [Thread-1 (]: Began compiling node model.suvera.cleaned_patients
[0m18:28:14.160526 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.cleaned_patients"
[0m18:28:14.162194 [debug] [Thread-1 (]: Began executing node model.suvera.cleaned_patients
[0m18:28:14.167641 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.cleaned_patients"
[0m18:28:14.168725 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:28:14.169294 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: BEGIN
[0m18:28:14.169811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:14.170704 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.171245 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:28:14.171818 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */

  
  create view "dev"."main"."cleaned_patients__dbt_tmp" as (
    with deduplicated as (
    select *
    from (
        select *,
               row_number() over (
                   partition by patient_id, practice_id
                   order by registration_date desc
               ) as row_num
        from "dev"."main"."stg_patients"
    )
    where row_num = 1
),

filtered as (
    select *
    from deduplicated
    where age between 0 and 120 and practice_id between 1 and 5 and age != 999
)

select
    patient_id,
    practice_id,
    age,
    gender,
    registration_date,
    email,
    phone,
    conditions
from filtered
  );

[0m18:28:14.174576 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:28:14.178923 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:28:14.179707 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */
alter view "dev"."main"."cleaned_patients" rename to "cleaned_patients__dbt_backup"
[0m18:28:14.181088 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:28:14.185633 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:28:14.186210 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */
alter view "dev"."main"."cleaned_patients__dbt_tmp" rename to "cleaned_patients"
[0m18:28:14.187115 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:28:14.189317 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: COMMIT
[0m18:28:14.189877 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:28:14.190401 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: COMMIT
[0m18:28:14.191650 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.195080 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:28:14.196174 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */
drop view if exists "dev"."main"."cleaned_patients__dbt_backup" cascade
[0m18:28:14.197575 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.199664 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: Close
[0m18:28:14.200442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8c92b7b-6da1-4687-a215-a0b0bcba4bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bd69f0>]}
[0m18:28:14.201332 [info ] [Thread-1 (]: 6 of 12 OK created sql view model main.cleaned_patients ........................ [[32mOK[0m in 0.04s]
[0m18:28:14.202232 [debug] [Thread-1 (]: Finished running node model.suvera.cleaned_patients
[0m18:28:14.202833 [debug] [Thread-1 (]: Began running node model.suvera.qa_flagged_patients
[0m18:28:14.203517 [info ] [Thread-1 (]: 7 of 12 START sql view model main.qa_flagged_patients .......................... [RUN]
[0m18:28:14.204233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.cleaned_patients, now model.suvera.qa_flagged_patients)
[0m18:28:14.204804 [debug] [Thread-1 (]: Began compiling node model.suvera.qa_flagged_patients
[0m18:28:14.208463 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.qa_flagged_patients"
[0m18:28:14.210387 [debug] [Thread-1 (]: Began executing node model.suvera.qa_flagged_patients
[0m18:28:14.217470 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.qa_flagged_patients"
[0m18:28:14.218617 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:28:14.219178 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: BEGIN
[0m18:28:14.219705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:14.220596 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.221155 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:28:14.221734 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */

  
  create view "dev"."main"."qa_flagged_patients__dbt_tmp" as (
    with source as (
    select *
    from "dev"."main"."stg_patients"
),

deduplicated as (
    select *
    from (
        select *,
               row_number() over (
                   partition by patient_id, practice_id
                   order by registration_date desc
               ) as row_num
        from source
    )
),

filtered_out as (
    select *
    from deduplicated
    where row_num > 1
       or try_cast(age as integer) not between 0 and 120
)

select * from filtered_out
  );

[0m18:28:14.224493 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:28:14.229913 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:28:14.230800 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */
alter view "dev"."main"."qa_flagged_patients" rename to "qa_flagged_patients__dbt_backup"
[0m18:28:14.231932 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:28:14.236829 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:28:14.237471 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */
alter view "dev"."main"."qa_flagged_patients__dbt_tmp" rename to "qa_flagged_patients"
[0m18:28:14.238573 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:28:14.240840 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: COMMIT
[0m18:28:14.241405 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:28:14.241935 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: COMMIT
[0m18:28:14.243175 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.246423 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:28:14.247010 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */
drop view if exists "dev"."main"."qa_flagged_patients__dbt_backup" cascade
[0m18:28:14.248335 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.250361 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: Close
[0m18:28:14.251126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8c92b7b-6da1-4687-a215-a0b0bcba4bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bd4bf0>]}
[0m18:28:14.252007 [info ] [Thread-1 (]: 7 of 12 OK created sql view model main.qa_flagged_patients ..................... [[32mOK[0m in 0.05s]
[0m18:28:14.252990 [debug] [Thread-1 (]: Finished running node model.suvera.qa_flagged_patients
[0m18:28:14.253660 [debug] [Thread-1 (]: Began running node model.suvera.mart_age_groups_by_pcn
[0m18:28:14.254495 [info ] [Thread-1 (]: 8 of 12 START sql view model main.mart_age_groups_by_pcn ....................... [RUN]
[0m18:28:14.255228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.qa_flagged_patients, now model.suvera.mart_age_groups_by_pcn)
[0m18:28:14.255806 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_age_groups_by_pcn
[0m18:28:14.260464 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_age_groups_by_pcn"
[0m18:28:14.262281 [debug] [Thread-1 (]: Began executing node model.suvera.mart_age_groups_by_pcn
[0m18:28:14.267769 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_age_groups_by_pcn"
[0m18:28:14.269574 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:28:14.270260 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: BEGIN
[0m18:28:14.270800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:14.271709 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.272252 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:28:14.272928 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_age_groups_by_pcn"} */

  
  create view "dev"."main"."mart_age_groups_by_pcn__dbt_tmp" as (
    with patients as (
    select
        patient_id,
        practice_id,
        age,
        case
            when age between 0 and 18 then '0-18'
            when age between 19 and 35 then '19-35'
            when age between 36 and 50 then '36-50'
            when age >= 51 then '51+'
            else 'Unknown'
        end as age_group
    from "dev"."main"."cleaned_patients"
),

practices as (
    select *
    from "dev"."main"."stg_practices"
),

pcns as (
    select *
    from "dev"."main"."stg_pcns"
),

joined as (
    select
        pcn.id as pcn_id,
        pcn.pcn_name,
        p.age_group
    from patients as p
    left join practices pr on p.practice_id = pr.id
    left join pcns pcn on pr.pcn = pcn.id
)

select
    pcn_id,
    pcn_name,
    age_group,
    count(*) as num_patients
from joined
group by pcn_id, pcn_name, age_group
order by pcn_id, age_group
  );

[0m18:28:14.276720 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:28:14.284233 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:28:14.284988 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_age_groups_by_pcn"} */
alter view "dev"."main"."mart_age_groups_by_pcn" rename to "mart_age_groups_by_pcn__dbt_backup"
[0m18:28:14.287063 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.294907 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:28:14.295955 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_age_groups_by_pcn"} */
alter view "dev"."main"."mart_age_groups_by_pcn__dbt_tmp" rename to "mart_age_groups_by_pcn"
[0m18:28:14.297457 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.300960 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: COMMIT
[0m18:28:14.301673 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:28:14.302253 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: COMMIT
[0m18:28:14.303724 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.307227 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:28:14.307896 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_age_groups_by_pcn"} */
drop view if exists "dev"."main"."mart_age_groups_by_pcn__dbt_backup" cascade
[0m18:28:14.309495 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.311744 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: Close
[0m18:28:14.312824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8c92b7b-6da1-4687-a215-a0b0bcba4bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bd63f0>]}
[0m18:28:14.313787 [info ] [Thread-1 (]: 8 of 12 OK created sql view model main.mart_age_groups_by_pcn .................. [[32mOK[0m in 0.06s]
[0m18:28:14.314738 [debug] [Thread-1 (]: Finished running node model.suvera.mart_age_groups_by_pcn
[0m18:28:14.315494 [debug] [Thread-1 (]: Began running node model.suvera.mart_avg_age_by_practice
[0m18:28:14.316663 [info ] [Thread-1 (]: 9 of 12 START sql view model main.mart_avg_age_by_practice ..................... [RUN]
[0m18:28:14.317394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_age_groups_by_pcn, now model.suvera.mart_avg_age_by_practice)
[0m18:28:14.317978 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_avg_age_by_practice
[0m18:28:14.328047 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_avg_age_by_practice"
[0m18:28:14.331167 [debug] [Thread-1 (]: Began executing node model.suvera.mart_avg_age_by_practice
[0m18:28:14.339298 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_avg_age_by_practice"
[0m18:28:14.340561 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:28:14.341270 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: BEGIN
[0m18:28:14.341937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:14.343113 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.343943 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:28:14.344563 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_avg_age_by_practice"} */

  
  create view "dev"."main"."mart_avg_age_by_practice__dbt_tmp" as (
    with patients as (
    select
        patient_id,
        practice_id,
        age
    from "dev"."main"."cleaned_patients"
),

aggregated as (
    select
        practice_id,
        avg(age) as avg_age,
        count(*) as num_patients
    from patients
    group by practice_id
)

select * from aggregated
order by avg_age desc
  );

[0m18:28:14.347561 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:28:14.352235 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:28:14.353007 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_avg_age_by_practice"} */
alter view "dev"."main"."mart_avg_age_by_practice" rename to "mart_avg_age_by_practice__dbt_backup"
[0m18:28:14.354505 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.359330 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:28:14.360129 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_avg_age_by_practice"} */
alter view "dev"."main"."mart_avg_age_by_practice__dbt_tmp" rename to "mart_avg_age_by_practice"
[0m18:28:14.361282 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:28:14.363739 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: COMMIT
[0m18:28:14.364387 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:28:14.364938 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: COMMIT
[0m18:28:14.366187 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.369396 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:28:14.369979 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_avg_age_by_practice"} */
drop view if exists "dev"."main"."mart_avg_age_by_practice__dbt_backup" cascade
[0m18:28:14.371150 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.373117 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: Close
[0m18:28:14.373994 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8c92b7b-6da1-4687-a215-a0b0bcba4bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ad4650>]}
[0m18:28:14.374950 [info ] [Thread-1 (]: 9 of 12 OK created sql view model main.mart_avg_age_by_practice ................ [[32mOK[0m in 0.06s]
[0m18:28:14.375932 [debug] [Thread-1 (]: Finished running node model.suvera.mart_avg_age_by_practice
[0m18:28:14.376589 [debug] [Thread-1 (]: Began running node model.suvera.mart_hypertension_pct_by_practice
[0m18:28:14.377379 [info ] [Thread-1 (]: 10 of 12 START sql view model main.mart_hypertension_pct_by_practice ........... [RUN]
[0m18:28:14.378094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_avg_age_by_practice, now model.suvera.mart_hypertension_pct_by_practice)
[0m18:28:14.378671 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_hypertension_pct_by_practice
[0m18:28:14.383661 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_hypertension_pct_by_practice"
[0m18:28:14.384817 [debug] [Thread-1 (]: Began executing node model.suvera.mart_hypertension_pct_by_practice
[0m18:28:14.390687 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_hypertension_pct_by_practice"
[0m18:28:14.391862 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:28:14.392461 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: BEGIN
[0m18:28:14.393002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:14.395475 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:28:14.396756 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:28:14.397997 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_hypertension_pct_by_practice"} */

  
  create view "dev"."main"."mart_hypertension_pct_by_practice__dbt_tmp" as (
    with patients as (
    select
        patient_id,
        practice_id,
        conditions
    from "dev"."main"."cleaned_patients"
),

exploded as (
    select
        patient_id,
        practice_id,
        unnest(conditions) as condition
    from patients
),

hypertension_counts as (
    select
        practice_id,
        count(distinct patient_id) as patients_with_hypertension
    from exploded
    where lower(condition) = 'hypertension'
    group by practice_id
),

total_patients as (
    select
        practice_id,
        count(distinct patient_id) as total_patients
    from patients
    group by practice_id
)

select
    t.practice_id,
    t.total_patients,
    coalesce(h.patients_with_hypertension, 0) as patients_with_hypertension,
    round(
        coalesce(h.patients_with_hypertension, 0) * 100.0 / t.total_patients,
        1
    ) as pct_with_hypertension
from total_patients t
left join hypertension_counts h
    on t.practice_id = h.practice_id
order by pct_with_hypertension desc
  );

[0m18:28:14.404566 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m18:28:14.411511 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:28:14.412298 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_hypertension_pct_by_practice"} */
alter view "dev"."main"."mart_hypertension_pct_by_practice" rename to "mart_hypertension_pct_by_practice__dbt_backup"
[0m18:28:14.413649 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.417848 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:28:14.418811 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_hypertension_pct_by_practice"} */
alter view "dev"."main"."mart_hypertension_pct_by_practice__dbt_tmp" rename to "mart_hypertension_pct_by_practice"
[0m18:28:14.420317 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.424153 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: COMMIT
[0m18:28:14.425189 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:28:14.426068 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: COMMIT
[0m18:28:14.428246 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.432478 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:28:14.433560 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_hypertension_pct_by_practice"} */
drop view if exists "dev"."main"."mart_hypertension_pct_by_practice__dbt_backup" cascade
[0m18:28:14.435536 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.439349 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: Close
[0m18:28:14.443238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8c92b7b-6da1-4687-a215-a0b0bcba4bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bd71d0>]}
[0m18:28:14.445657 [info ] [Thread-1 (]: 10 of 12 OK created sql view model main.mart_hypertension_pct_by_practice ...... [[32mOK[0m in 0.06s]
[0m18:28:14.446640 [debug] [Thread-1 (]: Finished running node model.suvera.mart_hypertension_pct_by_practice
[0m18:28:14.447357 [debug] [Thread-1 (]: Began running node model.suvera.mart_patient_count_by_pcn
[0m18:28:14.448159 [info ] [Thread-1 (]: 11 of 12 START sql view model main.mart_patient_count_by_pcn ................... [RUN]
[0m18:28:14.448929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_hypertension_pct_by_practice, now model.suvera.mart_patient_count_by_pcn)
[0m18:28:14.449501 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_patient_count_by_pcn
[0m18:28:14.454701 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_patient_count_by_pcn"
[0m18:28:14.455944 [debug] [Thread-1 (]: Began executing node model.suvera.mart_patient_count_by_pcn
[0m18:28:14.462163 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_patient_count_by_pcn"
[0m18:28:14.463337 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:28:14.463909 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: BEGIN
[0m18:28:14.464437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:14.465380 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.465957 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:28:14.466617 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patient_count_by_pcn"} */

  
  create view "dev"."main"."mart_patient_count_by_pcn__dbt_tmp" as (
    with patients as (
    select *
    from "dev"."main"."cleaned_patients"
),

practices as (
    select *
    from "dev"."main"."stg_practices"
),

pcns as (
    select *
    from "dev"."main"."stg_pcns"
),

joined as (
    select
        pcn.id as pcn_id,
        pcn.pcn_name pcn_name,
        patient.patient_id
    from patients as patient
    left join practices as practice
        on patient.practice_id = practice.id
    left join pcns as pcn
        on practice.pcn = pcn.id
)

select
    pcn_id,
    pcn_name,
    count(distinct patient_id) as num_patients
from joined
group by 1, 2
order by num_patients desc
  );

[0m18:28:14.470019 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:28:14.476343 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:28:14.477210 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patient_count_by_pcn"} */
alter view "dev"."main"."mart_patient_count_by_pcn" rename to "mart_patient_count_by_pcn__dbt_backup"
[0m18:28:14.478505 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.483517 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:28:14.484647 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patient_count_by_pcn"} */
alter view "dev"."main"."mart_patient_count_by_pcn__dbt_tmp" rename to "mart_patient_count_by_pcn"
[0m18:28:14.486253 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.490011 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: COMMIT
[0m18:28:14.490932 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:28:14.491582 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: COMMIT
[0m18:28:14.492927 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.496723 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:28:14.497375 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patient_count_by_pcn"} */
drop view if exists "dev"."main"."mart_patient_count_by_pcn__dbt_backup" cascade
[0m18:28:14.498716 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.500950 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: Close
[0m18:28:14.501836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8c92b7b-6da1-4687-a215-a0b0bcba4bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bd5fd0>]}
[0m18:28:14.502787 [info ] [Thread-1 (]: 11 of 12 OK created sql view model main.mart_patient_count_by_pcn .............. [[32mOK[0m in 0.05s]
[0m18:28:14.503758 [debug] [Thread-1 (]: Finished running node model.suvera.mart_patient_count_by_pcn
[0m18:28:14.504534 [debug] [Thread-1 (]: Began running node model.suvera.mart_recent_activity_by_patient
[0m18:28:14.505351 [info ] [Thread-1 (]: 12 of 12 START sql view model main.mart_recent_activity_by_patient ............. [RUN]
[0m18:28:14.506071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_patient_count_by_pcn, now model.suvera.mart_recent_activity_by_patient)
[0m18:28:14.506639 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_recent_activity_by_patient
[0m18:28:14.512158 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_recent_activity_by_patient"
[0m18:28:14.513839 [debug] [Thread-1 (]: Began executing node model.suvera.mart_recent_activity_by_patient
[0m18:28:14.519550 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_recent_activity_by_patient"
[0m18:28:14.520680 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:28:14.521241 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: BEGIN
[0m18:28:14.521761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:14.522662 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.523603 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:28:14.524746 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_recent_activity_by_patient"} */

  
  create view "dev"."main"."mart_recent_activity_by_patient__dbt_tmp" as (
    with patients as (
    select patient_id
    from "dev"."main"."cleaned_patients"
),

activities as (
    select
        patient_id,
        activity_date
    from "dev"."main"."stg_activities"
),

filtered as (
    select *
    from activities
    where patient_id in (select patient_id from patients)
)

select
    patient_id,
    max(activity_date) as most_recent_activity
from filtered
group by patient_id
  );

[0m18:28:14.528360 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:28:14.534690 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:28:14.535384 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_recent_activity_by_patient"} */
alter view "dev"."main"."mart_recent_activity_by_patient" rename to "mart_recent_activity_by_patient__dbt_backup"
[0m18:28:14.536428 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:28:14.541348 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:28:14.542078 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_recent_activity_by_patient"} */
alter view "dev"."main"."mart_recent_activity_by_patient__dbt_tmp" rename to "mart_recent_activity_by_patient"
[0m18:28:14.543588 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.546915 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: COMMIT
[0m18:28:14.547560 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:28:14.548100 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: COMMIT
[0m18:28:14.549412 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.553054 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:28:14.553642 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_recent_activity_by_patient"} */
drop view if exists "dev"."main"."mart_recent_activity_by_patient__dbt_backup" cascade
[0m18:28:14.554800 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:14.557197 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: Close
[0m18:28:14.558191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8c92b7b-6da1-4687-a215-a0b0bcba4bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bd5490>]}
[0m18:28:14.559105 [info ] [Thread-1 (]: 12 of 12 OK created sql view model main.mart_recent_activity_by_patient ........ [[32mOK[0m in 0.05s]
[0m18:28:14.560078 [debug] [Thread-1 (]: Finished running node model.suvera.mart_recent_activity_by_patient
[0m18:28:14.562003 [debug] [MainThread]: Using duckdb connection "master"
[0m18:28:14.562534 [debug] [MainThread]: On master: BEGIN
[0m18:28:14.562983 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:28:14.563796 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:28:14.564269 [debug] [MainThread]: On master: COMMIT
[0m18:28:14.564734 [debug] [MainThread]: Using duckdb connection "master"
[0m18:28:14.565183 [debug] [MainThread]: On master: COMMIT
[0m18:28:14.565891 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:28:14.566505 [debug] [MainThread]: On master: Close
[0m18:28:14.567153 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:28:14.567602 [debug] [MainThread]: Connection 'model.suvera.mart_recent_activity_by_patient' was properly closed.
[0m18:28:14.568170 [info ] [MainThread]: 
[0m18:28:14.568683 [info ] [MainThread]: Finished running 12 view models in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m18:28:14.572181 [debug] [MainThread]: Command end result
[0m18:28:14.623278 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m18:28:14.626634 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m18:28:14.637730 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m18:28:14.638291 [info ] [MainThread]: 
[0m18:28:14.638856 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:28:14.639357 [info ] [MainThread]: 
[0m18:28:14.640052 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m18:28:14.644850 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.4215336, "process_in_blocks": "0", "process_kernel_time": 0.815173, "process_mem_max_rss": "140279808", "process_out_blocks": "0", "process_user_time": 5.157435}
[0m18:28:14.645689 [debug] [MainThread]: Command `dbt run` succeeded at 18:28:14.645512 after 3.42 seconds
[0m18:28:14.646321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fbce30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039e9010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106214cb0>]}
[0m18:28:14.646928 [debug] [MainThread]: Flushing usage events
[0m18:28:15.316472 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:33:22.843039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eb9d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ccb610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ccb750>]}


============================== 18:33:22.854736 | 1cb93ecd-9e75-4f73-bc3f-e9739d9d2eaf ==============================
[0m18:33:22.854736 [info ] [MainThread]: Running with dbt=1.10.1
[0m18:33:22.855851 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:33:23.386183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1cb93ecd-9e75-4f73-bc3f-e9739d9d2eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10619d220>]}
[0m18:33:23.490609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1cb93ecd-9e75-4f73-bc3f-e9739d9d2eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bb3350>]}
[0m18:33:23.514187 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m18:33:23.706960 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m18:33:24.042280 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:33:24.043311 [debug] [MainThread]: Partial parsing: updated file: suvera://models/intermediate/cleaned_patients.sql
[0m18:33:24.482162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cb93ecd-9e75-4f73-bc3f-e9739d9d2eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107470350>]}
[0m18:33:24.623011 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m18:33:24.629725 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m18:33:24.686054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cb93ecd-9e75-4f73-bc3f-e9739d9d2eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fa2d50>]}
[0m18:33:24.686907 [info ] [MainThread]: Found 12 models, 4 seeds, 12 data tests, 544 macros
[0m18:33:24.687494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cb93ecd-9e75-4f73-bc3f-e9739d9d2eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107560bb0>]}
[0m18:33:24.691349 [info ] [MainThread]: 
[0m18:33:24.692040 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:33:24.692662 [info ] [MainThread]: 
[0m18:33:24.693681 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:33:24.702175 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m18:33:24.799758 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m18:33:24.800381 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m18:33:24.800868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:33:24.828239 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m18:33:24.833254 [debug] [ThreadPool]: On list_dev: Close
[0m18:33:24.835249 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m18:33:24.836133 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m18:33:24.845458 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:33:24.846000 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m18:33:24.846457 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:33:24.847818 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:33:24.850695 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:33:24.851293 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m18:33:24.852068 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:33:24.852532 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:33:24.852990 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m18:33:24.858436 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m18:33:24.860026 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m18:33:24.860554 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:33:24.861014 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m18:33:24.861780 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:33:24.862277 [debug] [ThreadPool]: On create_dev_main: Close
[0m18:33:24.865337 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m18:33:24.948823 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m18:33:24.949410 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m18:33:24.949862 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:33:24.950680 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:33:24.951153 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m18:33:24.951629 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m18:33:24.985543 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m18:33:24.988547 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m18:33:24.990725 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m18:33:24.991328 [debug] [ThreadPool]: On list_dev_main: Close
[0m18:33:24.996288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cb93ecd-9e75-4f73-bc3f-e9739d9d2eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107838600>]}
[0m18:33:24.996989 [debug] [MainThread]: Using duckdb connection "master"
[0m18:33:24.997454 [debug] [MainThread]: On master: BEGIN
[0m18:33:24.997886 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:33:24.998701 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:33:24.999178 [debug] [MainThread]: On master: COMMIT
[0m18:33:24.999646 [debug] [MainThread]: Using duckdb connection "master"
[0m18:33:25.000100 [debug] [MainThread]: On master: COMMIT
[0m18:33:25.000817 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:33:25.001340 [debug] [MainThread]: On master: Close
[0m18:33:25.006009 [debug] [Thread-1 (]: Began running node model.suvera.stg_activities
[0m18:33:25.006893 [info ] [Thread-1 (]: 1 of 12 START sql view model main.stg_activities ............................... [RUN]
[0m18:33:25.007670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.stg_activities)
[0m18:33:25.008240 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_activities
[0m18:33:25.019759 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_activities"
[0m18:33:25.022536 [debug] [Thread-1 (]: Began executing node model.suvera.stg_activities
[0m18:33:25.070910 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_activities"
[0m18:33:25.072735 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:33:25.073386 [debug] [Thread-1 (]: On model.suvera.stg_activities: BEGIN
[0m18:33:25.073919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:25.074824 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.075370 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:33:25.075910 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */

  
  create view "dev"."main"."stg_activities__dbt_tmp" as (
    select * 
from "dev"."main"."raw_activities"
  );

[0m18:33:25.077679 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.087387 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:33:25.088042 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
alter view "dev"."main"."stg_activities" rename to "stg_activities__dbt_backup"
[0m18:33:25.093502 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:33:25.097732 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:33:25.098310 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
alter view "dev"."main"."stg_activities__dbt_tmp" rename to "stg_activities"
[0m18:33:25.099256 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:33:25.117323 [debug] [Thread-1 (]: On model.suvera.stg_activities: COMMIT
[0m18:33:25.117991 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:33:25.118531 [debug] [Thread-1 (]: On model.suvera.stg_activities: COMMIT
[0m18:33:25.124589 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:33:25.132536 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:33:25.133166 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
drop view if exists "dev"."main"."stg_activities__dbt_backup" cascade
[0m18:33:25.137056 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:33:25.140940 [debug] [Thread-1 (]: On model.suvera.stg_activities: Close
[0m18:33:25.144637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb93ecd-9e75-4f73-bc3f-e9739d9d2eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10772e5d0>]}
[0m18:33:25.146246 [info ] [Thread-1 (]: 1 of 12 OK created sql view model main.stg_activities .......................... [[32mOK[0m in 0.13s]
[0m18:33:25.147363 [debug] [Thread-1 (]: Finished running node model.suvera.stg_activities
[0m18:33:25.148102 [debug] [Thread-1 (]: Began running node model.suvera.stg_patients
[0m18:33:25.149027 [info ] [Thread-1 (]: 2 of 12 START sql view model main.stg_patients ................................. [RUN]
[0m18:33:25.149960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_activities, now model.suvera.stg_patients)
[0m18:33:25.150717 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_patients
[0m18:33:25.155138 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_patients"
[0m18:33:25.157375 [debug] [Thread-1 (]: Began executing node model.suvera.stg_patients
[0m18:33:25.164849 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_patients"
[0m18:33:25.166753 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:33:25.167428 [debug] [Thread-1 (]: On model.suvera.stg_patients: BEGIN
[0m18:33:25.168029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:25.169020 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.169588 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:33:25.170203 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */

  
  create view "dev"."main"."stg_patients__dbt_tmp" as (
    with source as (
    select * from "dev"."main"."raw_patients"
),

parsed as (
    select
        case
            when regexp_extract(data, '"patient_id": ([0-9]+)', 1) ~ '^[0-9]+$'
            then cast(regexp_extract(data, '"patient_id": ([0-9]+)', 1) as integer)
        end as patient_id,
        case
            when regexp_extract(data, '"practice_id": ([0-9]+)', 1) ~ '^[0-9]+$'
            then cast(regexp_extract(data, '"practice_id": ([0-9]+)', 1) as integer)
        end as practice_id,
        case
            when regexp_extract(data, '"age": ([0-9]+)', 1) ~ '^[0-9]+$'
            then cast(regexp_extract(data, '"age": ([0-9]+)', 1) as integer)
        end as age,
        regexp_extract(data, '"gender": "([^""]*)"', 1) as gender,
        cast(nullif(regexp_extract(data, '"registration_date": "([^"]+)"', 1), '') as date) as registration_date,
        regexp_extract(data, '"email": "([^"]+)"', 1) as email,
        regexp_extract(data, '"phone": "([^"]+)"', 1) as phone,
        string_split(
            replace(
                regexp_extract(data, '"conditions": \[(.*?)\]', 1),
                '"',
                ''
            ),
            ', '
        ) as conditions
    from source
)

select * from parsed
  );

[0m18:33:25.173815 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:33:25.178013 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:33:25.178892 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients" rename to "stg_patients__dbt_backup"
[0m18:33:25.179925 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:33:25.184072 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:33:25.184653 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m18:33:25.185592 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:33:25.187830 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m18:33:25.188400 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:33:25.188939 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m18:33:25.190368 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.194273 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:33:25.194849 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
drop view if exists "dev"."main"."stg_patients__dbt_backup" cascade
[0m18:33:25.196198 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.198309 [debug] [Thread-1 (]: On model.suvera.stg_patients: Close
[0m18:33:25.199108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb93ecd-9e75-4f73-bc3f-e9739d9d2eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074beaf0>]}
[0m18:33:25.199990 [info ] [Thread-1 (]: 2 of 12 OK created sql view model main.stg_patients ............................ [[32mOK[0m in 0.05s]
[0m18:33:25.200893 [debug] [Thread-1 (]: Finished running node model.suvera.stg_patients
[0m18:33:25.201494 [debug] [Thread-1 (]: Began running node model.suvera.stg_pcns
[0m18:33:25.202175 [info ] [Thread-1 (]: 3 of 12 START sql view model main.stg_pcns ..................................... [RUN]
[0m18:33:25.202956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_patients, now model.suvera.stg_pcns)
[0m18:33:25.203676 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_pcns
[0m18:33:25.207405 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_pcns"
[0m18:33:25.208929 [debug] [Thread-1 (]: Began executing node model.suvera.stg_pcns
[0m18:33:25.215935 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_pcns"
[0m18:33:25.217108 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:33:25.217663 [debug] [Thread-1 (]: On model.suvera.stg_pcns: BEGIN
[0m18:33:25.218183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:25.219165 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.219720 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:33:25.220257 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */

  
  create view "dev"."main"."stg_pcns__dbt_tmp" as (
    select * 
from "dev"."main"."raw_pcns"
  );

[0m18:33:25.221330 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:33:25.225894 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:33:25.226518 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */
alter view "dev"."main"."stg_pcns" rename to "stg_pcns__dbt_backup"
[0m18:33:25.227485 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:33:25.231299 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:33:25.232049 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */
alter view "dev"."main"."stg_pcns__dbt_tmp" rename to "stg_pcns"
[0m18:33:25.233747 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:33:25.236156 [debug] [Thread-1 (]: On model.suvera.stg_pcns: COMMIT
[0m18:33:25.236737 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:33:25.237276 [debug] [Thread-1 (]: On model.suvera.stg_pcns: COMMIT
[0m18:33:25.238456 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.241554 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:33:25.242118 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */
drop view if exists "dev"."main"."stg_pcns__dbt_backup" cascade
[0m18:33:25.243387 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.245415 [debug] [Thread-1 (]: On model.suvera.stg_pcns: Close
[0m18:33:25.246189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb93ecd-9e75-4f73-bc3f-e9739d9d2eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072437f0>]}
[0m18:33:25.247177 [info ] [Thread-1 (]: 3 of 12 OK created sql view model main.stg_pcns ................................ [[32mOK[0m in 0.04s]
[0m18:33:25.248079 [debug] [Thread-1 (]: Finished running node model.suvera.stg_pcns
[0m18:33:25.248682 [debug] [Thread-1 (]: Began running node model.suvera.stg_practices
[0m18:33:25.249367 [info ] [Thread-1 (]: 4 of 12 START sql view model main.stg_practices ................................ [RUN]
[0m18:33:25.250026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_pcns, now model.suvera.stg_practices)
[0m18:33:25.250588 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_practices
[0m18:33:25.253833 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_practices"
[0m18:33:25.255534 [debug] [Thread-1 (]: Began executing node model.suvera.stg_practices
[0m18:33:25.261623 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_practices"
[0m18:33:25.263646 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:33:25.264594 [debug] [Thread-1 (]: On model.suvera.stg_practices: BEGIN
[0m18:33:25.265137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:25.266043 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.266587 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:33:25.267128 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */

  
  create view "dev"."main"."stg_practices__dbt_tmp" as (
    select * 
from "dev"."main"."raw_practices"
  );

[0m18:33:25.268130 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:33:25.272275 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:33:25.272959 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */
alter view "dev"."main"."stg_practices" rename to "stg_practices__dbt_backup"
[0m18:33:25.273993 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:33:25.278445 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:33:25.279014 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */
alter view "dev"."main"."stg_practices__dbt_tmp" rename to "stg_practices"
[0m18:33:25.279908 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:33:25.282558 [debug] [Thread-1 (]: On model.suvera.stg_practices: COMMIT
[0m18:33:25.283223 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:33:25.283772 [debug] [Thread-1 (]: On model.suvera.stg_practices: COMMIT
[0m18:33:25.285123 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.288232 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:33:25.288857 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */
drop view if exists "dev"."main"."stg_practices__dbt_backup" cascade
[0m18:33:25.290101 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.292123 [debug] [Thread-1 (]: On model.suvera.stg_practices: Close
[0m18:33:25.292893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb93ecd-9e75-4f73-bc3f-e9739d9d2eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f15850>]}
[0m18:33:25.293776 [info ] [Thread-1 (]: 4 of 12 OK created sql view model main.stg_practices ........................... [[32mOK[0m in 0.04s]
[0m18:33:25.294668 [debug] [Thread-1 (]: Finished running node model.suvera.stg_practices
[0m18:33:25.295274 [debug] [Thread-1 (]: Began running node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:33:25.295961 [info ] [Thread-1 (]: 5 of 12 START sql view model main.mart_patients_inactive_3_months_after_first .. [RUN]
[0m18:33:25.296655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_practices, now model.suvera.mart_patients_inactive_3_months_after_first)
[0m18:33:25.297344 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:33:25.301372 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:33:25.302892 [debug] [Thread-1 (]: Began executing node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:33:25.310238 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:33:25.311431 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:33:25.312006 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: BEGIN
[0m18:33:25.312546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:25.313458 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.314105 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:33:25.314706 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */

  
  create view "dev"."main"."mart_patients_inactive_3_months_after_first__dbt_tmp" as (
    with activities as (
    select
        patient_id,
        activity_date
    from "dev"."main"."stg_activities"
),

first_activity as (
    select
        patient_id,
        min(activity_date) as first_date
    from activities
    group by patient_id
),

follow_up_activity as (
    select
        a.patient_id
    from activities a
    join first_activity f
        on a.patient_id = f.patient_id
    where a.activity_date > f.first_date
      and a.activity_date <= f.first_date + interval '90 days'
),

inactive_patients as (
    select
        f.patient_id,
        f.first_date
    from first_activity f
    left join follow_up_activity fu
        on f.patient_id = fu.patient_id
    where fu.patient_id is null
)

select *
from inactive_patients
  );

[0m18:33:25.321268 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m18:33:25.325762 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:33:25.326381 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */
alter view "dev"."main"."mart_patients_inactive_3_months_after_first" rename to "mart_patients_inactive_3_months_after_first__dbt_backup"
[0m18:33:25.327392 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:33:25.331693 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:33:25.332302 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */
alter view "dev"."main"."mart_patients_inactive_3_months_after_first__dbt_tmp" rename to "mart_patients_inactive_3_months_after_first"
[0m18:33:25.334094 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.336433 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: COMMIT
[0m18:33:25.337016 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:33:25.337563 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: COMMIT
[0m18:33:25.338829 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.341962 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:33:25.342537 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */
drop view if exists "dev"."main"."mart_patients_inactive_3_months_after_first__dbt_backup" cascade
[0m18:33:25.343807 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.345776 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: Close
[0m18:33:25.346555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb93ecd-9e75-4f73-bc3f-e9739d9d2eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107850130>]}
[0m18:33:25.347462 [info ] [Thread-1 (]: 5 of 12 OK created sql view model main.mart_patients_inactive_3_months_after_first  [[32mOK[0m in 0.05s]
[0m18:33:25.348376 [debug] [Thread-1 (]: Finished running node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:33:25.348998 [debug] [Thread-1 (]: Began running node model.suvera.cleaned_patients
[0m18:33:25.349798 [info ] [Thread-1 (]: 6 of 12 START sql view model main.cleaned_patients ............................. [RUN]
[0m18:33:25.350537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_patients_inactive_3_months_after_first, now model.suvera.cleaned_patients)
[0m18:33:25.351116 [debug] [Thread-1 (]: Began compiling node model.suvera.cleaned_patients
[0m18:33:25.354935 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.cleaned_patients"
[0m18:33:25.356502 [debug] [Thread-1 (]: Began executing node model.suvera.cleaned_patients
[0m18:33:25.367538 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.cleaned_patients"
[0m18:33:25.368945 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:33:25.369629 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: BEGIN
[0m18:33:25.370189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:25.371102 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.371684 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:33:25.372503 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */

  
  create view "dev"."main"."cleaned_patients__dbt_tmp" as (
    with deduplicated as (
    select *
    from (
        select *,
               row_number() over (
                   partition by patient_id, practice_id
                   order by registration_date desc
               ) as row_num
        from "dev"."main"."stg_patients"
    )
    where row_num = 1
),

filtered as (
    select *
    from deduplicated
    where age between 0 and 120 and practice_id between 1 and 4 and age != 999
)

select
    patient_id,
    practice_id,
    age,
    gender,
    registration_date,
    email,
    phone,
    conditions
from filtered
  );

[0m18:33:25.377999 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:33:25.382419 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:33:25.383187 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */
alter view "dev"."main"."cleaned_patients" rename to "cleaned_patients__dbt_backup"
[0m18:33:25.384585 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.389263 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:33:25.389887 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */
alter view "dev"."main"."cleaned_patients__dbt_tmp" rename to "cleaned_patients"
[0m18:33:25.390925 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:33:25.393164 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: COMMIT
[0m18:33:25.393742 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:33:25.394302 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: COMMIT
[0m18:33:25.395652 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.399362 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:33:25.400005 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */
drop view if exists "dev"."main"."cleaned_patients__dbt_backup" cascade
[0m18:33:25.401302 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.403268 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: Close
[0m18:33:25.404035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb93ecd-9e75-4f73-bc3f-e9739d9d2eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071ff230>]}
[0m18:33:25.404921 [info ] [Thread-1 (]: 6 of 12 OK created sql view model main.cleaned_patients ........................ [[32mOK[0m in 0.05s]
[0m18:33:25.406012 [debug] [Thread-1 (]: Finished running node model.suvera.cleaned_patients
[0m18:33:25.406627 [debug] [Thread-1 (]: Began running node model.suvera.qa_flagged_patients
[0m18:33:25.407316 [info ] [Thread-1 (]: 7 of 12 START sql view model main.qa_flagged_patients .......................... [RUN]
[0m18:33:25.408228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.cleaned_patients, now model.suvera.qa_flagged_patients)
[0m18:33:25.408996 [debug] [Thread-1 (]: Began compiling node model.suvera.qa_flagged_patients
[0m18:33:25.413292 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.qa_flagged_patients"
[0m18:33:25.415193 [debug] [Thread-1 (]: Began executing node model.suvera.qa_flagged_patients
[0m18:33:25.419982 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.qa_flagged_patients"
[0m18:33:25.421099 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:33:25.421745 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: BEGIN
[0m18:33:25.422278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:25.423616 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.424510 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:33:25.425326 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */

  
  create view "dev"."main"."qa_flagged_patients__dbt_tmp" as (
    with source as (
    select *
    from "dev"."main"."stg_patients"
),

deduplicated as (
    select *
    from (
        select *,
               row_number() over (
                   partition by patient_id, practice_id
                   order by registration_date desc
               ) as row_num
        from source
    )
),

filtered_out as (
    select *
    from deduplicated
    where row_num > 1
       or try_cast(age as integer) not between 0 and 120
)

select * from filtered_out
  );

[0m18:33:25.428143 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:33:25.433137 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:33:25.433995 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */
alter view "dev"."main"."qa_flagged_patients" rename to "qa_flagged_patients__dbt_backup"
[0m18:33:25.435359 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:33:25.440492 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:33:25.441170 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */
alter view "dev"."main"."qa_flagged_patients__dbt_tmp" rename to "qa_flagged_patients"
[0m18:33:25.442192 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:33:25.444801 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: COMMIT
[0m18:33:25.445522 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:33:25.446199 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: COMMIT
[0m18:33:25.447705 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.451618 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:33:25.452287 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */
drop view if exists "dev"."main"."qa_flagged_patients__dbt_backup" cascade
[0m18:33:25.453583 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.455815 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: Close
[0m18:33:25.456650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb93ecd-9e75-4f73-bc3f-e9739d9d2eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107763650>]}
[0m18:33:25.457578 [info ] [Thread-1 (]: 7 of 12 OK created sql view model main.qa_flagged_patients ..................... [[32mOK[0m in 0.05s]
[0m18:33:25.458509 [debug] [Thread-1 (]: Finished running node model.suvera.qa_flagged_patients
[0m18:33:25.459140 [debug] [Thread-1 (]: Began running node model.suvera.mart_age_groups_by_pcn
[0m18:33:25.459945 [info ] [Thread-1 (]: 8 of 12 START sql view model main.mart_age_groups_by_pcn ....................... [RUN]
[0m18:33:25.460657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.qa_flagged_patients, now model.suvera.mart_age_groups_by_pcn)
[0m18:33:25.461231 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_age_groups_by_pcn
[0m18:33:25.466852 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_age_groups_by_pcn"
[0m18:33:25.468602 [debug] [Thread-1 (]: Began executing node model.suvera.mart_age_groups_by_pcn
[0m18:33:25.475267 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_age_groups_by_pcn"
[0m18:33:25.476772 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:33:25.477387 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: BEGIN
[0m18:33:25.477928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:25.479012 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.479644 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:33:25.480291 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_age_groups_by_pcn"} */

  
  create view "dev"."main"."mart_age_groups_by_pcn__dbt_tmp" as (
    with patients as (
    select
        patient_id,
        practice_id,
        age,
        case
            when age between 0 and 18 then '0-18'
            when age between 19 and 35 then '19-35'
            when age between 36 and 50 then '36-50'
            when age >= 51 then '51+'
            else 'Unknown'
        end as age_group
    from "dev"."main"."cleaned_patients"
),

practices as (
    select *
    from "dev"."main"."stg_practices"
),

pcns as (
    select *
    from "dev"."main"."stg_pcns"
),

joined as (
    select
        pcn.id as pcn_id,
        pcn.pcn_name,
        p.age_group
    from patients as p
    left join practices pr on p.practice_id = pr.id
    left join pcns pcn on pr.pcn = pcn.id
)

select
    pcn_id,
    pcn_name,
    age_group,
    count(*) as num_patients
from joined
group by pcn_id, pcn_name, age_group
order by pcn_id, age_group
  );

[0m18:33:25.484433 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:33:25.490362 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:33:25.491121 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_age_groups_by_pcn"} */
alter view "dev"."main"."mart_age_groups_by_pcn" rename to "mart_age_groups_by_pcn__dbt_backup"
[0m18:33:25.492375 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.496917 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:33:25.497582 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_age_groups_by_pcn"} */
alter view "dev"."main"."mart_age_groups_by_pcn__dbt_tmp" rename to "mart_age_groups_by_pcn"
[0m18:33:25.498707 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.501268 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: COMMIT
[0m18:33:25.501895 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:33:25.502442 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: COMMIT
[0m18:33:25.503764 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.507165 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:33:25.507800 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_age_groups_by_pcn"} */
drop view if exists "dev"."main"."mart_age_groups_by_pcn__dbt_backup" cascade
[0m18:33:25.509116 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.511196 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: Close
[0m18:33:25.511996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb93ecd-9e75-4f73-bc3f-e9739d9d2eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071ffcb0>]}
[0m18:33:25.512897 [info ] [Thread-1 (]: 8 of 12 OK created sql view model main.mart_age_groups_by_pcn .................. [[32mOK[0m in 0.05s]
[0m18:33:25.513809 [debug] [Thread-1 (]: Finished running node model.suvera.mart_age_groups_by_pcn
[0m18:33:25.514417 [debug] [Thread-1 (]: Began running node model.suvera.mart_avg_age_by_practice
[0m18:33:25.515106 [info ] [Thread-1 (]: 9 of 12 START sql view model main.mart_avg_age_by_practice ..................... [RUN]
[0m18:33:25.515898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_age_groups_by_pcn, now model.suvera.mart_avg_age_by_practice)
[0m18:33:25.516482 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_avg_age_by_practice
[0m18:33:25.521010 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_avg_age_by_practice"
[0m18:33:25.522174 [debug] [Thread-1 (]: Began executing node model.suvera.mart_avg_age_by_practice
[0m18:33:25.527990 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_avg_age_by_practice"
[0m18:33:25.529145 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:33:25.529747 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: BEGIN
[0m18:33:25.530293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:25.531279 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.531860 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:33:25.532450 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_avg_age_by_practice"} */

  
  create view "dev"."main"."mart_avg_age_by_practice__dbt_tmp" as (
    with patients as (
    select
        patient_id,
        practice_id,
        age
    from "dev"."main"."cleaned_patients"
),

aggregated as (
    select
        practice_id,
        avg(age) as avg_age,
        count(*) as num_patients
    from patients
    group by practice_id
)

select * from aggregated
order by avg_age desc
  );

[0m18:33:25.536311 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:33:25.544466 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:33:25.545572 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_avg_age_by_practice"} */
alter view "dev"."main"."mart_avg_age_by_practice" rename to "mart_avg_age_by_practice__dbt_backup"
[0m18:33:25.547095 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.553286 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:33:25.554085 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_avg_age_by_practice"} */
alter view "dev"."main"."mart_avg_age_by_practice__dbt_tmp" rename to "mart_avg_age_by_practice"
[0m18:33:25.555566 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.559510 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: COMMIT
[0m18:33:25.560562 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:33:25.561193 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: COMMIT
[0m18:33:25.562514 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.566584 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:33:25.567271 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_avg_age_by_practice"} */
drop view if exists "dev"."main"."mart_avg_age_by_practice__dbt_backup" cascade
[0m18:33:25.568737 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.572143 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: Close
[0m18:33:25.573875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb93ecd-9e75-4f73-bc3f-e9739d9d2eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071fe4b0>]}
[0m18:33:25.576007 [info ] [Thread-1 (]: 9 of 12 OK created sql view model main.mart_avg_age_by_practice ................ [[32mOK[0m in 0.06s]
[0m18:33:25.577211 [debug] [Thread-1 (]: Finished running node model.suvera.mart_avg_age_by_practice
[0m18:33:25.577881 [debug] [Thread-1 (]: Began running node model.suvera.mart_hypertension_pct_by_practice
[0m18:33:25.578607 [info ] [Thread-1 (]: 10 of 12 START sql view model main.mart_hypertension_pct_by_practice ........... [RUN]
[0m18:33:25.579439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_avg_age_by_practice, now model.suvera.mart_hypertension_pct_by_practice)
[0m18:33:25.580045 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_hypertension_pct_by_practice
[0m18:33:25.583894 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_hypertension_pct_by_practice"
[0m18:33:25.585754 [debug] [Thread-1 (]: Began executing node model.suvera.mart_hypertension_pct_by_practice
[0m18:33:25.591579 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_hypertension_pct_by_practice"
[0m18:33:25.593384 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:33:25.594039 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: BEGIN
[0m18:33:25.594581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:25.595496 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.596053 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:33:25.596803 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_hypertension_pct_by_practice"} */

  
  create view "dev"."main"."mart_hypertension_pct_by_practice__dbt_tmp" as (
    with patients as (
    select
        patient_id,
        practice_id,
        conditions
    from "dev"."main"."cleaned_patients"
),

exploded as (
    select
        patient_id,
        practice_id,
        unnest(conditions) as condition
    from patients
),

hypertension_counts as (
    select
        practice_id,
        count(distinct patient_id) as patients_with_hypertension
    from exploded
    where lower(condition) = 'hypertension'
    group by practice_id
),

total_patients as (
    select
        practice_id,
        count(distinct patient_id) as total_patients
    from patients
    group by practice_id
)

select
    t.practice_id,
    t.total_patients,
    coalesce(h.patients_with_hypertension, 0) as patients_with_hypertension,
    round(
        coalesce(h.patients_with_hypertension, 0) * 100.0 / t.total_patients,
        1
    ) as pct_with_hypertension
from total_patients t
left join hypertension_counts h
    on t.practice_id = h.practice_id
order by pct_with_hypertension desc
  );

[0m18:33:25.603680 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m18:33:25.612564 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:33:25.613602 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_hypertension_pct_by_practice"} */
alter view "dev"."main"."mart_hypertension_pct_by_practice" rename to "mart_hypertension_pct_by_practice__dbt_backup"
[0m18:33:25.614966 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.619284 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:33:25.619933 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_hypertension_pct_by_practice"} */
alter view "dev"."main"."mart_hypertension_pct_by_practice__dbt_tmp" rename to "mart_hypertension_pct_by_practice"
[0m18:33:25.621004 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:33:25.623565 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: COMMIT
[0m18:33:25.624198 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:33:25.624750 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: COMMIT
[0m18:33:25.626076 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.629718 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:33:25.630292 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_hypertension_pct_by_practice"} */
drop view if exists "dev"."main"."mart_hypertension_pct_by_practice__dbt_backup" cascade
[0m18:33:25.631546 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.633561 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: Close
[0m18:33:25.634374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb93ecd-9e75-4f73-bc3f-e9739d9d2eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071fe2d0>]}
[0m18:33:25.635317 [info ] [Thread-1 (]: 10 of 12 OK created sql view model main.mart_hypertension_pct_by_practice ...... [[32mOK[0m in 0.05s]
[0m18:33:25.636257 [debug] [Thread-1 (]: Finished running node model.suvera.mart_hypertension_pct_by_practice
[0m18:33:25.636928 [debug] [Thread-1 (]: Began running node model.suvera.mart_patient_count_by_pcn
[0m18:33:25.637680 [info ] [Thread-1 (]: 11 of 12 START sql view model main.mart_patient_count_by_pcn ................... [RUN]
[0m18:33:25.638492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_hypertension_pct_by_practice, now model.suvera.mart_patient_count_by_pcn)
[0m18:33:25.639115 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_patient_count_by_pcn
[0m18:33:25.643664 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_patient_count_by_pcn"
[0m18:33:25.644832 [debug] [Thread-1 (]: Began executing node model.suvera.mart_patient_count_by_pcn
[0m18:33:25.651043 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_patient_count_by_pcn"
[0m18:33:25.652232 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:33:25.652873 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: BEGIN
[0m18:33:25.653513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:25.654619 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.655442 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:33:25.656451 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patient_count_by_pcn"} */

  
  create view "dev"."main"."mart_patient_count_by_pcn__dbt_tmp" as (
    with patients as (
    select *
    from "dev"."main"."cleaned_patients"
),

practices as (
    select *
    from "dev"."main"."stg_practices"
),

pcns as (
    select *
    from "dev"."main"."stg_pcns"
),

joined as (
    select
        pcn.id as pcn_id,
        pcn.pcn_name pcn_name,
        patient.patient_id
    from patients as patient
    left join practices as practice
        on patient.practice_id = practice.id
    left join pcns as pcn
        on practice.pcn = pcn.id
)

select
    pcn_id,
    pcn_name,
    count(distinct patient_id) as num_patients
from joined
group by 1, 2
order by num_patients desc
  );

[0m18:33:25.660543 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:33:25.666475 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:33:25.667490 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patient_count_by_pcn"} */
alter view "dev"."main"."mart_patient_count_by_pcn" rename to "mart_patient_count_by_pcn__dbt_backup"
[0m18:33:25.669588 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.674625 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:33:25.675269 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patient_count_by_pcn"} */
alter view "dev"."main"."mart_patient_count_by_pcn__dbt_tmp" rename to "mart_patient_count_by_pcn"
[0m18:33:25.676516 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.679114 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: COMMIT
[0m18:33:25.679832 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:33:25.680397 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: COMMIT
[0m18:33:25.681750 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.689844 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:33:25.690522 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patient_count_by_pcn"} */
drop view if exists "dev"."main"."mart_patient_count_by_pcn__dbt_backup" cascade
[0m18:33:25.691884 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.693906 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: Close
[0m18:33:25.694669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb93ecd-9e75-4f73-bc3f-e9739d9d2eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077633b0>]}
[0m18:33:25.695544 [info ] [Thread-1 (]: 11 of 12 OK created sql view model main.mart_patient_count_by_pcn .............. [[32mOK[0m in 0.06s]
[0m18:33:25.696584 [debug] [Thread-1 (]: Finished running node model.suvera.mart_patient_count_by_pcn
[0m18:33:25.697222 [debug] [Thread-1 (]: Began running node model.suvera.mart_recent_activity_by_patient
[0m18:33:25.697922 [info ] [Thread-1 (]: 12 of 12 START sql view model main.mart_recent_activity_by_patient ............. [RUN]
[0m18:33:25.698658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_patient_count_by_pcn, now model.suvera.mart_recent_activity_by_patient)
[0m18:33:25.699232 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_recent_activity_by_patient
[0m18:33:25.703104 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_recent_activity_by_patient"
[0m18:33:25.704966 [debug] [Thread-1 (]: Began executing node model.suvera.mart_recent_activity_by_patient
[0m18:33:25.711453 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_recent_activity_by_patient"
[0m18:33:25.712641 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:33:25.713212 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: BEGIN
[0m18:33:25.713741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:25.714690 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.715272 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:33:25.715856 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_recent_activity_by_patient"} */

  
  create view "dev"."main"."mart_recent_activity_by_patient__dbt_tmp" as (
    with patients as (
    select patient_id
    from "dev"."main"."cleaned_patients"
),

activities as (
    select
        patient_id,
        activity_date
    from "dev"."main"."stg_activities"
),

filtered as (
    select *
    from activities
    where patient_id in (select patient_id from patients)
)

select
    patient_id,
    max(activity_date) as most_recent_activity
from filtered
group by patient_id
  );

[0m18:33:25.720258 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:33:25.725619 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:33:25.726283 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_recent_activity_by_patient"} */
alter view "dev"."main"."mart_recent_activity_by_patient" rename to "mart_recent_activity_by_patient__dbt_backup"
[0m18:33:25.727293 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:33:25.731315 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:33:25.731936 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_recent_activity_by_patient"} */
alter view "dev"."main"."mart_recent_activity_by_patient__dbt_tmp" rename to "mart_recent_activity_by_patient"
[0m18:33:25.732945 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:33:25.735223 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: COMMIT
[0m18:33:25.735790 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:33:25.736328 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: COMMIT
[0m18:33:25.737651 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.741987 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:33:25.742626 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_recent_activity_by_patient"} */
drop view if exists "dev"."main"."mart_recent_activity_by_patient__dbt_backup" cascade
[0m18:33:25.743967 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:25.745935 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: Close
[0m18:33:25.746712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb93ecd-9e75-4f73-bc3f-e9739d9d2eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071ff230>]}
[0m18:33:25.747611 [info ] [Thread-1 (]: 12 of 12 OK created sql view model main.mart_recent_activity_by_patient ........ [[32mOK[0m in 0.05s]
[0m18:33:25.748502 [debug] [Thread-1 (]: Finished running node model.suvera.mart_recent_activity_by_patient
[0m18:33:25.750210 [debug] [MainThread]: Using duckdb connection "master"
[0m18:33:25.750697 [debug] [MainThread]: On master: BEGIN
[0m18:33:25.751136 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:33:25.751947 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:33:25.752427 [debug] [MainThread]: On master: COMMIT
[0m18:33:25.752892 [debug] [MainThread]: Using duckdb connection "master"
[0m18:33:25.753340 [debug] [MainThread]: On master: COMMIT
[0m18:33:25.754013 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:33:25.754733 [debug] [MainThread]: On master: Close
[0m18:33:25.755522 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:33:25.756084 [debug] [MainThread]: Connection 'model.suvera.mart_recent_activity_by_patient' was properly closed.
[0m18:33:25.756668 [info ] [MainThread]: 
[0m18:33:25.757743 [info ] [MainThread]: Finished running 12 view models in 0 hours 0 minutes and 1.06 seconds (1.06s).
[0m18:33:25.762290 [debug] [MainThread]: Command end result
[0m18:33:25.806778 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m18:33:25.812330 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m18:33:25.824334 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m18:33:25.824895 [info ] [MainThread]: 
[0m18:33:25.825463 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:33:25.825979 [info ] [MainThread]: 
[0m18:33:25.826524 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m18:33:25.831555 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.119411, "process_in_blocks": "0", "process_kernel_time": 0.833344, "process_mem_max_rss": "140201984", "process_out_blocks": "0", "process_user_time": 4.894522}
[0m18:33:25.832836 [debug] [MainThread]: Command `dbt run` succeeded at 18:33:25.832263 after 3.12 seconds
[0m18:33:25.833551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10711e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de3050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078fbf50>]}
[0m18:33:25.834319 [debug] [MainThread]: Flushing usage events
[0m18:33:26.335530 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:34:15.091763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d619d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3f7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3f7750>]}


============================== 18:34:15.101183 | 233aaf64-c20e-4de5-a368-e902bdc8dfd5 ==============================
[0m18:34:15.101183 [info ] [MainThread]: Running with dbt=1.10.1
[0m18:34:15.102451 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:34:15.610234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '233aaf64-c20e-4de5-a368-e902bdc8dfd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8d1220>]}
[0m18:34:15.726930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '233aaf64-c20e-4de5-a368-e902bdc8dfd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2e3350>]}
[0m18:34:15.758408 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m18:34:15.938076 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m18:34:16.254997 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:34:16.255617 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:34:16.337157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '233aaf64-c20e-4de5-a368-e902bdc8dfd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6f3650>]}
[0m18:34:16.494798 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m18:34:16.500564 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m18:34:16.552824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '233aaf64-c20e-4de5-a368-e902bdc8dfd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6c2d50>]}
[0m18:34:16.553596 [info ] [MainThread]: Found 12 models, 4 seeds, 12 data tests, 544 macros
[0m18:34:16.554181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '233aaf64-c20e-4de5-a368-e902bdc8dfd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eaece50>]}
[0m18:34:16.558130 [info ] [MainThread]: 
[0m18:34:16.558834 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:34:16.559545 [info ] [MainThread]: 
[0m18:34:16.560517 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:34:16.568944 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m18:34:16.671769 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m18:34:16.672403 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m18:34:16.672885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:16.692536 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m18:34:16.693176 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m18:34:16.694344 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:16.694797 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m18:34:16.695250 [info ] [MainThread]: 
[0m18:34:16.695772 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m18:34:16.696514 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/puneeth/Documents/suvera_dbt_project/suvera/dev.duckdb": Conflicting lock is held in /usr/local/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 31245) by user puneeth. See also https://duckdb.org/docs/stable/connect/concurrency
[0m18:34:16.701463 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.733079, "process_in_blocks": "0", "process_kernel_time": 0.760651, "process_mem_max_rss": "126115840", "process_out_blocks": "0", "process_user_time": 3.76088}
[0m18:34:16.702376 [debug] [MainThread]: Command `dbt run` failed at 18:34:16.702189 after 1.73 seconds
[0m18:34:16.703195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecf4c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2a5a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ede8290>]}
[0m18:34:16.703811 [debug] [MainThread]: Flushing usage events
[0m18:34:17.096746 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:40:14.350080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118a9d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126bb610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126bb750>]}


============================== 18:40:14.362533 | 84a0741a-9489-46f0-a5f3-f19e89ef5f93 ==============================
[0m18:40:14.362533 [info ] [MainThread]: Running with dbt=1.10.1
[0m18:40:14.364248 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/puneeth/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:40:14.871272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84a0741a-9489-46f0-a5f3-f19e89ef5f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b89220>]}
[0m18:40:14.980917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84a0741a-9489-46f0-a5f3-f19e89ef5f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125a3350>]}
[0m18:40:15.014888 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m18:40:15.199417 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m18:40:15.525284 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:40:15.526292 [debug] [MainThread]: Partial parsing: updated file: suvera://models/qa/qa_flagged_patients.sql
[0m18:40:15.971797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84a0741a-9489-46f0-a5f3-f19e89ef5f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e58350>]}
[0m18:40:16.110826 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m18:40:16.115747 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m18:40:16.169288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84a0741a-9489-46f0-a5f3-f19e89ef5f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112992d50>]}
[0m18:40:16.170089 [info ] [MainThread]: Found 12 models, 4 seeds, 12 data tests, 544 macros
[0m18:40:16.170660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84a0741a-9489-46f0-a5f3-f19e89ef5f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f50910>]}
[0m18:40:16.174240 [info ] [MainThread]: 
[0m18:40:16.174831 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:40:16.175388 [info ] [MainThread]: 
[0m18:40:16.176393 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:40:16.186079 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m18:40:16.283646 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m18:40:16.284270 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m18:40:16.284759 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:40:16.312554 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m18:40:16.318253 [debug] [ThreadPool]: On list_dev: Close
[0m18:40:16.320545 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m18:40:16.321625 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m18:40:16.331845 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:40:16.332496 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m18:40:16.332962 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:40:16.334332 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:40:16.337322 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:40:16.337911 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m18:40:16.338686 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:40:16.339144 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:40:16.339598 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m18:40:16.345013 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m18:40:16.346631 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m18:40:16.347153 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:40:16.347603 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m18:40:16.348366 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:40:16.348904 [debug] [ThreadPool]: On create_dev_main: Close
[0m18:40:16.351978 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m18:40:16.435785 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m18:40:16.436368 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m18:40:16.436818 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:40:16.437650 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:40:16.438129 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m18:40:16.438608 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m18:40:16.468222 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m18:40:16.471641 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m18:40:16.474136 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m18:40:16.474754 [debug] [ThreadPool]: On list_dev_main: Close
[0m18:40:16.479955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84a0741a-9489-46f0-a5f3-f19e89ef5f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ea7e10>]}
[0m18:40:16.480666 [debug] [MainThread]: Using duckdb connection "master"
[0m18:40:16.481137 [debug] [MainThread]: On master: BEGIN
[0m18:40:16.481575 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:40:16.482429 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:40:16.482915 [debug] [MainThread]: On master: COMMIT
[0m18:40:16.483384 [debug] [MainThread]: Using duckdb connection "master"
[0m18:40:16.483831 [debug] [MainThread]: On master: COMMIT
[0m18:40:16.484497 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:40:16.484977 [debug] [MainThread]: On master: Close
[0m18:40:16.489486 [debug] [Thread-1 (]: Began running node model.suvera.stg_activities
[0m18:40:16.490382 [info ] [Thread-1 (]: 1 of 12 START sql view model main.stg_activities ............................... [RUN]
[0m18:40:16.491126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.stg_activities)
[0m18:40:16.491686 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_activities
[0m18:40:16.502734 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_activities"
[0m18:40:16.504701 [debug] [Thread-1 (]: Began executing node model.suvera.stg_activities
[0m18:40:16.554076 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_activities"
[0m18:40:16.555272 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:40:16.555919 [debug] [Thread-1 (]: On model.suvera.stg_activities: BEGIN
[0m18:40:16.556462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:40:16.557440 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:16.558009 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:40:16.558576 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */

  
  create view "dev"."main"."stg_activities__dbt_tmp" as (
    select * 
from "dev"."main"."raw_activities"
  );

[0m18:40:16.560362 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:16.569955 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:40:16.570593 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
alter view "dev"."main"."stg_activities" rename to "stg_activities__dbt_backup"
[0m18:40:16.575879 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:40:16.580348 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:40:16.580921 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
alter view "dev"."main"."stg_activities__dbt_tmp" rename to "stg_activities"
[0m18:40:16.581885 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:40:16.599720 [debug] [Thread-1 (]: On model.suvera.stg_activities: COMMIT
[0m18:40:16.600346 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:40:16.600885 [debug] [Thread-1 (]: On model.suvera.stg_activities: COMMIT
[0m18:40:16.605964 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:40:16.613664 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:40:16.614281 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
drop view if exists "dev"."main"."stg_activities__dbt_backup" cascade
[0m18:40:16.617849 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:40:16.621719 [debug] [Thread-1 (]: On model.suvera.stg_activities: Close
[0m18:40:16.625904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84a0741a-9489-46f0-a5f3-f19e89ef5f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11311e5d0>]}
[0m18:40:16.627117 [info ] [Thread-1 (]: 1 of 12 OK created sql view model main.stg_activities .......................... [[32mOK[0m in 0.13s]
[0m18:40:16.628094 [debug] [Thread-1 (]: Finished running node model.suvera.stg_activities
[0m18:40:16.628742 [debug] [Thread-1 (]: Began running node model.suvera.stg_patients
[0m18:40:16.629449 [info ] [Thread-1 (]: 2 of 12 START sql view model main.stg_patients ................................. [RUN]
[0m18:40:16.630301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_activities, now model.suvera.stg_patients)
[0m18:40:16.630899 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_patients
[0m18:40:16.634997 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_patients"
[0m18:40:16.636937 [debug] [Thread-1 (]: Began executing node model.suvera.stg_patients
[0m18:40:16.643475 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_patients"
[0m18:40:16.645263 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:40:16.645940 [debug] [Thread-1 (]: On model.suvera.stg_patients: BEGIN
[0m18:40:16.646484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:40:16.647435 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:16.647989 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:40:16.648602 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */

  
  create view "dev"."main"."stg_patients__dbt_tmp" as (
    with source as (
    select * from "dev"."main"."raw_patients"
),

parsed as (
    select
        case
            when regexp_extract(data, '"patient_id": ([0-9]+)', 1) ~ '^[0-9]+$'
            then cast(regexp_extract(data, '"patient_id": ([0-9]+)', 1) as integer)
        end as patient_id,
        case
            when regexp_extract(data, '"practice_id": ([0-9]+)', 1) ~ '^[0-9]+$'
            then cast(regexp_extract(data, '"practice_id": ([0-9]+)', 1) as integer)
        end as practice_id,
        case
            when regexp_extract(data, '"age": ([0-9]+)', 1) ~ '^[0-9]+$'
            then cast(regexp_extract(data, '"age": ([0-9]+)', 1) as integer)
        end as age,
        regexp_extract(data, '"gender": "([^""]*)"', 1) as gender,
        cast(nullif(regexp_extract(data, '"registration_date": "([^"]+)"', 1), '') as date) as registration_date,
        regexp_extract(data, '"email": "([^"]+)"', 1) as email,
        regexp_extract(data, '"phone": "([^"]+)"', 1) as phone,
        string_split(
            replace(
                regexp_extract(data, '"conditions": \[(.*?)\]', 1),
                '"',
                ''
            ),
            ', '
        ) as conditions
    from source
)

select * from parsed
  );

[0m18:40:16.652121 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:40:16.656277 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:40:16.656891 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients" rename to "stg_patients__dbt_backup"
[0m18:40:16.658323 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:16.662439 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:40:16.663022 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m18:40:16.663940 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:40:16.666285 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m18:40:16.666869 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:40:16.667404 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m18:40:16.668741 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:16.672486 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:40:16.673038 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
drop view if exists "dev"."main"."stg_patients__dbt_backup" cascade
[0m18:40:16.674257 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:16.676312 [debug] [Thread-1 (]: On model.suvera.stg_patients: Close
[0m18:40:16.677114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84a0741a-9489-46f0-a5f3-f19e89ef5f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112eb6c50>]}
[0m18:40:16.678003 [info ] [Thread-1 (]: 2 of 12 OK created sql view model main.stg_patients ............................ [[32mOK[0m in 0.05s]
[0m18:40:16.678900 [debug] [Thread-1 (]: Finished running node model.suvera.stg_patients
[0m18:40:16.679500 [debug] [Thread-1 (]: Began running node model.suvera.stg_pcns
[0m18:40:16.680179 [info ] [Thread-1 (]: 3 of 12 START sql view model main.stg_pcns ..................................... [RUN]
[0m18:40:16.680939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_patients, now model.suvera.stg_pcns)
[0m18:40:16.681510 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_pcns
[0m18:40:16.685003 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_pcns"
[0m18:40:16.686721 [debug] [Thread-1 (]: Began executing node model.suvera.stg_pcns
[0m18:40:16.692270 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_pcns"
[0m18:40:16.693424 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:40:16.694012 [debug] [Thread-1 (]: On model.suvera.stg_pcns: BEGIN
[0m18:40:16.694546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:40:16.695442 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:16.696005 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:40:16.696560 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */

  
  create view "dev"."main"."stg_pcns__dbt_tmp" as (
    select * 
from "dev"."main"."raw_pcns"
  );

[0m18:40:16.697588 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:40:16.702361 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:40:16.703013 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */
alter view "dev"."main"."stg_pcns" rename to "stg_pcns__dbt_backup"
[0m18:40:16.703982 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:40:16.708896 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:40:16.709511 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */
alter view "dev"."main"."stg_pcns__dbt_tmp" rename to "stg_pcns"
[0m18:40:16.710523 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:40:16.714020 [debug] [Thread-1 (]: On model.suvera.stg_pcns: COMMIT
[0m18:40:16.714621 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:40:16.715153 [debug] [Thread-1 (]: On model.suvera.stg_pcns: COMMIT
[0m18:40:16.716505 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:16.720186 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:40:16.720819 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */
drop view if exists "dev"."main"."stg_pcns__dbt_backup" cascade
[0m18:40:16.722137 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:16.724138 [debug] [Thread-1 (]: On model.suvera.stg_pcns: Close
[0m18:40:16.724906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84a0741a-9489-46f0-a5f3-f19e89ef5f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c1f890>]}
[0m18:40:16.725904 [info ] [Thread-1 (]: 3 of 12 OK created sql view model main.stg_pcns ................................ [[32mOK[0m in 0.04s]
[0m18:40:16.726868 [debug] [Thread-1 (]: Finished running node model.suvera.stg_pcns
[0m18:40:16.727861 [debug] [Thread-1 (]: Began running node model.suvera.stg_practices
[0m18:40:16.728591 [info ] [Thread-1 (]: 4 of 12 START sql view model main.stg_practices ................................ [RUN]
[0m18:40:16.729288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_pcns, now model.suvera.stg_practices)
[0m18:40:16.729856 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_practices
[0m18:40:16.733602 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_practices"
[0m18:40:16.735058 [debug] [Thread-1 (]: Began executing node model.suvera.stg_practices
[0m18:40:16.741760 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_practices"
[0m18:40:16.743387 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:40:16.744084 [debug] [Thread-1 (]: On model.suvera.stg_practices: BEGIN
[0m18:40:16.744627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:40:16.745686 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:16.746269 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:40:16.746814 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */

  
  create view "dev"."main"."stg_practices__dbt_tmp" as (
    select * 
from "dev"."main"."raw_practices"
  );

[0m18:40:16.747848 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:40:16.752622 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:40:16.753281 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */
alter view "dev"."main"."stg_practices" rename to "stg_practices__dbt_backup"
[0m18:40:16.754257 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:40:16.758644 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:40:16.759220 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */
alter view "dev"."main"."stg_practices__dbt_tmp" rename to "stg_practices"
[0m18:40:16.760165 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:40:16.762824 [debug] [Thread-1 (]: On model.suvera.stg_practices: COMMIT
[0m18:40:16.763505 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:40:16.764056 [debug] [Thread-1 (]: On model.suvera.stg_practices: COMMIT
[0m18:40:16.765317 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:16.768408 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:40:16.768967 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */
drop view if exists "dev"."main"."stg_practices__dbt_backup" cascade
[0m18:40:16.770239 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:16.772271 [debug] [Thread-1 (]: On model.suvera.stg_practices: Close
[0m18:40:16.773041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84a0741a-9489-46f0-a5f3-f19e89ef5f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129057d0>]}
[0m18:40:16.773943 [info ] [Thread-1 (]: 4 of 12 OK created sql view model main.stg_practices ........................... [[32mOK[0m in 0.04s]
[0m18:40:16.774837 [debug] [Thread-1 (]: Finished running node model.suvera.stg_practices
[0m18:40:16.775459 [debug] [Thread-1 (]: Began running node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:40:16.776290 [info ] [Thread-1 (]: 5 of 12 START sql view model main.mart_patients_inactive_3_months_after_first .. [RUN]
[0m18:40:16.777130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_practices, now model.suvera.mart_patients_inactive_3_months_after_first)
[0m18:40:16.777757 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:40:16.781485 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:40:16.783250 [debug] [Thread-1 (]: Began executing node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:40:16.788629 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:40:16.789859 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:40:16.790475 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: BEGIN
[0m18:40:16.791017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:40:16.791911 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:16.792465 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:40:16.793055 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */

  
  create view "dev"."main"."mart_patients_inactive_3_months_after_first__dbt_tmp" as (
    with activities as (
    select
        patient_id,
        activity_date
    from "dev"."main"."stg_activities"
),

first_activity as (
    select
        patient_id,
        min(activity_date) as first_date
    from activities
    group by patient_id
),

follow_up_activity as (
    select
        a.patient_id
    from activities a
    join first_activity f
        on a.patient_id = f.patient_id
    where a.activity_date > f.first_date
      and a.activity_date <= f.first_date + interval '90 days'
),

inactive_patients as (
    select
        f.patient_id,
        f.first_date
    from first_activity f
    left join follow_up_activity fu
        on f.patient_id = fu.patient_id
    where fu.patient_id is null
)

select *
from inactive_patients
  );

[0m18:40:16.795747 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:40:16.800131 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:40:16.800802 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */
alter view "dev"."main"."mart_patients_inactive_3_months_after_first" rename to "mart_patients_inactive_3_months_after_first__dbt_backup"
[0m18:40:16.801874 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:40:16.807020 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:40:16.807698 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */
alter view "dev"."main"."mart_patients_inactive_3_months_after_first__dbt_tmp" rename to "mart_patients_inactive_3_months_after_first"
[0m18:40:16.808718 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:40:16.811045 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: COMMIT
[0m18:40:16.811663 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:40:16.812520 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: COMMIT
[0m18:40:16.814023 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:16.817516 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:40:16.818316 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */
drop view if exists "dev"."main"."mart_patients_inactive_3_months_after_first__dbt_backup" cascade
[0m18:40:16.819785 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:16.821865 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: Close
[0m18:40:16.822638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84a0741a-9489-46f0-a5f3-f19e89ef5f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f46040>]}
[0m18:40:16.823523 [info ] [Thread-1 (]: 5 of 12 OK created sql view model main.mart_patients_inactive_3_months_after_first  [[32mOK[0m in 0.05s]
[0m18:40:16.824419 [debug] [Thread-1 (]: Finished running node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:40:16.825020 [debug] [Thread-1 (]: Began running node model.suvera.cleaned_patients
[0m18:40:16.825702 [info ] [Thread-1 (]: 6 of 12 START sql view model main.cleaned_patients ............................. [RUN]
[0m18:40:16.826360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_patients_inactive_3_months_after_first, now model.suvera.cleaned_patients)
[0m18:40:16.827001 [debug] [Thread-1 (]: Began compiling node model.suvera.cleaned_patients
[0m18:40:16.831268 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.cleaned_patients"
[0m18:40:16.832878 [debug] [Thread-1 (]: Began executing node model.suvera.cleaned_patients
[0m18:40:16.842577 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.cleaned_patients"
[0m18:40:16.843775 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:40:16.844389 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: BEGIN
[0m18:40:16.845242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:40:16.846521 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:16.847201 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:40:16.847876 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */

  
  create view "dev"."main"."cleaned_patients__dbt_tmp" as (
    with deduplicated as (
    select *
    from (
        select *,
               row_number() over (
                   partition by patient_id, practice_id
                   order by registration_date desc
               ) as row_num
        from "dev"."main"."stg_patients"
    )
    where row_num = 1
),

filtered as (
    select *
    from deduplicated
    where age between 0 and 120 and practice_id between 1 and 4 and age != 999
)

select
    patient_id,
    practice_id,
    age,
    gender,
    registration_date,
    email,
    phone,
    conditions
from filtered
  );

[0m18:40:16.852672 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:40:16.856833 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:40:16.857414 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */
alter view "dev"."main"."cleaned_patients" rename to "cleaned_patients__dbt_backup"
[0m18:40:16.858344 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:40:16.862725 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:40:16.863620 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */
alter view "dev"."main"."cleaned_patients__dbt_tmp" rename to "cleaned_patients"
[0m18:40:16.864652 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:40:16.867045 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: COMMIT
[0m18:40:16.867645 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:40:16.868179 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: COMMIT
[0m18:40:16.869528 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:16.872723 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:40:16.873292 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */
drop view if exists "dev"."main"."cleaned_patients__dbt_backup" cascade
[0m18:40:16.874606 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:16.876607 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: Close
[0m18:40:16.877374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84a0741a-9489-46f0-a5f3-f19e89ef5f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126d0a10>]}
[0m18:40:16.878354 [info ] [Thread-1 (]: 6 of 12 OK created sql view model main.cleaned_patients ........................ [[32mOK[0m in 0.05s]
[0m18:40:16.879282 [debug] [Thread-1 (]: Finished running node model.suvera.cleaned_patients
[0m18:40:16.879893 [debug] [Thread-1 (]: Began running node model.suvera.qa_flagged_patients
[0m18:40:16.880584 [info ] [Thread-1 (]: 7 of 12 START sql view model main.qa_flagged_patients .......................... [RUN]
[0m18:40:16.881374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.cleaned_patients, now model.suvera.qa_flagged_patients)
[0m18:40:16.882131 [debug] [Thread-1 (]: Began compiling node model.suvera.qa_flagged_patients
[0m18:40:16.886789 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.qa_flagged_patients"
[0m18:40:16.887917 [debug] [Thread-1 (]: Began executing node model.suvera.qa_flagged_patients
[0m18:40:16.892545 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.qa_flagged_patients"
[0m18:40:16.893627 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:40:16.894195 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: BEGIN
[0m18:40:16.894716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:40:16.895649 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:16.896207 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:40:16.896798 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */

  
  create view "dev"."main"."qa_flagged_patients__dbt_tmp" as (
    with source as (
    select *
    from "dev"."main"."stg_patients"
),

deduplicated as (
    select *
    from (
        select *,
               row_number() over (
                   partition by patient_id, practice_id
                   order by registration_date desc
               ) as row_num
        from source
    )
),

flagged as (
    select *,
        case
            when row_num > 1 then 'duplicate registration for patient + practice'
            when age not between 0 and 120 then 'invalid age'
            when practice_id is null then 'missing practice_id'
            when practice_id = 999 then 'dummy practice_id (999)'
        end as reason_flagged
    from deduplicated
    where
        row_num > 1
        or age not between 0 and 120
        or practice_id is null
        or practice_id = 999
)

select *
from flagged
  );

[0m18:40:16.900230 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:40:16.906013 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:40:16.907233 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */
alter view "dev"."main"."qa_flagged_patients" rename to "qa_flagged_patients__dbt_backup"
[0m18:40:16.908276 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:40:16.912332 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:40:16.913087 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */
alter view "dev"."main"."qa_flagged_patients__dbt_tmp" rename to "qa_flagged_patients"
[0m18:40:16.914366 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:40:16.917762 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: COMMIT
[0m18:40:16.918445 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:40:16.919627 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: COMMIT
[0m18:40:16.920971 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:16.924083 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:40:16.924659 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */
drop view if exists "dev"."main"."qa_flagged_patients__dbt_backup" cascade
[0m18:40:16.925960 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:16.928025 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: Close
[0m18:40:16.928932 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84a0741a-9489-46f0-a5f3-f19e89ef5f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127d0710>]}
[0m18:40:16.930205 [info ] [Thread-1 (]: 7 of 12 OK created sql view model main.qa_flagged_patients ..................... [[32mOK[0m in 0.05s]
[0m18:40:16.931222 [debug] [Thread-1 (]: Finished running node model.suvera.qa_flagged_patients
[0m18:40:16.931918 [debug] [Thread-1 (]: Began running node model.suvera.mart_age_groups_by_pcn
[0m18:40:16.932732 [info ] [Thread-1 (]: 8 of 12 START sql view model main.mart_age_groups_by_pcn ....................... [RUN]
[0m18:40:16.933522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.qa_flagged_patients, now model.suvera.mart_age_groups_by_pcn)
[0m18:40:16.934108 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_age_groups_by_pcn
[0m18:40:16.939252 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_age_groups_by_pcn"
[0m18:40:16.940776 [debug] [Thread-1 (]: Began executing node model.suvera.mart_age_groups_by_pcn
[0m18:40:16.946694 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_age_groups_by_pcn"
[0m18:40:16.948504 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:40:16.949228 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: BEGIN
[0m18:40:16.950113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:40:16.951768 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:40:16.952450 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:40:16.953080 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_age_groups_by_pcn"} */

  
  create view "dev"."main"."mart_age_groups_by_pcn__dbt_tmp" as (
    with patients as (
    select
        patient_id,
        practice_id,
        age,
        case
            when age between 0 and 18 then '0-18'
            when age between 19 and 35 then '19-35'
            when age between 36 and 50 then '36-50'
            when age >= 51 then '51+'
            else 'Unknown'
        end as age_group
    from "dev"."main"."cleaned_patients"
),

practices as (
    select *
    from "dev"."main"."stg_practices"
),

pcns as (
    select *
    from "dev"."main"."stg_pcns"
),

joined as (
    select
        pcn.id as pcn_id,
        pcn.pcn_name,
        p.age_group
    from patients as p
    left join practices pr on p.practice_id = pr.id
    left join pcns pcn on pr.pcn = pcn.id
)

select
    pcn_id,
    pcn_name,
    age_group,
    count(*) as num_patients
from joined
group by pcn_id, pcn_name, age_group
order by pcn_id, age_group
  );

[0m18:40:16.956937 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:40:16.962178 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:40:16.963070 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_age_groups_by_pcn"} */
alter view "dev"."main"."mart_age_groups_by_pcn" rename to "mart_age_groups_by_pcn__dbt_backup"
[0m18:40:16.964775 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:16.970402 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:40:16.971126 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_age_groups_by_pcn"} */
alter view "dev"."main"."mart_age_groups_by_pcn__dbt_tmp" rename to "mart_age_groups_by_pcn"
[0m18:40:16.972377 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:16.974880 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: COMMIT
[0m18:40:16.975507 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:40:16.976064 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: COMMIT
[0m18:40:16.977447 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:16.981115 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:40:16.981769 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_age_groups_by_pcn"} */
drop view if exists "dev"."main"."mart_age_groups_by_pcn__dbt_backup" cascade
[0m18:40:16.983206 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:16.985317 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: Close
[0m18:40:16.986159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84a0741a-9489-46f0-a5f3-f19e89ef5f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d72150>]}
[0m18:40:16.987096 [info ] [Thread-1 (]: 8 of 12 OK created sql view model main.mart_age_groups_by_pcn .................. [[32mOK[0m in 0.05s]
[0m18:40:16.988019 [debug] [Thread-1 (]: Finished running node model.suvera.mart_age_groups_by_pcn
[0m18:40:16.988654 [debug] [Thread-1 (]: Began running node model.suvera.mart_avg_age_by_practice
[0m18:40:16.989449 [info ] [Thread-1 (]: 9 of 12 START sql view model main.mart_avg_age_by_practice ..................... [RUN]
[0m18:40:16.990424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_age_groups_by_pcn, now model.suvera.mart_avg_age_by_practice)
[0m18:40:16.991097 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_avg_age_by_practice
[0m18:40:16.995736 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_avg_age_by_practice"
[0m18:40:16.996844 [debug] [Thread-1 (]: Began executing node model.suvera.mart_avg_age_by_practice
[0m18:40:17.003190 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_avg_age_by_practice"
[0m18:40:17.004358 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:40:17.004941 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: BEGIN
[0m18:40:17.005481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:40:17.006380 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:17.007046 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:40:17.007658 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_avg_age_by_practice"} */

  
  create view "dev"."main"."mart_avg_age_by_practice__dbt_tmp" as (
    with patients as (
    select
        patient_id,
        practice_id,
        age
    from "dev"."main"."cleaned_patients"
),

aggregated as (
    select
        practice_id,
        avg(age) as avg_age,
        count(*) as num_patients
    from patients
    group by practice_id
)

select * from aggregated
order by avg_age desc
  );

[0m18:40:17.010680 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:40:17.017897 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:40:17.018658 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_avg_age_by_practice"} */
alter view "dev"."main"."mart_avg_age_by_practice" rename to "mart_avg_age_by_practice__dbt_backup"
[0m18:40:17.019805 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:17.024113 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:40:17.024771 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_avg_age_by_practice"} */
alter view "dev"."main"."mart_avg_age_by_practice__dbt_tmp" rename to "mart_avg_age_by_practice"
[0m18:40:17.025769 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:40:17.028102 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: COMMIT
[0m18:40:17.028701 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:40:17.029244 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: COMMIT
[0m18:40:17.030810 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:17.034884 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:40:17.035495 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_avg_age_by_practice"} */
drop view if exists "dev"."main"."mart_avg_age_by_practice__dbt_backup" cascade
[0m18:40:17.036756 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:17.038727 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: Close
[0m18:40:17.039495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84a0741a-9489-46f0-a5f3-f19e89ef5f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d710d0>]}
[0m18:40:17.040409 [info ] [Thread-1 (]: 9 of 12 OK created sql view model main.mart_avg_age_by_practice ................ [[32mOK[0m in 0.05s]
[0m18:40:17.041399 [debug] [Thread-1 (]: Finished running node model.suvera.mart_avg_age_by_practice
[0m18:40:17.042056 [debug] [Thread-1 (]: Began running node model.suvera.mart_hypertension_pct_by_practice
[0m18:40:17.042774 [info ] [Thread-1 (]: 10 of 12 START sql view model main.mart_hypertension_pct_by_practice ........... [RUN]
[0m18:40:17.043572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_avg_age_by_practice, now model.suvera.mart_hypertension_pct_by_practice)
[0m18:40:17.044207 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_hypertension_pct_by_practice
[0m18:40:17.048300 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_hypertension_pct_by_practice"
[0m18:40:17.050465 [debug] [Thread-1 (]: Began executing node model.suvera.mart_hypertension_pct_by_practice
[0m18:40:17.055918 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_hypertension_pct_by_practice"
[0m18:40:17.057114 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:40:17.057749 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: BEGIN
[0m18:40:17.058296 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:40:17.059465 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:17.060541 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:40:17.061654 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_hypertension_pct_by_practice"} */

  
  create view "dev"."main"."mart_hypertension_pct_by_practice__dbt_tmp" as (
    with patients as (
    select
        patient_id,
        practice_id,
        conditions
    from "dev"."main"."cleaned_patients"
),

exploded as (
    select
        patient_id,
        practice_id,
        unnest(conditions) as condition
    from patients
),

hypertension_counts as (
    select
        practice_id,
        count(distinct patient_id) as patients_with_hypertension
    from exploded
    where lower(condition) = 'hypertension'
    group by practice_id
),

total_patients as (
    select
        practice_id,
        count(distinct patient_id) as total_patients
    from patients
    group by practice_id
)

select
    t.practice_id,
    t.total_patients,
    coalesce(h.patients_with_hypertension, 0) as patients_with_hypertension,
    round(
        coalesce(h.patients_with_hypertension, 0) * 100.0 / t.total_patients,
        1
    ) as pct_with_hypertension
from total_patients t
left join hypertension_counts h
    on t.practice_id = h.practice_id
order by pct_with_hypertension desc
  );

[0m18:40:17.069222 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m18:40:17.074355 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:40:17.075040 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_hypertension_pct_by_practice"} */
alter view "dev"."main"."mart_hypertension_pct_by_practice" rename to "mart_hypertension_pct_by_practice__dbt_backup"
[0m18:40:17.076103 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:40:17.080340 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:40:17.081355 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_hypertension_pct_by_practice"} */
alter view "dev"."main"."mart_hypertension_pct_by_practice__dbt_tmp" rename to "mart_hypertension_pct_by_practice"
[0m18:40:17.083462 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:17.085913 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: COMMIT
[0m18:40:17.086516 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:40:17.087058 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: COMMIT
[0m18:40:17.088397 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:17.092048 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:40:17.092631 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_hypertension_pct_by_practice"} */
drop view if exists "dev"."main"."mart_hypertension_pct_by_practice__dbt_backup" cascade
[0m18:40:17.093910 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:17.095867 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: Close
[0m18:40:17.096628 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84a0741a-9489-46f0-a5f3-f19e89ef5f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d70590>]}
[0m18:40:17.097587 [info ] [Thread-1 (]: 10 of 12 OK created sql view model main.mart_hypertension_pct_by_practice ...... [[32mOK[0m in 0.05s]
[0m18:40:17.098767 [debug] [Thread-1 (]: Finished running node model.suvera.mart_hypertension_pct_by_practice
[0m18:40:17.099446 [debug] [Thread-1 (]: Began running node model.suvera.mart_patient_count_by_pcn
[0m18:40:17.100235 [info ] [Thread-1 (]: 11 of 12 START sql view model main.mart_patient_count_by_pcn ................... [RUN]
[0m18:40:17.100942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_hypertension_pct_by_practice, now model.suvera.mart_patient_count_by_pcn)
[0m18:40:17.101505 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_patient_count_by_pcn
[0m18:40:17.105754 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_patient_count_by_pcn"
[0m18:40:17.106919 [debug] [Thread-1 (]: Began executing node model.suvera.mart_patient_count_by_pcn
[0m18:40:17.112178 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_patient_count_by_pcn"
[0m18:40:17.113347 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:40:17.113935 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: BEGIN
[0m18:40:17.114459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:40:17.115489 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:17.116095 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:40:17.116760 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patient_count_by_pcn"} */

  
  create view "dev"."main"."mart_patient_count_by_pcn__dbt_tmp" as (
    with patients as (
    select *
    from "dev"."main"."cleaned_patients"
),

practices as (
    select *
    from "dev"."main"."stg_practices"
),

pcns as (
    select *
    from "dev"."main"."stg_pcns"
),

joined as (
    select
        pcn.id as pcn_id,
        pcn.pcn_name pcn_name,
        patient.patient_id
    from patients as patient
    left join practices as practice
        on patient.practice_id = practice.id
    left join pcns as pcn
        on practice.pcn = pcn.id
)

select
    pcn_id,
    pcn_name,
    count(distinct patient_id) as num_patients
from joined
group by 1, 2
order by num_patients desc
  );

[0m18:40:17.120938 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:40:17.125257 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:40:17.125932 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patient_count_by_pcn"} */
alter view "dev"."main"."mart_patient_count_by_pcn" rename to "mart_patient_count_by_pcn__dbt_backup"
[0m18:40:17.126958 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:40:17.130949 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:40:17.131579 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patient_count_by_pcn"} */
alter view "dev"."main"."mart_patient_count_by_pcn__dbt_tmp" rename to "mart_patient_count_by_pcn"
[0m18:40:17.133251 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:17.136547 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: COMMIT
[0m18:40:17.137190 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:40:17.137730 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: COMMIT
[0m18:40:17.139088 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:17.147031 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:40:17.147909 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patient_count_by_pcn"} */
drop view if exists "dev"."main"."mart_patient_count_by_pcn__dbt_backup" cascade
[0m18:40:17.150162 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:17.152599 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: Close
[0m18:40:17.153461 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84a0741a-9489-46f0-a5f3-f19e89ef5f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127d1250>]}
[0m18:40:17.154487 [info ] [Thread-1 (]: 11 of 12 OK created sql view model main.mart_patient_count_by_pcn .............. [[32mOK[0m in 0.05s]
[0m18:40:17.155681 [debug] [Thread-1 (]: Finished running node model.suvera.mart_patient_count_by_pcn
[0m18:40:17.156377 [debug] [Thread-1 (]: Began running node model.suvera.mart_recent_activity_by_patient
[0m18:40:17.157677 [info ] [Thread-1 (]: 12 of 12 START sql view model main.mart_recent_activity_by_patient ............. [RUN]
[0m18:40:17.159245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_patient_count_by_pcn, now model.suvera.mart_recent_activity_by_patient)
[0m18:40:17.159970 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_recent_activity_by_patient
[0m18:40:17.167331 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_recent_activity_by_patient"
[0m18:40:17.170951 [debug] [Thread-1 (]: Began executing node model.suvera.mart_recent_activity_by_patient
[0m18:40:17.179144 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_recent_activity_by_patient"
[0m18:40:17.184941 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:40:17.186448 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: BEGIN
[0m18:40:17.187064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:40:17.188040 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:17.188624 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:40:17.189221 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_recent_activity_by_patient"} */

  
  create view "dev"."main"."mart_recent_activity_by_patient__dbt_tmp" as (
    with patients as (
    select patient_id
    from "dev"."main"."cleaned_patients"
),

activities as (
    select
        patient_id,
        activity_date
    from "dev"."main"."stg_activities"
),

filtered as (
    select *
    from activities
    where patient_id in (select patient_id from patients)
)

select
    patient_id,
    max(activity_date) as most_recent_activity
from filtered
group by patient_id
  );

[0m18:40:17.195289 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:40:17.200000 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:40:17.202423 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_recent_activity_by_patient"} */
alter view "dev"."main"."mart_recent_activity_by_patient" rename to "mart_recent_activity_by_patient__dbt_backup"
[0m18:40:17.203899 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:40:17.208274 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:40:17.208909 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_recent_activity_by_patient"} */
alter view "dev"."main"."mart_recent_activity_by_patient__dbt_tmp" rename to "mart_recent_activity_by_patient"
[0m18:40:17.209915 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:40:17.212225 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: COMMIT
[0m18:40:17.212807 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:40:17.213370 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: COMMIT
[0m18:40:17.214676 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:17.219785 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:40:17.220448 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_recent_activity_by_patient"} */
drop view if exists "dev"."main"."mart_recent_activity_by_patient__dbt_backup" cascade
[0m18:40:17.221827 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:17.223908 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: Close
[0m18:40:17.224691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84a0741a-9489-46f0-a5f3-f19e89ef5f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127d0950>]}
[0m18:40:17.225587 [info ] [Thread-1 (]: 12 of 12 OK created sql view model main.mart_recent_activity_by_patient ........ [[32mOK[0m in 0.07s]
[0m18:40:17.226478 [debug] [Thread-1 (]: Finished running node model.suvera.mart_recent_activity_by_patient
[0m18:40:17.228184 [debug] [MainThread]: Using duckdb connection "master"
[0m18:40:17.228683 [debug] [MainThread]: On master: BEGIN
[0m18:40:17.229133 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:40:17.229928 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:40:17.230404 [debug] [MainThread]: On master: COMMIT
[0m18:40:17.230866 [debug] [MainThread]: Using duckdb connection "master"
[0m18:40:17.231316 [debug] [MainThread]: On master: COMMIT
[0m18:40:17.232754 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:40:17.234356 [debug] [MainThread]: On master: Close
[0m18:40:17.235077 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:40:17.235521 [debug] [MainThread]: Connection 'model.suvera.mart_recent_activity_by_patient' was properly closed.
[0m18:40:17.236088 [info ] [MainThread]: 
[0m18:40:17.236606 [info ] [MainThread]: Finished running 12 view models in 0 hours 0 minutes and 1.06 seconds (1.06s).
[0m18:40:17.240172 [debug] [MainThread]: Command end result
[0m18:40:17.284616 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m18:40:17.287937 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m18:40:17.301746 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m18:40:17.302615 [info ] [MainThread]: 
[0m18:40:17.303269 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:40:17.303789 [info ] [MainThread]: 
[0m18:40:17.304318 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m18:40:17.308808 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.1040528, "process_in_blocks": "0", "process_kernel_time": 0.81506, "process_mem_max_rss": "139685888", "process_out_blocks": "0", "process_user_time": 4.96916}
[0m18:40:17.309559 [debug] [MainThread]: Command `dbt run` succeeded at 18:40:17.309393 after 3.10 seconds
[0m18:40:17.310394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112584170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122076b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b11370>]}
[0m18:40:17.311052 [debug] [MainThread]: Flushing usage events
[0m18:40:17.817234 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:41:07.204989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccd1d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcab610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcab750>]}


============================== 18:41:07.216525 | 89b20b33-eb96-4053-944b-78b03432a896 ==============================
[0m18:41:07.216525 [info ] [MainThread]: Running with dbt=1.10.1
[0m18:41:07.219108 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/puneeth/Documents/suvera_dbt_project/suvera/logs', 'profiles_dir': '/Users/puneeth/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:41:07.878312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89b20b33-eb96-4053-944b-78b03432a896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d159220>]}
[0m18:41:07.984534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89b20b33-eb96-4053-944b-78b03432a896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db93350>]}
[0m18:41:08.015203 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m18:41:08.200626 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m18:41:08.518838 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:41:08.519435 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:41:08.629316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89b20b33-eb96-4053-944b-78b03432a896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfb7650>]}
[0m18:41:08.795260 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m18:41:08.800855 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m18:41:08.848305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89b20b33-eb96-4053-944b-78b03432a896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df86d50>]}
[0m18:41:08.849056 [info ] [MainThread]: Found 12 models, 4 seeds, 12 data tests, 544 macros
[0m18:41:08.849631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89b20b33-eb96-4053-944b-78b03432a896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e398bb0>]}
[0m18:41:08.853147 [info ] [MainThread]: 
[0m18:41:08.853724 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:41:08.854203 [info ] [MainThread]: 
[0m18:41:08.855208 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:41:08.865274 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m18:41:08.964760 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m18:41:08.965376 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m18:41:08.965862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:09.157974 [debug] [ThreadPool]: SQL status: OK in 0.192 seconds
[0m18:41:09.160971 [debug] [ThreadPool]: On list_dev: Close
[0m18:41:09.161994 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m18:41:09.163106 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m18:41:09.172279 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:41:09.172799 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m18:41:09.173328 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:09.175346 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:41:09.177638 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:41:09.178126 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m18:41:09.178862 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:41:09.179333 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:41:09.179779 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m18:41:09.182525 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:41:09.184127 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m18:41:09.184657 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:41:09.185111 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m18:41:09.185905 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:41:09.186403 [debug] [ThreadPool]: On create_dev_main: Close
[0m18:41:09.189537 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m18:41:09.198028 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m18:41:09.198575 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m18:41:09.199025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:09.199834 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:41:09.200315 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m18:41:09.200788 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m18:41:09.240834 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m18:41:09.243393 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m18:41:09.245622 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m18:41:09.246198 [debug] [ThreadPool]: On list_dev_main: Close
[0m18:41:09.251535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89b20b33-eb96-4053-944b-78b03432a896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5d14a0>]}
[0m18:41:09.252295 [debug] [MainThread]: Using duckdb connection "master"
[0m18:41:09.252768 [debug] [MainThread]: On master: BEGIN
[0m18:41:09.253207 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:41:09.254020 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:41:09.254501 [debug] [MainThread]: On master: COMMIT
[0m18:41:09.254963 [debug] [MainThread]: Using duckdb connection "master"
[0m18:41:09.255406 [debug] [MainThread]: On master: COMMIT
[0m18:41:09.256086 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:41:09.256578 [debug] [MainThread]: On master: Close
[0m18:41:09.261171 [debug] [Thread-1 (]: Began running node model.suvera.stg_activities
[0m18:41:09.262066 [info ] [Thread-1 (]: 1 of 12 START sql view model main.stg_activities ............................... [RUN]
[0m18:41:09.262781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.suvera.stg_activities)
[0m18:41:09.263339 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_activities
[0m18:41:09.274659 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_activities"
[0m18:41:09.276716 [debug] [Thread-1 (]: Began executing node model.suvera.stg_activities
[0m18:41:09.325710 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_activities"
[0m18:41:09.326912 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:41:09.327478 [debug] [Thread-1 (]: On model.suvera.stg_activities: BEGIN
[0m18:41:09.328002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:09.328935 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.329490 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:41:09.330034 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */

  
  create view "dev"."main"."stg_activities__dbt_tmp" as (
    select * 
from "dev"."main"."raw_activities"
  );

[0m18:41:09.331106 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.340107 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:41:09.340729 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
alter view "dev"."main"."stg_activities" rename to "stg_activities__dbt_backup"
[0m18:41:09.342757 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.347343 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:41:09.347960 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
alter view "dev"."main"."stg_activities__dbt_tmp" rename to "stg_activities"
[0m18:41:09.348968 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:41:09.366969 [debug] [Thread-1 (]: On model.suvera.stg_activities: COMMIT
[0m18:41:09.367608 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:41:09.368137 [debug] [Thread-1 (]: On model.suvera.stg_activities: COMMIT
[0m18:41:09.370808 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:41:09.377729 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_activities"
[0m18:41:09.378321 [debug] [Thread-1 (]: On model.suvera.stg_activities: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_activities"} */
drop view if exists "dev"."main"."stg_activities__dbt_backup" cascade
[0m18:41:09.380591 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:41:09.384591 [debug] [Thread-1 (]: On model.suvera.stg_activities: Close
[0m18:41:09.388806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b20b33-eb96-4053-944b-78b03432a896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e691a90>]}
[0m18:41:09.390029 [info ] [Thread-1 (]: 1 of 12 OK created sql view model main.stg_activities .......................... [[32mOK[0m in 0.12s]
[0m18:41:09.391003 [debug] [Thread-1 (]: Finished running node model.suvera.stg_activities
[0m18:41:09.391632 [debug] [Thread-1 (]: Began running node model.suvera.stg_patients
[0m18:41:09.392376 [info ] [Thread-1 (]: 2 of 12 START sql view model main.stg_patients ................................. [RUN]
[0m18:41:09.393963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_activities, now model.suvera.stg_patients)
[0m18:41:09.394652 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_patients
[0m18:41:09.399908 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_patients"
[0m18:41:09.401424 [debug] [Thread-1 (]: Began executing node model.suvera.stg_patients
[0m18:41:09.407797 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_patients"
[0m18:41:09.408950 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:41:09.409508 [debug] [Thread-1 (]: On model.suvera.stg_patients: BEGIN
[0m18:41:09.410020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:09.410912 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.411450 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:41:09.412053 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */

  
  create view "dev"."main"."stg_patients__dbt_tmp" as (
    with source as (
    select * from "dev"."main"."raw_patients"
),

parsed as (
    select
        case
            when regexp_extract(data, '"patient_id": ([0-9]+)', 1) ~ '^[0-9]+$'
            then cast(regexp_extract(data, '"patient_id": ([0-9]+)', 1) as integer)
        end as patient_id,
        case
            when regexp_extract(data, '"practice_id": ([0-9]+)', 1) ~ '^[0-9]+$'
            then cast(regexp_extract(data, '"practice_id": ([0-9]+)', 1) as integer)
        end as practice_id,
        case
            when regexp_extract(data, '"age": ([0-9]+)', 1) ~ '^[0-9]+$'
            then cast(regexp_extract(data, '"age": ([0-9]+)', 1) as integer)
        end as age,
        regexp_extract(data, '"gender": "([^""]*)"', 1) as gender,
        cast(nullif(regexp_extract(data, '"registration_date": "([^"]+)"', 1), '') as date) as registration_date,
        regexp_extract(data, '"email": "([^"]+)"', 1) as email,
        regexp_extract(data, '"phone": "([^"]+)"', 1) as phone,
        string_split(
            replace(
                regexp_extract(data, '"conditions": \[(.*?)\]', 1),
                '"',
                ''
            ),
            ', '
        ) as conditions
    from source
)

select * from parsed
  );

[0m18:41:09.416581 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:41:09.422766 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:41:09.423432 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients" rename to "stg_patients__dbt_backup"
[0m18:41:09.424427 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:41:09.428478 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:41:09.429101 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
alter view "dev"."main"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m18:41:09.430064 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:41:09.432811 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m18:41:09.433451 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:41:09.433991 [debug] [Thread-1 (]: On model.suvera.stg_patients: COMMIT
[0m18:41:09.435391 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.439467 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_patients"
[0m18:41:09.440178 [debug] [Thread-1 (]: On model.suvera.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_patients"} */
drop view if exists "dev"."main"."stg_patients__dbt_backup" cascade
[0m18:41:09.441539 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.443586 [debug] [Thread-1 (]: On model.suvera.stg_patients: Close
[0m18:41:09.444377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b20b33-eb96-4053-944b-78b03432a896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e38e150>]}
[0m18:41:09.445267 [info ] [Thread-1 (]: 2 of 12 OK created sql view model main.stg_patients ............................ [[32mOK[0m in 0.05s]
[0m18:41:09.446170 [debug] [Thread-1 (]: Finished running node model.suvera.stg_patients
[0m18:41:09.446772 [debug] [Thread-1 (]: Began running node model.suvera.stg_pcns
[0m18:41:09.447453 [info ] [Thread-1 (]: 3 of 12 START sql view model main.stg_pcns ..................................... [RUN]
[0m18:41:09.448354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_patients, now model.suvera.stg_pcns)
[0m18:41:09.449042 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_pcns
[0m18:41:09.452752 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_pcns"
[0m18:41:09.454530 [debug] [Thread-1 (]: Began executing node model.suvera.stg_pcns
[0m18:41:09.463959 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_pcns"
[0m18:41:09.465326 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:41:09.465951 [debug] [Thread-1 (]: On model.suvera.stg_pcns: BEGIN
[0m18:41:09.466496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:09.467434 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.468012 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:41:09.468552 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */

  
  create view "dev"."main"."stg_pcns__dbt_tmp" as (
    select * 
from "dev"."main"."raw_pcns"
  );

[0m18:41:09.469517 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:41:09.474735 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:41:09.475357 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */
alter view "dev"."main"."stg_pcns" rename to "stg_pcns__dbt_backup"
[0m18:41:09.476352 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:41:09.480185 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:41:09.480747 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */
alter view "dev"."main"."stg_pcns__dbt_tmp" rename to "stg_pcns"
[0m18:41:09.481645 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:41:09.484414 [debug] [Thread-1 (]: On model.suvera.stg_pcns: COMMIT
[0m18:41:09.485076 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:41:09.485610 [debug] [Thread-1 (]: On model.suvera.stg_pcns: COMMIT
[0m18:41:09.486904 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.562933 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_pcns"
[0m18:41:09.563589 [debug] [Thread-1 (]: On model.suvera.stg_pcns: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_pcns"} */
drop view if exists "dev"."main"."stg_pcns__dbt_backup" cascade
[0m18:41:09.565307 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.567481 [debug] [Thread-1 (]: On model.suvera.stg_pcns: Close
[0m18:41:09.568279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b20b33-eb96-4053-944b-78b03432a896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e781e50>]}
[0m18:41:09.569158 [info ] [Thread-1 (]: 3 of 12 OK created sql view model main.stg_pcns ................................ [[32mOK[0m in 0.12s]
[0m18:41:09.570051 [debug] [Thread-1 (]: Finished running node model.suvera.stg_pcns
[0m18:41:09.570648 [debug] [Thread-1 (]: Began running node model.suvera.stg_practices
[0m18:41:09.571326 [info ] [Thread-1 (]: 4 of 12 START sql view model main.stg_practices ................................ [RUN]
[0m18:41:09.572024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_pcns, now model.suvera.stg_practices)
[0m18:41:09.572581 [debug] [Thread-1 (]: Began compiling node model.suvera.stg_practices
[0m18:41:09.576092 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.stg_practices"
[0m18:41:09.577925 [debug] [Thread-1 (]: Began executing node model.suvera.stg_practices
[0m18:41:09.584384 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.stg_practices"
[0m18:41:09.586083 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:41:09.586708 [debug] [Thread-1 (]: On model.suvera.stg_practices: BEGIN
[0m18:41:09.587232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:09.588179 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.588748 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:41:09.589300 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */

  
  create view "dev"."main"."stg_practices__dbt_tmp" as (
    select * 
from "dev"."main"."raw_practices"
  );

[0m18:41:09.590404 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:41:09.594985 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:41:09.596151 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */
alter view "dev"."main"."stg_practices" rename to "stg_practices__dbt_backup"
[0m18:41:09.597698 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.603195 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:41:09.603838 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */
alter view "dev"."main"."stg_practices__dbt_tmp" rename to "stg_practices"
[0m18:41:09.604816 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:41:09.607164 [debug] [Thread-1 (]: On model.suvera.stg_practices: COMMIT
[0m18:41:09.607775 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:41:09.608303 [debug] [Thread-1 (]: On model.suvera.stg_practices: COMMIT
[0m18:41:09.609498 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.614414 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.stg_practices"
[0m18:41:09.615031 [debug] [Thread-1 (]: On model.suvera.stg_practices: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.stg_practices"} */
drop view if exists "dev"."main"."stg_practices__dbt_backup" cascade
[0m18:41:09.616372 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.618426 [debug] [Thread-1 (]: On model.suvera.stg_practices: Close
[0m18:41:09.619263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b20b33-eb96-4053-944b-78b03432a896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dea13d0>]}
[0m18:41:09.620163 [info ] [Thread-1 (]: 4 of 12 OK created sql view model main.stg_practices ........................... [[32mOK[0m in 0.05s]
[0m18:41:09.621053 [debug] [Thread-1 (]: Finished running node model.suvera.stg_practices
[0m18:41:09.621659 [debug] [Thread-1 (]: Began running node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:41:09.622354 [info ] [Thread-1 (]: 5 of 12 START sql view model main.mart_patients_inactive_3_months_after_first .. [RUN]
[0m18:41:09.623103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.stg_practices, now model.suvera.mart_patients_inactive_3_months_after_first)
[0m18:41:09.623693 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:41:09.627358 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:41:09.628953 [debug] [Thread-1 (]: Began executing node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:41:09.636251 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:41:09.637434 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:41:09.638000 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: BEGIN
[0m18:41:09.638531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:09.639473 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.640074 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:41:09.640721 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */

  
  create view "dev"."main"."mart_patients_inactive_3_months_after_first__dbt_tmp" as (
    with activities as (
    select
        patient_id,
        activity_date
    from "dev"."main"."stg_activities"
),

first_activity as (
    select
        patient_id,
        min(activity_date) as first_date
    from activities
    group by patient_id
),

follow_up_activity as (
    select
        a.patient_id
    from activities a
    join first_activity f
        on a.patient_id = f.patient_id
    where a.activity_date > f.first_date
      and a.activity_date <= f.first_date + interval '90 days'
),

inactive_patients as (
    select
        f.patient_id,
        f.first_date
    from first_activity f
    left join follow_up_activity fu
        on f.patient_id = fu.patient_id
    where fu.patient_id is null
)

select *
from inactive_patients
  );

[0m18:41:09.644823 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:41:09.649998 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:41:09.650685 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */
alter view "dev"."main"."mart_patients_inactive_3_months_after_first" rename to "mart_patients_inactive_3_months_after_first__dbt_backup"
[0m18:41:09.651820 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:41:09.656453 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:41:09.657102 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */
alter view "dev"."main"."mart_patients_inactive_3_months_after_first__dbt_tmp" rename to "mart_patients_inactive_3_months_after_first"
[0m18:41:09.658116 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:41:09.660415 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: COMMIT
[0m18:41:09.661068 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:41:09.661615 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: COMMIT
[0m18:41:09.662896 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.666731 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patients_inactive_3_months_after_first"
[0m18:41:09.667381 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patients_inactive_3_months_after_first"} */
drop view if exists "dev"."main"."mart_patients_inactive_3_months_after_first__dbt_backup" cascade
[0m18:41:09.668690 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.670665 [debug] [Thread-1 (]: On model.suvera.mart_patients_inactive_3_months_after_first: Close
[0m18:41:09.671442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b20b33-eb96-4053-944b-78b03432a896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e796f90>]}
[0m18:41:09.672332 [info ] [Thread-1 (]: 5 of 12 OK created sql view model main.mart_patients_inactive_3_months_after_first  [[32mOK[0m in 0.05s]
[0m18:41:09.673243 [debug] [Thread-1 (]: Finished running node model.suvera.mart_patients_inactive_3_months_after_first
[0m18:41:09.673846 [debug] [Thread-1 (]: Began running node model.suvera.cleaned_patients
[0m18:41:09.674636 [info ] [Thread-1 (]: 6 of 12 START sql view model main.cleaned_patients ............................. [RUN]
[0m18:41:09.675316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_patients_inactive_3_months_after_first, now model.suvera.cleaned_patients)
[0m18:41:09.675876 [debug] [Thread-1 (]: Began compiling node model.suvera.cleaned_patients
[0m18:41:09.679464 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.cleaned_patients"
[0m18:41:09.680989 [debug] [Thread-1 (]: Began executing node model.suvera.cleaned_patients
[0m18:41:09.687483 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.cleaned_patients"
[0m18:41:09.688626 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:41:09.689187 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: BEGIN
[0m18:41:09.689799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:09.690719 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.691260 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:41:09.691910 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */

  
  create view "dev"."main"."cleaned_patients__dbt_tmp" as (
    with deduplicated as (
    select *
    from (
        select *,
               row_number() over (
                   partition by patient_id, practice_id
                   order by registration_date desc
               ) as row_num
        from "dev"."main"."stg_patients"
    )
    where row_num = 1
),

filtered as (
    select *
    from deduplicated
    where age between 0 and 120 and practice_id between 1 and 4 and age != 999
)

select
    patient_id,
    practice_id,
    age,
    gender,
    registration_date,
    email,
    phone,
    conditions
from filtered
  );

[0m18:41:09.696543 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:41:09.701962 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:41:09.702594 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */
alter view "dev"."main"."cleaned_patients" rename to "cleaned_patients__dbt_backup"
[0m18:41:09.703593 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:41:09.708235 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:41:09.708871 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */
alter view "dev"."main"."cleaned_patients__dbt_tmp" rename to "cleaned_patients"
[0m18:41:09.709855 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:41:09.712123 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: COMMIT
[0m18:41:09.712684 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:41:09.713206 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: COMMIT
[0m18:41:09.714644 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.718313 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.cleaned_patients"
[0m18:41:09.718931 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.cleaned_patients"} */
drop view if exists "dev"."main"."cleaned_patients__dbt_backup" cascade
[0m18:41:09.720227 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.722208 [debug] [Thread-1 (]: On model.suvera.cleaned_patients: Close
[0m18:41:09.722973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b20b33-eb96-4053-944b-78b03432a896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de0a510>]}
[0m18:41:09.723881 [info ] [Thread-1 (]: 6 of 12 OK created sql view model main.cleaned_patients ........................ [[32mOK[0m in 0.05s]
[0m18:41:09.724767 [debug] [Thread-1 (]: Finished running node model.suvera.cleaned_patients
[0m18:41:09.725370 [debug] [Thread-1 (]: Began running node model.suvera.qa_flagged_patients
[0m18:41:09.726049 [info ] [Thread-1 (]: 7 of 12 START sql view model main.qa_flagged_patients .......................... [RUN]
[0m18:41:09.727014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.cleaned_patients, now model.suvera.qa_flagged_patients)
[0m18:41:09.727630 [debug] [Thread-1 (]: Began compiling node model.suvera.qa_flagged_patients
[0m18:41:09.732242 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.qa_flagged_patients"
[0m18:41:09.734207 [debug] [Thread-1 (]: Began executing node model.suvera.qa_flagged_patients
[0m18:41:09.740558 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.qa_flagged_patients"
[0m18:41:09.741720 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:41:09.742285 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: BEGIN
[0m18:41:09.742811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:09.743752 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.744319 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:41:09.745069 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */

  
  create view "dev"."main"."qa_flagged_patients__dbt_tmp" as (
    with source as (
    select *
    from "dev"."main"."stg_patients"
),

deduplicated as (
    select *
    from (
        select *,
               row_number() over (
                   partition by patient_id, practice_id
                   order by registration_date desc
               ) as row_num
        from source
    )
),

flagged as (
    select *,
        case
            when row_num > 1 then 'duplicate registration for patient + practice'
            when age not between 0 and 120 then 'invalid age'
            when practice_id is null then 'missing practice_id'
            when practice_id = 999 then 'dummy practice_id (999)'
        end as reason_flagged
    from deduplicated
    where
        row_num > 1
        or age not between 0 and 120
        or practice_id is null
        or practice_id = 999
)

select *
from flagged
  );

[0m18:41:09.748573 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:41:09.754137 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:41:09.754852 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */
alter view "dev"."main"."qa_flagged_patients" rename to "qa_flagged_patients__dbt_backup"
[0m18:41:09.756334 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.762114 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:41:09.762765 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */
alter view "dev"."main"."qa_flagged_patients__dbt_tmp" rename to "qa_flagged_patients"
[0m18:41:09.763931 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.767179 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: COMMIT
[0m18:41:09.767979 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:41:09.768623 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: COMMIT
[0m18:41:09.770013 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.773226 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.qa_flagged_patients"
[0m18:41:09.773910 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.qa_flagged_patients"} */
drop view if exists "dev"."main"."qa_flagged_patients__dbt_backup" cascade
[0m18:41:09.775230 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.777310 [debug] [Thread-1 (]: On model.suvera.qa_flagged_patients: Close
[0m18:41:09.778096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b20b33-eb96-4053-944b-78b03432a896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de1a7b0>]}
[0m18:41:09.779054 [info ] [Thread-1 (]: 7 of 12 OK created sql view model main.qa_flagged_patients ..................... [[32mOK[0m in 0.05s]
[0m18:41:09.779965 [debug] [Thread-1 (]: Finished running node model.suvera.qa_flagged_patients
[0m18:41:09.780829 [debug] [Thread-1 (]: Began running node model.suvera.mart_age_groups_by_pcn
[0m18:41:09.781633 [info ] [Thread-1 (]: 8 of 12 START sql view model main.mart_age_groups_by_pcn ....................... [RUN]
[0m18:41:09.782318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.qa_flagged_patients, now model.suvera.mart_age_groups_by_pcn)
[0m18:41:09.782874 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_age_groups_by_pcn
[0m18:41:09.788153 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_age_groups_by_pcn"
[0m18:41:09.790044 [debug] [Thread-1 (]: Began executing node model.suvera.mart_age_groups_by_pcn
[0m18:41:09.794896 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_age_groups_by_pcn"
[0m18:41:09.796708 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:41:09.797384 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: BEGIN
[0m18:41:09.798107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:09.799076 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.799671 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:41:09.800807 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_age_groups_by_pcn"} */

  
  create view "dev"."main"."mart_age_groups_by_pcn__dbt_tmp" as (
    with patients as (
    select
        patient_id,
        practice_id,
        age,
        case
            when age between 0 and 18 then '0-18'
            when age between 19 and 35 then '19-35'
            when age between 36 and 50 then '36-50'
            when age >= 51 then '51+'
            else 'Unknown'
        end as age_group
    from "dev"."main"."cleaned_patients"
),

practices as (
    select *
    from "dev"."main"."stg_practices"
),

pcns as (
    select *
    from "dev"."main"."stg_pcns"
),

joined as (
    select
        pcn.id as pcn_id,
        pcn.pcn_name,
        p.age_group
    from patients as p
    left join practices pr on p.practice_id = pr.id
    left join pcns pcn on pr.pcn = pcn.id
)

select
    pcn_id,
    pcn_name,
    age_group,
    count(*) as num_patients
from joined
group by pcn_id, pcn_name, age_group
order by pcn_id, age_group
  );

[0m18:41:09.804645 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:41:09.809561 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:41:09.810242 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_age_groups_by_pcn"} */
alter view "dev"."main"."mart_age_groups_by_pcn" rename to "mart_age_groups_by_pcn__dbt_backup"
[0m18:41:09.811271 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:41:09.816733 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:41:09.817471 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_age_groups_by_pcn"} */
alter view "dev"."main"."mart_age_groups_by_pcn__dbt_tmp" rename to "mart_age_groups_by_pcn"
[0m18:41:09.818600 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:41:09.820919 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: COMMIT
[0m18:41:09.821487 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:41:09.822014 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: COMMIT
[0m18:41:09.823404 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.826659 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_age_groups_by_pcn"
[0m18:41:09.827283 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_age_groups_by_pcn"} */
drop view if exists "dev"."main"."mart_age_groups_by_pcn__dbt_backup" cascade
[0m18:41:09.828690 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.830969 [debug] [Thread-1 (]: On model.suvera.mart_age_groups_by_pcn: Close
[0m18:41:09.832232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b20b33-eb96-4053-944b-78b03432a896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddc4890>]}
[0m18:41:09.833228 [info ] [Thread-1 (]: 8 of 12 OK created sql view model main.mart_age_groups_by_pcn .................. [[32mOK[0m in 0.05s]
[0m18:41:09.834120 [debug] [Thread-1 (]: Finished running node model.suvera.mart_age_groups_by_pcn
[0m18:41:09.834725 [debug] [Thread-1 (]: Began running node model.suvera.mart_avg_age_by_practice
[0m18:41:09.835409 [info ] [Thread-1 (]: 9 of 12 START sql view model main.mart_avg_age_by_practice ..................... [RUN]
[0m18:41:09.836079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_age_groups_by_pcn, now model.suvera.mart_avg_age_by_practice)
[0m18:41:09.836640 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_avg_age_by_practice
[0m18:41:09.840937 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_avg_age_by_practice"
[0m18:41:09.842160 [debug] [Thread-1 (]: Began executing node model.suvera.mart_avg_age_by_practice
[0m18:41:09.847681 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_avg_age_by_practice"
[0m18:41:09.849853 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:41:09.850655 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: BEGIN
[0m18:41:09.851339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:09.852331 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.852904 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:41:09.853472 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_avg_age_by_practice"} */

  
  create view "dev"."main"."mart_avg_age_by_practice__dbt_tmp" as (
    with patients as (
    select
        patient_id,
        practice_id,
        age
    from "dev"."main"."cleaned_patients"
),

aggregated as (
    select
        practice_id,
        avg(age) as avg_age,
        count(*) as num_patients
    from patients
    group by practice_id
)

select * from aggregated
order by avg_age desc
  );

[0m18:41:09.856187 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:41:09.863887 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:41:09.864506 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_avg_age_by_practice"} */
alter view "dev"."main"."mart_avg_age_by_practice" rename to "mart_avg_age_by_practice__dbt_backup"
[0m18:41:09.865750 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:41:09.870051 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:41:09.870646 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_avg_age_by_practice"} */
alter view "dev"."main"."mart_avg_age_by_practice__dbt_tmp" rename to "mart_avg_age_by_practice"
[0m18:41:09.871620 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:41:09.873862 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: COMMIT
[0m18:41:09.874433 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:41:09.874970 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: COMMIT
[0m18:41:09.876244 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.879901 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_avg_age_by_practice"
[0m18:41:09.880482 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_avg_age_by_practice"} */
drop view if exists "dev"."main"."mart_avg_age_by_practice__dbt_backup" cascade
[0m18:41:09.881794 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.883833 [debug] [Thread-1 (]: On model.suvera.mart_avg_age_by_practice: Close
[0m18:41:09.884614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b20b33-eb96-4053-944b-78b03432a896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1f1eb0>]}
[0m18:41:09.885501 [info ] [Thread-1 (]: 9 of 12 OK created sql view model main.mart_avg_age_by_practice ................ [[32mOK[0m in 0.05s]
[0m18:41:09.886395 [debug] [Thread-1 (]: Finished running node model.suvera.mart_avg_age_by_practice
[0m18:41:09.887006 [debug] [Thread-1 (]: Began running node model.suvera.mart_hypertension_pct_by_practice
[0m18:41:09.887693 [info ] [Thread-1 (]: 10 of 12 START sql view model main.mart_hypertension_pct_by_practice ........... [RUN]
[0m18:41:09.888450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_avg_age_by_practice, now model.suvera.mart_hypertension_pct_by_practice)
[0m18:41:09.889029 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_hypertension_pct_by_practice
[0m18:41:09.892732 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_hypertension_pct_by_practice"
[0m18:41:09.894295 [debug] [Thread-1 (]: Began executing node model.suvera.mart_hypertension_pct_by_practice
[0m18:41:09.899139 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_hypertension_pct_by_practice"
[0m18:41:09.900836 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:41:09.901784 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: BEGIN
[0m18:41:09.902382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:09.903327 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.903956 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:41:09.904562 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_hypertension_pct_by_practice"} */

  
  create view "dev"."main"."mart_hypertension_pct_by_practice__dbt_tmp" as (
    with patients as (
    select
        patient_id,
        practice_id,
        conditions
    from "dev"."main"."cleaned_patients"
),

exploded as (
    select
        patient_id,
        practice_id,
        unnest(conditions) as condition
    from patients
),

hypertension_counts as (
    select
        practice_id,
        count(distinct patient_id) as patients_with_hypertension
    from exploded
    where lower(condition) = 'hypertension'
    group by practice_id
),

total_patients as (
    select
        practice_id,
        count(distinct patient_id) as total_patients
    from patients
    group by practice_id
)

select
    t.practice_id,
    t.total_patients,
    coalesce(h.patients_with_hypertension, 0) as patients_with_hypertension,
    round(
        coalesce(h.patients_with_hypertension, 0) * 100.0 / t.total_patients,
        1
    ) as pct_with_hypertension
from total_patients t
left join hypertension_counts h
    on t.practice_id = h.practice_id
order by pct_with_hypertension desc
  );

[0m18:41:09.910764 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:41:09.917363 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:41:09.918095 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_hypertension_pct_by_practice"} */
alter view "dev"."main"."mart_hypertension_pct_by_practice" rename to "mart_hypertension_pct_by_practice__dbt_backup"
[0m18:41:09.919239 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.924300 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:41:09.925212 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_hypertension_pct_by_practice"} */
alter view "dev"."main"."mart_hypertension_pct_by_practice__dbt_tmp" rename to "mart_hypertension_pct_by_practice"
[0m18:41:09.926609 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.930253 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: COMMIT
[0m18:41:09.931171 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:41:09.932349 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: COMMIT
[0m18:41:09.935829 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:41:09.939752 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_hypertension_pct_by_practice"
[0m18:41:09.940481 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_hypertension_pct_by_practice"} */
drop view if exists "dev"."main"."mart_hypertension_pct_by_practice__dbt_backup" cascade
[0m18:41:09.941807 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.943881 [debug] [Thread-1 (]: On model.suvera.mart_hypertension_pct_by_practice: Close
[0m18:41:09.944955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b20b33-eb96-4053-944b-78b03432a896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7eaed0>]}
[0m18:41:09.945940 [info ] [Thread-1 (]: 10 of 12 OK created sql view model main.mart_hypertension_pct_by_practice ...... [[32mOK[0m in 0.06s]
[0m18:41:09.946856 [debug] [Thread-1 (]: Finished running node model.suvera.mart_hypertension_pct_by_practice
[0m18:41:09.947470 [debug] [Thread-1 (]: Began running node model.suvera.mart_patient_count_by_pcn
[0m18:41:09.948339 [info ] [Thread-1 (]: 11 of 12 START sql view model main.mart_patient_count_by_pcn ................... [RUN]
[0m18:41:09.949142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_hypertension_pct_by_practice, now model.suvera.mart_patient_count_by_pcn)
[0m18:41:09.949880 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_patient_count_by_pcn
[0m18:41:09.954367 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_patient_count_by_pcn"
[0m18:41:09.955499 [debug] [Thread-1 (]: Began executing node model.suvera.mart_patient_count_by_pcn
[0m18:41:09.961930 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_patient_count_by_pcn"
[0m18:41:09.963087 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:41:09.963649 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: BEGIN
[0m18:41:09.964171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:09.965126 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.965758 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:41:09.966631 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patient_count_by_pcn"} */

  
  create view "dev"."main"."mart_patient_count_by_pcn__dbt_tmp" as (
    with patients as (
    select *
    from "dev"."main"."cleaned_patients"
),

practices as (
    select *
    from "dev"."main"."stg_practices"
),

pcns as (
    select *
    from "dev"."main"."stg_pcns"
),

joined as (
    select
        pcn.id as pcn_id,
        pcn.pcn_name pcn_name,
        patient.patient_id
    from patients as patient
    left join practices as practice
        on patient.practice_id = practice.id
    left join pcns as pcn
        on practice.pcn = pcn.id
)

select
    pcn_id,
    pcn_name,
    count(distinct patient_id) as num_patients
from joined
group by 1, 2
order by num_patients desc
  );

[0m18:41:09.970753 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:41:09.976617 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:41:09.977280 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patient_count_by_pcn"} */
alter view "dev"."main"."mart_patient_count_by_pcn" rename to "mart_patient_count_by_pcn__dbt_backup"
[0m18:41:09.978306 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:41:09.982545 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:41:09.983574 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patient_count_by_pcn"} */
alter view "dev"."main"."mart_patient_count_by_pcn__dbt_tmp" rename to "mart_patient_count_by_pcn"
[0m18:41:09.984790 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.987562 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: COMMIT
[0m18:41:09.988281 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:41:09.988833 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: COMMIT
[0m18:41:09.990109 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.993832 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_patient_count_by_pcn"
[0m18:41:09.994412 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_patient_count_by_pcn"} */
drop view if exists "dev"."main"."mart_patient_count_by_pcn__dbt_backup" cascade
[0m18:41:09.995701 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:09.997700 [debug] [Thread-1 (]: On model.suvera.mart_patient_count_by_pcn: Close
[0m18:41:09.998731 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b20b33-eb96-4053-944b-78b03432a896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7eaed0>]}
[0m18:41:09.999972 [info ] [Thread-1 (]: 11 of 12 OK created sql view model main.mart_patient_count_by_pcn .............. [[32mOK[0m in 0.05s]
[0m18:41:10.001375 [debug] [Thread-1 (]: Finished running node model.suvera.mart_patient_count_by_pcn
[0m18:41:10.002048 [debug] [Thread-1 (]: Began running node model.suvera.mart_recent_activity_by_patient
[0m18:41:10.002824 [info ] [Thread-1 (]: 12 of 12 START sql view model main.mart_recent_activity_by_patient ............. [RUN]
[0m18:41:10.003521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.suvera.mart_patient_count_by_pcn, now model.suvera.mart_recent_activity_by_patient)
[0m18:41:10.004082 [debug] [Thread-1 (]: Began compiling node model.suvera.mart_recent_activity_by_patient
[0m18:41:10.008016 [debug] [Thread-1 (]: Writing injected SQL for node "model.suvera.mart_recent_activity_by_patient"
[0m18:41:10.009851 [debug] [Thread-1 (]: Began executing node model.suvera.mart_recent_activity_by_patient
[0m18:41:10.015471 [debug] [Thread-1 (]: Writing runtime sql for node "model.suvera.mart_recent_activity_by_patient"
[0m18:41:10.017304 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:41:10.018161 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: BEGIN
[0m18:41:10.018709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:10.019679 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:10.020278 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:41:10.020879 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_recent_activity_by_patient"} */

  
  create view "dev"."main"."mart_recent_activity_by_patient__dbt_tmp" as (
    with patients as (
    select patient_id
    from "dev"."main"."cleaned_patients"
),

activities as (
    select
        patient_id,
        activity_date
    from "dev"."main"."stg_activities"
),

filtered as (
    select *
    from activities
    where patient_id in (select patient_id from patients)
)

select
    patient_id,
    max(activity_date) as most_recent_activity
from filtered
group by patient_id
  );

[0m18:41:10.024621 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:41:10.029127 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:41:10.030150 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_recent_activity_by_patient"} */
alter view "dev"."main"."mart_recent_activity_by_patient" rename to "mart_recent_activity_by_patient__dbt_backup"
[0m18:41:10.031950 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:10.039615 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:41:10.040289 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_recent_activity_by_patient"} */
alter view "dev"."main"."mart_recent_activity_by_patient__dbt_tmp" rename to "mart_recent_activity_by_patient"
[0m18:41:10.041308 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:41:10.043705 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: COMMIT
[0m18:41:10.044410 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:41:10.045043 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: COMMIT
[0m18:41:10.046435 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:10.050680 [debug] [Thread-1 (]: Using duckdb connection "model.suvera.mart_recent_activity_by_patient"
[0m18:41:10.051510 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "suvera", "target_name": "dev", "node_id": "model.suvera.mart_recent_activity_by_patient"} */
drop view if exists "dev"."main"."mart_recent_activity_by_patient__dbt_backup" cascade
[0m18:41:10.052911 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:10.054983 [debug] [Thread-1 (]: On model.suvera.mart_recent_activity_by_patient: Close
[0m18:41:10.055850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b20b33-eb96-4053-944b-78b03432a896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1f0770>]}
[0m18:41:10.056732 [info ] [Thread-1 (]: 12 of 12 OK created sql view model main.mart_recent_activity_by_patient ........ [[32mOK[0m in 0.05s]
[0m18:41:10.057619 [debug] [Thread-1 (]: Finished running node model.suvera.mart_recent_activity_by_patient
[0m18:41:10.059456 [debug] [MainThread]: Using duckdb connection "master"
[0m18:41:10.060000 [debug] [MainThread]: On master: BEGIN
[0m18:41:10.060453 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:41:10.061298 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:41:10.061790 [debug] [MainThread]: On master: COMMIT
[0m18:41:10.062264 [debug] [MainThread]: Using duckdb connection "master"
[0m18:41:10.062713 [debug] [MainThread]: On master: COMMIT
[0m18:41:10.063428 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:41:10.064171 [debug] [MainThread]: On master: Close
[0m18:41:10.064837 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:41:10.065334 [debug] [MainThread]: Connection 'model.suvera.mart_recent_activity_by_patient' was properly closed.
[0m18:41:10.065917 [info ] [MainThread]: 
[0m18:41:10.066601 [info ] [MainThread]: Finished running 12 view models in 0 hours 0 minutes and 1.21 seconds (1.21s).
[0m18:41:10.071276 [debug] [MainThread]: Command end result
[0m18:41:10.115423 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/manifest.json
[0m18:41:10.118334 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/semantic_manifest.json
[0m18:41:10.129987 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/puneeth/Documents/suvera_dbt_project/suvera/target/run_results.json
[0m18:41:10.130621 [info ] [MainThread]: 
[0m18:41:10.131419 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:41:10.131993 [info ] [MainThread]: 
[0m18:41:10.132546 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m18:41:10.137401 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.0708673, "process_in_blocks": "0", "process_kernel_time": 0.839845, "process_mem_max_rss": "136155136", "process_out_blocks": "0", "process_user_time": 4.721221}
[0m18:41:10.138288 [debug] [MainThread]: Command `dbt run` succeeded at 18:41:10.138094 after 3.07 seconds
[0m18:41:10.139232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0b9010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de9f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbca7b0>]}
[0m18:41:10.140157 [debug] [MainThread]: Flushing usage events
[0m18:41:10.585043 [debug] [MainThread]: An error was encountered while trying to flush usage events
